{"version":3,"file":"main.a0521281796572b0.js","mappings":"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AK,kDACLvd,GAAI,iDAEN,CACEud,IAAK,wDACLvd,GAAI,8CAEN,CACEud,IAAK,sCACLvd,GAAI,0CAEN,CACEud,IAAK,mCACLvd,GAAI,wCAEN,CACEud,IAAK,4EACLvd,GAAI,0CAEN,CACEud,IAAK,oEACLvd,GAAI,6CAEN,CACEud,IAAK,oEACLvd,GAAI,yDAEN,CACEud,IAAK,yEACLvd,GAAI,8DAEN,CACEud,IAAK,2CACLvd,GAAI,wCAEN,CACEud,IAAK,gEACLvd,GAAI,oDAEN,CACEud,IAAK,6CACLvd,GAAI,yDAEN,CACEud,IAAK,kEACLvd,GAAI,yCAEN,CACEud,IAAK,wCACLvd,GAAI,qDAEN,CACEud,IAAK,6CACLvd,GAAI,0DAEN,CACEud,IAAK,4CACLvd,GAAI,sDAEN,CACEud,IAAK,iDACLvd,GAAI,2DAEN,CACEud,IAAK,yCACLvd,GAAI,uDAEN,CACEud,IAAK,8CACLvd,GAAI,4DAEN,CACEud,IAAK,0BACLvd,GAAI,kDAEN,CACEud,IAAK,8CACLvd,GAAI,iDAEN,CACEud,IAAK,oGACLvd,GAAI,qCAEN,CACEud,IAAK,gEACLvd,GAAI,wCAEN,CACEud,IAAK,sDACLvd,GAAI,+CAEN,CACEud,IAAK,wDACLvd,GAAI,8CAEN,CACEud,IAAK,sDACLvd,GAAI,4CAEN,CACEud,IAAK,0DACLvd,GAAI,0CAEN,CACEud,IAAK,oCACLvd,GAAI,gCAEN,CACEud,IAAK,oEACLvd,GAAI,kDAEN,CACEud,IAAK,0CACLvd,GAAI,oDAEN,CACEud,IAAK,wEACLvd,GAAI,kDAEN,CACEud,IAAK,wFACLvd,GAAI,wDAEN,CACEud,IAAK,wBACLvd,GAAI,qDAEN,CACEud,IAAK,sEACLvd,GAAI,2DAEN,CACEud,IAAK,6DACLvd,GAAI,sDAEN,CACEud,IAAK,iGACLvd,GAAI,8CAEN,CACEud,IAAK,mDACLvd,GAAI,gDAEN,CACEud,IAAK,kFACLvd,GAAI,uCAEN,CACEud,IAAK,kEACLvd,GAAI,6CAEN,CACEud,IAAK,gCACLvd,GAAI,uCAEN,CACEud,IAAK,oDACLvd,GAAI,oDAEN,CACEud,IAAK,gEACLvd,GAAI,+CAEN,CACEud,IAAK,iCACLvd,GAAI,oCAEN,CACEud,IAAK,mDACLvd,GAAI,kCAEN,CACEud,IAAK,kCACLvd,GAAI,8BAEN,CACEud,IAAK,kGACLvd,GAAI,mCAEN,CACEud,IAAK,kMACLvd,GAAI,8CAEN,CACEud,IAAK,6CACLvd,GAAI,uCAEN,CACEud,IAAK,sDACLvd,GAAI,kCAEN,CACEud,IAAK,4FACLvd,GAAI,gDAEN,CACEud,IAAK,yDACLvd,GAAI,0DAEN,CACEud,IAAK,+FACLvd,GAAI,gDAEN,CACEud,IAAK,uCACLvd,GAAI,kCAEN,CACEud,IAAK,sDACLvd,GAAI,yCAEN,CACEud,IAAK,6DACLvd,GAAI,6CAEN,CACEud,IAAK,gDACLvd,GAAI,2BAEN,CACEud,IAAK,0EACLvd,GAAI,qCAEN,CACEud,IAAK,yDACLvd,GAAI,+BAEN,CACEud,IAAK,8DACLvd,GAAI,gCAEN,CACEud,IAAK,sBACLvd,GAAI,gCAEN,CACEud,IAAK,8KACLvd,GAAI,mDAEN,CACEud,IAAK,qDACLvd,GAAI,uCAEN,CACEud,IAAK,kDACLvd,GAAI,sCAEN,CACEud,IAAK,mGACLvd,GAAI,2CAEN,CACEud,IAAK,+DACLvd,GAAI,mDAEN,CACEud,IAAK,0EACLvd,GAAI,qDAEN,CACEud,IAAK,gFACLvd,GAAI,iDAEN,CACEud,IAAK,0EACLvd,GAAI,qDAEN,CACEud,IAAK,sFACLvd,GAAI,qDAEN,CACEud,IAAK,0EACLvd,GAAI,mDAEN,CACEud,IAAK,sCACLvd,GAAI,iDAEN,CACEud,IAAK,8CACLvd,GAAI,+CAEN,CACEud,IAAK,wDACLvd,GAAI,mDAEN,CACEud,IAAK,0FACLvd,GAAI,4DAEN,CACEud,IAAK,kEACLvd,GAAI,qDAEN,CACEud,IAAK,8DACLvd,GAAI,sDAEN,CACEud,IAAK,6GACLvd,GAAI,4CAEN,CACEud,IAAK,6JACLvd,GAAI,+CAEN,CACEud,IAAK,sIACLvd,GAAI,2CAEN,CACEud,IAAK,mDACLvd,GAAI,qDAEN,CACEud,IAAK,sEACLvd,GAAI,2DAEN,CACEud,IAAK,gGACLvd,GAAI,uDAEN,CACEud,IAAK,sDACLvd,GAAI,0DAEN,CACEud,IAAK,gMACLvd,GAAI,+CAEN,CACEud,IAAK,iGACLvd,GAAI,0CAEN,CACEud,IAAK,wHACLvd,GAAI,4CAEN,CACEud,IAAK,uDACLvd,GAAI,6CAEN,CACEud,IAAK,0HACLvd,GAAI,6CAEN,CACEud,IAAK,8IACLvd,GAAI,oDAEN,CACEud,IAAK,yFACLvd,GAAI,8CAEN,CACEud,IAAK,2GACLvd,GAAI,mDAEN,CACEud,IAAK,0DACLvd,GAAI,6CAEN,CACEud,IAAK,2DACLvd,GAAI,8CAEN,CACEud,IAAK,mFACLvd,GAAI,mDAEN,CACEud,IAAK,mGACLvd,GAAI,wDAEN,CACEud,IAAK,0EACLvd,GAAI,wDAEN,CACEud,IAAK,8DACLvd,GAAI,iDAEN,CACEud,IAAK,uDACLvd,GAAI,+CAEN,CACEud,IAAK,+CACLvd,GAAI,0CAEN,CACEud,IAAK,qEACLvd,GAAI,4CAEN,CACEud,IAAK,qCACLvd,GAAI,4CAEN,CACEud,IAAK,6DACLvd,GAAI,2CAEN,CACEud,IAAK,yDACLvd,GAAI,2CAEN,CACEud,IAAK,kFACLvd,GAAI,4CAEN,CACEud,IAAK,kFACLvd,GAAI,2CAEN,CACEud,IAAK,sDACLvd,GAAI,kDAEN,CACEud,IAAK,yIACLvd,GAAI,8CAEN,CACEud,IAAK,oFACLvd,GAAI,gDAEN,CACEud,IAAK,sFACLvd,GAAI,iDAEN,CACEud,IAAK,+CACLvd,GAAI,kDAEN,CACEud,IAAK,2DACLvd,GAAI,mDAEN,CACEud,IAAK,sGACLvd,GAAI,+CAEN,CACEud,IAAK,gDACLvd,GAAI,kDAEN,CACEud,IAAK,kDACLvd,GAAI,kDAEN,CACEud,IAAK,kDACLvd,GAAI,mDAEN,CACEud,IAAK,qCACLvd,GAAI,yCAEN,CACEud,IAAK,4CACLvd,GAAI,0CAEN,CACEud,IAAK,oCACLvd,GAAI,yCAEN,CACEud,IAAK,oEACLvd,GAAI,gCAEN,CACEud,IAAK,8DACLvd,GAAI,sCAEN,CACEud,IAAK,+CACLvd,GAAI,+CAEN,CACEud,IAAK,mFACLvd,GAAI,4CAEN,CACEud,IAAK,4EACLvd,GAAI,mDAEN,CACEud,IAAK,mFACLvd,GAAI,2CAEN,CACEud,IAAK,+EACLvd,GAAI,2CAEN,CACEud,IAAK,4GACLvd,GAAI,+DAEN,CACEud,IAAK,4FACLvd,GAAI,uDAEN,CACEud,IAAK,yEACLvd,GAAI,6CAEN,CACEud,IAAK,sCACLvd,GAAI,iCAEN,CACEud,IAAK,kFACLvd,GAAI,2CAEN,CACEud,IAAK,0DACLvd,GAAI,sCAEN,CACEud,IAAK,4CACLvd,GAAI,qCAEN,CACEud,IAAK,2DACLvd,GAAI,mCAEN,CACEud,IAAK,4DACLvd,GAAI,2CAEN,CACEud,IAAK,uDACLvd,GAAI,0CAEN,CACEud,IAAK,gDACLvd,GAAI,yCAEN,CACEud,IAAK,mCACLvd,GAAI,6BAEN,CACEud,IAAK,uDACLvd,GAAI,6BAEN,CACEud,IAAK,2EACLvd,GAAI,4CAEN,CACEud,IAAK,gEACLvd,GAAI,kCAEN,CACEud,IAAK,sEACLvd,GAAI,mCAEN,CACEud,IAAK,wEACLvd,GAAI,qCAEN,CACEud,IAAK,sEACLvd,GAAI,yCAEN,CACEud,IAAK,8CACLvd,GAAI,iCAEN,CACEud,IAAK,8BACLvd,GAAI,gCAEN,CACEud,IAAK,6BACLvd,GAAI,uCAEN,CACEud,IAAK,kDACLvd,GAAI,mCAEN,CACEud,IAAK,4BACLvd,GAAI,2CAEN,CACEud,IAAK,8BACLvd,GAAI,6CAEN,CACEud,IAAK,8CACLvd,GAAI,2CAEN,CACEud,IAAK,oEACLvd,GAAI,2BAEN,CACEud,IAAK,0BACLvd,GAAI,oCAEN,CACEud,IAAK,oDACLvd,GAAI,6BAEN,CACEud,IAAK,gEACLvd,GAAI,oCAEN,CACEud,IAAK,8CACLvd,GAAI,8BAEN,CACEud,IAAK,2BACLvd,GAAI,8BAEN,CACEud,IAAK,yCACLvd,GAAI,0BAEN,CACEud,IAAK,wBACLvd,GAAI,sCAEN,CACEud,IAAK,uCACLvd,GAAI,kCAEN,CACEud,IAAK,oCACLvd,GAAI,kCAEN,CACEud,IAAK,oCACLvd,GAAI,kCAEN,CACEud,IAAK,oDACLvd,GAAI,gCAEN,CACEud,IAAK,+BACLvd,GAAI,uCAEN,CACEud,IAAK,oDACLvd,GAAI,wCAEN,CACEud,IAAK,oCACLvd,GAAI,0BAEN,CACEud,IAAK,iEACLvd,GAAI,4CAEN,CACEud,IAAK,8GACLvd,GAAI,oCAEN,CACEud,IAAK,4GACLvd,GAAI,+CAEN,CACEud,IAAK,wDACLvd,GAAI,8CAEN,CACEud,IAAK,yCACLvd,GAAI,sCAEN,CACEud,IAAK,gDACLvd,GAAI,qCAEN,CACEud,IAAK,mDACLvd,GAAI,wCAEN,CACEud,IAAK,6DACLvd,GAAI,0CAEN,CACEud,IAAK,6CACLvd,GAAI,0CAEN,CACEud,IAAK,+EACLvd,GAAI,kCAEN,CACEud,IAAK,qCACLvd,GAAI,0CAEN,CACEud,IAAK,oBACLvd,GAAI,4CAEN,CACEud,IAAK,4LACLvd,GAAI,2BAEN,CACEud,IAAK,6GACLvd,GAAI,8CAEN,CACEud,IAAK,6DACLvd,GAAI,gCAEN,CACEud,IAAK,0EACLvd,GAAI,4BAEN,CACEud,IAAK,oFACLvd,GAAI,mCAEN,CACEud,IAAK,0DACLvd,GAAI,iCAEN,CACEud,IAAK,iCACLvd,GAAI,kDAEN,CACEud,IAAK,uBACLvd,GAAI,qBAEN,CACEud,IAAK,yEACLvd,GAAI,0CAEN,CACEud,IAAK,iBACLvd,GAAI,2BAEN,CACEud,IAAK,oDACLvd,GAAI,mCAEN,CACEud,IAAK,2DACLvd,GAAI,kCAEN,CACEud,IAAK,8DACLvd,GAAI,uCAEN,CACEud,IAAK,uEACLvd,GAAI,iBAEN,CACEud,IAAK,8FACLvd,GAAI,uDAEN,CACEud,IAAK,gFACLvd,GAAI,0CAEN,CACEud,IAAK,iGACLvd,GAAI,qCAEN,CACEud,IAAK,0GACLvd,GAAI,+CAEN,CACEud,IAAK,yIACLvd,GAAI,yCAEN,CACEud,IAAK,qIACLvd,GAAI,oDAEN,CACEud,IAAK,4IACLvd,GAAI,4CAEN,CACEud,IAAK,oFACLvd,GAAI,wCAEN,CACEud,IAAK,wGACLvd,GAAI,mDAEN,CACEud,IAAK,sFACLvd,GAAI,8CAEN,CACEud,IAAK,kFACLvd,GAAI,0CAEN,CACEud,IAAK,4EACLvd,GAAI,8CAEN,CACEud,IAAK,4EACLvd,GAAI,8CAEN,CACEud,IAAK,0EACLvd,GAAI,6CAEN,CACEud,IAAK,mBACLvd,GAAI,YAEN,CACEud,IAAK,iDACLvd,GAAI,sDAEN,CACEud,IAAK,qBACLvd,GAAI,qBAEN,CACEud,IAAK,4CACLvd,GAAI,qBAEN,CACEud,IAAK,8CACLvd,GAAI,6BAEN,CACEud,IAAK,kDACLvd,GAAI,+BAEN,CACEud,IAAK,oDACLvd,GAAI,8BAEN,CACEud,IAAK,oCACLvd,GAAI,8BAEN,CACEud,IAAK,2CACLvd,GAAI,6BAEN,CACEud,IAAK,qDACLvd,GAAI,4BAEN,CACEud,IAAK,8DACLvd,GAAI,yBAEN,CACEud,IAAK,uEACLvd,GAAI,oBAEN,CACEud,IAAK,4FACLvd,GAAI,yBAEN,CACEud,IAAK,6CACLvd,GAAI,2BAEN,CACEud,IAAK,sCACLvd,GAAI,yBAEN,CACEud,IAAK,sBACLvd,GAAI,qBAEN,CACEud,IAAK,iDACLvd,GAAI,mDAEN,CACEud,IAAK,wCACLvd,GAAI,iBAEN,CACEud,IAAK,oDACLvd,GAAI,oBAEN,CACEud,IAAK,sBACLvd,GAAI,qBAEN,CACEud,IAAK,qEACLvd,GAAI,uBAEN,CACEud,IAAK,2BACLvd,GAAI,aAEN,CACEud,IAAK,sCACLvd,GAAI,YAEN,CACEud,IAAK,+CACLvd,GAAI,uBAEN,CACEud,IAAK,2CACLvd,GAAI,0BAEN,CACEud,IAAK,gFACLvd,GAAI,+BAEN,CACEud,IAAK,8HACLvd,GAAI,yCAEN,CACEud,IAAK,0IACLvd,GAAI,sCAEN,CACEud,IAAK,gHACLvd,GAAI,wCAEN,CACEud,IAAK,yCACLvd,GAAI,uCAEN,CACEud,IAAK,oCACLvd,GAAI,kCAEN,CACEud,IAAK,wCACLvd,GAAI,qCAEN,CACEud,IAAK,0CACLvd,GAAI,kCAEN,CACEud,IAAK,gDACLvd,GAAI,sCAEN,CACEud,IAAK,wCACLvd,GAAI,0BAEN,CACEud,IAAK,iFACLvd,GAAI,qCAEN,CACEud,IAAK,sGACLvd,GAAI,oCAEN,CACEud,IAAK,2GACLvd,GAAI,qCAEN,CACEud,IAAK,kHACLvd,GAAI,6CAEN,CACEud,IAAK,4GACLvd,GAAI,oCAEN,CACEud,IAAK,6GACLvd,GAAI,iCAEN,CACEud,IAAK,sDACLvd,GAAI,2CAEN,CACEud,IAAK,+DACLvd,GAAI,mDAEN,CACEud,IAAK,4EACLvd,GAAI,uDAEN,CACEud,IAAK,mDACLvd,GAAI,qCAEN,CACEud,IAAK,qHACLvd,GAAI,8CAEN,CACEud,IAAK,yJACLvd,GAAI,oCAEN,CACEud,IAAK,uGACLvd,GAAI,iCAEN,CACEud,IAAK,2CACLvd,GAAI,mCAEN,CACEud,IAAK,qCAEP,CACEA,IAAK,oCAEP,CACEA,IAAK,sCAEP,CACEA,IAAK,uCACLvd,GAAI,WAEN,CACEud,IAAK,0DACLvd,GAAI,mCAEN,CACEud,IAAK,8DACLvd,GAAI,6BAEN,CACEud,IAAK,sDACLvd,GAAI,6CAEN,CACEud,IAAK,kDACLvd,GAAI,2CAEN,CACEud,IAAK,8CACLvd,GAAI,0CAEN,CACEud,IAAK,oDACLvd,GAAI,oCAEN,CACEud,IAAK,iDACLvd,GAAI,0CAEN,CACEud,IAAK,6CACLvd,GAAI,yCAEN,CACEud,IAAK,mDACLvd,GAAI,mCAEN,CACEud,IAAK,8CACLvd,GAAI,uCAEN,CACEud,IAAK,0CACLvd,GAAI,sCAEN,CACEud,IAAK,gDACLvd,GAAI,gCAEN,CACEud,IAAK,oDACLvd,GAAI,6CAEN,CACEud,IAAK,gDACLvd,GAAI,4CAEN,CACEud,IAAK,sDACLvd,GAAI,sCAEN,CACEud,IAAK,8CACLvd,GAA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YAkCFV,GAAb,GC1KIv0E,sBACFk1E,SACAz2E,OAAO4C,QAAQI,IAAM,cAGvB0zE,OACGC,gBAAgBb,IAChBt8C,MAAOzU,GAAQniB,QAAQI,IAAI+hB,sBCb9B,OACA,aACA,gBACA,WACA,eACA,kBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,cACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,YACA,eACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,gBACA,mBACA,gBACA,mBACA,eACA,kBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,cACA,iBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,mBACA,gBACA,WACA,cACA,aACA,gBACA,aACA,gBACA,YACA,eACA,mBACA,sBACA,kBACA,qBACA,aACA,gBACA,aACA,gBACA,WACA,cACA,aACA,gBACA,aACA,gBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,iBACA,oBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,mBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,kBACA,qBACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,cACA,iBACA,aACA,gBACA,aACA,gBACA,aACA,gBACA,gBACA,mBACA,cACA,iBACA,aACA,gBACA,cACA,iBACA,cACA,kBACA,qBACA,iBACA,gBACA,mBACA,aACA,gBACA,aACA,gBACA,aACA,kBACA,qBACA,gBACA,aACA,gBACA,mBACA,sBACA,aACA,gBACA,gBACA,mBACA,gBACA,mBACA,gBACA,mBACA,gBACA,oBAIA,cACA,WACA,YAEA,cACA,cACA,8CACA,gCACAe,EAEA,YAEAulB,kBACA,uBAEAA,YACAurC,aACAvrC","names":["ModalComponent","constructor","cd","this","Subscription","modalSub","currentModel","subscribe","load","forceClose","undefined","name","isOpen","willOpen","open","data","close","detectChanges","ngOnInit","ngOnDestroy","unsubscribe","window","innerHeight","document","body","scrollHeight","style","marginRight","overflowY","isMobile","documentElement","getPropertyValue","setTimeout","scrollTo","top","BehaviorSubject","i0","selectors","QrScannerComponent","beaconService","deeplinkService","messageService","super","_CONSTANTS","environment","EventEmitter","openModal","override","scan","loadingCam","QrScanner","v","videoplayer","_a","nativeElement","errorMessage","qrScanner","f","_b","result","handleQrCode","start","stop","destroy","e","console","warn","scanResult","qrString","log","pairingInfo","QRtoPairingJson","preNotifyPairing","addPeer","scanResponse","emit","pkh","closeModal","addError","handlePaste","ev","env","production","clipboardString","clipboardData","getData","manualInput","Display","Size","AssetComponent","elRef","tokenService","image","medium","loaderUrl","hideSpinner","display","none","ngOnChanges","changes","P","assets","previousValue","currentValue","JSON","stringify","N","_c","j","_d","p0","assetToUrl","pickAsset","z","_e","p1","A","_f","from","to","reload","ngAfterViewInit","lazyLoad","dataSrc","preSrc","postSrc","mimeType","updateDisplay","isImage","requires","includes","isAudio","audio","isVideo","video","is3D","threeD","startsWith","onLoad","target","id","onLoadData","muted","volume","onError","errors","evaluateInvalid","unknownUrl","type","priorityList","uri","evaluate","poster","asset","determineMime","error","setSrc","obs","IntersectionObserver","entries","_","forEach","entry","isIntersecting","unobserve","inView","observe","url","Error","MODEL_3D_WHITELIST","getContractAddressFromAsset","response","i","ok","fetch","method","headers","get","contractAddress","size","slice","CONSTANTS","ToggleComponent","state","default","toggle","stateChange","AdvancedToggleComponent","ctx","ctx_r7","l","width","height","gradient","chartArea","theme","replace","chartWidth","right","left","chartHeight","bottom","createLinearGradient","H","addColorStop","Chart","registerables","ChartSeries","ChartComponent","Object","datasets","labels","day","afterTooltipDraw","chart","args","options","x","tooltip","dataPoints","element","yAxis","scales","y","save","beginPath","moveTo","lineTo","lineWidth","setLineDash","strokeStyle","stroke","textAlign","cn","font","fillStyle","getComputedStyle","fillText","title","restore","toggleChartExpand","chartExpanded","chartRef","parentElement","classList","refreshDDSets","ddSets","D","sets","sort","a","b","nameA","toLowerCase","nameB","draw","set","ChartTitle","datas","series","find","ds","label","tooltipValue","parseFloat","length","toString","toFixed","toLocaleString","V","Mn","Cn","zn","_g","Zn","_h","getContext","En","_j","q","_k","map","plugins","drawn","toggleSeries","overrideDatasetConfig","getChartOptions","toggleSet","reset","key","keys","hidden","units","month","pointHoverBorderWidth","design","pointHitRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointBackgroundColor","backgroundColor","context","getGradientBackground","yTickPadding","layout","padding","beginAtZero","position","ticks","maxTicksLimit","align","weight","family","textStrokeColor","callback","index","Number","grid","drawBorder","responsive","maintainAspectRatio","legend","hover","mode","axis","intersect","tooltips","interaction","elements","line","tension","point","radius","enabled","titleColor","bodyColor","footerColor","displayColors","callbacks","item","dataset","dataIndex","DropdownComponent","ListComponent","closeDropdown","closest","ecmpId","toggleDropdown","EventComponent","translate","timeAgoPipe","activityService","subjectService","OpStatus","LookupType","setInterval","trigger","subscriptions","add","confirmedOp","opHash","activity","hash","fresh","getType","destination","address","operationType","source","account","explorerURL","getCounterparty","transaction","c","trim","getEventIcon","lookupType","getEventStatusIcon","status","printAmount","formatAmount","tokenId","amount","sentKind","entrypoint","zeroSent","receivedKind","split","getAddressPrefix","copy","copyToClipboard","instant","ActivityComponent","trackEvent","block","NftsTokenComponent","tokenBalancesService","DisplayLinkOption","m","token","balance","F","nn","dn","isNew","viewToken","balanceChangeTimer","formatBalance","Big","div","Math","parseInt","decimals","SearchBarComponent","Subject","inputUpdated","pipe","debounceTime","filter","value","onInput","hasValue","activeAccount","placeholderText","placeholder","onKeydown","next","onFocus","isActive","searchButtonClicked","input","focus","onBlur","searchText","NftsBodyComponent","loaded","filtered","raw","chunkSize","refresh","isDisplaying","tokensToDisplay","tokens","search","sliceEnd","cb","Pn","scrollTop","Tn","rn","Un","Dn","clientHeight","Fn","An","addEventListener","t","match","RegExp","isNaN","updateFilter","prevFilter","trackToken","ctx_r9","NftsComponent","walletService","nftsUpdated","p","activeAddress","getValue","isInitLoad","nfts","isDiscover","nftsArray","flat","logout","o","displayTokenCard","sel","querySelector","innerWidth","scroll","offsetTop","shouldDisplayLink","option","wallet","TorusWallet","sanitizeKey","trackContract","contract","getContractAlias","category","join","BasicButtonComponent","SendButtonComponent","getAsset","tokenTransfer","prepareTransaction","prepareTokenTransfer","symbol","BalanceTokenComponent","removeCommaPipe","getBalance","balanceXTZ","getBalanceFiat","balanceUSD","price","buyTez","moonpay","BalancesComponent","balances","calcTotalBalances","walletUpdated","wrap","remove","ngAfterViewChecked","thumbnailAsset","toggleTotalBalances","isFiat","totalBalances","reduce","prev","XTZrate","openSwap","startSpinner","TokenDetail","unlockableService","feat","contains","blacklistMeta","tokenFiltered","isNFT","descOverflow","description","expand","moreInfo","autoOverflow","expandImage","imageExpanded","toggleFeature","assetLoaded","AccountViewComponent","ImplicitAccount","SettingsComponent","router","coordinatorService","implicitAccounts","getImplicitAccounts","syncBeaconState","onResize","accountAvailable","findIndex","impAcc","wideAccounts","formatAddress","rescan","resetCounters","update","navigate","rescanAll","resetAllMetadata","revealMnemonic","canRevealMnomonic","HdWallet","LegacyWalletV3","routes","path","component","DelegatePageComponent","delegateService","inputValidationService","messageServcie","delegates","take","d","delegate","ceil","freeSpace","estimatedRoi","openForDelegation","minDelegation","obj","stake","round","val","toPercent","toggleCustom","isShowingCustom","ActivateComponent","LoggedInRoutingModule","RouterModule","LoggedInModule","SwapLiquidityService","ChartService","EstimateService","RemoveCommaPipe","imports","CommonModule","HttpClientModule","FormsModule","operationService","activate","formInvalid","checkInput","secret","ans","success","payload","res","addSuccess","addWarning","msg","err","code","WalletType","ErrorHandlingPipe","transform","errorId","withObj","location","protocol","ERROR_LIST","s","string","k","int","jsonWith","Z","indexOf","pure","TimeAgoPipe","timestamp","now","sec","secs","mn","mns","hr","hrs","days","months","year","years","timeNow","Date","getTime","diff","timediff","count","output","minutes","seconds","ActivityService","lookupService","indexerService","updateTransactions","getAccount","getTransactonsCounter","flatMap","of","knownTokenIds","fromPromise","accountInfo","counter","searchAllMetadata","unknownTokenIds","recheckMetadata","updateTokenBalances","getAllTransactions","activities","storeWallet","upToDate","Array","isArray","idsWithBalance","push","updateTokenBalance","currentTokenIds","getTokenBalances","tokenBalanceUpdated","getOperations","resp","operations","oldActivities","unconfirmedOps","op","opNew","concat","oldState","promptNewActivities","counterParty","check","newActivities","timeDiff","shortAddress","ref","metadataUpdated","takeUntil","delay","Y","modify","withLookup","u","resolve","factory","BalanceService","tzrateService","getBalanceAll","getAccounts","getAccountBalance","updateAccountBalance","newBalance","updateTotalBalance","updateFiatBalances","change","totalBalanceXTZ","BeaconService","tzktService","pairInfoJson","pairInfo","parse","isNewPairingRequest","addBeaconWait","peersJson","localStorage","getItem","newPublicKey","peers","publicKey","peer","force","client","removeBeaconMsg","icon","cacheIcon","json","cachedIcon","setItem","getPeers","permissions","getPermissions","removePeers","removePeer","senderId","getSenderId","peerResponse","removeAppMetadata","removePermissions","removeAllPermissions","removePermission","accountIdentifier","getAppMetadataList","rejectOnPermission","message","respondWithError","BeaconErrorType","rejectOnNetwork","rejectOnUserAbort","rejectOnSourceAddress","rejectOnTooManyOps","rejectOnUnknown","rejectOnParameters","rejectOnBroadcastError","errorType","requestMessage","BeaconMessageType","version","BEACON_VERSION","beaconId","respond","approvePermissionRequest","network","scopes","approveSignPayloadRequest","signature","signingType","responseSync","removeItem","swapLiquidityService","fetchLBGraphData","tzbtc","fetchHistoricalQuotesByContract","tzBTCContract","stats","fetchHistoricalStatsByContract","lqdContract","interval","reverse","tvlUsd","getDate","getHours","defaultDatasetValues","borderColor","borderRadius","borderWidth","pointBorderWidth","pointBorderColor","pointRadius","pointHoverColor","fill","XTZtzBTC","tzBTCXTZ","totalValueLocked","offset","req","query","r","quotes1h","C","quotes1d","stats1d","SignalService","balanceService","init","connection","HubConnectionBuilder","withUrl","build","on","sender","invoke","parameter","confirmStatus","onclose","__awaiter","updateAccountData","acc","handleDelegateResponse","subscribeToAccount","types","State","CoordinatorService","teztoolsService","signalService","Map","stopAll","accounts","defaultDelayActivity","longDelayActivity","startXTZ","tzrateInterval","getTzrate","getMarkets","recheckWalletAddresses","defaultDelayPrice","restoreFeatures","scheduler","scheduleData","UpToDate","stateCounter","setDelay","boost","metadata","addressExists","addUnconfirmedOperations","Wait","changeState","Updating","shortDelayActivity","latestActivity","age","shift","newState","time","delete","transactions","times","fee","parameters","unshift","delegation","origination","kt1","DeeplinkService","params","pairingJson","extractPairingJson","b58cdecode","popPairingJson","qrPayload","T","DelegateService","getDelegates","getDelegate","I","bcd","then","resolveDelegateByAddress","Promise","EncryptionService","encrypt","plaintext","password","salt","encrypt_v2","decrypt","chiphertext","decrypt_v1","decrypt_v2","encrypt_v1","pbkdf2","aesCtr","AES","salty","Buffer","cryptob","scrypt","cipher","forge","iv","byteStringBuffer","finish","toHex","tag","chipher","parts","decipher","shiftIV","isInteger","buf","http","imputValidationService","contractsOverride","chainId","manager","pk","preLoadData","head","all","getHeader","toPromise","getCounter","getManager","chain_id","estimateTransactions","estimate","estimateOrigination","isOrigination","queue","retry","_estimate","catch","simulation","gasLimit","min","floor","storageLimit","tx","createOriginationObject","createTransactionObject","simulate","contents","reveal","limits","kind","operation_result","opObj","gas","storage","getOpUsage","localForge","fop","bytes","totalGasLimit","totalStorageLimit","dtp","customLimits","recommendFee","burn","burnFee","content","gasUsage","minus","plus","balance_updates","balanceUpdate","consumed_gas","internal_operation_results","internalResult","storageUsage","costPerByte","getOpLimits","gasUnits","numberOfOperations","revealGasLimit","minimalFee","feePerByte","feePerGasUnit","postRpc","operation","checkApplied","catchError","errHandler","limit","contractOverride","gasRecommendation","relativeLimit","percentage","max","gasEstimation","storageRecommendation","storageEstimation","getRpc","IndexerService","isUsedAccount","getContractAddresses","getTokenMetadata","skipTzkt","TeztoolsService","rehydrate","_defiTokens","_markets","contracts","tokenAddress","usdValue","markets","defiTokens","store","storeKey","parsed","TzktService","Tezos","TezosToolkit","customHandlers","IpfsHttpHandler","TezosStorageHandler","customMetadataProvider","MetadataProvider","addExtension","Tzip12Module","tzkt","originatedContract","getHashAndBlockById","transactionId","ops","tokenBalances","getAllTokenBalances","digest","tokenBalancesCount","tokenCount","hasInternals","opId","extractEntrypoint","newDelegate","contractBalance","tokenTxs","tokenArr","O","meta","tokenType","tokenBalanceCache","standard","normalizeMetadata","filterMetadata","getTokenMetadataWithTaquito","at","tzip12","parsed_uri","token_metadata_uri","fetchToken","TZKT_TOKEN_QUERY_SIZE","tzktTokensResponse","toAsset","formats","charAt","aryCamelKey","char","toUpperCase","camelKey","hasOwnProperty","mutableConvertObjectPropertiesSnakeToCamel","handleMetadataExceptions","isTransferable","shouldPreferSymbol","isBooleanAmount","displayUri","thumbnailUri","artifactUri","InputValidationService","mnemonics","validMnemonic","zxcvbn","score","passwordStrengthDisplay","validAddress","torusAccount","verifierId","loginType","email","redditAccount","twitterAccount","tezosDomain","username","re","test","domain","sub","twitterId","passphrase","expr","endsWith","derivationPath","hexString","hex","isMessageSigning","isMichelineExpr","parsedPayload","valueDecoder","Uint8ArrayConsumer","LookupService","torusService","tezosDomainsService","initCheck","records","lookups","TezosDomains","clear","pendingLookups","mark","indexTop","getDomainFromAddress","torusLookup","torusKeyLookup","Verifiers","verifierMap","google","verifier","Google","reddit","Reddit","twitter","verifierArray","twitterLookup","Twitter","noReveal","torusEntryExist","record","party","alias","Alias","MessageService","defaultTime","messages","timeout","newMessage","emailNotify","redditNotify","twitterNotify","handler","loader","splice","pairingCompleteMsg","text","spinnerText","spinnerOn","stopSpinner","httpOptions","OperationService","errorHandlingPipe","tz1","Uint8Array","tz2","tz3","edpk","sppk","edsk","spsk","edsig","spsig","sig","B","TZ","KT","header","branch","opbytes","sopbytes","preApplyResult","final","opCheck","newPkh","originate","actions","feeHardCap","gas_limit","storage_limit","public_key","microTez","script","transfer","currentFee","invocation","txAmount","mod","eq","getFA12Transaction","getFA2Transaction","transactionOp","managerTransaction","getContractPkhTransaction","getContractKtTransaction","delegationOp","getContractDelegation","getContractUnDelegation","localOpbytes","sk","signed","sign","sbytes","applied","originated_contracts","unsignedOperation","broadcast","sig2edsig","localForger","tz2address","decompress","post","jsonrpc","pub_key_X","X","pub_key_Y","PublicKey","tn","failed","lines","n","with","statusText","localForgedBytes","getVotingRights","listings","isRevealed","getVerifiedOpBytes","operationLevel","operationHash","opHashes","opIndex","managerPubkey","manager_pubkey","opBytes","pk2pkh","verify","buf2hex","prefix","getConstants","seed2keyPair","seed","keyPair","naclSign","b58cencode","secretKey","blake2b","mnemonic2seed","mnemonic","bip39","mnemonic2entropy","pkDecoded","spPrivKeyToKeyPair","hex2buf","elliptic","keyFromPrivate","yArray","getPublic","getY","toArray","prefixVal","pad","getX","isInvertedPk","invertSpsk","invertedPks","inv","remainder","spPointsToPkh","pubX","pubY","keyFromPublic","decodedPk","hexPk","secp256k1","instantiateSecp256k1","compressed","hexToBin","uncompressed","uncompressPublicKey","xy","binToHex","hex2pk","h","buffer","byteArray","hexParts","paddedHex","prefixx","Bs58check","enc","ledgerPreHash","canonical","hexsigToEdsig","decodeString","zarithDecode","byte","zarithDecodeInt","R","prim","getManagerScript","pkHex","annots","getApproveAmountParameters","getRevokeAmountParameters","getXTZToTokenParameters","minimum","expirationTime","getTokenToXTZParameters","minimumToken","minimumXTZ","getAddLiquidityParameters","minimumLqt","getRemoveLiquidityParameters","lqtBurn","minXtzWithdrawn","minTokensWithdrawn","getTezToTokenPaymentParameters","getTokenToTezPaymentParameters","minimumXtz","parseTokenTransfer","opJson","addresses","amounts","K","fa12ref","isEqual","fa2ref","String","nodeURL","retryPipeline","retries","retryWhen","concatMap","iif","throwError","delayOperator","retryWithWarning","SubjectService","origin","beaconResponse","Amount","rpcAmount","normalisedAmount","decimalPlaces","multiplierIntValue","pow","internalNormalised","internalBigInt","fetchContracts","dipdupContract","dipdupContracts","fetchStorage","total_pool","lqtTotal","tez_pool","xtzPool","token_pool","tokenPool","settings","dex","includeSubsidy","createPoolAmounts","calculateXtzToToken","xtzToSell","maxSlippage","expected","xtzToTokenExpectedReturn","xtzToTokenMinimumReturn","rate","xtzToTokenExchangeRateDisplay","priceImpact","xtzToTokenPriceImpact","impactDouble","calculateXtzToTokenFromToken","tokenToSell","calculateTokenToXTZ","xtz","tokenToXtzExpectedReturn","tokenToXtzMinimumReturn","tokenToXtzExchangeRateDisplay","tokenToXtzPriceImpact","calculateTokenToXTZFromXTZ","calculateAddLiquidityXTZ","totalLiquidity","tokenRequired","addLiquidityTokenRequired","liquidityReturned","addLiquidityReturn","exchangeRate","liquidityExpected","liquidityMinimum","calculateAddLiquidityToken","xtzRequired","addLiquidityXtzRequired","calculateRemoveLiquidity","liquidityBurned","xtzOut","removeLiquidityXtzReceived","tokenOut","removeLiquidityTokenReceived","xtzExpected","xtzMinimum","tokenExpected","tokenMinimum","xPool","tPool","dexterCalculations","includeSibsidy","tokenAmount","slippage","xtzToTokenRequiredXtzFor","xtzPoolRpc","tokenPoolRpc","xtzToTokenExchangeRate","xtzAmount","tokenToXtzRequiredTokenFor","tokenToXtzExchangeRate","tokenToXtzMarketRate","xtzToDeposit","xtzIn","totalLqt","tokenToDeposit","tokenIn","lqtBurned","tLqt","estimateLiquidityBakingAPY","TezosDomainsService","tezosToolkit","Tzip16Module","TaquitoTezosDomainsClient","tezos","caching","getAddressFromDomain","resolver","resolveNameToAddress","pending","collect","reject","items","getDomainFromAddresses","promise","baseUrl","reverseRecords","TokenBalancesService","mergeMarket","combineLatest","resolveAsset","contractAlias","CONTRACT_ALIASES","thumbnailUrl","_thumbnailsToCreate","getContractName","getContractLogo","link","visitUrl","unknown","getPlaceholderToken","orderedNfts","getThumbnailUrl","_nfts","aliases","pixels","decode","canvas","createElement","imageData","createImageData","putImageData","toDataURL","logo_url","displayUrl","ObjktService","resolveToken","resolveCollection","sleep","resolveCollections","contractAddresses","_objkts","fa","objkts","objkt","logo","ms","TokenService","objktService","loadMetadata","saveMetadata","events","evt","NavigationEnd","className","tokenIdArray","ids","idx","span","first","last","gte","lte","displayAsset","artifactAsset","isKnownTokenId","tokenIds","contractKeys","contractKey","tokenKeys","tokenKey","isCategoryType","regex","isKnownTokenContract","addAsset","currentKeys","newKeys","checkObjktData","updated","_objkt","_saveMetadata","searchMetadata","tokenObject","ttl","exp","exploredIds","lastCheck","explore","workers","startWorker","recentDay","firstCheck","handleMetadata","tokenCategory","TRUSTED_TOKEN_CONTRACTS","t1","searchTimeMs","isUnknownToken","pendingSave","metadataJson","BLACKLISTED_TOKEN_CONTRACTS","baseUnit","GOOGLE","REDDIT","TWITTER","FACEBOOK","AUTH_DOMAIN","TorusService","testnet","typeOfLogin","clientId","subVerifier","caseSensitiveVerifierID","aggregated","mainnet","scope","verifierIdField","isVerifierIdCaseSensitive","verifierMaps","proxy","verifierMapKeys","initTorus","torus","torusdirectsdk","DirectWebSdk","redirectToOpener","enableLogging","proxyContractAddress","skipSw","lookupPkh","selectedVerifier","fetchNodeDetails","FetchNodeDetails","proxyAddress","TorusUtils","nodeDetails","torusNodeEndpoints","torusNodePub","getNodeDetails","sanitizedVerifierId","toLocaleLowerCase","getPublicAddress","referrerPolicy","loginTorus","skipTorusKey","host","mockLogin","jwtParams","_loginToConnectionMap","login_hint","loginDetails","triggerAggregateLogin","aggregateVerifierType","verifierIdentifier","subVerifierDetailsArray","triggerLogin","userInfo","accessToken","privateKey","getTorusKeyPair","TzrateService","apiUrl","usd","tot","totalBalanceUSD","UnlockableService","unlockables","settingsKey","WalletService","encryptionService","createNewWallet","utils","createEncryptedWallet","hdSeed","entropy","hd","encrypted","encryptedSeed","iv2","encryptedEntropy","exportKeyStoreInit","getKeys","pwd","LegacyWalletV1","LegacyWalletV2","IV","LedgerWallet","EmbeddedTorusWallet","getImplicitAccount","revealMnemonicPhrase","addImplicitAccount","addOriginatedAccount","kt","implicitAccount","origAcc","OriginatedAccount","originatedAccounts","incrementAccountIndex","clearWallet","instanceId","storageId","sessionStorage","isFullWallet","FullWallet","isViewOnlyWallet","isObserverWallet","isLedgerWallet","isHdWallet","isTorusWallet","isEmbeddedTorusWallet","isWatchWallet","WatchWallet","isPwdWallet","walletType","provider","initStorage","localStorageId","getLocalStorageId","getStorage","walletData","loadStoredWallet","parsedWalletData","deserializeStoredWallet","wd","implicit","originated","Wallet","originatedAccount","encrypedSeed","displayName","Account","getTokenBalance","isImplicit","ktAddress","managerPkh","managerPk","NETWORK","NAME","TEZOS_DOMAIN","CONTRACT","TOP_DOMAINS","MAINNET","NODE_URL","BLOCK_EXPLORER_URL","HARD_LIMITS","hard_gas_limit_per_operation","hard_gas_limit_per_block","hard_storage_limit_per_operation","ASSETS","NFT_CONTRACT_OVERRIDES","CONTRACT_OVERRIDES","FEATURE_CONTRACTS","_TTC","_BLTC","_M3DW","ImportService","pwdRequired","importWalletFromJson","g","importWalletFromObject","findContracts","importWalletFromPk","verifierDetails","ledgerImport","torusImport","watch","embedded","updateTwitterName","StartComponent","importService","route","queryParams","devtool","prompt","torusLogin","ExportService","downloadWallet","blob","Blob","filename","saveAs","downloadOperationData","$event","NewWalletComponent","exportService","generateSeed","MNEMONIC","array","wordsToVerify","mnemonicLength","random","activePanel","checkWord","wordInput","getElementById","blur","formatVerifyDescription","indexFormat","valueFormat","verifyView","pwdView","userMnemonic","mnemonicMatch","encryptWallet","validPwd","pwd1","pwd2","offsetWidth","showTacos","calcStrength","pwdStrength","done","export","getPkh","download","ekfDownloaded","mouseOut","stopPropagation","hideBlur","getSelection","removeAllRanges","checkSelection","isTextSelected","isSelectedMnemonic","selection","isCollapsed","_r5","ctx_r15","ctx_r40","ctx_r42","ctx_r43","MnemonicImportComponent","navigation","getCurrentNavigation","importOption","gn","W","extras","allowDrop","bind","handleFileDragAndDrop","clickPassword","removeAttribute","blurPassword","setAttribute","retrieve","hdImport","setPwd","showPkh","Downloaded","importPreCheck","keyFile","typeCheckFile","walletJson","checkImportPwd","import","preventDefault","handleFileInput","dataTransfer","files","fileToUpload","validateFile","fileNotSupported","reader","FileReader","readAsText","onload","fileName","ext","substring","lastIndexOf","advancedForm","LedgerService","setTransport","transport","TransportWebHID","TransportU2F","transportCheck","getAddress","sanitize","signOperation","signHash","getPk","ConnectLedgerComponent","ledgerService","defaultText","checkBrowser","navigator","userAgent","browser","userAgentData","brands","some","brand","platform","defaultPath","pendingLedgerConfirmation","importFromPk","setDefaultPath","isHDDerivationPathCustom","P404Component","P500Component","PrivacyPolicyComponent","getHostName","hostname","TermsOfUseComponent","EmbeddedAuthService","authenticate","authReq","authMessage","createAuthMessage","nonce","signMessage","signExprSilent","hexExpr","requestId","authPayload","purpose","currentTime","_network","parser","Parser","parseMichelineExpression","hexMessage","valueEncoder","LqdEntrypoints","Mode","zeroTxParams","SwapLiquidityComponent","estimateService","tezosDomainService","tezosDomains","chartService","swap","setTokenBalances","xtzBalance","Nn","wn","lqdBalance","ot","Kn","lqdTokenContract","tzBTCBalance","Ie","Ae","initChartsMobile","arr","chartDatas","leftChart","miniChart","w","U","J","initChartsDesktop","initCharts","birthExchangeRate","qty","expectedRate","qtyRaw","hydratePools","attributes","APY","_super","call","chartInit","qtyOut","qtyRawOut","xtzToBuy","tokenToBuy","calcSwap","calcAddLiquidity","minimumLqd","qn","pn","calcRemoveLiquidity","lqtToBurn","customFee","customGasLimit","customStorageLimit","defaultTransactionParams","latestSimError","estimateFees","preview","prepareResponse","getFullyPreparedTxs","toggleMode","chartToggle","liquidity","toggleDirection","dir","evalAmount","getTotalFee","getTotalBurn","mul","burnAmount","customSlippage","customSlippageFocus","customSlippageBlur","getMaxAmount","accountBalance","tez","lqd","tzBTC","prevSimError","txs","getMinimalPreparedTxs","simSemaphore","checkBalances","updateMaxAmount","removeLiquidity","tokenToXtz","xtzToToken","addLiquidity","assert","minimalTxs","opsWithCustomLimits","extraGas","extraStorage","extraGasPerOp","extraStoragePerOp","fullyTx","maxTez","maxLQD","maxtzBTC","gt","sanitizeNumberInput","openInfoModal","ctx_r51","ctx_r54","ConfirmSendComponent","tokenBalanceService","confirmRequest","externalReq","syncSub","closeModalAction","loadParameters","ledgerError","batchParameters","num","updateParameters","batchParamIndex","parametersToMicheline","parametersDisplay","parametersTextboxDisplay","parametersFormat","micheline","setParametersFormat","beaconTokenTransfer","assertMichelsonData","emitMicheline","indent","newline","getTotalAmount","totalSent","getTotalCost","totalFee","totalActiveStorageLimit","getTotalDefaultStorage","getTotalDefaultGas","totalGas","totalStorage","getQuantity","totalAmount","ledgerRetry","sendTransaction","inject","broadCastLedgerTransaction","sendResponse","pwdInvalid","operationResponse","torusNotification","requestLedgerSignature","signedOperation","getUsername","getVerifier","previewAttention","recipientKind","tmp","showFullBatch","PrepareSendDropdownComponent","dropdownResponse","torusVerifierName","torusVerifier","ctx_r19","ctx_r44","ctx_r45","ctx_r47","ctx_r48","PrepareSendComponent","prepareRequest","active","isMultipleDestinations","hideAmount","accountDropdownIsOpen","toMultipleDestinationsString","prevEquiClass","sendMax","toPkh","clearTorus","getTitle","getAssetName","short","amountChange","equiClass","checkBalance","updateDefaultValues","toPkhChange","finalCheck","getBatch","invalidTorusAccount","torusReady","checkTx","torusLookupAddress","torusLookupId","torusTwitterId","row","cols","col","sendEntireBalance","event","checkMaxAmount","toggleDestination","torusPendingLookup","maxToSend","maxKt","maxTz","maxAmount","verifierChange","batchSpace","numberOfTxs","txsLimit","numberWithCommas","dynSize","pasteToPkh","clipboard","readText","clipText","handleScanResponse","ConfirmSendEmbedComponent","template","templateRequest","descriptions","hideScrollbar","cancel","isApproved","approve","showMore","resetScrollbar","scrollBarWidth","overflow","SwapLiquidityConfirmComponent","parseTransactions","csr","hasTrailingZeroApproval","values","kn","ln","confirmTitle","expectedXtz","bn","expectedToken","expectedLqd","semaphore","toSell","SendComponent","externalRequest","selectedAccount","checkOpReq","operationRequest","opReq","operationDetails","silent","validParameters","simulateRequest","tokenTransferObj","getTokenTransferObj","partialOps","fullyPrepared","getTemplateFee","total","thresholdUSD","silentInject","confirmTransactions","isLbReq","confirmSwapLiquidityRequest","Set","yn","_l","_m","_o","_p","_q","_r","_s","_t","handlePrepareResponse","preparedTransactions","handleConfirmResponse","handleTemplateApproval","ExprTemplateComponent","SignExprEmbedComponent","signRequest","ui","isMessage","acceptSigning","rejectSigning","signResponse","QueueEmbedComponent","updateTime","queueTime","hours","SigninComponent","dismiss","loginResponse","loginConfig","customPrio","loginOptions","startQueue","loginOption","setHighPrio","queueTimeVisible","queueInterval","timeBetweenChecks","statusCounter","checkQueue","stopQueue","clearInterval","abort","login","loginData","LoginPrio","setLowPrio","updateQueue","EstimatedTimeSeconds","Status","triesLeft","CardComponent","Permission","EmbeddedComponent","embeddedAuthService","brio","origins","minterpop","interpop","humanMachine","ubisoft","gap","micheline_silent","lexus","blockspace","evian","souvie","tzstaging","studioexception","cleantree","vitality","hasPermission","RequestTypes","handleLoginRequest","handleOperationRequest","handleSignExprRequest","handleTrackRequest","handleLogoutRequest","handleAuthRequest","handleCardRequest","fontSize","background","handleRequest","attachEvent","currentInstanceId","subscribeToConfirmedOps","parent","postMessage","ResponseTypes","MICHELINE","MICHELINE_SILENT","normalizeTemplate","LOGIN","queueMode","config","customSpinnerDismissal","OPERATIONS","isValidOperation","pendingOps","noWalletError","toImport","idToken","long_lived_token","filteredUserInfo","generateInstanceId","userData","authParams","authResponse","strictAuth","importAccount","blockCard","show","common","ophashSubscription","permission","permissionMatrix","allowedOrigin","ReceiveComponent","btnOutline","dropdownItem","getQR","QRCode","errorCorrectionLevel","scaleFactor","color","light","ctx_r8","NewImplicitComponent","openPkhSpot","addPkh","navigateByUrl","errorMsg","PermissionRequestDropdownComponent","current","list","PermissionRequestComponent","preSelectedAccount","permissionRequest","permissionResponse","rejectPermissions","grantPermissions","scopeToText","app","ctx_r16","SignExprComponent","ctx_r21","ctx_r24","OriginateComponent","beaconMode","isValidOrigination","clearForm","assertMichelsonContract","recommendations","getOrigination","simError","customGas","customStorage","getScript","activeTab","validateOrigination","sendOrigination","ledgerSign","keyPressNumbersDecimal","charCode","which","keyCode","ctx_r22","DelegateComponent","snapshot","paramMap","estimateDefaultFee","pwdValid","sendDelegation","getFee","revealed","revealFee","defaultFee","pkhFee","ktFee","domainPendingLookup","advanced","invalidInput","ctx_r5","AccountListBodyComponent","accountAddress","substr","postfix","selRef","viewRef","getTotalBalance","getTotalFiat","AccountListComponent","ctx_r17","ctx_r18","ExportMnemonicComponent","mnemonicPhrase","UriHandlerComponent","WalletClient","connect","handlePermissionRequest","isSupportedOperationRequest","changeFavicon","isSupportedSignPayload","pairingString","handleStorageEvent","connectApp","isConnected","hasFocus","src","PermissionScope","sourceAddress","invalidParameters","invalidOptionals","transactionHash","newValue","senderIds","newPeers","newPeer","pop","MoonpayComponent","sanitizer","dev","mobile","signUrl","encodeURIComponent","bypassSecurityTrustResourceUrl","children","LoggedInComponent","loadChildren","module","redirectTo","AppRoutingModule","relativeLinkResolution","InfoComponent","action","href","proceed","newTab","opener","AlertComponent","removeMessage","notifyFormat","mailtoFormat","redditPmFormat","twitterPmFormat","subject","encodeURI","encodedBody","accountType","getAlias","MessagesComponent","ctx_r14","AccountDropdownComponent","showAll","trackAccount","ctx_r6","ctx_r10","ctx_r12","MobileMenuDropdownComponent","HeaderComponent","delegateName","getDelegateName","parentNode","newAccount","receive","FooterComponent","promptTelegramDialog","SpinnerNewComponent","SpinnerComponent","AgreementComponent","accepted","displayAgreement","accept","AppComponent","setDefaultLang","getBrowserLang","use","checkEmbedded","brk","clientWidth","setProperty","oldValue","returnLanguage","lang","resize","setLanguage","TruncatePipe","endTrail","returnString","endTrailstring","TranslateHttpLoader","AppModule","bootstrap","BrowserModule","BrowserAnimationsModule","TranslateModule","provide","TranslateLoader","useFactory","HttpLoaderFactory","deps","HttpClient","enableProdMode","__NgCli_bootstrap_1","bootstrapModule","_n"],"sourceRoot":"webpack:///","sources":["./src/app/components/modals/modal.component.ts","./src/app/components/modals/qr-scanner/qr-scanner.component.html","./src/app/components/modals/qr-scanner/qr-scanner.component.ts","./src/app/components/ui/asset/asset.component.html","./src/app/components/ui/asset/asset.component.ts","./src/app/components/ui/button/toggle/toggle.component.ts","./src/app/components/ui/button/toggle/advanced/advanced.component.ts","./src/app/components/ui/button/toggle/advanced/advanced.component.html","./src/app/components/ui/chart/chart.component.html","./src/app/components/ui/chart/chart.component.ts","./src/app/components/ui/dropdown/dropdown.component.ts","./src/app/components/ui/generic/list.component.ts","./src/app/components/views/logged-in/account-view/activity/event/event.component.html","./src/app/components/views/logged-in/account-view/activity/event/event.component.ts","./src/app/components/views/logged-in/account-view/activity/activity.component.html","./src/app/components/views/logged-in/account-view/activity/activity.component.ts","./src/app/components/views/logged-in/account-view/nfts/token/token.component.html","./src/app/components/views/logged-in/account-view/nfts/token/token.component.ts","./src/app/components/ui/search/search.component.html","./src/app/components/ui/search/search.component.ts","./src/app/components/views/logged-in/account-view/nfts/body/body.component.html","./src/app/components/views/logged-in/account-view/nfts/body/body.component.ts","./src/app/components/views/logged-in/account-view/nfts/nfts.component.html","./src/app/components/views/logged-in/account-view/nfts/nfts.component.ts","./src/app/components/ui/button/basic/basic.component.ts","./src/app/components/ui/button/basic/send/send-button.component.html","./src/app/components/ui/button/basic/send/send-button.component.ts","./src/app/components/views/logged-in/account-view/balances/token/balance-token.component.html","./src/app/components/views/logged-in/account-view/balances/token/balance-token.component.ts","./src/app/components/views/logged-in/account-view/balances/balances.component.html","./src/app/components/views/logged-in/account-view/balances/balances.component.ts","./src/app/components/modals/send/detail/token-detail.component.html","./src/app/components/modals/send/detail/token-detail.component.ts","./src/app/components/views/logged-in/account-view/account-view.component.html","./src/app/components/views/logged-in/account-view/account-view.component.ts","./src/app/components/views/logged-in/settings/settings.component.html","./src/app/components/views/logged-in/settings/settings.component.ts","./src/app/components/views/logged-in/delegate-page/delegate-page.component.html","./src/app/components/views/logged-in/logged-in-routing.module.ts","./src/app/components/views/logged-in/delegate-page/delegate-page.component.ts","./src/app/components/views/logged-in/logged-in.module.ts","./src/app/components/views/start/activate/activate.component.html","./src/app/components/views/start/activate/activate.component.ts","./src/app/interfaces.ts","./src/app/pipes/error-handling.pipe.ts","./src/app/pipes/remove-comma.pipe.ts","./src/app/pipes/time-ago.pipe.ts","./src/app/services/activity/activity.service.ts","./src/app/services/balance/balance.service.ts","./src/app/services/beacon/beacon.service.ts","./src/app/services/chart/chart.service.ts","./src/app/services/indexer/signal/signal.service.ts","./src/app/services/coordinator/coordinator.service.ts","./src/app/services/deeplink/deeplink.service.ts","./src/app/services/delegate/delegate.service.ts","./src/app/services/encryption/encryption.service.ts","./src/app/services/estimate/estimate.service.ts","./src/app/services/indexer/indexer.service.ts","./src/app/services/indexer/teztools/teztools.service.ts","./src/app/services/indexer/tzkt/tzkt.service.ts","./src/app/services/input-validation/input-validation.service.ts","./src/app/services/lookup/lookup.service.ts","./src/app/services/message/message.service.ts","./src/app/services/operation/operation.service.ts","./src/app/services/subject/subject.service.ts","./src/app/services/swap-liquidity/classes/Amount.ts","./src/app/services/swap-liquidity/swap-liquidity.service.ts","./src/app/services/tezos-domains/tezos-domains.service.ts","./src/app/services/token-balances/token-balances.service.ts","./src/app/services/indexer/objkt/objkt.service.ts","./src/app/services/token/token.service.ts","./src/app/services/torus/torus.service.ts","./src/app/services/tzrate/tzrate.service.ts","./src/app/services/unlockable/unlockable.service.ts","./src/app/services/wallet/wallet.service.ts","./src/app/services/wallet/wallet.ts","./src/environments/environment.jakartanet.ts","./src/environments/environment.ts","./src/app/services/import/import.service.ts","./src/app/components/views/start/start.component.html","./src/app/components/views/start/start.component.ts","./src/app/services/export/export.service.ts","./src/app/components/views/start/login-types/new-wallet/new-wallet.component.html","./src/app/components/views/start/login-types/new-wallet/new-wallet.component.ts","./src/app/components/views/start/login-types/mnemonic-import/mnemonic-import.component.html","./src/app/components/views/start/login-types/mnemonic-import/mnemonic-import.component.ts","./src/app/services/ledger/ledger.service.ts","./src/app/components/views/start/login-types/connect-ledger/connect-ledger.component.ts","./src/app/components/views/start/login-types/connect-ledger/connect-ledger.component.html","./src/app/components/views/error/404.component.ts","./src/app/components/views/error/404.component.html","./src/app/components/views/error/500.component.ts","./src/app/components/views/error/500.component.html","./src/app/components/views/start/agreement/privacy-policy/privacy-policy.component.ts","./src/app/components/views/start/agreement/privacy-policy/privacy-policy.component.html","./src/app/components/views/start/agreement/terms-of-use/terms-of-use.component.ts","./src/app/components/views/start/agreement/terms-of-use/terms-of-use.component.html","./src/app/services/embedded-auth/embedded-auth.service.ts","./src/app/components/misc/send/interfaces.ts","./src/app/components/modals/swap-liquidity/swap-liquidity.component.html","./src/app/components/modals/swap-liquidity/swap-liquidity.component.ts","./src/app/components/modals/send/confirm/send-confirmation.component.html","./src/app/components/modals/send/confirm/send-confirmation.component.ts","./src/app/components/ui/dropdown/prepare-send/prepare-send-dropdown.component.html","./src/app/components/ui/dropdown/prepare-send/prepare-send-dropdown.component.ts","./src/app/components/modals/send/prepare/prepare-send.component.html","./src/app/components/modals/send/prepare/prepare-send.component.ts","./src/app/components/views/embedded/confirm-send/confirm-send.component.html","./src/app/components/views/embedded/confirm-send/confirm-send.component.ts","./src/app/components/modals/swap-liquidity/swap-liquidity-confirm.component.html","./src/app/components/modals/swap-liquidity/swap-liquidity-confirm.component.ts","./src/app/components/misc/send/send.component.html","./src/app/components/misc/send/send.component.ts","./src/app/components/views/embedded/sign-expr/template/template.component.html","./src/app/components/views/embedded/sign-expr/template/template.component.ts","./src/app/components/views/embedded/sign-expr/sign-expr.component.html","./src/app/components/views/embedded/sign-expr/sign-expr.component.ts","./src/app/components/views/embedded/queue/queue.component.html","./src/app/components/views/embedded/queue/queue.component.ts","./src/app/components/views/embedded/signin/signin.component.html","./src/app/components/views/embedded/signin/signin.component.ts","./src/app/components/views/embedded/card/card.component.ts","./src/app/components/views/embedded/card/card.component.html","./src/app/components/views/embedded/embedded.component.html","./src/app/components/views/embedded/embedded.component.ts","./src/app/components/modals/receive/receive.component.html","./src/app/components/modals/receive/receive.component.ts","./src/app/components/modals/new-implicit/new-implicit.component.html","./src/app/components/modals/new-implicit/new-implicit.component.ts","./src/app/components/ui/dropdown/permission-request/permission-request.component.html","./src/app/components/ui/dropdown/permission-request/permission-request.component.ts","./src/app/components/modals/permission-request/permission-request.component.html","./src/app/components/modals/permission-request/permission-request.component.ts","./src/app/components/modals/sign-expr/sign-expr.component.html","./src/app/components/modals/sign-expr/sign-expr.component.ts","./src/app/components/modals/originate/originate.component.html","./src/app/components/modals/originate/originate.component.ts","./src/app/components/modals/delegate/delegate.component.html","./src/app/components/modals/delegate/delegate.component.ts","./src/app/components/modals/account-list/body/body.component.html","./src/app/components/modals/account-list/body/body.component.ts","./src/app/components/modals/account-list/list.component.ts","./src/app/components/modals/account-list/list.component.html","./src/app/components/modals/export-mnemonic/export-mnemonic.component.html","./src/app/components/modals/export-mnemonic/export-mnemonic.component.ts","./src/app/components/misc/uri-handler/uri-handler.component.ts","./src/app/components/misc/uri-handler/uri-handler.component.html","./src/app/components/views/logged-in/account-view/moonpay/moonpay.component.html","./src/app/components/views/logged-in/account-view/moonpay/moonpay.component.ts","./src/app/app-routing.module.ts","./src/app/components/views/logged-in/logged-in.component.ts","./src/app/components/views/logged-in/logged-in.component.html","./src/app/components/modals/info/info.component.html","./src/app/components/modals/info/info.component.ts","./src/app/components/modals/alert/alert.component.html","./src/app/components/modals/alert/alert.component.ts","./src/app/components/ui/messages/messages.component.html","./src/app/components/ui/messages/messages.component.ts","./src/app/components/ui/dropdown/account/account-dropdown.component.html","./src/app/components/ui/dropdown/account/account-dropdown.component.ts","./src/app/components/ui/dropdown/mobile-menu/mobile-menu.component.html","./src/app/components/ui/dropdown/mobile-menu/mobile-menu.component.ts","./src/app/components/views/layouts/header/header.component.html","./src/app/components/views/layouts/header/header.component.ts","./src/app/components/views/layouts/footer/footer.component.html","./src/app/components/views/layouts/footer/footer.component.ts","./src/app/components/ui/spinner/new/spinner-new.component.ts","./src/app/components/ui/spinner/new/spinner-new.component.html","./src/app/components/ui/spinner/spinner.component.html","./src/app/components/ui/spinner/spinner.component.ts","./src/app/components/views/start/agreement/agreement.component.html","./src/app/components/views/start/agreement/agreement.component.ts","./src/app/app.component.html","./src/app/app.component.ts","./src/app/pipes/truncate.pipe.ts","./src/app/app.module.ts","./src/main.ts","./node_modules/moment/locale/ sync ^\\.\\/.*$"],"sourcesContent":["import { Component, OnInit, Optional, ChangeDetectorRef, OnDestroy } from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { BehaviorSubject } from 'rxjs';\n\ninterface ModalPayload {\n  name: string | null;\n  data: any;\n  forceClose?: boolean;\n}\n\n@Component({\n  selector: 'app-modal',\n  templateUrl: './modal.component.html'\n})\nexport class ModalComponent implements OnInit, OnDestroy {\n  public isOpen = false;\n  name = '';\n  static currentModel = new BehaviorSubject<ModalPayload>({\n    name: '',\n    data: null\n  });\n  private modalSub: Subscription = new Subscription();\n  constructor(@Optional() public cd?: ChangeDetectorRef) {\n    this.cd = cd;\n    this.modalSub = ModalComponent.currentModel.subscribe((load) => {\n      load.forceClose = load.forceClose === undefined ? true : load.forceClose;\n      if (!!load.name && load.name === this.name) {\n        if (!this.isOpen) {\n          this.willOpen();\n          this.open(load.data);\n        }\n      } else {\n        if (this.isOpen && load.forceClose) {\n          this.close();\n          if (this.cd) {\n            this.cd.detectChanges();\n          }\n        }\n      }\n    });\n  }\n\n  ngOnInit(): void {}\n\n  ngOnDestroy(): void {\n    this.modalSub.unsubscribe();\n  }\n\n  willOpen(): void {}\n\n  open(data?: any): void {\n    if (window.innerHeight < document.body.scrollHeight) {\n      document.body.style.marginRight = '0.5rem !important';\n      document.body.style.overflowY = 'hidden !important';\n    }\n    const isMobile = Number(document.documentElement.style.getPropertyValue('--is-mobile'));\n    if (isMobile) {\n      setTimeout(() => {\n        window.scrollTo({ top: 0 });\n      }, 0);\n    }\n    this.isOpen = true;\n  }\n\n  close(): void {\n    document.body.style.marginRight = '';\n    document.body.style.overflowY = '';\n    this.isOpen = false;\n  }\n}\n","<button *ngIf=\"!override\" class=\"scan\" (click)=\"openModal()\">Scan QR code</button>\n<img *ngIf=\"override\" class=\"scan override\" (click)=\"openModal()\" src=\"assets/img/qr.svg\" />\n<div *ngIf=\"isOpen\" class=\"flex-column kukai-modal\">\n  <form autocomplete=\"off\">\n    <div class=\"content\">\n      <div class=\"flex-row top\">\n        <div class=\"flex-row button close\" (click)=\"closeModal()\"><img class=\"x\"\n            src=\"../../../assets/img/close-btn-x.png\" /></div>\n        <h1 class=\"title\">QR-Scanner</h1>\n      </div>\n      <div class=\"seperator\"></div>\n      <div class=\"flex-column qr-scanner\">\n        <div class=\"video-container\">\n          <video #videoPlayer>\n            Browser not supported\n          </video>\n          <p class=\"no-cam\" *ngIf=\"!qrScanner\">No camera detected</p>\n          <p class=\"no-cam\" *ngIf=\"!!errorMessage\">{{ errorMessage }}</p>\n          <p class=\"no-cam\" *ngIf=\"!!errorMessage\">Please check site permissions</p>\n        </div>\n        <input *ngIf=\"!env.production && !override\" name=\"none\" type=\"text\" [(ngModel)]=\"manualInput\" class=\"text\" (paste)=\"handlePaste($event)\"\n          placeholder=\"...or paste pairing string here\">\n      </div>\n    </div>\n  </form>\n</div>","import { Component, ViewChild, ElementRef, Input, EventEmitter, Output } from '@angular/core';\nimport { BeaconService } from '../../../services/beacon/beacon.service';\nimport QrScanner from 'qr-scanner';\nimport { DeeplinkService } from '../../../services/deeplink/deeplink.service';\nimport { CONSTANTS as _CONSTANTS, environment } from '../../../../environments/environment';\nimport { MessageService } from '../../../services/message/message.service';\nimport { ModalComponent } from '../modal.component';\n\n@Component({\n  selector: 'app-qr-scanner',\n  templateUrl: './qr-scanner.component.html',\n  styleUrls: ['../../../../scss/components/modals/modal.scss']\n})\nexport class QrScannerComponent extends ModalComponent {\n  readonly CONSTANTS = _CONSTANTS;\n  readonly env = environment;\n  constructor(private beaconService: BeaconService, private deeplinkService: DeeplinkService, private messageService: MessageService) {\n    super();\n  }\n  @Output('scanResponse') scanResponse = new EventEmitter();\n  @ViewChild('videoPlayer') videoplayer: ElementRef;\n  @Input() override = false;\n  qrScanner: QrScanner;\n  manualInput = '';\n  name = 'qr-scanner';\n  loadingCam = false;\n  errorMessage = '';\n  openModal(): void {\n    if (!this.override) {\n      ModalComponent.currentModel.next({ name: this.name, data: null });\n    } else {\n      super.open();\n    }\n    this.scan();\n  }\n  async scan(): Promise<void> {\n    this.loadingCam = true;\n    const hasCamera = await QrScanner.hasCamera();\n    if (hasCamera && this.videoplayer?.nativeElement) {\n      this.errorMessage = '';\n      try {\n        this.qrScanner = new QrScanner(this.videoplayer?.nativeElement, (result: QrScanner.ScanResult) => this.handleQrCode(result), {});\n        await this.qrScanner.start();\n        if (!this.isOpen) {\n          this.qrScanner.stop();\n          this.qrScanner.destroy();\n          this.qrScanner = null;\n        }\n      } catch (e) {\n        this.errorMessage = e;\n      }\n    } else {\n      console.warn('no camera found');\n    }\n    this.loadingCam = false;\n  }\n  handleQrCode(scanResult: QrScanner.ScanResult): void {\n    const qrString = scanResult.data;\n    console.log('QR Code', qrString);\n    try {\n      const pairingInfo = this.deeplinkService.QRtoPairingJson(qrString);\n      if (pairingInfo && !this.override) {\n        this.beaconService.preNotifyPairing(pairingInfo);\n        this.beaconService.addPeer(pairingInfo);\n      } else if (qrString && this.override) {\n        this.scanResponse.emit({ pkh: qrString });\n      }\n      this.closeModal();\n    } catch (e) {\n      if (!this.override) {\n        this.messageService.addError('Invalid Base58 checksum!');\n      }\n    }\n  }\n  handlePaste(ev: ClipboardEvent): void {\n    if (!this.env.production) {\n      try {\n        const clipboardString = ev?.clipboardData?.getData('text');\n        const pairingInfo = clipboardString ? this.deeplinkService.QRtoPairingJson(clipboardString) : '';\n        if (!this.override && pairingInfo) {\n          this.beaconService.preNotifyPairing(pairingInfo);\n          this.beaconService.addPeer(pairingInfo);\n        } else if (clipboardString && this.override) {\n          this.scanResponse.emit({ pkh: clipboardString });\n        }\n        this.closeModal();\n      } catch (e) {\n        if (!this.override) {\n          this.messageService.addError('Invalid Base58 checksum!');\n        }\n      }\n    }\n  }\n  closeModal(): void {\n    // restore body scrollbar\n    if (this.qrScanner && !this.loadingCam) {\n      this.qrScanner.stop();\n      this.qrScanner.destroy();\n      this.qrScanner = null;\n    }\n    if (!this.override) {\n      ModalComponent.currentModel.next({ name: '', data: null });\n    } else {\n      super.close();\n    }\n    this.manualInput = '';\n  }\n}\n","<ng-container *ngIf=\"this.display === Display.image || (this.display === Display.audio && !!poster)\">\n  <!-- Need crossorigin anonymous here to leverage caching from first GET (check mime type) -->\n  <img crossorigin=\"anonymous\" #postImage [src]=\"postSrc\" id=\"postImage\" [style.objectFit]=\"postSrc?.indexOf(loaderUrl) > -1 ? 'scale-down' : ''\" (error)=\"onError($event)\" (load)=\"onLoad($event)\" />\n  <img crossorigin=\"anonymous\" #preImage [src]=\"preSrc\" id=\"preImage\" (error)=\"onError($event)\" (load)=\"onLoad($event)\" />\n</ng-container>\n<audio crossorigin=\"anonymous\" #audio *ngIf=\"this.display === Display.audio\" preload=\"metadata\" [controls]=\"controls\" [controlsList]=\"controlsList\" id=\"audio\" (error)=\"onError($event)\" (loadeddata)=\"onLoadData($event)\">\n  <source crossorigin=\"anonymous\" [src]=\"dataSrc\" [type]=\"mimeType\" />\n</audio>\n<video crossorigin=\"anonymous\" #video *ngIf=\"this.display === Display.video\" preload=\"metadata\" id=\"video\" [controls]=\"controls\" [playsinline]=\"playsinline\" [muted]=\"muted\" [loop]=\"loop\" [autoplay]=\"autoplay\" (error)=\"onError($event)\" (loadeddata)=\"onLoadData($event)\">\n  <source crossorigin=\"anonymous\" [src]=\"dataSrc\" [type]=\"mimeType\" />\n  <img crossorigin=\"anonymous\" [src]=\"loaderUrl\" class=\"spinner\" />\n</video>\n<div *ngIf=\"this.display === Display.threeD\" class=\"model-wrapper\">\n  <model-viewer crossorigin=\"anonymous\" #model id=\"modelCanvas\" auto-rotate rotation-per-second=\"30deg\"\n    [src]=\"dataSrc\" alt=\"postSrc\" (load)=\"onLoad($event)\" (error)=\"onError($event)\"\n    camera-controls ar ar-modes=\"webxr scene-viewer quick-look\"></model-viewer>\n</div>","import { AfterViewInit, Component, ElementRef, EventEmitter, Input, OnInit, Output, Sanitizer, SimpleChanges, ViewChild } from '@angular/core';\nimport { Asset, CachedAsset, TokenService } from '../../../services/token/token.service';\nimport { CONSTANTS, MODEL_3D_WHITELIST } from '../../../../environments/environment';\n\nenum Display {\n  'none',\n  'audio',\n  'image',\n  'video',\n  'threeD'\n}\n\nenum Size {\n  'icon' = 'icon',\n  'small' = 'small',\n  'medium' = 'medium',\n  'gallery' = 'gallery',\n  'raw' = 'raw'\n}\n\nconst MIMETYPE_OVERLOADS = ['unknown', 'image/gif'];\n\n@Component({\n  selector: 'app-asset',\n  templateUrl: './asset.component.html',\n  styleUrls: ['../../../../scss/components/ui/asset/asset.component.scss']\n})\nexport class AssetComponent implements OnInit, AfterViewInit {\n  Display = Display;\n  display = Display.image;\n  @ViewChild('preImage') preImage;\n  @ViewChild('postImage') postImage;\n  @ViewChild('audio') audio;\n  @ViewChild('video') video;\n  @ViewChild('model') model;\n  @Input() assets: any;\n  @Input() size = Size.medium;\n  @Input() priorityList = ['displayAsset', 'thumbnailAsset'];\n  @Input() controlsList = 'nofullscreen nodownload noremoteplayback noplaybackrate';\n  @Input() poster: CachedAsset;\n  @Input() controls = false;\n  @Input() requires = ['all'];\n  @Input() hideSpinner = false;\n  @Input() muted = false;\n  @Input() autoplay = false;\n  @Input() loop = false;\n  @Input() playsinline = false;\n  @Output() inView = new EventEmitter(null);\n  @Output() load = new EventEmitter(null);\n  readonly loaderUrl = 'assets/img/loader.svg';\n  readonly unknownUrl = 'assets/img/unknown-token-grayscale.svg';\n  dataSrc = undefined;\n  preSrc = this.loaderUrl;\n  postSrc = this.loaderUrl;\n  mimeType = 'image/*';\n  errors = 0;\n  obs: IntersectionObserver;\n\n  constructor(private elRef: ElementRef, private tokenService: TokenService) {}\n\n  ngOnInit(): void {\n    if (this.hideSpinner) {\n      this.display = Display.none;\n    }\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (\n      changes?.assets?.previousValue &&\n      changes?.assets?.currentValue &&\n      JSON.stringify(changes?.assets?.previousValue) !== JSON.stringify(changes?.assets?.currentValue)\n    ) {\n      const p0 = this.assetToUrl(this.pickAsset(changes?.assets?.previousValue));\n      const p1 = this.assetToUrl(this.pickAsset(changes?.assets?.currentValue));\n      if (p0 !== p1) {\n        console.log('reload asset', { from: p0, to: p1 });\n        this.reload();\n      }\n    }\n  }\n\n  ngAfterViewInit(): void {\n    this.lazyLoad();\n  }\n  private reload() {\n    this.display = Display.none;\n    this.dataSrc = undefined;\n    this.preSrc = this.loaderUrl;\n    this.postSrc = this.loaderUrl;\n    this.mimeType = 'image/*';\n    this.updateDisplay();\n    this.lazyLoad();\n  }\n  updateDisplay(): void {\n    if (this.isImage() && (this.requires.includes('image') || this.requires.includes('all'))) {\n      this.display = Display.image;\n    } else if (this.isAudio() && (this.requires.includes('audio') || this.requires.includes('all'))) {\n      this.display = Display.audio;\n    } else if (this.isVideo() && (this.requires.includes('video') || this.requires.includes('all'))) {\n      this.display = Display.video;\n    } else if (this.is3D() && (this.requires.includes('model') || this.requires.includes('all'))) {\n      this.display = Display.threeD;\n    } else {\n      this.display = Display.none;\n    }\n  }\n\n  isImage(): boolean {\n    return this.mimeType?.startsWith('image/') || this.mimeType?.startsWith('application/');\n  }\n\n  isVideo(): boolean {\n    return this.mimeType?.startsWith('video/');\n  }\n\n  isAudio(): boolean {\n    return this.mimeType?.startsWith('audio/');\n  }\n\n  is3D(): boolean {\n    return this.mimeType?.startsWith('model/');\n  }\n\n  onLoad(e): void {\n    if (e?.target?.id === 'preImage') {\n      this.postSrc = this.preSrc;\n      this.updateDisplay();\n    }\n  }\n\n  onLoadData(e): void {\n    if (this.isAudio()) {\n      if (this.audio.nativeElement.muted) {\n        this.audio.nativeElement.volume = 1.0;\n      }\n    }\n  }\n\n  onError(e): void {\n    if ((e?.target?.id === 'postImage' || e?.target?.id === 'preImage') && this.isImage()) {\n      this.errors++;\n      if (this.errors <= 2) {\n        console.log('retry lazyload', this.preSrc);\n        this.reload();\n      } else {\n        console.log('failed to load asset', this.preSrc);\n        this.evaluateInvalid();\n      }\n    }\n  }\n\n  evaluateInvalid(): void {\n    this.mimeType = 'image/*';\n    this.updateDisplay();\n    this.preSrc = this.unknownUrl;\n  }\n  pickAsset(assets): Asset {\n    for (let type of this.priorityList) {\n      if (assets && assets[type] && !(typeof assets[type] === 'object' && !assets[type]?.uri)) {\n        return assets[type];\n      }\n    }\n    return null;\n  }\n\n  async evaluate(assets): Promise<void> {\n    if (this.poster) {\n      this.preSrc = this.assetToUrl(this.poster);\n    }\n    let asset = this.pickAsset(assets);\n    if (asset) {\n      try {\n        await this.determineMime(asset);\n      } catch (e) {\n        console.error(e);\n        this.evaluateInvalid();\n        return;\n      }\n      this.setSrc(asset);\n    } else {\n      this.evaluateInvalid();\n    }\n  }\n\n  lazyLoad(): void {\n    this.obs = new IntersectionObserver((entries, _) => {\n      entries.forEach((entry) => {\n        if (entry.isIntersecting) {\n          this.evaluate(this.assets);\n          this.obs.unobserve(this.elRef?.nativeElement);\n        }\n        this.inView.emit();\n      });\n    });\n    if (this.elRef?.nativeElement) {\n      this.obs.observe(this.elRef?.nativeElement);\n    }\n  }\n\n  async determineMime(asset: Asset) {\n    const url = this.assetToUrl(asset);\n    if (!url) {\n      throw new Error('InvalidUrl');\n    }\n    if (url?.startsWith('data:image')) {\n      this.mimeType = 'image/*';\n      return (this.preSrc = url);\n    }\n    // Ignore MIME type provided in metadata for now. Way too unreliable. Exception for nfts in 3d wl. (media proxy don't return the correct mime type)\n    if (\n      typeof asset !== 'string' &&\n      !(asset?.mimeType?.startsWith('model/') && (MODEL_3D_WHITELIST as Array<any>).includes(this.tokenService.getContractAddressFromAsset(asset?.uri)))\n    ) {\n      let response;\n      for (let i = 0; i < 3 && !response?.ok; i++) {\n        response = await fetch(url, { method: 'GET' });\n      }\n      if (!response?.ok) {\n        throw new Error();\n      }\n      this.mimeType = response.headers.get('content-type');\n    } else if (typeof asset === 'string') {\n      this.mimeType = 'image/*';\n    } else {\n      this.mimeType = asset.mimeType;\n    }\n  }\n\n  setSrc(asset): void {\n    this.updateDisplay();\n    if (this.isAudio() || this.isVideo() || this.is3D()) {\n      this.isAudio() ? this.load.emit() : undefined;\n      if (this.is3D()) {\n        const contractAddress = this.tokenService.getContractAddressFromAsset(asset?.uri);\n        if (!(MODEL_3D_WHITELIST as Array<any>).includes(contractAddress)) {\n          console.warn('Content blocked');\n          this.evaluateInvalid();\n          return;\n        }\n      }\n      this.dataSrc = this.assetToUrl(asset);\n    } else if (this.isImage()) {\n      this.preSrc = this.assetToUrl(asset);\n    } else {\n      console.warn(`Unrecognized MIME type: ${this.mimeType}`, '\\n', 'Assuming: image/*');\n      this.mimeType = 'image/*';\n      this.updateDisplay();\n      this.preSrc = this.assetToUrl(asset);\n    }\n  }\n  assetToUrl(asset: Asset): string {\n    let url = '';\n    const uri = typeof asset === 'string' ? asset : asset?.uri;\n    if (uri.startsWith('ipfs://')) {\n      url = `https://static.tcinfra.net/media/${this.size}/ipfs/${uri.slice(7)}`;\n    } else if (uri.startsWith('https://')) {\n      url = `https://static.tcinfra.net/media/${this.size}/web/${uri.slice(8)}`;\n    } else if (!CONSTANTS.MAINNET && (uri.startsWith('http://localhost') || uri.startsWith('http://127.0.0.1'))) {\n      url = uri.slice(16);\n    } else if (typeof asset === 'string') {\n      url = uri;\n    } else {\n      console.warn('failed to parse asset', asset);\n      url = uri;\n    }\n    return url ?? '';\n  }\n}\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\n\n@Component({\n  selector: 'app-ui-toggle',\n  templateUrl: './toggle.component.html'\n})\nexport class ToggleComponent implements OnInit {\n  @Input() state: boolean;\n  @Input() text = 'Advanced:';\n  @Input() default: boolean = false;\n  @Output() stateChange = new EventEmitter<boolean>();\n\n  constructor() {}\n\n  ngOnInit(): void {\n    this.state = this.default;\n  }\n\n  toggle(): void {\n    this.state = !this.state;\n    this.stateChange.emit(this.state);\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ToggleComponent } from '../toggle.component';\n\n@Component({\n  selector: 'app-ui-toggle-advanced',\n  templateUrl: './advanced.component.html',\n  styleUrls: ['../../../../../../scss/components/ui/button/toggle.component.scss']\n})\nexport class AdvancedToggleComponent extends ToggleComponent implements OnInit {\n  constructor() {\n    super();\n  }\n\n  ngOnInit(): void {}\n}\n","<div class=\"flex-row advanced\">\n  <div class=\"flex-row switch-container\">\n    <span class=\"value\">{{ text }}&nbsp;&nbsp;&nbsp;&nbsp;</span>\n    <label class=\"flex-row switch\">\n      <span class=\"key\" [class]=\"state ? 'active' : ''\">{{ state ? ' ON' : 'OFF' }}</span>\n      <span class=\"slider\" [class]=\"state ? 'active' : ''\" (click)=\"toggle()\">\n        <span class=\"round\"></span>\n      </span>\n    </label>\n  </div>\n</div>","<div class=\"title-dropdown\" [class.expanded]=\"ddExpanded\">\n  <ng-container *ngFor=\"let value of ddSets\">\n    <p [class.active]=\"set === value?.name\" (click)=\"toggleSet(value?.name);ddExpanded = !ddExpanded\">{{ value?.name ||\n      '' }}</p>\n  </ng-container>\n</div>\n<div *ngIf=\"sets?.length\" class=\"flex-row mode\">\n  <div class=\"flex-column left\">\n    <span class=\"title\" (click)=\"ddExpanded = !ddExpanded\">{{ set }}<img [class.expanded]=\"ddExpanded\"\n        src=\"assets/img/chevron-down.svg\" /></span>\n    <span class=\"tooltip value\">{{ tooltipValue }}\n      <span class=\"unit\">{{ units }}</span>\n    </span>\n  </div>\n  <div class=\"right\">\n    <div class=\"attributes\">\n      <ng-container *ngFor=\"let key of Object.keys(attributes)\">\n        <span>{{ attributes[key] }}</span>\n      </ng-container>\n    </div>\n  </div>\n</div>\n<svg *ngIf=\"!sets?.length\" class=\"spinner\" viewBox=\"0 0 50 50\">\n  <circle class=\"path\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\" stroke-width=\"5\"></circle>\n</svg>\n<span *ngIf=\"!sets?.length\" class=\"loading-text\">Loading Chart...</span>\n<div class=\"expand\" (click)=\"toggleChartExpand(); ddExpanded = false; toggleSet(set)\">{{ !chartExpanded ? 'Expand' : 'Collapse' }}\n</div>\n<ng-container *ngIf=\"design === 'default'\">\n  <div class=\"flex-column canvas-wrapper\">\n    <canvas #chart [class.loaded]=\"sets?.length\"></canvas>\n    <div *ngIf=\"sets?.length\" class=\"flex-row time\" [class.expanded]=\"chartExpanded\">\n      <span *ngIf=\"set !== 'Total Value Locked'\" [class.active]=\"series === 'day'\" (click)=\"toggleSeries('day')\">24H</span><span\n      *ngIf=\"set !== 'Total Value Locked'\" [class.active]=\"series === 'week'\" (click)=\"toggleSeries('week')\">1W</span>\n      <span [class.active]=\"series === 'month'\" (click)=\"toggleSeries('month')\">1M</span><span\n      *ngIf=\"set !== 'Total Value Locked'\" [class.active]=\"series === 'year'\" (click)=\"toggleSeries('year')\">1Y</span>\n    </div>\n  </div>\n</ng-container>\n<ng-container *ngIf=\"design === 'mini'\">\n  <div class=\"canvas-wrapper\">\n    <canvas #chart [class.loaded]=\"sets?.length\"></canvas>\n    <div *ngIf=\"sets?.length\" class=\"flex-row time\" [class.expanded]=\"chartExpanded\">\n      <span *ngIf=\"set !== 'Total Value Locked'\" [class.active]=\"series === 'day'\"\n        (click)=\"toggleSeries('day')\">24H</span><span *ngIf=\"set !== 'Total Value Locked'\"\n        [class.active]=\"series === 'week'\" (click)=\"toggleSeries('week')\">1W</span>\n      <span [class.active]=\"series === 'month'\" (click)=\"toggleSeries('month')\">1M</span><span\n        *ngIf=\"set !== 'Total Value Locked'\" [class.active]=\"series === 'year'\" (click)=\"toggleSeries('year')\">1Y</span>\n    </div>\n  </div>\n</ng-container>","import { Component, ElementRef, EventEmitter, Input, Output, SimpleChange, SimpleChanges, ViewChild } from '@angular/core';\nimport { Chart, ChartOptions, ChartTypeRegistry, registerables } from 'chart.js';\nimport { ChartTitle } from '../../../services/chart/chart.service';\n\nChart.register(...registerables);\n\nlet width, height, gradient;\nfunction getGradientBackground(ctx, chartArea) {\n  const style = getComputedStyle(document.body);\n  const theme = style.getPropertyValue('--theme').replace(/[ \\\"]/g, '');\n  const chartWidth = chartArea.right - chartArea.left;\n  const chartHeight = chartArea.bottom - chartArea.top;\n  if (gradient === null || width !== chartWidth || height !== chartHeight) {\n    width = chartWidth;\n    height = chartHeight;\n    gradient = ctx.createLinearGradient(0, chartArea.bottom, 0, chartArea.top);\n    // gradient.addColorStop(1, '#5963ff88');\n    // gradient.addColorStop(0.5, '#5963ff33');\n    // gradient.addColorStop(0, '#5963ff19');\n    if (theme === 'dark') {\n      gradient.addColorStop(1, '#383d7d');\n      gradient.addColorStop(0.5, '#2e304f');\n      gradient.addColorStop(0, '#2a2c3f');\n    } else {\n      gradient.addColorStop(1, '#c2c5fc');\n      gradient.addColorStop(0.5, '#e0e1fb');\n      gradient.addColorStop(0, '#e8eafb');\n    }\n  }\n\n  return gradient;\n}\n\nexport enum ChartSeries {\n  'day' = 'day',\n  'week' = 'week',\n  'month' = 'month',\n  'year' = 'year'\n}\n@Component({\n  selector: 'app-ui-chart',\n  templateUrl: './chart.component.html',\n  styleUrls: ['../../../../scss/components/ui/chart/chart.component.scss']\n})\nexport class ChartComponent {\n  Object = Object;\n  @Input() attributes: any = {};\n  @Input() type: keyof ChartTypeRegistry = 'line';\n  @Input() data = { datasets: [], labels: [] };\n  @Input() datas = {};\n  @Input() options: ChartOptions = {};\n  @Input() design: string;\n  @Input() ddSets = [];\n  @Input() sets = [];\n  @Input() set = '';\n  @Input() units = {};\n  @Input() layout = 'default';\n  tooltipValue: string = '';\n  @ViewChild('chart') chartRef: ElementRef;\n  @Output('drawn') drawn = new EventEmitter();\n\n  chart = null;\n  series: ChartSeries = ChartSeries.day;\n  ddExpanded = false;\n  chartExpanded = false;\n\n  constructor() {\n    Chart.register({\n      id: 'my-plugin',\n      afterTooltipDraw: (chart, args, options) => {\n        if (chart) {\n          let x = chart.tooltip.dataPoints[0].element.x;\n          let yAxis = chart.scales.y;\n          let ctx = chart.ctx;\n          ctx.save();\n          ctx.beginPath();\n          ctx.moveTo(x, yAxis.bottom + 60);\n          ctx.lineTo(x, yAxis.top + 60);\n          ctx.lineWidth = 2;\n          ctx.setLineDash([3, 1]);\n          ctx.strokeStyle = 'rgba(0, 0, 255, 0.3)';\n          ctx.stroke();\n          ctx.setLineDash([0, 0]);\n          ctx.textAlign = 'center';\n          if (x >= chart.chartArea.right + -30) {\n            ctx.textAlign = 'right';\n          } else if (x <= chart.chartArea.left + 30) {\n            ctx.textAlign = 'left';\n          }\n          ctx.font = '14px sans-serif';\n          ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--base-font-color-secondary');\n          ctx.fillText(chart.tooltip.title[0], x, yAxis.top + 45);\n          ctx.restore();\n        }\n      }\n    });\n  }\n\n  toggleChartExpand() {\n    this.chartExpanded = !this.chartExpanded;\n    (this.chartRef.nativeElement as HTMLCanvasElement).parentElement.parentElement.classList.toggle('expanded');\n  }\n\n  refreshDDSets(): void {\n    this.ddSets = this.sets?.sort(function (a, b) {\n      const nameA = a.name.toLowerCase(),\n        nameB = b.name.toLowerCase();\n      if (nameA > nameB) return -1;\n      if (nameA < nameB) return 1;\n      return 0;\n    });\n  }\n\n  draw(): void {\n    if (this.set === ChartTitle.totalValueLocked) {\n      const data = this.datas[this.series]?.datasets?.find((ds) => ds.label === ChartTitle.totalValueLocked).data;\n      if (!data) {\n        return;\n      }\n      this.tooltipValue = parseFloat(parseFloat(data[data.length - 1].toString()).toFixed(2)).toLocaleString();\n    } else if (this.set === ChartTitle.XTZtzBTC) {\n      const data = this.datas[this.series]?.datasets?.find((ds) => ds.label === ChartTitle.XTZtzBTC).data;\n      if (!data) {\n        return;\n      }\n      this.tooltipValue = parseFloat(data[data.length - 1].toString()).toFixed(8);\n    } else if (this.set === ChartTitle.tzBTCXTZ) {\n      const data = this.datas[this.series]?.datasets?.find((ds) => ds.label === ChartTitle.tzBTCXTZ).data;\n      if (!data) {\n        return;\n      }\n      this.tooltipValue = parseFloat(parseFloat(data[data.length - 1].toString()).toFixed(6)).toLocaleString();\n    }\n\n    if (this.chartRef?.nativeElement && this.datas[this.series]?.datasets) {\n      const ctx = this.chartRef.nativeElement.getContext('2d');\n      this.chart?.destroy();\n      this.sets = this.data?.datasets.map((set) => ({ name: set.label }));\n      this.chart = new Chart(ctx, {\n        type: this.type,\n        data: this.data,\n        options: this.options,\n        plugins: []\n      });\n      this.drawn.emit(null);\n    }\n  }\n  toggleSeries(series): void {\n    this.series = series;\n    this.data = this.datas[series];\n    this.overrideDatasetConfig();\n    this.options = this.getChartOptions();\n    this.draw();\n  }\n  toggleSet(set): void {\n    this.reset();\n    this.overrideDatasetConfig();\n    for (let key of Object.keys(this.datas)) {\n      for (let i = 0; i < this.datas[key].datasets.length; ++i) {\n        if (this.datas[key].datasets[i].label === set) {\n          this.datas[key].datasets[i].hidden = false;\n          if (set === ChartTitle.XTZtzBTC) {\n            this.units = 'tzBTC';\n          } else if (set === ChartTitle.tzBTCXTZ) {\n            this.units = 'XTZ';\n          } else {\n            this.toggleSeries(ChartSeries['month']);\n            this.units = 'usd';\n          }\n        } else {\n          this.datas[key].datasets[i].hidden = true;\n        }\n      }\n    }\n    this.data = this.datas[this.series];\n    this.sets = this.data?.datasets.map((set) => ({ name: set.label }));\n    this.set = set ?? this.sets[0].name;\n    this.refreshDDSets();\n    this.options = this.getChartOptions();\n    this.draw();\n  }\n  reset(): void {\n    this.ddSets = [];\n    this.sets = [];\n    this.set = '';\n    this.data = null;\n  }\n  overrideDatasetConfig(): void {\n    for (let i = 0; i < this.datas[this.series]?.datasets.length; ++i) {\n      this.datas[this.series].datasets[i].pointHoverBorderWidth = this.design === 'mini' && !this.chartExpanded ? 0 : 6;\n      this.datas[this.series].datasets[i].pointHitRadius = this.design === 'mini' && !this.chartExpanded ? 0 : 6;\n      this.datas[this.series].datasets[i].pointHoverBackgroundColor = this.design === 'mini' && !this.chartExpanded ? '#00000000' : '#5963ff88';\n      this.datas[this.series].datasets[i].pointHoverBorderColor = this.design === 'mini' && !this.chartExpanded ? '#00000000' : '#5963ff88';\n      this.datas[this.series].datasets[i].pointBackgroundColor = this.design === 'mini' && !this.chartExpanded ? '#00000000' : '#5963ff88';\n      this.datas[this.series].datasets[i].backgroundColor = function (context) {\n        const chart = context.chart;\n        const { ctx, chartArea } = chart;\n\n        if (!chartArea) {\n          return null;\n        }\n        return getGradientBackground(ctx, chartArea);\n      };\n    }\n  }\n  getChartOptions(): any {\n    let yTickPadding = -102;\n    if (this.set === ChartTitle.tzBTCXTZ) {\n      yTickPadding = -71;\n    } else if (this.set === ChartTitle.totalValueLocked) {\n      yTickPadding = -95;\n    }\n    return {\n      layout: {\n        padding: 0\n      },\n      scales: {\n        y: {\n          beginAtZero: false,\n          position: 'right',\n          ticks: {\n            maxTicksLimit: 5,\n            display: this.design === 'mini' && this.chartExpanded === false ? false : true,\n            padding: yTickPadding,\n            align: 'start',\n            font: {\n              size: 14,\n              weight: 500,\n              family: 'Roboto'\n            },\n            textStrokeColor: '#333',\n            z: 1,\n            callback: (label, index, ticks) => {\n              if (index >= 1 && index < 4) {\n                return label < 1 ? label.toFixed(8) : Number(label.toFixed(8).replace(/(\\.0+|0+)$/, '')).toLocaleString();\n              } else {\n                return '';\n              }\n            }\n          },\n          grid: {\n            drawBorder: false,\n            lineWidth: 0\n          }\n        },\n        x: {\n          ticks: {\n            maxTicksLimit: 0,\n            display: false\n          },\n          grid: {\n            drawBorder: false,\n            lineWidth: 0\n          }\n        }\n      },\n      responsive: true,\n      maintainAspectRatio: false,\n      legend: {\n        display: false\n      },\n      hover: {\n        mode: 'nearest',\n        axis: 'x',\n        intersect: false\n      },\n      tooltips: {\n        mode: 'index',\n        axis: 'x',\n        intersect: false\n      },\n      interaction: {\n        intersect: false,\n        mode: 'index',\n        axis: 'x'\n      },\n      elements: {\n        line: {\n          tension: 0.0\n        },\n        point: {\n          radius: 0\n        }\n      },\n      plugins: {\n        tooltip: {\n          enabled: this.design === 'mini' && !this.chartExpanded ? false : true,\n          mode: 'nearest',\n          intersect: false,\n          backgroundColor: 'rgba(0, 0, 0, 0.0)',\n          titleColor: 'rgba(0, 0, 0, 0.0)',\n          bodyColor: 'rgba(0, 0, 0, 0.0)',\n          footerColor: 'rgba(0, 0, 0, 0.0)',\n          displayColors: false,\n          callbacks: {\n            label: (item, a, b) => {\n              this.tooltipValue =\n                item.dataset.data[item.dataIndex] < 1\n                  ? item.dataset.data[item.dataIndex].toFixed(8).toLocaleString()\n                  : parseFloat(item.dataset.data[item.dataIndex].toFixed(2).replace(/(\\.0+|0+)$/, '')).toLocaleString() ?? '';\n              return parseFloat(item.dataset.data[item.dataIndex].toFixed(8)).toLocaleString();\n            }\n          }\n        },\n        legend: { display: false }\n      }\n    };\n  }\n}\n","import { Component, EventEmitter, HostListener, Input, OnInit, Output } from '@angular/core';\nimport { ListComponent } from '../generic/list.component';\n\n@Component({\n  selector: 'app-ui-dropdown',\n  templateUrl: './dropdown.component.html'\n})\nexport class DropdownComponent extends ListComponent implements OnInit {\n  @Output() dropdownResponse = new EventEmitter();\n  @Input() options: any[];\n  selection: any;\n  ecmpId = this.constructor['cmp'].id;\n  isOpen = false;\n  constructor() {\n    super();\n  }\n\n  ngOnInit(): void {}\n\n  @HostListener('document:click', ['$event'])\n  @HostListener('document:touchend', ['$event'])\n  closeDropdown(e): void {\n    if (!e.target.closest('#' + this.ecmpId) && this.isOpen) {\n      this.isOpen = false;\n    }\n  }\n\n  toggleDropdown(): void {\n    this.isOpen = !this.isOpen;\n  }\n}\n","import { Component, Input, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-list',\n  templateUrl: './list.component.html'\n})\nexport class ListComponent implements OnInit {\n  @Input() current;\n  @Input() list: any[];\n\n  constructor() {}\n\n  ngOnInit(): void {}\n}\n","<div class=\"flex-column\" [class]=\"getType().replace('undelegated', 'delegated')\"\n  [class.unconfirmed]=\"activity.status === OpStatus.UNCONFIRMED\" [class.half_confirmed]=\"activity.status === OpStatus.HALF_CONFIRMED\"\n  [class.confirmed]=\"activity.status === OpStatus.CONFIRMED\" [class.new]=\"fresh && activity.status === OpStatus.CONFIRMED\"\n  [class.failed]=\"activity.status === OpStatus.FAILED\">\n  <div class=\"flex-row top\">\n    <div class=\"flex-row title\">\n      <ng-container *ngIf=\"!activity.entrypoint; else callEntrypoint\">\n        <ng-container [ngSwitch]=\"getType()?.replace('undelegated', 'delegated')\">\n          <img *ngSwitchCase=\"'sent'\" [src]=\"activity.status === OpStatus.FAILED ? '../../../../assets/img/up-arrow-red.svg' : '../../../../assets/img/up-arrow-black.svg'\"\n            style=\"transform: rotate(45deg)\" />\n          <img *ngSwitchCase=\"'received'\" [src]=\"activity.status === OpStatus.FAILED ? '../../../../assets/img/up-arrow-red.svg' : '../../../../assets/img/up-arrow.svg'\" style=\"transform: rotate(135deg)\" />\n          <div *ngSwitchDefault class=\"blank\"></div>\n        </ng-container>{{ printAmount() }}\n      </ng-container>\n      <ng-template #callEntrypoint>\n        <ng-container *ngIf=\"zeroSent(activity); else notZero\">\n          <div class=\"blank\"></div>\n        </ng-container>\n        <ng-template #notZero>\n          <img src=\"../../../../assets/img/up-arrow-black.svg\" style=\"transform: rotate(45deg)\" />\n        </ng-template>\n        {{ sentKind(activity) }}\n      </ng-template>\n    </div>\n    <span class=\"failed\" *ngIf=\"activity.status === OpStatus.FAILED\">Error</span>\n    <div class=\"updating-balances\" *ngIf=\"activity.status === OpStatus.HALF_CONFIRMED\">\n      <img class=\"spinner\" src=\"../../../../../assets/img/feeLoader.gif\">\n      <span>Updating balances</span>\n    </div>\n  </div>\n  <div class=\"flex-row bottom\">\n    <div class=\"flex-row address\"><img\n        *ngIf=\"!!getCounterparty(activity)?.lookupType && getCounterparty(activity)?.lookupType !== 5\"\n        [src]=\"getEventIcon()\" class=\"event-icon\" />\n      <div class=\"flex-row value\">{{ getAddressPrefix(getType()) }}&nbsp;{{getCounterparty(activity)?.name ||\n        getCounterparty(activity)?.address || ''}}</div>\n      <img class=\"copy\" src=\"../../../../assets/img/copy-icon.svg\"\n          (click)=\"copy(getCounterparty(activity)?.address)\" />\n    </div>\n    <span class=\"flex-row time\">\n      <img [src]=\"getEventStatusIcon()\" />\n      <a class=\"status\" *ngIf=\"activity.status !== OpStatus.UNCONFIRMED\" href=\"{{ explorerURL(activity.hash) }}\" target=\"_blank\">\n        <ng-container *ngIf=\"activity.status !== OpStatus.HALF_CONFIRMED; else halfConfirmed\">\n          {{ activity.timestamp | timeAgo:trigger }}\n        </ng-container>\n        <ng-template #halfConfirmed>\n          Confirmed\n        </ng-template>\n      </a>\n      <div class=\"status\" *ngIf=\"activity.status === OpStatus.UNCONFIRMED\">Unconfirmed</div>\n    </span>\n  </div>\n</div>","import { Component, Input, OnChanges, OnDestroy, OnInit, SimpleChanges } from '@angular/core';\nimport { Account, Activity, OpStatus } from '../../../../../../services/wallet/wallet';\nimport { TimeAgoPipe } from '../../../../../../pipes/time-ago.pipe';\nimport { TranslateService } from '@ngx-translate/core';\nimport { MessageService } from '../../../../../../services/message/message.service';\nimport { ActivityService } from '../../../../../../services/activity/activity.service';\nimport { TokenService } from '../../../../../../services/token/token.service';\nimport { CONSTANTS } from '../../../../../../../environments/environment';\nimport { LookupType } from '../../../../../../services/lookup/lookup.service';\nimport copy from 'copy-to-clipboard';\nimport { SubjectService } from '../../../../../../services/subject/subject.service';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'app-event',\n  templateUrl: './event.component.html',\n  styleUrls: ['../../../../../../../scss/components/views/logged-in/account-view/cards/activity/event.component.scss']\n})\nexport class EventComponent implements OnInit, OnChanges, OnDestroy {\n  public OpStatus = OpStatus;\n  public LookupType = LookupType;\n  public fresh = undefined;\n  private subscriptions: Subscription = new Subscription();\n  constructor(\n    public translate: TranslateService,\n    public messageService: MessageService,\n    public timeAgoPipe: TimeAgoPipe,\n    private activityService: ActivityService,\n    public tokenService: TokenService,\n    private subjectService: SubjectService\n  ) {}\n  trigger = true;\n  @Input() activity: Activity;\n  @Input() account: Account;\n  ngOnInit(): void {\n    setInterval(() => {\n      this.trigger = !this.trigger;\n    }, 1000);\n    this.subscriptions.add(\n      this.subjectService.confirmedOp.subscribe((opHash) => {\n        if (opHash === this.activity.hash && this.fresh === undefined) {\n          this.fresh = true;\n          setTimeout(() => {\n            this.fresh = false;\n          }, 20000);\n        }\n      })\n    );\n  }\n  ngOnChanges(changes: SimpleChanges): void {}\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n  getType(): string {\n    if (this.activity.type !== 'transaction') {\n      if (this.activity.type === 'delegation') {\n        if (this.activity.destination.address) {\n          return 'delegated';\n        } else {\n          return 'undelegated';\n        }\n      } else {\n        return this.activity.type;\n      }\n    } else {\n      let operationType = '';\n      if (this.activity.source.address === this.account.address) {\n        operationType = 'sent';\n      } else {\n        operationType = 'received';\n      }\n      return operationType;\n    }\n  }\n\n  explorerURL(hash: string): string {\n    const baseURL = CONSTANTS.BLOCK_EXPLORER_URL;\n    return `${baseURL}/${hash}`;\n  }\n  getCounterparty(transaction): any {\n    const c = this.activityService.getCounterparty(transaction, this.account);\n    if (!c.name) {\n      c.name = c.address ? `${c.address.slice(0, 7)}...${c.address.slice(-4)}` : '';\n    }\n    c.name.trim();\n    return c;\n  }\n  getEventIcon(): string {\n    return `../../../../assets/img/${LookupType[this.getCounterparty(this.activity)?.lookupType].toLowerCase().replace('tezosdomains', 'domain')}-logo.svg`;\n  }\n  getEventStatusIcon(): string {\n    return this.fresh && this.activity.status === OpStatus.CONFIRMED\n      ? '../../../../assets/img/event-new.png'\n      : this.activity.status === OpStatus.CONFIRMED\n      ? '../../../../assets/img/event-confirmed.png'\n      : this.activity.status === OpStatus.UNCONFIRMED\n      ? '../../../../assets/img/event-unconfirmed.png'\n      : this.activity.status === OpStatus.FAILED\n      ? '../../../../assets/img/event-error.png'\n      : this.activity.status === OpStatus.HALF_CONFIRMED\n      ? '../../../../../assets/img/event-half-confirmed.png'\n      : '../../../../assets/img/event-unconfirmed.png';\n  }\n  printAmount(): string {\n    switch (this.getType()) {\n      case 'sent':\n        return this.tokenService.formatAmount(this.activity.tokenId, this.activity.amount.toString());\n      case 'received':\n        return this.tokenService.formatAmount(this.activity.tokenId, this.activity.amount.toString());\n      case 'delegated':\n        return 'Staked';\n      case 'undelegated':\n        return 'Unstaked';\n      case 'origination':\n        return this.tokenService.formatAmount(this.activity.tokenId, this.activity.amount.toString());\n      default:\n        return '';\n    }\n  }\n  sentKind(activity): string {\n    if (activity.entrypoint) {\n      if (activity.amount !== '0') {\n        return `${this.printAmount()}, Call ${activity.entrypoint}`;\n      }\n      return `Call ${activity.entrypoint}`;\n    }\n    return '0';\n  }\n  zeroSent(activity): boolean {\n    return this.sentKind(activity).length > 4 && activity.amount === '0';\n  }\n  receivedKind(activity): string {\n    return activity.tokenId && activity.source.address && activity.tokenId.split(':')[0] === activity.source.address ? 'Minted' : 'Received';\n  }\n  getAddressPrefix(type: string) {\n    switch (type.toLowerCase()) {\n      case 'sent':\n        return 'Sent to:';\n      case 'received':\n        return this.receivedKind(this.activity) + ' from:';\n      case 'delegated':\n        return 'To:';\n      case 'undelegated':\n        return 'To:';\n      case 'origination':\n        return 'Originated contract:';\n    }\n  }\n  copy(address: string): void {\n    copy(address);\n    const copyToClipboard = this.translate.instant('OVERVIEWCOMPONENT.COPIEDTOCLIPBOARD');\n    this.messageService.add(address + ' ' + copyToClipboard, 5);\n  }\n}\n","<div class=\"selectable main-container\">\n  <div class=\"top-container-activity\">\n    <h1>Recent Activity</h1>\n    <div class=\"right\">\n      <a class=\"view-all\" href=\"{{ explorerURL(account.address) }}\" target=\"_blank\">View in Explorer</a>\n      <!-- <img class=\"button icon\" src=\"../../../../assets/img/info.svg\" /> -->\n    </div>\n  </div>\n  <div class=\"selectable\" id=\"operations-container\" *ngIf=\"this.translate.store.translations.en\">\n    <ng-container *ngIf=\"account.activities; else loading\">\n      <ng-container *ngIf=\"!account.activities.length\">\n        <div class=\"line\"><span>No activity yet</span></div>\n      </ng-container>\n      <ng-container *ngFor=\"let activity of account.activities | slice:0:10; trackBy: trackEvent\">\n        <app-event [activity]=\"activity\" [account]=\"account\"></app-event>\n      </ng-container>\n    </ng-container>\n    <ng-template #loading>Loading activity...</ng-template>\n  </div>\n</div>","import { Component, Input, OnInit } from '@angular/core';\nimport { Account } from '../../../../../services/wallet/wallet';\nimport { TimeAgoPipe } from '../../../../../pipes/time-ago.pipe';\nimport { TranslateService } from '@ngx-translate/core';\nimport { MessageService } from '../../../../../services/message/message.service';\nimport { CONSTANTS } from '../../../../../../environments/environment';\nimport { TokenService } from '../../../../../services/token/token.service';\n\n@Component({\n  selector: 'app-activity',\n  templateUrl: './activity.component.html',\n  styleUrls: ['../../../../../../scss/components/views/logged-in/account-view/cards/activity/activity.component.scss']\n})\nexport class ActivityComponent implements OnInit {\n  public currTimeStamp: number;\n  constructor(public translate: TranslateService, public messageService: MessageService, public timeAgoPipe: TimeAgoPipe, public tokenService: TokenService) {}\n  trigger = true;\n  @Input() activity: any;\n  @Input() account: Account;\n  ngOnInit(): void {}\n  explorerURL(hash: string): string {\n    const baseURL = CONSTANTS.BLOCK_EXPLORER_URL;\n    return `${baseURL}/${hash}`;\n  }\n\n  trackEvent(index: number, activity: any): string {\n    return activity.block + activity.hash;\n  }\n}\n","<div class=\"flex-row token\" (click)=\"viewToken(token)\">\n  <div class=\"dot\"></div>\n  <div class=\"wrapper\">\n    <app-asset class=\"asset\" (inView)=\"balanceChangeTimer()\" [assets]=\"token\" [size]=\"'small'\" [muted]=\"true\" [autoplay]=\"true\" [playsinline]=\"true\" [loop]=\"true\" [priorityList]=\"['thumbnailAsset', 'displayAsset']\"></app-asset>\n    <div *ngIf=\"Number.parseInt(token?.balance) > 1\" class=\"balance\">x{{\n      formatBalance(token) }}</div>\n  </div>\n  <div class=\"flex-column right\">\n    <div class=\"title\">\n      {{token?.name}}\n    </div>\n    <div *ngIf=\"token?.series\" class=\"series\">\n      {{ token?.series }}\n    </div>\n  </div>\n</div>","import { Component, Input, OnChanges, OnInit, SimpleChanges } from '@angular/core';\nimport { TranslateService } from '@ngx-translate/core';\nimport { MessageService } from '../../../../../../services/message/message.service';\nimport { TokenService } from '../../../../../../services/token/token.service';\nimport { CONSTANTS } from '../../../../../../../environments/environment';\nimport { ModalComponent } from '../../../../../modals/modal.component';\nimport { TokenBalancesService } from '../../../../../../services/token-balances/token-balances.service';\nimport { DisplayLinkOption } from '../../../../../../interfaces';\nimport Big from 'big.js';\n\n@Component({\n  selector: 'app-nfts-token',\n  templateUrl: './token.component.html',\n  styleUrls: ['../../../../../../../scss/components/views/logged-in/account-view/cards/nfts/token.component.scss']\n})\nexport class NftsTokenComponent implements OnInit, OnChanges {\n  DisplayLinkOption = DisplayLinkOption;\n  Number = Number;\n  @Input() token;\n  isNew = false;\n  contractAliases = CONSTANTS.CONTRACT_ALIASES;\n  constructor(\n    public translate: TranslateService,\n    public messageService: MessageService,\n    public tokenService: TokenService,\n    public tokenBalancesService: TokenBalancesService\n  ) {}\n  ngOnInit(): void {}\n  ngOnChanges(changes: SimpleChanges): void {\n    if (\n      changes.token.previousValue?.balance > -1 &&\n      changes.token.currentValue?.balance > -1 &&\n      changes.token.currentValue?.balance != changes.token.previousValue?.balance\n    ) {\n      this.isNew = true;\n    }\n  }\n  viewToken(token): void {\n    ModalComponent.currentModel.next({ name: 'token-detail', data: token });\n  }\n  balanceChangeTimer(): void {\n    setTimeout(() => {\n      this.isNew = false;\n    }, 5000);\n  }\n  formatBalance(token): string {\n    return Big(token.balance)\n      .div(10 ** parseInt(token.decimals))\n      .toFixed();\n  }\n}\n","<form autocomplete=\"off\">\n  <div class=\"flex-row\" [id]=\"ecmpId\">\n    <div class=\"flex-row search-bar\" [class.active]=\"isActive\" [class.has-value]=\"hasValue\">\n      <img class=\"search-button\" src=\"assets/img/search.svg\" (click)=\"searchButtonClicked()\" />\n      <input #input name=\"none\" type=\"text\" [(ngModel)]=\"searchText\" [placeholder]=\"placeholderText\" (focus)=\"onFocus()\"\n        (keydown)=\"onKeydown($event)\" />\n      <div *ngIf=\"isActive && hasValue\" class=\"flex-row match-count\"><span>{{ matchCount + ' matches' }}</span></div>\n    </div>\n    <div *ngIf=\"!hasValue\" class=\"flex-row item-count\"><span>{{ '(' + itemCount + ')' }}</span></div>\n  </div>\n</form>","import { Component, ElementRef, EventEmitter, HostListener, Input, OnDestroy, OnInit, Output, ViewChild } from '@angular/core';\nimport { Subject, Subscription } from 'rxjs';\nimport { debounceTime } from 'rxjs/operators';\nimport { SubjectService } from '../../../services/subject/subject.service';\nimport { DropdownComponent } from '../dropdown/dropdown.component';\n\n@Component({\n  selector: 'app-search-bar',\n  templateUrl: './search.component.html',\n  styleUrls: ['../../../../scss/components/ui/search-bar/search.component.scss']\n})\nexport class SearchBarComponent extends DropdownComponent implements OnInit, OnDestroy {\n  @ViewChild('input') input: ElementRef;\n  @Output() onInput = new EventEmitter();\n  @Input() itemCount = 0;\n  @Input() matchCount = 0;\n  inputUpdated = new Subject<any>();\n  filter = '.*';\n  isActive = false;\n  hasValue = false;\n  @Input() placeholder = '';\n  placeholderText = '';\n  searchText = '';\n  private subscriptions: Subscription = new Subscription();\n\n  constructor(private subjectService: SubjectService) {\n    super();\n    this.subscriptions.add(\n      this.inputUpdated.pipe(debounceTime(150)).subscribe((e) => {\n        this.filter = !!e?.target.value ? `${e.target.value.replace(/(\\W)/g, '\\\\$1')}` : '';\n        if (!!e) {\n          this.onInput.emit(this.filter);\n        }\n        this.hasValue = !!this.filter;\n      })\n    );\n    this.subscriptions.add(\n      this.subjectService.activeAccount.subscribe((_) => {\n        this.reset();\n      })\n    );\n  }\n  ngOnInit(): void {\n    this.placeholderText = this.placeholder;\n  }\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n  onKeydown(e): void {\n    this.inputUpdated.next(e);\n  }\n  onFocus(): void {\n    this.isActive = true;\n    this.onInput.emit(this.filter);\n  }\n  searchButtonClicked(): void {\n    if (!this.isActive) {\n      this.input.nativeElement.focus();\n    }\n  }\n  @HostListener('document:click', ['$event'])\n  @HostListener('document:touchend', ['$event'])\n  onBlur(e): void {\n    if (!e.target.closest('#' + this.ecmpId) && this.isActive && !this.hasValue) {\n      this.isActive = false;\n      this.onInput.emit('');\n    }\n  }\n  reset(): void {\n    this.isActive = false;\n    this.filter = '';\n    this.searchText = '';\n    this.hasValue = false;\n    this.onInput.emit(this.filter);\n  }\n}\n","<app-search-bar *ngIf=\"tokens?.length > 12 && searchable\" [placeholder]=\"'Search'\"\n  [matchCount]=\"tokensToDisplay?.filtered.length || 0\" [itemCount]=\"tokensToDisplay?.raw.length || 0\"\n  (onInput)=\"updateFilter($event)\"></app-search-bar>\n<div class=\"scroll-wrapper\">\n  <div #body [style.display]=\"!isDisplaying ? 'none' : ''\" class=\"body\">\n    <ng-container *ngFor=\"let token of tokensToDisplay.loaded; trackBy:trackToken\">\n      <app-nfts-token class=\"token\" [token]=\"token\"></app-nfts-token>\n    </ng-container>\n    <ng-container *ngIf=\"filter !== '.*' && !tokensToDisplay.filtered.length\">\n      No Matches Found\n    </ng-container>\n  </div>\n</div>","import { AfterViewInit, Component, Input, OnChanges, OnInit, ViewChild } from '@angular/core';\nimport { TranslateService } from '@ngx-translate/core';\nimport { MessageService } from '../../../../../../services/message/message.service';\nimport { TokenService } from '../../../../../../services/token/token.service';\nimport { CONSTANTS } from '../../../../../../../environments/environment';\nimport { TokenBalancesService } from '../../../../../../services/token-balances/token-balances.service';\nimport { DisplayLinkOption } from '../../../../../../interfaces';\nimport { Subject } from 'rxjs';\nimport { Token } from '../../../../../../services/wallet/wallet';\n\n@Component({\n  selector: 'app-nfts-body',\n  templateUrl: './body.component.html',\n  styleUrls: ['../../../../../../../scss/components/views/logged-in/account-view/cards/nfts/body.component.scss']\n})\nexport class NftsBodyComponent implements OnInit, OnChanges, AfterViewInit {\n  DisplayLinkOption = DisplayLinkOption;\n  @ViewChild('body') body;\n  @Input() isDisplaying;\n  @Input() tokens;\n  @Input() searchable = false;\n  tokensToDisplay = { loaded: [], filtered: [], raw: [] };\n  contractAliases = CONSTANTS.CONTRACT_ALIASES;\n  readonly chunkSize = 24;\n  sliceEnd = this.chunkSize;\n  inputUpdated = new Subject<any>();\n  filter = '.*';\n\n  constructor(\n    public translate: TranslateService,\n    public messageService: MessageService,\n    public tokenService: TokenService,\n    public tokenBalancesService: TokenBalancesService\n  ) {}\n  ngOnInit(): void {\n    this.refresh();\n  }\n  ngOnChanges(): void {\n    if (this.isDisplaying) {\n      this.refresh();\n    }\n  }\n  refresh(): void {\n    this.tokensToDisplay.raw = this.tokens;\n    this.tokensToDisplay.filtered = this.search(this.tokens);\n    this.tokensToDisplay.loaded = this.tokensToDisplay.filtered.slice(0, this.sliceEnd);\n  }\n  ngAfterViewInit(): void {\n    const cb = (e) => {\n      if (\n        this.body?.nativeElement?.scrollTop >= this.body?.nativeElement?.scrollHeight - this.body?.nativeElement?.clientHeight - 15 &&\n        (this.sliceEnd < this.tokensToDisplay.raw?.length ?? 0)\n      ) {\n        this.sliceEnd += this.chunkSize;\n        this.refresh();\n      }\n    };\n    this.body?.nativeElement.addEventListener('scroll', cb);\n    this.body?.nativeElement.addEventListener('touchmove', cb);\n  }\n  search(tokens): Token[] {\n    if (this.filter.length > 0 && this.filter !== '.*') {\n      return tokens.filter(\n        (t: any) =>\n          t.name.match(new RegExp(`.*${this.filter}.*`, 'i')) ||\n          (!isNaN(Number(this.filter)) && t.id.toString().match(new RegExp(`.*${parseInt(this.filter)}.*`, 'g')))\n      );\n    }\n    return tokens;\n  }\n  updateFilter(filter: string): void {\n    const prevFilter = this.filter;\n    this.filter = filter || '.*';\n    if (prevFilter !== this.filter) {\n      this.sliceEnd = this.chunkSize;\n      this.refresh();\n      this.body.nativeElement.scrollTo(0, 0);\n    }\n  }\n  trackToken(index: number, token: any): string | number {\n    return token?.contractAddress ? token?.contractAddress + ':' + token?.id : index;\n  }\n}\n","<div class=\"main-container\" *ngIf=\"displayTokenCard()\">\n  <div class=\"flex-row top-container-nfts\">\n    <div class=\"flex-row toggle\">\n      <h1 class=\"flex-row\" [class.selected]=\"!isDiscover\" (click)=\"isDiscover = false\">NFT<span> / Collectibles</span>\n      </h1>\n      <h1 class=\"flex-row\" [class.selected]=\"isDiscover\" (click)=\"isDiscover = true\">{{ 'Discover' }}</h1>\n    </div>\n    <div class=\"flex-row right\">\n      <ng-container *ngIf=\"this.nfts && Object.keys(this.nfts).length > 0 && !isDiscover\">\n        <span class=\"flex-row button icon-grey\" [class.selected]=\"filter === 'ALL'\" (click)=\"filter = 'ALL';\">ALL</span>\n        <span class=\"flex-row button icon-grey\" [class.selected]=\"filter !== 'ALL'\" (click)=\"filter = '';\">APP</span>\n      </ng-container>\n      <!-- <img class=\"button icon\" src=\"../../../../assets/img/filter.svg\" />\n      <img class=\"button icon\" src=\"../../../../assets/img/info.svg\" /> -->\n    </div>\n  </div>\n  <div class=\"flex-row-wrap nfts\" [class.d]=\"isDiscover\">\n    <!-- loop through contracts -->\n    <ng-container *ngIf=\"!nftsArray?.length && !isDiscover\"><span>There are no NFTs in this account</span>\n    </ng-container>\n    <ng-container *ngFor=\"let contract of nftsArray; trackBy:trackContract\">\n      <div class=\"flex-column collection\" [class.expanded]=\"filter === sanitizeKey(contract?.key)\"\n        [id]=\"sanitizeKey(contract?.key)\" [style.display]=\"!isDiscover && filter !== 'ALL' ? '' : 'none'\">\n        <div class=\"flex-row head\" (click)=\"toggleDropdown(sanitizeKey(contract?.key))\">\n          <div class=\"flex-row left\">\n            <app-asset class=\"nfts-head-thumbnail\" [assets]=\"{ thumbnailAsset:contract?.thumbnailUrl}\"></app-asset>\n            <div class=\"title\">\n              {{ contract?.name }}\n            </div>\n          </div>\n          <div class=\"flex-row right\">\n            <div class=\"count\">({{ contract?.tokens?.length }})</div>\n            <div class=\"flex-row button toggle\"><img src=\"../../../../assets/img/caret-left.svg\" /></div>\n          </div>\n        </div>\n        <div class=\"flex-column scroll\">\n          <app-nfts-body [isDisplaying]=\"filter === sanitizeKey(contract?.key)\" [tokens]=\"contract?.tokens\">\n          </app-nfts-body>\n        </div>\n      </div>\n    </ng-container>\n    <div class=\"flex-column collection scroll all\" [style.display]=\"!isDiscover && filter === 'ALL' ? '' : 'none'\">\n      <app-nfts-body class=\"all\" [isDisplaying]=\"!isDiscover && filter === 'ALL'\" [tokens]=\"tokens\" [searchable]=\"true\">\n      </app-nfts-body>\n    </div>\n    <ng-container *ngIf=\"isDiscover\">\n      <ng-container *ngFor=\"let contractAlias of contractAliases\">\n        <ng-container *ngIf=\"shouldDisplayLink(contractAlias?.shouldDisplayLink)\">\n          <a class=\"flex-column discover\" rel=\"noreferrer\" [href]=\"contractAlias?.link || '/'\" target=\"_blank\"\n            [style.display]=\"isDiscover ? '' : 'none'\">\n            <div class=\"flex-row top\">{{ getContractAlias(contractAlias?.category) || '' }}</div>\n            <div class=\"flex-column middle\" [class.zoom]=\"contractAlias?.zoomDiscoverImg\"\n              [style.backgroundColor]=\"contractAlias?.backgroundColor\">\n              <app-asset class=\"discover\" [class.zoom]=\"contractAlias?.zoomDiscoverImg\" [size]=\"'raw'\"\n                [assets]=\"{displayAsset: contractAlias.discoverUrl, thumbnailAsset: contractAlias.thumbnailUrl}\">\n              </app-asset>\n            </div>\n            <div class=\"flex-row bottom\">\n              <div class=\"flex-column left\">\n                <div class=\"title\">{{ contractAlias?.name || key }}</div>\n                <div class=\"description\">{{ contractAlias?.description }}</div>\n              </div>\n              <div class=\"flex-column right\">\n                <a class=\"link-to-app\">\n                  <button class=\"flex-row button\">GO <img src=\"assets/img/discover-right-angle.svg\" /></button>\n                </a>\n              </div>\n            </div>\n          </a>\n        </ng-container>\n      </ng-container>\n    </ng-container>\n  </div>\n</div>","import { Component, Input, OnDestroy, OnInit } from '@angular/core';\nimport { TorusWallet } from '../../../../../services/wallet/wallet';\nimport { WalletService } from '../../../../../services/wallet/wallet.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport { MessageService } from '../../../../../services/message/message.service';\nimport { TokenService } from '../../../../../services/token/token.service';\nimport { CONSTANTS } from '../../../../../../environments/environment';\nimport { TokenBalancesService } from '../../../../../services/token-balances/token-balances.service';\nimport { SubjectService } from '../../../../../services/subject/subject.service';\nimport { DisplayLinkOption } from '../../../../../interfaces';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'app-nfts',\n  templateUrl: './nfts.component.html',\n  styleUrls: ['../../../../../../scss/components/views/logged-in/account-view/cards/nfts/nfts.component.scss']\n})\nexport class NftsComponent implements OnInit, OnDestroy {\n  DisplayLinkOption = DisplayLinkOption;\n  Object = Object;\n  nfts = undefined;\n  nftsArray = [];\n  tokens = [];\n  isDiscover: boolean = false;\n  isInitLoad: boolean = true;\n  filter: string = 'APP';\n  contractAliases = Object.keys(CONSTANTS.CONTRACT_ALIASES).map((key: any) => ({ key, ...CONSTANTS.CONTRACT_ALIASES[key] }));\n  activeAddress: string = '';\n  private subscriptions: Subscription = new Subscription();\n  constructor(\n    public translate: TranslateService,\n    public messageService: MessageService,\n    public tokenService: TokenService,\n    public tokenBalancesService: TokenBalancesService,\n    private subjectService: SubjectService,\n    private walletService: WalletService\n  ) {\n    this.subscriptions.add(\n      this.subjectService.nftsUpdated.subscribe((p) => {\n        const activeAddress = this.subjectService.activeAccount.getValue()?.address;\n        if (activeAddress !== this.activeAddress) {\n          this.activeAddress = activeAddress;\n          this.reset();\n        }\n        if (this.isInitLoad) {\n          if (!p?.nfts || !Object.keys(p.nfts)?.length) {\n            this.isDiscover = true;\n          } else {\n            this.isInitLoad = false;\n            this.isDiscover = false;\n          }\n        }\n        this.nfts = p?.nfts;\n        this.nftsArray = p?.nfts ? Object.keys(p.nfts).map((key: any) => ({ key, ...p.nfts[key] })) : [];\n        this.tokens = p?.nfts\n          ? Object.keys(p.nfts)\n              .map((key: any) => p.nfts[key]?.tokens)\n              .flat()\n          : [];\n      })\n    );\n    this.subscriptions.add(\n      this.subjectService.logout.subscribe((o) => {\n        if (o) {\n          this.reset();\n          this.activeAddress = '';\n        }\n      })\n    );\n    this.subscriptions.add(\n      this.subjectService.activeAccount.subscribe((activeAccount) => {\n        const activeAddress = activeAccount?.address;\n        if (activeAddress !== this.activeAddress) {\n          this.activeAddress = activeAddress;\n          this.reset();\n        }\n      })\n    );\n  }\n  @Input() activity: any;\n  @Input() account;\n  ngOnInit(): void {}\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n  displayTokenCard(): boolean {\n    return this.nfts !== undefined;\n  }\n  toggleDropdown(sel): void {\n    if (this.filter === sel) {\n      this.filter = '';\n    } else {\n      this.filter = sel;\n      const c = document.querySelector('#' + sel) as HTMLElement;\n      if (window.innerWidth < 1024) {\n        setTimeout(() => {\n          document.body.scroll(0, c.offsetTop - 25);\n        }, 25);\n      }\n    }\n  }\n  shouldDisplayLink(option: DisplayLinkOption): boolean {\n    if (option === 0 || (option === 1 && this.walletService.wallet instanceof TorusWallet)) {\n      return true;\n    }\n    return false;\n  }\n  sanitizeKey(key: string): string {\n    return 'ku' + key?.replace(/ /g, '');\n  }\n\n  trackContract(index: number, contract: any): string | number {\n    return contract?.key ? contract.key : index;\n  }\n\n  getContractAlias(category): string {\n    return category?.join('  ');\n  }\n  reset(): void {\n    this.nfts = undefined;\n    this.isDiscover = false;\n    this.tokens = [];\n    this.nftsArray = [];\n    this.isInitLoad = true;\n    this.filter = 'APP';\n  }\n}\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-basic-button',\n  templateUrl: './basic.component.html'\n})\nexport class BasicButtonComponent implements OnInit {\n  constructor() {}\n\n  ngOnInit(): void {}\n}\n","<button *ngIf=\"symbol && !override; else detailButton\" class=\"flex-row button button-primary with-image\"\n  [class]=\"symbol === 'tez' ? 'tez' : ''\" (click)=\"prepareTransaction()\">\n  <svg *ngIf=\"symbol === 'tez'\" width=\"18\" height=\"18\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 18 18\">\n    <path id=\"svg_1\"\n      d=\"m16.4439,9.50064c-0.764,0.764 -2.003,0.764 -2.767,0l-2.66,-2.659l0,9.231c0,1.105 -0.895,2 -2,2c-1.104,0 -2,-0.895 -2,-2l0,-9.254l-2.679,2.68c-0.767,0.767 -2.01,0.767 -2.777,0c-0.767,-0.767 -0.767,-2.01 0,-2.776l5.936,-5.936c0.037,-0.044 0.052,-0.099 0.093,-0.14c0.203,-0.203 0.558,-0.344 0.693,-0.439c0.716,-0.307 1.575,-0.176 2.16,0.409c0.101,0.101 0.152,0.227 0.227,0.342l5.774,5.774c0.765,0.764 0.765,2.004 0,2.768z\"\n      fill=\"rgb(255, 255, 255)\" fill-rule=\"evenodd\" />\n  </svg>\n  <img *ngIf=\"symbol !== 'tez'\" [src]=\"'../../../../assets/img/up-arrow.svg'\" />\n  <div class=\"tooltip\">\n    <div class=\"description\">SEND {{ symbol }}</div>\n  </div>\n</button>\n<ng-template #detailButton>\n  <button class=\"button button-primary detail\" (click)=\"prepareTransaction()\">SEND</button>\n</ng-template>","import { Component, OnInit, Input } from '@angular/core';\nimport { Account } from '../../../../../services/wallet/wallet';\nimport { TokenService } from '../../../../../services/token/token.service';\nimport { SubjectService } from '../../../../../services/subject/subject.service';\nimport { BasicButtonComponent } from '../basic.component';\n\n@Component({\n  selector: 'app-send-button',\n  templateUrl: './send-button.component.html',\n  styleUrls: ['../../../../../../scss/components/ui/button/send.component.scss']\n})\nexport class SendButtonComponent extends BasicButtonComponent implements OnInit {\n  @Input() activeAccount: Account;\n  @Input() tokenTransfer: string;\n  @Input() symbol: string;\n  @Input() override = false;\n  asset = null;\n  constructor(public tokenService: TokenService, private subjectService: SubjectService) {\n    super();\n  }\n\n  ngOnInit(): void {\n    this.asset = this.tokenService.getAsset(this.tokenTransfer);\n  }\n  prepareTransaction(): void {\n    this.subjectService.prepareTokenTransfer.next({\n      account: this.activeAccount,\n      tokenTransfer: this.tokenTransfer,\n      symbol: this.symbol\n    });\n  }\n}\n","<div class=\"flex-row balance\">\n  <div class=\"flex-row left\">\n    <app-asset class=\"asset\" [priorityList]=\"['thumbnailAsset', 'displayAsset', 'fallback']\" [assets]=\"token\" [class.sd]=\"token.name === 'tezos'\"\n      (click)=\"viewToken()\">\n    </app-asset>\n    <div class=\"flex-row title\" (click)=\"viewToken()\">{{token.name === 'tezos' ? 'Tezos' : token.symbol}}</div>\n    <div class=\"flex-column prices\">\n      <div class=\"price\">{{ token.name === 'tezos' ? (getBalance() | number: '1.0-' + (token?.decimals || 6) | removeComma) || '' :\n        getBalance() }}</div>\n      <div class=\"price-usd\">{{ getBalanceFiat() ? '$' + (getBalanceFiat() | number:'1.2-2' | removeComma) : '' }}\n      </div>\n    </div>\n  </div>\n  <div class=\"flex-row right\">\n    <ng-container *ngIf=\"token?.name === 'tezos'\">\n      <button *ngIf=\"this.account?.balanceXTZ\" class=\"flex-row button button-primary with-image buy\" (click)=\"this.buyTez()\">\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M12 5.00024V19.0002\" stroke=\"#ffffff\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n          <path d=\"M5 12H19\" stroke=\"#ffffff\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n        </svg>\n        <div class=\"tooltip\">\n          <div class=\"description\">BUY tez</div>\n        </div>\n      </button>\n      <button *ngIf=\"this.account?.balanceXTZ === 0\" class=\"flex-row button button-primary with-image buy tez\" (click)=\"this.buyTez()\">\n        <span>Buy</span>\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M12 5.00024V19.0002\" stroke=\"#ffffff\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n          <path d=\"M5 12H19\" stroke=\"#ffffff\" stroke-width=\"3\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n        </svg>\n        <div class=\"tooltip alt\">\n          <div class=\"description\">BUY tez</div>\n        </div>\n      </button>\n    </ng-container>\n    <app-send-button *ngIf=\"token && this.account?.balanceXTZ !== 0\" [activeAccount]=\"account\"\n      [tokenTransfer]=\"token?.name === 'tezos' ? null : token?.contractAddress + ':' + token?.id\"\n      [symbol]=\"token?.name === 'tezos' ? 'tez' : token?.symbol\"></app-send-button>\n  </div>\n</div>","import { Component, Input, OnInit } from '@angular/core';\nimport { ModalComponent } from '../../../../../modals/modal.component';\nimport { CONSTANTS } from '../../../../../../../environments/environment';\nimport { Big } from 'big.js';\nimport { RemoveCommaPipe } from '../../../../../../pipes/remove-comma.pipe';\nimport { SubjectService } from '../../../../../../services/subject/subject.service';\n\n@Component({\n  selector: 'app-balance-token',\n  templateUrl: './balance-token.component.html',\n  styleUrls: ['../../../../../../../scss/components/views/logged-in/account-view/cards/balances/balance-token.component.scss']\n})\nexport class BalanceTokenComponent implements OnInit {\n  @Input() token = null;\n  @Input() account;\n  contractAliases = CONSTANTS.CONTRACT_ALIASES;\n\n  constructor(public removeCommaPipe: RemoveCommaPipe, private subjectService: SubjectService) {}\n  ngOnInit(): void {}\n\n  getBalance(): number | string {\n    return this.token?.name === 'tezos'\n      ? this.account?.balanceXTZ !== null\n        ? Big(this.account?.balanceXTZ).div(1000000).toFixed()\n        : undefined\n      : this.token?.balance;\n  }\n\n  getBalanceFiat(): number | undefined {\n    return this.token.name === 'tezos' ? this.account?.balanceUSD || undefined : this.token?.price && this.token.price >= 0.005 ? this.token.price : undefined;\n  }\n  viewToken(): void {\n    if (this.token?.name !== 'tezos') {\n      ModalComponent.currentModel.next({\n        name: 'token-detail',\n        data: this.token\n      });\n    }\n  }\n  buyTez(): void {\n    this.subjectService.moonpay.next(true);\n  }\n}\n","<div class=\"main-container\">\n  <div class=\"flex-row top-container-balances\">\n    <h1>Balances</h1>\n    <div class=\"flex-row button right\">\n      <button class=\"swap-liquidity\" (click)=\"openSwap()\">Liquidity Baking</button>\n    </div>\n  </div>\n  <div class=\"scroll-wrapper\">\n    <app-balance-token [account]=\"account\" [token]=\"{name: 'tezos', fallback: 'assets/img/tezos-xtz-logo.svg'}\" class=\"tez no-box\"></app-balance-token>\n    <div *ngIf=\"!!this.tokenBalancesService?.balances?.length\" class=\"flex-column balances\">\n      <ng-container *ngFor=\"let balance of balances; let i = index; trackBy: trackToken\">\n        <app-balance-token [account]=\"account\" [token]=\"balance\" [class.first]=\"i === 0\"></app-balance-token>\n      </ng-container>\n    </div>\n    <div class=\"flex-row total-balances no-box\">\n      <div class=\"flex-row left\">\n        <h3>TOTAL VALUE:</h3>\n        <h1>{{ !!totalBalances && isFiat ? '$' + (totalBalances | number: '1.2-2' | removeComma) : '' }}{{ !!totalBalances && !isFiat ? (totalBalances | number: '1.0-6' | removeComma) + ' tez' : '' }}{{ !totalBalances ? '' : '' }}</h1>\n      </div>\n      <div class=\"flex-row\" (click)=\"toggleTotalBalances()\">\n        <span class=\"fiat\" [class.selected]=\"isFiat\">\n          {{ 'usd' }}\n        </span>\n        <span class=\"sep\">&nbsp;{{ '|' }}&nbsp;</span>\n        <span class=\"tez\" [class.selected]=\"!isFiat\">\n          {{ 'tez' }}\n        </span>\n      </div>\n    </div>\n  </div>\n</div>","import { AfterViewChecked, Component, Input, OnDestroy, OnInit } from '@angular/core';\nimport { Account } from '../../../../../services/wallet/wallet';\nimport { CONSTANTS } from '../../../../../../environments/environment';\nimport { TokenBalancesService } from '../../../../../services/token-balances/token-balances.service';\nimport { SubjectService } from '../../../../../services/subject/subject.service';\nimport { WalletService } from '../../../../../services/wallet/wallet.service';\nimport { Subscription } from 'rxjs';\nimport { filter } from 'rxjs/operators';\nimport { Big } from 'big.js';\nimport { RemoveCommaPipe } from '../../../../../pipes/remove-comma.pipe';\nimport { ModalComponent } from '../../../../../components/modals/modal.component';\nimport { MessageService } from '../../../../../services/message/message.service';\n\n@Component({\n  selector: 'app-balances',\n  templateUrl: './balances.component.html',\n  styleUrls: ['../../../../../../scss/components/views/logged-in/account-view/cards/balances/balances.component.scss']\n})\nexport class BalancesComponent implements OnInit, AfterViewChecked, OnDestroy {\n  Object = Object;\n  @Input() account: Account;\n  contractAliases = CONSTANTS.CONTRACT_ALIASES;\n  totalBalances: string | number = 0;\n  balances: any[];\n  isFiat = false;\n\n  private subscriptions: Subscription = new Subscription();\n\n  constructor(\n    public tokenBalancesService: TokenBalancesService,\n    private subjectService: SubjectService,\n    private walletService: WalletService,\n    public removeCommaPipe: RemoveCommaPipe,\n    private messageService: MessageService\n  ) {\n    this.subscriptions.add(\n      this.subjectService.activeAccount.pipe(filter((account: Account) => account?.address !== this.account?.address)).subscribe((account) => {\n        this.account = account;\n        this.balances = this.tokenBalancesService?.balances;\n        this.calcTotalBalances();\n      })\n    );\n    this.subscriptions.add(\n      this.subjectService.nftsUpdated.subscribe((p) => {\n        this.balances = p?.balances ?? this.tokenBalancesService?.balances;\n        this.calcTotalBalances();\n      })\n    );\n    this.subscriptions.add(\n      this.subjectService.walletUpdated.subscribe(() => {\n        this.balances = this.tokenBalancesService?.balances;\n        this.calcTotalBalances();\n      })\n    );\n  }\n  e(wrap) {\n    if (!!wrap) {\n      if (wrap.scrollTop < 1 || this.tokenBalancesService?.balances?.length <= 5) {\n        document.querySelector('.scroll-wrapper .tez').classList.add('no-box');\n        document.querySelector('.total-balances').classList.add('no-box');\n      } else {\n        document.querySelector('.scroll-wrapper .tez').classList.remove('no-box');\n        document.querySelector('.total-balances').classList.remove('no-box');\n      }\n\n      if (this.tokenBalancesService?.balances?.length > 4) {\n        wrap.style.overflowY = 'auto';\n        wrap.style.width = 'calc(100% - 2.675rem)';\n        wrap.style.padding = '0 0 0 2rem';\n      } else {\n        wrap.style.overflowY = '';\n        wrap.style.width = '';\n        wrap.style.padding = '';\n      }\n    }\n  }\n  ngOnInit(): void {\n    this.balances = this.tokenBalancesService?.balances;\n    this.calcTotalBalances();\n  }\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n  ngAfterViewChecked(): void {\n    const wrap = document.querySelector('.scroll-wrapper .balances') as HTMLElement;\n    this.e(wrap);\n  }\n  trackToken(index: number, token: any): string | number {\n    return token?.contractAddress ? token.contractAddress + ':' + token?.id + ':' + token?.balance + ':' + token?.thumbnailAsset : index;\n  }\n\n  toggleTotalBalances(): void {\n    this.isFiat = !this.isFiat;\n    this.calcTotalBalances();\n  }\n  calcTotalBalances(): void {\n    this.totalBalances = this.isFiat\n      ? this.balances.reduce((prev, balance) => prev + parseFloat(balance?.price ?? 0), 0) + this.account?.balanceUSD\n      : this.balances.reduce((prev, balance) => prev + parseFloat(balance?.price ?? 0), 0) / this.walletService.wallet.XTZrate +\n        parseFloat(\n          Big(this.account?.balanceXTZ ?? 0)\n            .div(1000000)\n            .toFixed()\n        );\n  }\n  openSwap() {\n    this.messageService.startSpinner();\n    ModalComponent.currentModel.next({ name: 'swap-liquidity', data: null });\n  }\n}\n","<div *ngIf=\"isOpen\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-row top\">\n      <div class=\"flex-row button close\" (click)=\"close()\"><img class=\"x\"\n          src=\"../../../../../assets/img/close-btn-x.png\" />\n      </div>\n      <h1 class=\"title\">Token Info</h1>\n    </div>\n    <div class=\"flex-column token-info\">\n      <div class=\"flex-row-wrap data\">\n        <div class=\"flex-column wrapper\" [class]=\"imageExpanded ? 'expanded' : ''\">\n          <app-asset [style.display]=\"imageExpanded ? 'none' : ''\" class=\"flex-row button sd-only\"\n            [priorityList]=\"['displayAsset', 'thumbnailAsset']\"\n            [assets]=\"{thumbnailAsset: token?.thumbnailAsset, displayAsset: token?.displayAsset}\" [size]=\"'small'\"\n            (click)=\"expandImage()\" (loaded)=\"assetLoaded = true\"></app-asset>\n          <app-asset [style.display]=\"!imageExpanded ? 'none' : ''\" class=\"flex-row button sd-only\"\n            [priorityList]=\"['artifactAsset', 'displayAsset', 'thumbnailAsset']\"\n            [assets]=\"{thumbnailAsset: token?.thumbnailAsset, displayAsset: token?.displayAsset, artifactAsset: token?.artifactAsset}\"\n            [size]=\"'raw'\" [poster]=\"token?.displayAsset\" [controls]=\"true\"></app-asset>\n          <img *ngIf=\"imageExpanded\" class=\"flex-row button close\" (click)=\"expandImage()\"\n            src=\"../../../../../assets/img/close-btn-x.png\" />\n          <img *ngIf=\"!imageExpanded && assetLoaded && !token.displayAsset?.mimeType?.startsWith('model/')\"\n            class=\"expand\" src=\"../../../../../assets/img/expand.png\" (click)=\"expandImage()\" />\n          <b *ngIf=\"!imageExpanded && token.artifactAsset?.mimeType?.startsWith('model/')\" class=\"expand icon-threed\"\n            (click)=\"expandImage()\">3D</b>\n        </div>\n        <div class=\"flex-column meta\">\n          <div class=\"flex-column top\">\n            <div *ngIf=\"token?.name\" class=\"flex-column key-value\">\n              <div class=\"key\">\n                name\n              </div>\n              <div class=\"value\">\n                {{ token?.name }}\n              </div>\n            </div>\n            <div *ngIf=\"!isNFT && token?.symbol\" class=\"flex-column key-value\">\n              <div class=\"key\">\n                symbol\n              </div>\n              <div class=\"value\">\n                {{ token?.symbol }}\n              </div>\n            </div>\n            <div *ngIf=\"!isNFT && !!token?.decimals\" class=\"flex-column key-value\">\n              <div class=\"key\">\n                decimals\n              </div>\n              <div class=\"value\">\n                {{ token?.decimals }}\n              </div>\n            </div>\n            <div *ngIf=\"token?.description\" class=\"flex-column key-value desc\">\n              <div class=\"key\">\n                description\n              </div>\n              <div class=\"value\" style=\"white-space: pre-line\">\n                {{token?.description}}\n              </div>\n            </div>\n            <div *ngIf=\"token?.creator\" class=\"flex-column key-value\">\n              <div class=\"key\">\n                creator\n              </div>\n              <div class=\"value\">\n                {{ token?.creator }}\n              </div>\n            </div>\n          </div>\n        </div>\n        <app-asset [style.height]=\"isAudio ? '' : '0px'\" class=\"flex-row audio minimal-controls\" [requires]=\"['audio']\"\n          [assets]=\"token\" [priorityList]=\"['artifactAsset']\" [size]=\"'raw'\" [autoplay]=\"true\" [muted]=\"true\"\n          [hideSpinner]=\"true\" [controls]=\"true\" (load)=\"isAudio = true\"></app-asset>\n      </div>\n      <ng-container *ngFor=\"let type of Object.keys(CONSTANTS.FEATURE_CONTRACTS)\">\n        <ng-container *ngFor=\"let feat of Object.keys(CONSTANTS.FEATURE_CONTRACTS[type])\">\n          <app-ui-toggle-advanced\n            *ngIf=\"CONSTANTS.FEATURE_CONTRACTS[type][feat]?.includes(token?.contractAddress + ':' + token?.id)\"\n            [class]=\"'feat ' + feat\" style=\"width: 100%\" (stateChange)=\"toggleFeature(type, feat)\"\n            [text]=\"(feat + ' Mode').toUpperCase()\" [state]=\"theme === feat\" [default]=\"theme === feat\">\n          </app-ui-toggle-advanced>\n        </ng-container>\n      </ng-container>\n      <div *ngIf=\"!!token\" class=\"flex-row button more-info\" [class]=\"moreInfo ? 'open' : ''\" (click)=\"expand()\">\n        <span>{{ moreInfo ? 'LESS' : 'MORE' }} INFO</span><img src=\"../../../assets/img/chevron-down.svg\" />\n      </div>\n      <div *ngIf=\"!!token\" [style.maxHeight]=\"moreInfo ? (3.25 * Object.keys(tokenFiltered).length) + 'rem' : ''\"\n        [style.overflowY]=\"autoOverflow ? 'auto' : ''\" class=\"flex-column meta-more\">\n        <ng-container *ngFor=\"let key of Object.keys(tokenFiltered)\">\n          <div *ngIf=\"key === 'contractAddress'\" class=\"flex-column key-value\">\n            <div class=\"key\">\n              {{ 'CONTRACT (ID)' }}\n            </div>\n            <div class=\"value\">\n              {{ token[key] + ' ' + '(' + token['id'] + ')' }}\n            </div>\n          </div>\n          <div *ngIf=\"key !== 'contractAddress' && key !== 'description' && key !== 'id' && !!token[key]\"\n            class=\"flex-column key-value\">\n            <div class=\"key\">\n              {{key}}\n            </div>\n            <div class=\"value\">\n              {{ token[key] }}\n            </div>\n          </div>\n        </ng-container>\n      </div>\n      <div *ngIf=\"!token?.isUnknownToken\" class=\"flex-column bottom\">\n        <div class=\"seperator\"></div>\n        <app-send-button class=\"send\" [override]=\"true\" [activeAccount]=\"activeAccount\"\n          [tokenTransfer]=\"!token ? null : token['contractAddress']+':'+token['id']\"\n          [symbol]=\"!token ? 'tez' : token?.symbol\">\n        </app-send-button>\n      </div>\n    </div>\n  </div>\n</div>","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { ModalComponent } from '../../modal.component';\nimport { TokenBalancesService } from '../../../../services/token-balances/token-balances.service';\nimport { Subscription } from 'rxjs';\nimport { SubjectService } from '../../../../services/subject/subject.service';\nimport { CONSTANTS } from '../../../../../environments/environment';\nimport { UnlockableService } from '../../../../services/unlockable/unlockable.service';\n\n@Component({\n  selector: 'app-token-detail',\n  templateUrl: './token-detail.component.html',\n  styleUrls: ['../../../../../scss/components/modals/modal.scss']\n})\nexport class TokenDetail extends ModalComponent implements OnInit, OnDestroy {\n  Object = Object;\n  CONSTANTS = CONSTANTS;\n  token = null;\n  tokenFiltered = {};\n  activeAccount = null;\n  moreInfo = false;\n  imageExpanded = false;\n  autoOverflow = false;\n  descOverflow = false;\n  isNFT = false;\n  assetLoaded = false;\n  isAudio = false;\n  name = 'token-detail';\n  readonly blacklistMeta = [\n    'name',\n    'kind',\n    'artifactAsset',\n    'displayAsset',\n    'thumbnailAsset',\n    'rawUrl',\n    'isTransferable',\n    'isBooleanAmount',\n    'balance',\n    'category',\n    'symbol',\n    'decimals',\n    'status',\n    'shouldPreferSymbol',\n    'price',\n    'formats',\n    'isUnknownToken'\n  ];\n\n  theme = '';\n\n  private subscriptions: Subscription = new Subscription();\n  constructor(private subjectService: SubjectService, private tokenBalancesService: TokenBalancesService, private unlockableService: UnlockableService) {\n    super();\n  }\n\n  ngOnInit(): void {\n    this.subscriptions.add(\n      this.subjectService.activeAccount.subscribe((activeAccount) => {\n        this.activeAccount = activeAccount;\n      })\n    );\n    for (let type of Object.keys(CONSTANTS.FEATURE_CONTRACTS)) {\n      for (let feat of Object.keys(CONSTANTS.FEATURE_CONTRACTS[type])) {\n        if (document.documentElement.classList.contains(feat)) {\n          this.theme = feat;\n        }\n        return;\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n\n  open(data): void {\n    !!data\n      ? Object.keys(data)\n          .filter((key) => !this.blacklistMeta.includes(key))\n          .forEach((key) => (this.tokenFiltered[key] = data[key]))\n      : undefined;\n    this.token = data;\n    this.isNFT = this.tokenBalancesService.isNFT(this.token);\n    this.descOverflow = this.token?.description && this.token?.description.length > 250 ? true : false;\n    super.open();\n  }\n\n  close(): void {\n    this.reset();\n    super.close();\n  }\n\n  expand(): void {\n    this.moreInfo = !this.moreInfo;\n    if (!this.autoOverflow) {\n      setTimeout(() => {\n        this.autoOverflow = !this.autoOverflow;\n      }, 160);\n    } else {\n      this.autoOverflow = !this.autoOverflow;\n    }\n  }\n\n  expandImage(): void {\n    this.imageExpanded = !this.imageExpanded;\n  }\n\n  async toggleFeature(type, feat): Promise<void> {\n    this.theme = this.unlockableService.toggleFeature(type, feat) ? feat : '';\n  }\n\n  reset(): void {\n    this.moreInfo = false;\n    this.imageExpanded = false;\n    this.descOverflow = false;\n    this.assetLoaded = false;\n    this.isAudio = false;\n  }\n}\n","<div class=\"flex-column wrapper\" *ngIf=\"account\">\n  <div class=\"grid\">\n    <app-balances [account]=\"account\"></app-balances>\n    <app-nfts [account]=\"account\"></app-nfts>\n    <app-activity [account]=\"account\"></app-activity>\n  </div>\n</div>\n<app-token-detail></app-token-detail>","import { Component, Input, OnDestroy, OnInit } from '@angular/core';\nimport { Account, Activity, ImplicitAccount } from '../../../../services/wallet/wallet';\nimport { TimeAgoPipe } from '../../../../pipes/time-ago.pipe';\nimport { TranslateService } from '@ngx-translate/core';\nimport { MessageService } from '../../../../services/message/message.service';\nimport * as copy from 'copy-to-clipboard';\nimport { CONSTANTS } from '../../../../../environments/environment';\nimport { ActivityService } from '../../../../services/activity/activity.service';\nimport { TokenService } from '../../../../services/token/token.service';\nimport { Subscription } from 'rxjs';\nimport { SubjectService } from '../../../../services/subject/subject.service';\n\n@Component({\n  selector: 'app-account-view',\n  templateUrl: './account-view.component.html',\n  styleUrls: ['../../../../../scss/components/views/logged-in/account-view/account-view.component.scss']\n})\nexport class AccountViewComponent implements OnInit, OnDestroy {\n  account: Account;\n  private subscriptions: Subscription = new Subscription();\n  constructor(\n    public translate: TranslateService,\n    public messageService: MessageService,\n    public timeAgoPipe: TimeAgoPipe,\n    private activityService: ActivityService,\n    public tokenService: TokenService,\n    private subjectService: SubjectService\n  ) {}\n  trigger = true;\n  @Input() activity: any;\n  ngOnInit(): void {\n    this.subscriptions.add(\n      this.subjectService.activeAccount.subscribe((activeAccount) => {\n        this.account = activeAccount;\n      })\n    );\n    setInterval(() => (this.trigger = !this.trigger), 1000);\n  }\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n  getType(transaction: Activity): string {\n    if (transaction.type !== 'transaction') {\n      if (transaction.type === 'delegation') {\n        if (transaction.destination.address) {\n          return 'delegated';\n        } else {\n          return 'undelegated';\n        }\n      } else {\n        return transaction.type;\n      }\n    } else {\n      let operationType = '';\n      if (transaction.source.address === this.account.address) {\n        operationType = 'sent';\n      } else {\n        operationType = 'received';\n      }\n      return operationType;\n    }\n  }\n\n  getCounterparty(transaction: any): string {\n    return this.activityService.getCounterparty(transaction, this.account);\n  }\n  copy(account: Account): void {\n    copy(account.address);\n    const copyToClipboard = this.translate.instant('OVERVIEWCOMPONENT.COPIEDTOCLIPBOARD');\n    this.messageService.add(account.address + ' ' + copyToClipboard, 5);\n  }\n  explorerURL(hash: string): string {\n    const baseURL = CONSTANTS.BLOCK_EXPLORER_URL;\n    return `${baseURL}/${hash}`;\n  }\n  printAmount(activity: Activity): string {\n    return this.tokenService.formatAmount(activity.tokenId, activity.amount.toString());\n  }\n  sentKind(activity): string {\n    if (activity.entrypoint) {\n      return `Called ${activity.entrypoint}`;\n    }\n    return 'Sent';\n  }\n  zeroSent(activity): boolean {\n    return this.sentKind(activity).length > 4 && activity.amount === '0';\n  }\n  receivedKind(activity): string {\n    return activity.tokenId && activity.source.address && activity.tokenId.split(':')[0] === activity.source.address ? 'Minted' : 'Received';\n  }\n  displayTokenCard(): boolean {\n    return this.account instanceof ImplicitAccount || this.account?.tokens?.length > 0;\n  }\n}\n","<div class=\"flex-column settings\">\n  <a><button class=\"flex-row back\" [routerLink]=\"'/account/' + activeAccount?.address\"><img src=\"../../../../../assets/img/left-arrow.svg\">BACK</button></a>\n  <h3>Connect with dApps</h3>\n  <div class=\"seperator\"></div>\n  <div class=\"flex-column handler\">\n    <div>\n      <h4>Connect to dApps on <u>another device</u> by scanning a QR code.</h4>\n    </div>\n    <div class=\"scan-button\">\n      <app-qr-scanner></app-qr-scanner>\n    </div>\n  </div>\n  <h3>Peers</h3>\n  <div class=\"seperator\"></div>\n  <table *ngIf=\"beaconService.peers.length\">\n    <thead>\n      <tr>\n        <th>Name</th>\n        <th>Relay server</th>\n        <th><span (click)=\"beaconService.removePeers()\">Remove&nbsp;all</span></th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr *ngFor=\"let peer of beaconService.peers; index as i\">\n        <td>{{ peer.name }}</td>\n        <td>{{ peer.relayServer }}</td>\n        <td (click)=\"beaconService.removePeer(i)\"><img (click)=\"beaconService.removePeer(i)\" src=\"../../../assets/img/cross.svg\"></td>\n      </tr>\n    </tbody>\n  </table>\n  <h3>Permissions</h3>\n  <div class=\"seperator\"></div>\n  <table *ngIf=\"beaconService.permissions.length\">\n    <thead>\n      <tr>\n        <th>Name</th>\n        <th>Address</th>\n        <th><span (click)=\"beaconService.removePermissions()\">Remove&nbsp;all</span></th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr *ngFor=\"let permission of beaconService.permissions; index as i\"\n        [class.inactive]=\"!accountAvailable(permission.address)\">\n        <td>{{ permission.appMetadata.name }}</td>\n        <td>{{ formatAddress(permission.address) }}</td>\n        <td><img (click)=\"beaconService.removePermission(i)\" src=\"../../../assets/img/cross.svg\"></td>\n      </tr>\n    </tbody>\n  </table>\n  <h3>Tokens</h3>\n  <div class=\"seperator\"></div>\n  <button class=\"rescan\" (click)=\"rescan()\">Rescan unknown tokens</button>\n  <button id=\"all\" class=\"rescan\" (click)=\"rescanAll()\">Clear all token metadata</button>\n  <button *ngIf=\"canRevealMnomonic()\" class=\"reveal-mnemonic\" (click)=\"revealMnemonic()\">Reveal Seed Words</button>\n</div>","import { Component, OnInit, HostListener, OnDestroy } from '@angular/core';\nimport { BeaconService } from '../../../../services/beacon/beacon.service';\nimport { WalletService } from '../../../../services/wallet/wallet.service';\nimport { Router } from '@angular/router';\nimport { TokenService } from '../../../../services/token/token.service';\nimport { MessageService } from '../../../../services/message/message.service';\nimport { Subscription } from 'rxjs';\nimport { CoordinatorService } from '../../../../services/coordinator/coordinator.service';\nimport { SubjectService } from '../../../../services/subject/subject.service';\nimport { ModalComponent } from '../../../../components/modals/modal.component';\nimport { HdWallet, LegacyWalletV3 } from '../../../../services/wallet/wallet';\n\n@Component({\n  selector: 'app-settings',\n  templateUrl: './settings.component.html',\n  styleUrls: ['../../../../../scss/components/views/logged-in/settings/settings.component.scss']\n})\nexport class SettingsComponent implements OnInit, OnDestroy {\n  implicitAccounts = [];\n  wideAccounts = false;\n  activeAccount = null;\n  private subscriptions: Subscription = new Subscription();\n  constructor(\n    public beaconService: BeaconService,\n    private messageService: MessageService,\n    private walletService: WalletService,\n    private router: Router,\n    private tokenService: TokenService,\n    private coordinatorService: CoordinatorService,\n    private subjectService: SubjectService\n  ) {}\n\n  ngOnInit(): void {\n    if (this.walletService.wallet) {\n      this.implicitAccounts = this.walletService.wallet.getImplicitAccounts();\n      this.beaconService.syncBeaconState();\n      this.onResize();\n    }\n\n    this.subscriptions.add(\n      this.subjectService.activeAccount.subscribe((activeAccount) => {\n        this.activeAccount = activeAccount;\n      })\n    );\n  }\n  ngOnDestroy(): void {}\n  accountAvailable(pkh: string): boolean {\n    const index = this.implicitAccounts.findIndex((impAcc: any) => impAcc.pkh === pkh);\n    if (index === -1) {\n      return false;\n    }\n    return true;\n  }\n  @HostListener('window:resize')\n  onResize(): void {\n    this.wideAccounts = window.innerWidth > 600;\n  }\n  formatAddress(address: string): string {\n    if (this.wideAccounts) {\n      return address;\n    } else {\n      return address.slice(0, 6) + '...' + address.slice(-4);\n    }\n  }\n  rescan(): void {\n    this.tokenService.resetCounters();\n    this.messageService.add('Scanning for token metadata...');\n    this.coordinatorService.update(this.activeAccount.address);\n    this.router.navigate([`/account/${this.activeAccount.address}`]);\n  }\n  rescanAll(): void {\n    this.tokenService.resetAllMetadata();\n    this.messageService.add('Rescanning all token metadata...');\n    this.coordinatorService.update(this.activeAccount.address);\n    this.router.navigate([`/account/${this.activeAccount.address}`]);\n  }\n  revealMnemonic(): void {\n    ModalComponent.currentModel.next({ name: 'export-mnemonic', data: null });\n  }\n  canRevealMnomonic(): boolean {\n    return this.walletService.wallet && (this.walletService.wallet instanceof HdWallet || this.walletService.wallet instanceof LegacyWalletV3);\n  }\n}\n","<div class=\"flex-column delegate-page\">\n  <div class=\"content\">\n    <div class=\"flex-column manual\">\n      <div class=\"flex-column delegate\">\n        <a [routerLink]=\"'/account/' + activeAccount?.address\"><button class=\"flex-row back\"><img\n              src=\"../../../../../assets/img/left-arrow.svg\">BACK</button></a>\n        <h1>Staking</h1>\n        <div class=\"flex-row toolbar\"><span class=\"button blue\" (click)=\"toggleCustom()\">Enter Custom Baker</span><span\n            *ngIf=\"!delegates?.length\" class=\"button blue\" (click)=\"this.delegateService.getDelegates()\">Reload</span>\n        </div>\n        <ng-container *ngIf=\"isShowingCustom\">\n          <span>Address or domain of a registered baker</span>\n          <div class=\"custom\">\n            <input [(ngModel)]=\"customAddress\" placeholder=\"Custom baker address\" /><button class=\"button\" (click)=\"stake({address: customAddress})\">STAKE</button>\n          </div>\n        </ng-container>\n      </div>\n    </div>\n    <div class=\"flex-column list\">\n      <ng-container *ngFor=\"let delegate of delegates\">\n        <div class=\"flex-row delegate desktop\">\n          <img class=\"logo\" [src]=\"delegate.logo ? delegate.logo : ''\" />\n          <span class=\"name\">{{ delegate.name }}</span>\n          <span class=\"fee\">SPLIT:&nbsp;<b class=\"value\">{{ toPercent(delegate?.fee) }}</b></span>\n          <span class=\"freespace\">SPACE:&nbsp;<b class=\"value\">{{ round(delegate?.freeSpace) + ' tez' }}</b></span>\n          <span class=\"estROI\">EST REWARDS:&nbsp;<b class=\"value\">{{ toPercent(delegate?.estimatedRoi) }}</b></span>\n          <span class=\"accuracy\">ACCURACY:&nbsp;<b class=\"value\">{{ delegate?.payoutAccuracy }}</b></span>\n          <button *ngIf=\"delegate?.address !== activeAccount?.delegate\" class=\"button\" (click)=\"stake(delegate)\">STAKE</button>\n          <span class=\"current\" *ngIf=\"delegate?.address === activeAccount?.delegate\">CURRENT</span>\n        </div>\n        <div class=\"flex-row delegate mobile\">\n          <div class=\"flex-column props\">\n            <img class=\"logo\" [src]=\"delegate.logo ? delegate.logo : ''\" />\n            <span class=\"name\">{{ delegate.name }}</span>\n            <span class=\"fee\">SPLIT:&nbsp;<b class=\"value\">{{ toPercent(delegate?.fee) }}</b></span>\n            <span class=\"freespace\">SPACE:&nbsp;<b class=\"value\">{{ round(delegate?.freeSpace) + ' tez' }}</b></span>\n            <span class=\"estROI\">EST REWARDS:&nbsp;<b class=\"value\">{{ toPercent(delegate?.estimatedRoi) }}</b></span>\n          </div>\n          <button *ngIf=\"delegate?.address !== activeAccount?.delegate\" class=\"button\" (click)=\"stake(delegate)\">STAKE</button>\n          <span class=\"current\" *ngIf=\"delegate?.address === activeAccount?.delegate\">CURRENT</span>\n        </div>\n      </ng-container>\n    </div>\n  </div>\n</div>","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { AccountViewComponent } from './account-view/account-view.component';\nimport { SettingsComponent } from './settings/settings.component';\nimport { DelegatePageComponent } from './delegate-page/delegate-page.component';\nimport { ActivateComponent } from '../start/activate/activate.component';\n\nconst routes: Routes = [\n  { path: ':address', component: AccountViewComponent },\n  { path: ':address/settings', component: SettingsComponent },\n  { path: ':address/stakers', component: DelegatePageComponent },\n  { path: 'activate', component: ActivateComponent }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class LoggedInRoutingModule {}\n","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { WalletService } from '../../../../services/wallet/wallet.service';\nimport { DelegateService } from '../../../../services/delegate/delegate.service';\nimport { ModalComponent } from '../../../modals/modal.component';\nimport { InputValidationService } from '../../../../services/input-validation/input-validation.service';\nimport { MessageService } from '../../../../services/message/message.service';\nimport { Subscription } from 'rxjs';\nimport { take } from 'rxjs/operators';\nimport { SubjectService } from '../../../../services/subject/subject.service';\n\n@Component({\n  selector: 'app-delegate-page',\n  templateUrl: './delegate-page.component.html',\n  styleUrls: ['../../../../../scss/components/views/logged-in/delegate/delegate.component.scss']\n})\nexport class DelegatePageComponent implements OnInit, OnDestroy {\n  delegates;\n  activeAccount = null;\n  customAddress: string = '';\n  isShowingCustom = false;\n  private subscriptions: Subscription = new Subscription();\n\n  constructor(\n    public delegateService: DelegateService,\n    public router: Router,\n    public walletService: WalletService,\n    public inputValidationService: InputValidationService,\n    private messageServcie: MessageService,\n    private subjectService: SubjectService\n  ) {\n    this.subscriptions.add(\n      this.subjectService.activeAccount.subscribe((activeAccount) => {\n        if (this.activeAccount !== activeAccount) {\n          this.activeAccount = activeAccount;\n          this.subscriptions.add(\n            this.delegateService.delegates.pipe(take(1)).subscribe((d) => {\n              this.delegates = this.filter(d).sort((x, y) => (x.address === this.activeAccount?.delegate ? -1 : y === this.activeAccount?.delegate ? 1 : 0));\n            })\n          );\n        }\n      })\n    );\n\n    this.subscriptions.add(\n      this.delegateService.delegates.subscribe((d) => {\n        this.delegates = this.filter(d).sort((x, y) => (x.address === this.activeAccount?.delegate ? -1 : y === this.activeAccount?.delegate ? 1 : 0));\n      })\n    );\n  }\n\n  ngOnInit(): void {}\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n\n  filter(delegates: any): any[] | null {\n    if (delegates?.length) {\n      const balanceXTZ = this.activeAccount ? Math.ceil(this.activeAccount.balanceXTZ / 1000000) : 0;\n      return delegates\n        .map((d) => {\n          try {\n            if (d.freeSpace > balanceXTZ && d.estimatedRoi > 0 && d.openForDelegation === true && d.minDelegation < balanceXTZ) {\n              return d;\n            }\n          } catch {\n            return null;\n          }\n          return null;\n        })\n        .filter((obj) => obj);\n    }\n    return [];\n  }\n  stake(delegate: any): void {\n    if (delegate.address === '' || this.inputValidationService.address(delegate.address)) {\n      ModalComponent.currentModel.next({\n        name: 'delegate-confirm',\n        data: delegate\n      });\n    } else {\n      this.messageServcie.addError(`Invalid baker address: ${delegate?.address}`);\n    }\n  }\n\n  round(val): string {\n    return Math.round(Number(val)).toString();\n  }\n\n  toPercent(val): string {\n    return parseFloat((Number(val) * 100).toFixed(2)).toString() + '%';\n  }\n\n  toggleCustom(): void {\n    this.isShowingCustom = this.isShowingCustom ? false : true;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { EstimateService } from '../../../services/estimate/estimate.service';\nimport { SendComponent } from '../../misc/send/send.component';\nimport { ReceiveComponent } from '../../modals/receive/receive.component';\nimport { DelegateComponent } from '../../modals/delegate/delegate.component';\nimport { DelegatePageComponent } from './delegate-page/delegate-page.component';\nimport { ActivateComponent } from '../start/activate/activate.component';\nimport { NewImplicitComponent } from '../../modals/new-implicit/new-implicit.component';\nimport { UriHandlerComponent } from '../../misc/uri-handler/uri-handler.component';\nimport { PermissionRequestComponent } from '../../modals/permission-request/permission-request.component';\nimport { PermissionRequestDropdownComponent } from '../../ui/dropdown/permission-request/permission-request.component';\nimport { SettingsComponent } from './settings/settings.component';\nimport { QrScannerComponent } from '../../modals/qr-scanner/qr-scanner.component';\nimport { SignExprComponent } from '../../modals/sign-expr/sign-expr.component';\nimport { ConfirmSendComponent } from '../../modals/send/confirm/send-confirmation.component';\nimport { PrepareSendComponent } from '../../modals/send/prepare/prepare-send.component';\nimport { OriginateComponent } from '../../modals/originate/originate.component';\nimport { LoggedInComponent } from './logged-in.component';\nimport { LoggedInRoutingModule } from './logged-in-routing.module';\nimport { ConfirmSendEmbedComponent } from '../embedded/confirm-send/confirm-send.component';\nimport { SignExprEmbedComponent } from '../embedded/sign-expr/sign-expr.component';\nimport { AdvancedToggleComponent } from '../../ui/button/toggle/advanced/advanced.component';\nimport { PrepareSendDropdownComponent } from '../../ui/dropdown/prepare-send/prepare-send-dropdown.component';\nimport { AssetComponent } from '../../ui/asset/asset.component';\nimport { NftsBodyComponent } from './account-view/nfts/body/body.component';\nimport { NftsTokenComponent } from './account-view/nfts/token/token.component';\nimport { AccountListComponent } from '../../modals/account-list/list.component';\nimport { AccountListBodyComponent } from '../../modals/account-list/body/body.component';\nimport { ListComponent } from '../../ui/generic/list.component';\nimport { SearchBarComponent } from '../../ui/search/search.component';\nimport { RemoveCommaPipe } from '../../../pipes/remove-comma.pipe';\nimport { ExprTemplateComponent } from '../embedded/sign-expr/template/template.component';\nimport { QueueEmbedComponent } from '../embedded/queue/queue.component';\nimport { MoonpayComponent } from './account-view/moonpay/moonpay.component';\nimport { SwapLiquidityComponent } from '../../modals/swap-liquidity/swap-liquidity.component';\nimport { SwapLiquidityService } from '../../../services/swap-liquidity/swap-liquidity.service';\nimport { InfoComponent } from '../../modals/info/info.component';\nimport { ExportMnemonicComponent } from '../../modals/export-mnemonic/export-mnemonic.component';\nimport { SwapLiquidityConfirmComponent } from '../../modals/swap-liquidity/swap-liquidity-confirm.component';\nimport { ChartComponent } from '../../ui/chart/chart.component';\nimport { ChartService } from '../../../../app/services/chart/chart.service';\n\n@NgModule({\n  declarations: [\n    SendComponent,\n    ReceiveComponent,\n    DelegatePageComponent,\n    SwapLiquidityComponent,\n    ActivateComponent,\n    LoggedInComponent,\n    NewImplicitComponent,\n    UriHandlerComponent,\n    PermissionRequestComponent,\n    PermissionRequestDropdownComponent,\n    SettingsComponent,\n    QrScannerComponent,\n    SignExprComponent,\n    OriginateComponent,\n    ConfirmSendComponent,\n    PrepareSendComponent,\n    DelegateComponent,\n    AdvancedToggleComponent,\n    ConfirmSendEmbedComponent,\n    SignExprEmbedComponent,\n    QueueEmbedComponent,\n    PrepareSendDropdownComponent,\n    AssetComponent,\n    NftsBodyComponent,\n    NftsTokenComponent,\n    AccountListComponent,\n    AccountListBodyComponent,\n    ListComponent,\n    SearchBarComponent,\n    RemoveCommaPipe,\n    ExprTemplateComponent,\n    MoonpayComponent,\n    SwapLiquidityConfirmComponent,\n    InfoComponent,\n    RemoveCommaPipe,\n    ExportMnemonicComponent,\n    ChartComponent\n  ],\n  imports: [CommonModule, LoggedInRoutingModule, HttpClientModule, FormsModule],\n  exports: [\n    AdvancedToggleComponent,\n    SendComponent,\n    ConfirmSendEmbedComponent,\n    SignExprEmbedComponent,\n    QueueEmbedComponent,\n    AssetComponent,\n    NftsBodyComponent,\n    NftsTokenComponent,\n    PermissionRequestComponent,\n    PermissionRequestDropdownComponent,\n    ListComponent,\n    AccountListComponent,\n    AccountListBodyComponent,\n    SearchBarComponent,\n    RemoveCommaPipe,\n    ExprTemplateComponent,\n    InfoComponent,\n    ChartComponent\n  ],\n  providers: [SwapLiquidityService, ChartService, EstimateService, RemoveCommaPipe]\n})\nexport class LoggedInModule {}\n","<form autocomplete=\"off\">\n  <div class=\"flex-column card\">\n    <a routerLink=\"/import/\" [state]=\"{ option: 2 }\"><button class=\"flex-row back\"><img\n          src=\"../../../../../assets/img/left-arrow.svg\">BACK</button></a>\n    <div class=\"flex-column body\">\n      <h1>\n        Activate a Fundraiser wallet\n      </h1>\n      <p class=\"description\">Wallets created during the fundraiser need to be activated. No private key is required for\n        the activation process.</p>\n      <span class=\"description\">Your public key hash</span>\n      <input name=\"none\" type=\"text\" class=\"text\" [(ngModel)]=\"pkh\" [placeholder]=\"'tz1...'\">\n      <span class=\"description\">Your activation code</span>\n      <input name=\"none\" type=\"text\" class=\"text\" [(ngModel)]=\"secret\" [placeholder]=\"'Code'\">\n      <button class=\"button next\" (click)=\"activate()\">Activate</button>\n      <span *ngIf=\"formInvalid\" class=\"description red\">\n        {{ formInvalid }}\n      </span>\n    </div>\n  </div>\n</form>","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { MessageService } from '../../../../services/message/message.service';\nimport { OperationService } from '../../../../services/operation/operation.service';\nimport { InputValidationService } from '../../../../services/input-validation/input-validation.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'app-activate',\n  templateUrl: './activate.component.html',\n  styleUrls: ['../../../../../scss/components/views/start/login.component.scss']\n})\nexport class ActivateComponent implements OnInit, OnDestroy {\n  pkh: string;\n  secret: string;\n  formInvalid = '';\n  private subscriptions: Subscription = new Subscription();\n  constructor(\n    private messageService: MessageService,\n    private operationService: OperationService,\n    private inputValidationService: InputValidationService,\n    private translate: TranslateService\n  ) {}\n\n  ngOnInit(): void {}\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n  activate(): void {\n    this.formInvalid = this.checkInput();\n    if (!this.formInvalid) {\n      const pkh = this.pkh;\n      const secret = this.secret;\n      this.pkh = '';\n      this.secret = '';\n      this.subscriptions.add(\n        this.operationService.activate(pkh, secret).subscribe(\n          (ans: any) => {\n            if (ans.success) {\n              if (ans.payload.opHash) {\n                this.subscriptions.add(\n                  this.translate.get('ACTIVATECOMPONENT.ACTIVATESUCCESS').subscribe(\n                    (res: string) => this.messageService.addSuccess(res) // 'Activation successfully broadcasted to the blockchain!'\n                  )\n                );\n              } else {\n                this.subscriptions.add(\n                  this.translate.get('ACTIVATECOMPONENT.RETRIEVEFAIL').subscribe(\n                    (res: string) => this.messageService.addWarning(res) // Could not retrieve an operation hash\n                  )\n                );\n              }\n            } else {\n              let errorMessage = '';\n              if (typeof ans.payload.msg === 'string') {\n                errorMessage = 'NodeError ' + ans.payload.msg;\n              } else {\n                errorMessage = 'NodeError ' + JSON.stringify(ans.payload.msg);\n              }\n              this.messageService.addError(errorMessage);\n              console.log(JSON.stringify(ans.payload.msg));\n            }\n          },\n          (err) => {\n            this.subscriptions.add(\n              this.translate.get('ACTIVATECOMPONENT.ACTIVATEFAIL').subscribe(\n                (res: string) => {\n                  let errorMessage = '';\n                  const activateFailed = res;\n                  if (typeof err.payload.msg === 'string') {\n                    errorMessage = activateFailed + ' ' + err.payload.msg;\n                  } else {\n                    errorMessage = activateFailed;\n                  }\n                  this.messageService.addError(errorMessage);\n                } // 'Failed to activate wallet!'\n              )\n            );\n            console.log(JSON.stringify(err));\n          }\n        )\n      );\n    }\n  }\n  checkInput(): string {\n    if (!this.inputValidationService.address(this.pkh)) {\n      return 'Invalid public key hash!';\n    } else if (!this.inputValidationService.code(this.secret)) {\n      return 'Invalid activation code!';\n    }\n    return '';\n  }\n}\n","import { Activity, Account as WalletAccount } from './services/wallet/wallet';\nimport { Asset, ContractType } from './services/token/token.service';\n\nexport { Activity };\n\nexport interface KeyPair {\n  sk: string | null;\n  pk: string | null;\n  pkh: string;\n}\nexport interface Wallet {\n  seed: null | string;\n  salt: null | string;\n  pk?: string;\n  encryptionVersion: number | null;\n  type: WalletType;\n  balance: Balance;\n  XTZrate: number | null;\n  accounts: Account[];\n  derivationPath?: string;\n}\nexport interface Account {\n  pkh: string | null;\n  delegate: string;\n  balance: Balance;\n  numberOfActivites: number;\n  activities: Activity[];\n}\nexport interface Balance {\n  balanceXTZ: number | null;\n  pendingXTZ: number | null;\n  balanceFiat: number | null;\n  pendingFiat: number | null;\n}\nexport enum WalletType {\n  LegacyWallet,\n  ViewOnlyWallet,\n  ObserverWallet,\n  LedgerWallet,\n  HdWallet\n}\nexport interface Baker {\n  baker_name: string;\n  image: string;\n  rolls: number;\n  identity: string;\n  vote: string;\n  vote2: string;\n  // vote: []\n}\nexport interface Vote {\n  voting_period: string;\n  period_kind: PeriodKind;\n  proposal_hash: string[];\n  proposal_alias: string[];\n  votes: number[];\n  operation: string[];\n}\nexport interface Period {\n  amendment: string;\n  period: number;\n  period_kind: string;\n  proposal_hash: string[];\n  proposal_alias: string[];\n  start_level: number;\n  end_level: number;\n  level: number;\n  progress: number;\n  remaining: number;\n}\nexport interface ParticipationPerPeriod {\n  proposal?: [\n    {\n      hash: string;\n      alias: string;\n      count: number;\n      votes: number;\n    }\n  ];\n  unused_count: number;\n  total_count: number;\n  unused_votes: number;\n  total_votes: number;\n}\nexport interface Ballot {\n  proposal: string;\n  nb_yay: number;\n  nb_nay: number;\n  nb_pass: number;\n  vote_yay: number;\n  vote_nay: number;\n  vote_pass: number;\n}\nexport enum PeriodKind {\n  Proposal,\n  Exploration,\n  Testing,\n  Promotion\n}\nexport interface DefaultTransactionParams {\n  gas: number;\n  storage: number;\n  fee: number;\n  burn: number;\n  reveal?: boolean;\n  customLimits?: {\n    gasLimit: number;\n    storageLimit: number;\n  }[];\n}\n\nexport enum DisplayLinkOption {\n  All,\n  DirectAuth,\n  None\n}\n\nexport interface OpLimits {\n  gas?: number;\n  storage?: number;\n}\n\nexport interface ExternalRequest {\n  operationRequest: any;\n  selectedAccount: WalletAccount;\n}\nexport interface Constants {\n  NAME: string;\n  TEZOS_DOMAIN: {\n    CONTRACT: string;\n    TOP_DOMAINS: string[];\n  };\n  NETWORK: string;\n  MAINNET: boolean;\n  NODE_URL: string;\n  BLOCK_EXPLORER_URL: string;\n  HARD_LIMITS: {\n    hard_gas_limit_per_operation: number;\n    hard_gas_limit_per_block: number;\n    hard_storage_limit_per_operation: number;\n  };\n  ASSETS: Record<string, ContractType>;\n  CONTRACT_OVERRIDES: Record<string, OpLimits>;\n  CONTRACT_ALIASES: Record<\n    string,\n    {\n      name?: string;\n      address: string[];\n      thumbnailUrl: Asset;\n      discoverUrl?: string;\n      zoomDiscoverImg?: boolean;\n      link: string;\n      shouldDisplayLink: DisplayLinkOption;\n      category?: string[];\n      backgroundColor?: string;\n      description?: string;\n    }\n  >;\n  NFT_CONTRACT_OVERRIDES: string[];\n  FEATURE_CONTRACTS: {};\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n/*\n    Informs users on most common errors\n    RPC errors doc: http://tezos.gitlab.io/mainnet/api/errors.html\n*/\n\n@Pipe({\n  name: 'errorHandling'\n})\nexport class ErrorHandlingPipe implements PipeTransform {\n  ERROR_LIST = [\n    {\n      msg: 'A fatal assertion failed',\n      id: 'proto.alpha.assertion'\n    },\n    {\n      msg: \"The block's proof-of-work stamp is insufficient\",\n      id: 'proto.alpha.baking.insufficient_proof_of_work'\n    },\n    {\n      msg: 'A block was not signed with the expected private key.',\n      id: 'proto.alpha.baking.invalid_block_signature'\n    },\n    {\n      msg: 'The gap of fitness is out of bounds',\n      id: 'proto.alpha.baking.invalid_fitness_gap'\n    },\n    {\n      msg: \"The block's signature is invalid\",\n      id: 'proto.alpha.baking.invalid_signature'\n    },\n    {\n      msg: 'The block timestamp is before the first slot for this baker at this level',\n      id: 'proto.alpha.baking.timestamp_too_early'\n    },\n    {\n      msg: 'The operation is signed by a delegate without endorsement rights.',\n      id: 'proto.alpha.baking.unexpected_endorsement'\n    },\n    {\n      msg: 'A double-baking evidence is inconsistent (two distinct delegates)',\n      id: 'proto.alpha.block.inconsistent_double_baking_evidence'\n    },\n    {\n      msg: 'A double-endorsement evidence is inconsistent (two distinct delegates)',\n      id: 'proto.alpha.block.inconsistent_double_endorsement_evidence'\n    },\n    {\n      msg: 'The block header has invalid commitment.',\n      id: 'proto.alpha.block.invalid_commitment'\n    },\n    {\n      msg: 'A double-baking evidence is inconsistent (two distinct level)',\n      id: 'proto.alpha.block.invalid_double_baking_evidence'\n    },\n    {\n      msg: 'A double-endorsement evidence is malformed',\n      id: 'proto.alpha.block.invalid_double_endorsement_evidence'\n    },\n    {\n      msg: 'A manager operation should not contain more than one revelation',\n      id: 'proto.alpha.block.multiple_revelation'\n    },\n    {\n      msg: 'A double-baking evidence is outdated.',\n      id: 'proto.alpha.block.outdated_double_baking_evidence'\n    },\n    {\n      msg: 'A double-endorsement evidence is outdated.',\n      id: 'proto.alpha.block.outdated_double_endorsement_evidence'\n    },\n    {\n      msg: 'A double-baking evidence is in the future',\n      id: 'proto.alpha.block.too_early_double_baking_evidence'\n    },\n    {\n      msg: 'A double-endorsement evidence is in the future',\n      id: 'proto.alpha.block.too_early_double_endorsement_evidence'\n    },\n    {\n      msg: 'A double-baking evidence is unrequired',\n      id: 'proto.alpha.block.unrequired_double_baking_evidence'\n    },\n    {\n      msg: 'A double-endorsement evidence is unrequired',\n      id: 'proto.alpha.block.unrequired_double_endorsement_evidence'\n    },\n    {\n      msg: 'Unexpected JSON object.',\n      id: 'proto.alpha.context.failed_to_decode_parameter'\n    },\n    {\n      msg: 'The protocol parameters are not valid JSON.',\n      id: 'proto.alpha.context.failed_to_parse_parameter'\n    },\n    {\n      msg: 'An error that should never happen unless something has been deleted or corrupted in the database.',\n      id: 'proto.alpha.context.storage_error'\n    },\n    {\n      msg: 'An operation tried to spend more tokens than the contract has',\n      id: 'proto.alpha.contract.balance_too_low'\n    },\n    {\n      msg: 'The storage fee is higher than the contract balance',\n      id: 'proto.alpha.contract.cannot_pay_storage_fee'\n    },\n    {\n      msg: 'An operation assumed a contract counter in the future',\n      id: 'proto.alpha.contract.counter_in_the_future'\n    },\n    {\n      msg: 'An operation assumed a contract counter in the past',\n      id: 'proto.alpha.contract.counter_in_the_past'\n    },\n    {\n      msg: 'Forbidden to credit 0 to a contract without code.',\n      id: 'proto.alpha.contract.empty_transaction'\n    },\n    {\n      msg: 'Unexpected contract storage error',\n      id: 'proto.alpha.contract.failure'\n    },\n    {\n      msg: 'A malformed contract notation was given to an RPC or in a script.',\n      id: 'proto.alpha.contract.invalid_contract_notation'\n    },\n    {\n      msg: 'Change is not enough to consume a roll.',\n      id: 'proto.alpha.contract.manager.consume_roll_change'\n    },\n    {\n      msg: 'A revealed manager public key is inconsistent with the announced hash',\n      id: 'proto.alpha.contract.manager.inconsistent_hash'\n    },\n    {\n      msg: 'A provided manager public key is different with the public key stored in the contract',\n      id: 'proto.alpha.contract.manager.inconsistent_public_key'\n    },\n    {\n      msg: 'Delegate has no roll.',\n      id: 'proto.alpha.contract.manager.no_roll_for_delegate'\n    },\n    {\n      msg: 'A snapshot of the rolls distribution does not exist for this cycle.',\n      id: 'proto.alpha.contract.manager.no_roll_snapshot_for_cycle'\n    },\n    {\n      msg: 'A contract cannot be delegated to an unregistered delegate',\n      id: 'proto.alpha.contract.manager.unregistered_delegate'\n    },\n    {\n      msg: 'A contract handle is not present in the context (either it never was or it has been destroyed)',\n      id: 'proto.alpha.contract.non_existing_contract'\n    },\n    {\n      msg: 'One tried to revealed twice a manager public key',\n      id: 'proto.alpha.contract.previously_revealed_key'\n    },\n    {\n      msg: 'One tried to apply a manager operation without revealing the manager public key',\n      id: 'proto.alpha.contract.unrevealed_key'\n    },\n    {\n      msg: 'An operation tried to spend tokens from an unspendable contract',\n      id: 'proto.alpha.contract.unspendable_contract'\n    },\n    {\n      msg: 'Useless delegate reactivation',\n      id: 'proto.alpha.delegate.already_active'\n    },\n    {\n      msg: 'Cannot freeze deposit when the balance is too low',\n      id: 'proto.alpha.delegate.balance_too_low_for_deposit'\n    },\n    {\n      msg: 'Cannot register a delegate when its implicit account is empty',\n      id: 'proto.alpha.delegate.empty_delegate_account'\n    },\n    {\n      msg: 'Tried to unregister a delegate',\n      id: 'proto.alpha.delegate.no_deletion'\n    },\n    {\n      msg: 'Contract already delegated to the given delegate',\n      id: 'proto.alpha.delegate.unchanged'\n    },\n    {\n      msg: 'Proposal lists cannot be empty.',\n      id: 'proto.alpha.empty_proposal'\n    },\n    {\n      msg: 'The sum of gas consumed by all the operations in the block exceeds the hard gas limit per block',\n      id: 'proto.alpha.gas_exhausted.block'\n    },\n    {\n      msg: 'Gas limit was not high enough to deserialize the transaction parameters or origination script code or initial storage, making the operation impossible to parse within the provided gas bounds.',\n      id: 'proto.alpha.gas_exhausted.init_deserialize'\n    },\n    {\n      msg: 'An operation tried to exceed the gas limit',\n      id: 'proto.alpha.gas_exhausted.operation'\n    },\n    {\n      msg: 'A transaction tried to exceed the hard limit on gas',\n      id: 'proto.alpha.gas_limit_too_high'\n    },\n    {\n      msg: 'No manager operations are allowed on an empty account. Make sure you have enough balance.',\n      id: 'proto.alpha.implicit.empty_implicit_contract'\n    },\n    {\n      msg: 'Emptying an implicit delegated account is not allowed.',\n      id: 'proto.alpha.implicit.empty_implicit_delegated_contract'\n    },\n    {\n      msg: 'The number of endorsements must be non-negative and at most the endosers_per_block constant.',\n      id: 'proto.alpha.incorrect_number_of_endorsements'\n    },\n    {\n      msg: 'Block priority must be non-negative.',\n      id: 'proto.alpha.incorrect_priority'\n    },\n    {\n      msg: 'An internal operation was emitted twice by a script',\n      id: 'proto.alpha.internal_operation_replay'\n    },\n    {\n      msg: 'A compile-time constant was invalid for its expected form.',\n      id: 'proto.alpha.invalidSyntacticConstantError'\n    },\n    {\n      msg: 'Negative multiple of periods are not allowed.',\n      id: 'proto.alpha.invalid_arg'\n    },\n    {\n      msg: 'Could not deserialize some piece of data from its binary representation',\n      id: 'proto.alpha.invalid_binary_format'\n    },\n    {\n      msg: 'Fitness representation should be exactly 8 bytes long.',\n      id: 'proto.alpha.invalid_fitness'\n    },\n    {\n      msg: 'Ballot provided for a proposal that is not the current one.',\n      id: 'proto.alpha.invalid_proposal'\n    },\n    {\n      msg: 'Period is negative.',\n      id: 'proto.alpha.malformed_period'\n    },\n    {\n      msg: 'Either no parameter was supplied to a contract with a non-unit parameter type, a non-unit parameter was passed to an account, or a parameter was supplied of the wrong type',\n      id: 'proto.alpha.michelson_v1.bad_contract_parameter'\n    },\n    {\n      msg: 'Unexpected stack at the end of a lambda or script.',\n      id: 'proto.alpha.michelson_v1.bad_return'\n    },\n    {\n      msg: 'The stack has an unexpected length or contents.',\n      id: 'proto.alpha.michelson_v1.bad_stack'\n    },\n    {\n      msg: 'The type of a stack item is unexpected (this error is always accompanied by a more precise one).',\n      id: 'proto.alpha.michelson_v1.bad_stack_item'\n    },\n    {\n      msg: 'The error was too big to be serialized with the provided gas',\n      id: 'proto.alpha.michelson_v1.cannot_serialize_error'\n    },\n    {\n      msg: 'Argument of FAILWITH was too big to be serialized with the provided gas',\n      id: 'proto.alpha.michelson_v1.cannot_serialize_failure'\n    },\n    {\n      msg: 'Execution trace with stacks was to big to be serialized with the provided gas',\n      id: 'proto.alpha.michelson_v1.cannot_serialize_log'\n    },\n    {\n      msg: 'The returned storage was too big to be serialized with the provided gas',\n      id: 'proto.alpha.michelson_v1.cannot_serialize_storage'\n    },\n    {\n      msg: 'A non comparable type was used in a place where only comparable types are accepted.',\n      id: 'proto.alpha.michelson_v1.comparable_type_expected'\n    },\n    {\n      msg: 'A deprecated instruction usage is disallowed in newly created contracts',\n      id: 'proto.alpha.michelson_v1.deprecated_instruction'\n    },\n    {\n      msg: 'Two entrypoints have the same name.',\n      id: 'proto.alpha.michelson_v1.duplicate_entrypoint'\n    },\n    {\n      msg: 'Map literals cannot contain duplicated keys',\n      id: 'proto.alpha.michelson_v1.duplicate_map_keys'\n    },\n    {\n      msg: 'When parsing script, a field was found more than once',\n      id: 'proto.alpha.michelson_v1.duplicate_script_field'\n    },\n    {\n      msg: 'Set literals cannot contain duplicate elements, but a duplicae was found while parsing.',\n      id: 'proto.alpha.michelson_v1.duplicate_set_values_in_literal'\n    },\n    {\n      msg: 'An entrypoint name exceeds the maximum length of 31 characters.',\n      id: 'proto.alpha.michelson_v1.entrypoint_name_too_long'\n    },\n    {\n      msg: 'There is non trivial garbage code after a FAIL instruction.',\n      id: 'proto.alpha.michelson_v1.fail_not_in_tail_position'\n    },\n    {\n      msg: 'The toplevel error thrown when trying to parse a type expression (always followed by more precise errors).',\n      id: 'proto.alpha.michelson_v1.ill_formed_type'\n    },\n    {\n      msg: 'The toplevel error thrown when trying to typecheck a contract code against given input, output and storage types (always followed by more precise errors).',\n      id: 'proto.alpha.michelson_v1.ill_typed_contract'\n    },\n    {\n      msg: 'The toplevel error thrown when trying to typecheck a data expression against a given type (always followed by more precise errors).',\n      id: 'proto.alpha.michelson_v1.ill_typed_data'\n    },\n    {\n      msg: 'The annotations on two types could not be merged',\n      id: 'proto.alpha.michelson_v1.inconsistent_annotations'\n    },\n    {\n      msg: 'The specified field does not match the field annotation in the type',\n      id: 'proto.alpha.michelson_v1.inconsistent_field_annotations'\n    },\n    {\n      msg: 'A stack was of an unexpected length (this error is always in the context of a located error).',\n      id: 'proto.alpha.michelson_v1.inconsistent_stack_lengths'\n    },\n    {\n      msg: 'The two types contain annotations that do not match',\n      id: 'proto.alpha.michelson_v1.inconsistent_type_annotations'\n    },\n    {\n      msg: 'This is the basic type clash error, that appears in several places where the equality of two types have to be proven, it is always accompanied with another error that provides more context.',\n      id: 'proto.alpha.michelson_v1.inconsistent_types'\n    },\n    {\n      msg: 'In a script or data expression, a primitive was applied to an unsupported number of arguments.',\n      id: 'proto.alpha.michelson_v1.invalid_arity'\n    },\n    {\n      msg: 'A script or data expression references a big_map that does not exist or assumes a wrong type for an existing big_map.',\n      id: 'proto.alpha.michelson_v1.invalid_big_map'\n    },\n    {\n      msg: 'A data expression was invalid for its expected type.',\n      id: 'proto.alpha.michelson_v1.invalid_constant'\n    },\n    {\n      msg: 'A script or data expression references a contract that does not exist or assumes a wrong type for an existing contract.',\n      id: 'proto.alpha.michelson_v1.invalid_contract'\n    },\n    {\n      msg: 'In a script or data expression, an expression was of the wrong kind (for instance a string where only a primitive applications can appear).',\n      id: 'proto.alpha.michelson_v1.invalid_expression_kind'\n    },\n    {\n      msg: 'The body of an ITER instruction must result in the same stack type as before the ITER.',\n      id: 'proto.alpha.michelson_v1.invalid_iter_body'\n    },\n    {\n      msg: 'FAIL cannot be the only instruction in the body. The propper type of the return list cannot be inferred.',\n      id: 'proto.alpha.michelson_v1.invalid_map_block_fail'\n    },\n    {\n      msg: 'The body of a map block did not match the expected type',\n      id: 'proto.alpha.michelson_v1.invalid_map_body'\n    },\n    {\n      msg: 'In a script or data expression, a primitive was unknown.',\n      id: 'proto.alpha.michelson_v1.invalid_primitive'\n    },\n    {\n      msg: 'In a script or data expression, a primitive name is unknown or has a wrong case.',\n      id: 'proto.alpha.michelson_v1.invalid_primitive_name'\n    },\n    {\n      msg: 'In a script or data expression, a primitive name is neither uppercase, lowercase or capitalized.',\n      id: 'proto.alpha.michelson_v1.invalid_primitive_name_case'\n    },\n    {\n      msg: 'In a script or data expression, a primitive was of the wrong namespace.',\n      id: 'proto.alpha.michelson_v1.invalid_primitive_namespace'\n    },\n    {\n      msg: 'When parsing script, a field was expected, but not provided',\n      id: 'proto.alpha.michelson_v1.missing_script_field'\n    },\n    {\n      msg: 'An entrypoint was not found when calling a contract.',\n      id: 'proto.alpha.michelson_v1.no_such_entrypoint'\n    },\n    {\n      msg: 'Toplevel error for all runtime script errors',\n      id: 'proto.alpha.michelson_v1.runtime_error'\n    },\n    {\n      msg: 'A FAIL instruction was reached due to the detection of an overflow',\n      id: 'proto.alpha.michelson_v1.script_overflow'\n    },\n    {\n      msg: 'A FAILWITH instruction was reached',\n      id: 'proto.alpha.michelson_v1.script_rejected'\n    },\n    {\n      msg: 'A SELF instruction was encountered in a lambda expression.',\n      id: 'proto.alpha.michelson_v1.self_in_lambda'\n    },\n    {\n      msg: 'An instruction generated a type larger than the limit.',\n      id: 'proto.alpha.michelson_v1.type_too_large'\n    },\n    {\n      msg: 'A binary operation is called on operands of types over which it is not defined.',\n      id: 'proto.alpha.michelson_v1.undefined_binop'\n    },\n    {\n      msg: 'A unary operation is called on an operand of type over which it is not defined.',\n      id: 'proto.alpha.michelson_v1.undefined_unop'\n    },\n    {\n      msg: 'A node in the syntax tree was impropperly annotated',\n      id: 'proto.alpha.michelson_v1.unexpected_annotation'\n    },\n    {\n      msg: 'When parsing script, a big_map type was found in a position where it could end up stored inside a big_map, which is forbidden for now.',\n      id: 'proto.alpha.michelson_v1.unexpected_bigmap'\n    },\n    {\n      msg: 'When parsing script, a contract type was found in the storage or parameter field.',\n      id: 'proto.alpha.michelson_v1.unexpected_contract'\n    },\n    {\n      msg: 'When parsing script, an operation type was found in the storage or parameter field.',\n      id: 'proto.alpha.michelson_v1.unexpected_operation'\n    },\n    {\n      msg: 'Annotations of the same kind must be grouped',\n      id: 'proto.alpha.michelson_v1.ungrouped_annotations'\n    },\n    {\n      msg: 'In a script or data expression, a primitive was unknown.',\n      id: 'proto.alpha.michelson_v1.unknown_primitive_name'\n    },\n    {\n      msg: 'At the join point at the end of two code branches the stacks have inconsistent lengths or contents.',\n      id: 'proto.alpha.michelson_v1.unmatched_branches'\n    },\n    {\n      msg: 'Map keys must be in strictly increasing order',\n      id: 'proto.alpha.michelson_v1.unordered_map_literal'\n    },\n    {\n      msg: 'Set values must be in strictly increasing order',\n      id: 'proto.alpha.michelson_v1.unordered_set_literal'\n    },\n    {\n      msg: 'An entrypoint in the contract is not reachable.',\n      id: 'proto.alpha.michelson_v1.unreachable_entrypoint'\n    },\n    {\n      msg: 'Duplicated revelation for a nonce.',\n      id: 'proto.alpha.nonce.previously_revealed'\n    },\n    {\n      msg: 'Nonce revelation happens before cycle end',\n      id: 'proto.alpha.nonce.too_early_revelation'\n    },\n    {\n      msg: 'Nonce revelation happens too late',\n      id: 'proto.alpha.nonce.too_late_revelation'\n    },\n    {\n      msg: 'The provided nonce is inconsistent with the committed nonce hash.',\n      id: 'proto.alpha.nonce.unexpected'\n    },\n    {\n      msg: 'The operation is ill-formed or for another protocol version',\n      id: 'proto.alpha.operation.cannot_parse'\n    },\n    {\n      msg: 'Two endorsements received from same delegate',\n      id: 'proto.alpha.operation.duplicate_endorsement'\n    },\n    {\n      msg: 'The given key and secret do not correspond to any existing preallocated contract',\n      id: 'proto.alpha.operation.invalid_activation'\n    },\n    {\n      msg: 'The level of an endorsement is inconsistent with the provided block hash.',\n      id: 'proto.alpha.operation.invalid_endorsement_level'\n    },\n    {\n      msg: 'The operation signature is ill-formed or has been made with the wrong public key',\n      id: 'proto.alpha.operation.invalid_signature'\n    },\n    {\n      msg: 'The operation is of a kind that must be signed, but the signature is missing',\n      id: 'proto.alpha.operation.missing_signature'\n    },\n    {\n      msg: 'The block being validated does not include the required minimum number of endorsements for this priority.',\n      id: 'proto.alpha.operation.not_enought_endorsements_for_priority'\n    },\n    {\n      msg: 'Trying to include an endorsement in a block that is not the successor of the endorsed one',\n      id: 'proto.alpha.operation.wrong_endorsement_predecessor'\n    },\n    {\n      msg: 'Trying to onclude a proposal or ballot meant for another voting period',\n      id: 'proto.alpha.operation.wrong_voting_period'\n    },\n    {\n      msg: 'The requested seed is not available',\n      id: 'proto.alpha.seed.unknown_seed'\n    },\n    {\n      msg: 'A script or one of its callee wrote more bytes than the operation said it would',\n      id: 'proto.alpha.storage_exhausted.operation'\n    },\n    {\n      msg: 'A transaction tried to exceed the hard limit on storage',\n      id: 'proto.alpha.storage_limit_too_high'\n    },\n    {\n      msg: 'An addition of two tez amounts overflowed',\n      id: 'proto.alpha.tez.addition_overflow'\n    },\n    {\n      msg: 'Multiplication of a tez amount by a non positive integer',\n      id: 'proto.alpha.tez.invalid_divisor'\n    },\n    {\n      msg: 'A multiplication of a tez amount by an integer overflowed',\n      id: 'proto.alpha.tez.multiplication_overflow'\n    },\n    {\n      msg: 'Multiplication of a tez amount by a negative integer',\n      id: 'proto.alpha.tez.negative_multiplicator'\n    },\n    {\n      msg: 'An subtraction of two tez amounts underflowed',\n      id: 'proto.alpha.tez.subtraction_underflow'\n    },\n    {\n      msg: 'Overflow when adding timestamps.',\n      id: 'proto.alpha.timestamp_add'\n    },\n    {\n      msg: 'Substracting timestamps resulted in negative period.',\n      id: 'proto.alpha.timestamp_sub'\n    },\n    {\n      msg: 'A transaction exceeded the hard limit of internal operations it can emit',\n      id: 'proto.alpha.too_many_internal_operations'\n    },\n    {\n      msg: 'The delegate reached the maximum number of allowed proposals.',\n      id: 'proto.alpha.too_many_proposals'\n    },\n    {\n      msg: 'The delegate provided for the ballot is not in the voting listings.',\n      id: 'proto.alpha.unauthorized_ballot'\n    },\n    {\n      msg: 'The delegate provided for the proposal is not in the voting listings.',\n      id: 'proto.alpha.unauthorized_proposal'\n    },\n    {\n      msg: 'An origination was attemped out of the scope of a manager operation',\n      id: 'proto.alpha.undefined_operation_nonce'\n    },\n    {\n      msg: 'Ballot recorded outside of a voting period.',\n      id: 'proto.alpha.unexpected_ballot'\n    },\n    {\n      msg: 'Level must be non-negative.',\n      id: 'proto.alpha.unexpected_level'\n    },\n    {\n      msg: 'Nonce length is incorrect.',\n      id: 'proto.alpha.unexpected_nonce_length'\n    },\n    {\n      msg: 'Proposal recorded outside of a proposal period.',\n      id: 'proto.alpha.unexpected_proposal'\n    },\n    {\n      msg: 'Block locator is invalid.',\n      id: 'node.bootstrap_pipeline.invalid_locator'\n    },\n    {\n      msg: 'Block locator is too short.',\n      id: 'node.bootstrap_pipeline.too_short_locator'\n    },\n    {\n      msg: 'IO error: connection with a peer is closed.',\n      id: 'node.p2p_io_scheduler.connection_closed'\n    },\n    {\n      msg: 'Fail to connect with a peer: a connection is already established.',\n      id: 'node.p2p_pool.connected'\n    },\n    {\n      msg: 'Connection was refused.',\n      id: 'node.p2p_pool.connection_refused'\n    },\n    {\n      msg: 'The peer identity you tried to connect is banned.',\n      id: 'node.p2p_pool.peer_banned'\n    },\n    {\n      msg: 'Fail to connect with a peer: a connection is already pending.',\n      id: 'node.p2p_pool.pending_connection'\n    },\n    {\n      msg: 'The address you tried to connect is banned.',\n      id: 'node.p2p_pool.point_banned'\n    },\n    {\n      msg: 'Node is in private mode.',\n      id: 'node.p2p_pool.private_mode'\n    },\n    {\n      msg: 'Connection to peer was rejected by us.',\n      id: 'node.p2p_pool.rejected'\n    },\n    {\n      msg: 'Too many connections.',\n      id: 'node.p2p_pool.too_many_connections'\n    },\n    {\n      msg: 'An error occurred while deciphering.',\n      id: 'node.p2p_socket.decipher_error'\n    },\n    {\n      msg: 'An error occurred while decoding.',\n      id: 'node.p2p_socket.decoding_error'\n    },\n    {\n      msg: 'An error occurred while encoding.',\n      id: 'node.p2p_socket.encoding_error'\n    },\n    {\n      msg: 'Rejected peer connection: invalid authentication.',\n      id: 'node.p2p_socket.invalid_auth'\n    },\n    {\n      msg: 'Size of chunks is not valid.',\n      id: 'node.p2p_socket.invalid_chunks_size'\n    },\n    {\n      msg: 'The size of the message to be written is invalid.',\n      id: 'node.p2p_socket.invalid_message_size'\n    },\n    {\n      msg: 'Remote peer is actually yourself.',\n      id: 'node.p2p_socket.myself'\n    },\n    {\n      msg: 'Remote peer cannot be authenticated: not enough proof of work.',\n      id: 'node.p2p_socket.not_enough_proof_of_work'\n    },\n    {\n      msg: 'Rejected peer connection: The peer rejected the socket connection by Nack with a list of alternative peers.',\n      id: 'node.p2p_socket.rejected_by_nack'\n    },\n    {\n      msg: 'Rejected peer connection: rejected socket connection as we have no common network protocol with the peer.',\n      id: 'node.p2p_socket.rejected_no_common_protocol'\n    },\n    {\n      msg: 'Rejected peer connection: rejected socket connection.',\n      id: 'node.p2p_socket.rejected_socket_connection'\n    },\n    {\n      msg: 'Rejecting peer connection with motive.',\n      id: 'node.p2p_socket.rejecting_incoming'\n    },\n    {\n      msg: \"Known invalid block found in the peer's chain\",\n      id: 'node.peer_validator.known_invalid'\n    },\n    {\n      msg: \"Unknown ancestor block found in the peer's chain\",\n      id: 'node.peer_validator.unknown_ancestor'\n    },\n    {\n      msg: 'The block was annotated with a time too far in the future.',\n      id: 'node.prevalidation.future_block_header'\n    },\n    {\n      msg: 'The operation size is bigger than allowed.',\n      id: 'node.prevalidation.oversized_operation'\n    },\n    {\n      msg: 'Raised when an operation has not been parsed correctly during prevalidation.',\n      id: 'node.prevalidation.parse_error'\n    },\n    {\n      msg: 'The prevalidation context is full.',\n      id: 'node.prevalidation.too_many_operations'\n    },\n    {\n      msg: 'Invalid protocol.',\n      id: 'node.protocol_validator.invalid_protocol'\n    },\n    {\n      msg: 'The data directory could not be read. This could be because it was generated with an old version of the tezos-node program. Deleting and regenerating this directory may fix the problem.',\n      id: 'node.state.bad_data_dir'\n    },\n    {\n      msg: 'When commiting the context of a block, the announced context hash was not the one computed at commit time.',\n      id: 'node.state.block.inconsistent_context_hash'\n    },\n    {\n      msg: 'The invalid block to be unmarked was not actually invalid.',\n      id: 'node.state.block_not_invalid'\n    },\n    {\n      msg: 'The chain identifier could not be found in the chain identifiers table.',\n      id: 'node.state.unknown_chain'\n    },\n    {\n      msg: 'The block belongs to a branch that is not compatible with the current checkpoint.',\n      id: 'node.validator.checkpoint_error'\n    },\n    {\n      msg: 'Attempted validation of a block from an inactive chain.',\n      id: 'node.validator.inactive_chain'\n    },\n    {\n      msg: 'Incorrect history mode switch.',\n      id: 'node_config_file.incorrect_history_mode_switch'\n    },\n    {\n      msg: 'Missing key in store',\n      id: 'raw_store.unknown'\n    },\n    {\n      msg: 'The provided list of operations is inconsistent with the block header.',\n      id: 'validator.inconsistent_operations_hash'\n    },\n    {\n      msg: 'Invalid block.',\n      id: 'validator.invalid_block'\n    },\n    {\n      msg: 'Missing test protocol when forking the test chain',\n      id: 'validator.missing_test_protocol'\n    },\n    {\n      msg: 'The protocol required for validating a block is missing.',\n      id: 'validator.unavailable_protocol'\n    },\n    {\n      msg: 'Failed to validate block using exteranl validation process.',\n      id: 'validator.validation_process_failed'\n    },\n    {\n      msg: 'An operation on a worker could not complete before it was shut down.',\n      id: 'worker.closed'\n    },\n    {\n      msg: 'While parsing a piece of Micheline source, an annotation exceeded the maximum length (255).',\n      id: 'micheline.parse_error.annotation_exceeds_max_length'\n    },\n    {\n      msg: 'Tried to interpret an empty piece or Micheline source as a single expression.',\n      id: 'micheline.parse_error.empty_expression'\n    },\n    {\n      msg: 'While parsing a piece of Micheline source, an extra semi colon or parenthesis was encountered.',\n      id: 'micheline.parse_error.extra_token'\n    },\n    {\n      msg: 'While parsing a piece of Micheline source, a sequence of bytes that is not valid UTF-8 was encountered.',\n      id: 'micheline.parse_error.invalid_utf8_sequence'\n    },\n    {\n      msg: 'While parsing a piece of Micheline source, an expression was not aligned with its siblings of the same mother application or sequence.',\n      id: 'micheline.parse_error.misaligned_node'\n    },\n    {\n      msg: 'While parsing a piece of Micheline source, a number was not visually separated from its follower token, leading to misreadability.',\n      id: 'micheline.parse_error.missing_break_after_number'\n    },\n    {\n      msg: 'While parsing a piece of Micheline source, the length of a byte sequence (0x...) was not a multiple of two, leaving a trailing half byte.',\n      id: 'micheline.parse_error.odd_lengthed_bytes'\n    },\n    {\n      msg: 'While parsing a piece of Micheline source, a parenthesis or a brace was unclosed.',\n      id: 'micheline.parse_error.unclosed_token'\n    },\n    {\n      msg: 'While parsing a piece of Micheline source, an unexpected escape sequence was encountered in a string.',\n      id: 'micheline.parse_error.undefined_escape_sequence'\n    },\n    {\n      msg: 'While parsing a piece of Micheline source, an unexpected character was encountered.',\n      id: 'micheline.parse_error.unexpected_character'\n    },\n    {\n      msg: 'While parsing a piece of Micheline source, an unexpected token was encountered.',\n      id: 'micheline.parse_error.unexpected_token'\n    },\n    {\n      msg: 'While parsing a piece of Micheline source, a commentX was not terminated.',\n      id: 'micheline.parse_error.unterminated_comment'\n    },\n    {\n      msg: 'While parsing a piece of Micheline source, an integer was not terminated.',\n      id: 'micheline.parse_error.unterminated_integer'\n    },\n    {\n      msg: 'While parsing a piece of Micheline source, a string was not terminated.',\n      id: 'micheline.parse_error.unterminated_string'\n    },\n    {\n      msg: 'Wrong hash given',\n      id: 'Bad_hash'\n    },\n    {\n      msg: 'The context checkout failed using a given hash',\n      id: 'Block_validator_process.failed_to_checkout_context'\n    },\n    {\n      msg: 'Cannot reconstruct',\n      id: 'CannotReconstruct'\n    },\n    {\n      msg: 'Cannot find context corresponding to hash',\n      id: 'Context_not_found'\n    },\n    {\n      msg: 'The imported block is not the expected one.',\n      id: 'InconsistentImportedBlock'\n    },\n    {\n      msg: 'The operations given do not match their hashes.',\n      id: 'InconsistentOperationHashes'\n    },\n    {\n      msg: 'The data provided by the snapshot is inconsistent',\n      id: 'Inconsistent_snapshot_data'\n    },\n    {\n      msg: 'Error while opening snapshot file',\n      id: 'Inconsistent_snapshot_file'\n    },\n    {\n      msg: 'Invalid specification of block to import',\n      id: 'InvalidBlockSpecification'\n    },\n    {\n      msg: 'The version of the snapshot to import is not valid',\n      id: 'Invalid_snapshot_version'\n    },\n    {\n      msg: 'Mandatory data missing while reaching end of snapshot file.',\n      id: 'Missing_snapshot_data'\n    },\n    {\n      msg: 'RPC lookup failed. Block has been pruned and requested data deleted.',\n      id: 'RPC_context.Gone'\n    },\n    {\n      msg: 'RPC lookup failed. No RPC exists at the URL or the RPC tried to access non-existent data.',\n      id: 'RPC_context.Not_found'\n    },\n    {\n      msg: 'Internal error while restoring the context',\n      id: 'Restore_context_failure'\n    },\n    {\n      msg: 'The imported snapshot is malformed.',\n      id: 'SnapshotImportFailure'\n    },\n    {\n      msg: 'Failed to read file',\n      id: 'System_read_error'\n    },\n    {\n      msg: 'The validator failed because of a system error',\n      id: 'Validator_process.system_error_while_validating'\n    },\n    {\n      msg: 'Cannot write in file for context dump',\n      id: 'Writing_error'\n    },\n    {\n      msg: 'The block to export in the snapshot is not valid.',\n      id: 'WrongBlockExport'\n    },\n    {\n      msg: 'Wrong protocol hash',\n      id: 'WrongProtocolHash'\n    },\n    {\n      msg: 'Snapshot exports is not compatible with the current configuration.',\n      id: 'WrongSnapshotExport'\n    },\n    {\n      msg: 'A fatal assertion failed',\n      id: 'assertion'\n    },\n    {\n      msg: 'A promise was unexpectedly canceled',\n      id: 'canceled'\n    },\n    {\n      msg: 'A key has been provided with an invalid uri.',\n      id: 'cli.key.invalid_uri'\n    },\n    {\n      msg: 'The signer produced an invalid signature',\n      id: 'cli.signature_mismatch'\n    },\n    {\n      msg: 'A key has been provided with an unregistered scheme (no corresponding plugin)',\n      id: 'cli.unregistered_key_scheme'\n    },\n    {\n      msg: 'The byte sequence references a multisig counter that does not match the one currently stored in the given multisig contract',\n      id: 'client.alpha.Bad deserialized counter'\n    },\n    {\n      msg: 'When trying to deserialise an action from a sequence of bytes, we got an expression that does not correspond to a known multisig action',\n      id: 'client.alpha.actionDeserialisation'\n    },\n    {\n      msg: 'When trying to deserialise an action from a sequence of bytes, we got an action for another multisig contract',\n      id: 'client.alpha.badDeserializedContract'\n    },\n    {\n      msg: 'invalid duration in -endorsement-delay',\n      id: 'client.alpha.badEndorsementDelayArg'\n    },\n    {\n      msg: 'invalid priority in -max-priority',\n      id: 'client.alpha.badMaxPriorityArg'\n    },\n    {\n      msg: 'invalid duration in -max-waiting-time',\n      id: 'client.alpha.badMaxWaitingTimeArg'\n    },\n    {\n      msg: 'invalid fee threshold in -fee-threshold',\n      id: 'client.alpha.badMinimalFeesArg'\n    },\n    {\n      msg: 'invalid number of levels in -preserved-levels',\n      id: 'client.alpha.badPreservedLevelsArg'\n    },\n    {\n      msg: 'Invalid  notation in parameter.',\n      id: 'client.alpha.badTezArg'\n    },\n    {\n      msg: 'When trying to deserialise an action from a sequence of bytes, we got an error',\n      id: 'client.alpha.bytesDeserialisation'\n    },\n    {\n      msg: 'A multisig command has referenced a scriptless smart contract instead of a multisig smart contract.',\n      id: 'client.alpha.contractHasNoScript'\n    },\n    {\n      msg: 'A multisig command has referenced a smart contract without storage instead of a multisig smart contract.',\n      id: 'client.alpha.contractHasNoStorage'\n    },\n    {\n      msg: 'A multisig command has referenced a smart contract whose storage is of a different shape than the expected one.',\n      id: 'client.alpha.contractHasUnexpectedStorage'\n    },\n    {\n      msg: 'Attempt to get the code of a contract failed because it has nocode. No scriptless contract should remain.',\n      id: 'client.alpha.contractWithoutCode'\n    },\n    {\n      msg: 'A signature was given for a multisig contract that matched none of the public keys of the contract signers',\n      id: 'client.alpha.invalidSignature'\n    },\n    {\n      msg: 'A wrong number of arguments was provided to a macro',\n      id: 'client.alpha.michelson.macros.bas_arity'\n    },\n    {\n      msg: 'An macro expects a sequence, but a sequence was not provided',\n      id: 'client.alpha.michelson.macros.sequence_expected'\n    },\n    {\n      msg: 'A macro had an annotation, but no annotation was permitted on this macro.',\n      id: 'client.alpha.michelson.macros.unexpected_annotation'\n    },\n    {\n      msg: 'A multisig threshold should be a positive number',\n      id: 'client.alpha.nonPositiveThreshold'\n    },\n    {\n      msg: 'A multisig command has referenced a smart contract whose script is not one of the known multisig contract scripts.',\n      id: 'client.alpha.notASupportedMultisigContract'\n    },\n    {\n      msg: 'To run an action on a multisig contract, you should provide at least as many signatures as indicated by the threshold stored in the multisig contract.',\n      id: 'client.alpha.notEnoughSignatures'\n    },\n    {\n      msg: 'The given threshold is higher than the number of keys, this would lead to a frozen multisig contract',\n      id: 'client.alpha.thresholdTooHigh'\n    },\n    {\n      msg: 'Cannot recover from a corrupted context.',\n      id: 'context.non_recoverable_context'\n    },\n    {\n      msg: '<gf>context_dump.read.cannot_open'\n    },\n    {\n      msg: '<gf>context_dump.read.suspicious'\n    },\n    {\n      msg: '<gf>context_dump.write.cannot_open'\n    },\n    {\n      msg: 'Exception safely wrapped in an error',\n      id: 'failure'\n    },\n    {\n      msg: 'Activation of an Internal Event SINK with an URI failed',\n      id: 'internal-event-activation-error'\n    },\n    {\n      msg: 'The raw context extraction depth argument must be positive.',\n      id: 'raw_context.invalid_depth'\n    },\n    {\n      msg: 'No protocol was registered with the requested hash.',\n      id: 'registered_protocol.unregistered_protocol'\n    },\n    {\n      msg: 'The fetch of a Operation_hash has been canceled',\n      id: 'requester.Operation_hash.fetch_canceled'\n    },\n    {\n      msg: 'The fetch of a Operation_hash has timed out',\n      id: 'requester.Operation_hash.fetch_timeout'\n    },\n    {\n      msg: 'Some Operation_hash is missing from the requester',\n      id: 'requester.Operation_hash.missing'\n    },\n    {\n      msg: 'The fetch of a Protocol_hash has been canceled',\n      id: 'requester.Protocol_hash.fetch_canceled'\n    },\n    {\n      msg: 'The fetch of a Protocol_hash has timed out',\n      id: 'requester.Protocol_hash.fetch_timeout'\n    },\n    {\n      msg: 'Some Protocol_hash is missing from the requester',\n      id: 'requester.Protocol_hash.missing'\n    },\n    {\n      msg: 'The fetch of a block_hash has been canceled',\n      id: 'requester.block_hash.fetch_canceled'\n    },\n    {\n      msg: 'The fetch of a block_hash has timed out',\n      id: 'requester.block_hash.fetch_timeout'\n    },\n    {\n      msg: 'Some block_hash is missing from the requester',\n      id: 'requester.block_hash.missing'\n    },\n    {\n      msg: 'The fetch of a operation_hashes has been canceled',\n      id: 'requester.operation_hashes.fetch_canceled'\n    },\n    {\n      msg: 'The fetch of a operation_hashes has timed out',\n      id: 'requester.operation_hashes.fetch_timeout'\n    },\n    {\n      msg: 'Some operation_hashes is missing from the requester',\n      id: 'requester.operation_hashes.missing'\n    },\n    {\n      msg: 'The fetch of a operations has been canceled',\n      id: 'requester.operations.fetch_canceled'\n    },\n    {\n      msg: 'The fetch of a operations has timed out',\n      id: 'requester.operations.fetch_timeout'\n    },\n    {\n      msg: 'Some operations is missing from the requester',\n      id: 'requester.operations.missing'\n    },\n    {\n      msg: 'Error while decoding a remote signer message',\n      id: 'signer.decoding_error'\n    },\n    {\n      msg: 'Error while encoding a remote signer message',\n      id: 'signer.encoding_error'\n    },\n    {\n      msg: 'Block not found',\n      id: 'state.block.contents_not_found'\n    },\n    {\n      msg: 'Block not found',\n      id: 'state.block.not_found'\n    },\n    {\n      msg: 'Unix System_info failure',\n      id: 'unix.system_info'\n    },\n    {\n      msg: 'An unhandled unix exception',\n      id: 'unix_error'\n    },\n    {\n      msg: 'Canceled',\n      id: 'utils.Canceled'\n    },\n    {\n      msg: 'Timeout',\n      id: 'utils.Timeout'\n    },\n    {\n      msg: 'Fee exceeded hard cap!',\n      id: 'TooHighFee'\n    },\n    {\n      msg: 'Node error: Timeout has occurred! Please try again later.',\n      id: 'Timeout has occurred'\n    }\n  ];\n  transform(errorId: string, withObj?: any, location?: number): any {\n    const protocol = errorId.match(/[0-9]{3}-P\\w{7}/g);\n    if (protocol && protocol[0]) {\n      errorId = errorId.replace(protocol[0], 'alpha');\n    }\n    let errorMessage = '';\n    const index = this.ERROR_LIST.findIndex((s) => s.id === errorId);\n    console.log('errorId', errorId);\n    if (errorId === 'proto.alpha.michelson_v1.script_rejected' && withObj) {\n      if (withObj.string) {\n        errorMessage = `${this.ERROR_LIST[index].msg} | ${withObj.string}`;\n      } else if (withObj?.int === '4' && location === 206) {\n        errorMessage = 'Tokens deposited is greater than maximum tokens deposited. Please retry in a while.';\n      } else {\n        let jsonWith = JSON.stringify(withObj);\n        if (jsonWith.length > 200) {\n          jsonWith = '[...]';\n          console.error('FAILWITH', withObj);\n        }\n        errorMessage = `${this.ERROR_LIST[index].msg} ${jsonWith}`;\n      }\n      console.log(withObj);\n    } else if (index !== -1) {\n      errorMessage = this.ERROR_LIST[index].msg;\n    } else {\n      if (errorId.indexOf('branch refused (Error:') !== -1 && errorId.indexOf('already used for contract') !== -1) {\n        errorMessage =\n          'Counter error: Another operation in mempool is blocking your operation. Wait for it to be included in a block or pruned from mempool (up to 60 minutes).';\n      } else {\n        errorMessage = 'Unrecognized error: ' + errorId;\n      }\n    }\n    return errorMessage;\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'removeComma'\n})\nexport class RemoveCommaPipe implements PipeTransform {\n  transform(value: string): string {\n    if (value !== undefined && value !== null) {\n      return value.replace(/,/g, '');\n    } else {\n      return '';\n    }\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\nimport { TranslateService } from '@ngx-translate/core'; // Multiple instances created ?\nimport * as timediff from 'timediff';\n\n@Pipe({\n  name: 'timeAgo',\n  pure: true // if false pipe will be called at each changes - necessary for translation - is there a better way?\n})\nexport class TimeAgoPipe implements PipeTransform {\n  constructor(private translate: TranslateService) {}\n  transform(timestamp: number): string {\n    const now = this.translate.instant('TIMEAGOPIPE.JUSTNOW');\n    const sec = this.translate.instant('TIMEAGOPIPE.SEC');\n    const secs = sec;\n    const mn = this.translate.instant('TIMEAGOPIPE.MINUTE');\n    const mns = mn;\n    const hr = this.translate.instant('TIMEAGOPIPE.HOUR');\n    const hrs = this.translate.instant('TIMEAGOPIPE.HOURS');\n    const day = this.translate.instant('TIMEAGOPIPE.DAY');\n    const days = this.translate.instant('TIMEAGOPIPE.DAYS');\n    const month = this.translate.instant('TIMEAGOPIPE.MONTH');\n    const months = this.translate.instant('TIMEAGOPIPE.MONTHS');\n    const year = this.translate.instant('TIMEAGOPIPE.YEAR');\n    const years = this.translate.instant('TIMEAGOPIPE.YEARS');\n\n    const timeNow = new Date().getTime();\n    const diff = timediff(timestamp, timeNow, 'YMDHmS');\n\n    const keys = Object.keys(diff);\n    let count = 0;\n    let output = '';\n\n    for (const key of keys) {\n      if (diff[key] || count) {\n        if (count) {\n          output = output + ' ';\n        }\n        switch (key) {\n          case 'years':\n            output = `${diff[key]}${diff[key] === 1 ? year : years}`;\n            break;\n          case 'months':\n            output = output + `${diff[key]}${diff[key] === 1 ? month : months}`;\n            break;\n          case 'days':\n            output = output + `${diff[key]}${diff[key] === 1 ? day : days}`;\n            break;\n          case 'hours':\n            output = output + `${diff[key]}${diff[key] === 1 ? hr : hrs}`;\n            break;\n          case 'minutes':\n            output = output + `${diff[key]}${diff[key] === 1 ? mn : mns}`;\n            break;\n          case 'seconds':\n            if (!diff.minutes && diff.seconds < 60) {\n              output = now;\n            } else if (diff.minutes < 2) {\n              output = output + `${diff[key]}${diff[key] === 1 ? sec : secs}`;\n            }\n            break;\n        }\n        if (count++) {\n          break;\n        }\n      }\n    }\n    return output;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { WalletService } from '../wallet/wallet.service';\nimport { of, Observable, from as fromPromise } from 'rxjs';\nimport { flatMap } from 'rxjs/operators';\nimport { delay, takeUntil } from 'rxjs/operators';\nimport { Activity, Account, OpStatus } from '../wallet/wallet';\nimport { MessageService } from '../message/message.service';\nimport { LookupService } from '../lookup/lookup.service';\nimport { IndexerService } from '../indexer/indexer.service';\nimport { TokenService } from '../token/token.service';\nimport { BehaviorSubject } from 'rxjs';\nimport { SubjectService } from '../subject/subject.service';\n\n@Injectable()\nexport class ActivityService {\n  readonly maxTransactions = 10;\n  public tokenBalanceUpdated = new BehaviorSubject(null);\n  constructor(\n    private walletService: WalletService,\n    private messageService: MessageService,\n    private lookupService: LookupService,\n    private indexerService: IndexerService,\n    private tokenService: TokenService,\n    private subjectService: SubjectService\n  ) {}\n  updateTransactions(pkh): Observable<any> {\n    try {\n      const account = this.walletService.wallet.getAccount(pkh);\n      return this.getTransactonsCounter(account).pipe(\n        flatMap((ans: any) => {\n          return of(ans);\n        })\n      );\n    } catch (e) {\n      console.log(e);\n    }\n  }\n  getTransactonsCounter(account: Account): Observable<any> {\n    const knownTokenIds: string[] = this.tokenService.knownTokenIds();\n    return fromPromise(this.indexerService.accountInfo(account.address, knownTokenIds)).pipe(\n      flatMap((data) => {\n        const counter = data.counter;\n        const unknownTokenIds = data.unknownTokenIds ? data.unknownTokenIds : [];\n        this.tokenService.searchAllMetadata(unknownTokenIds);\n        this.tokenService.recheckMetadata(data?.tokens);\n        if (account.state !== counter) {\n          if (data.tokens) {\n            this.updateTokenBalances(account, data.tokens);\n          } else {\n            this.updateTokenBalances(account, []);\n          }\n          return this.getAllTransactions(account, counter);\n        } else {\n          if (!account.state) {\n            if (!account.activities || !account.tokens) {\n              if (!account.activities) {\n                account.activities = [];\n              }\n              if (!account.tokens) {\n                account.tokens = [];\n              }\n              this.updateTokenBalances(account, []);\n              this.walletService.storeWallet();\n            }\n          }\n          return of({\n            upToDate: true,\n            balance: data?.balance ? data.balance : 0\n          });\n        }\n      })\n    );\n  }\n  async updateTokenBalances(account, tokens) {\n    if (Array.isArray(tokens)) {\n      const idsWithBalance: string[] = [];\n      if (!tokens.length) {\n        account.updateTokenBalance('', '');\n      } else {\n        for (const token of tokens) {\n          idsWithBalance.push(token.tokenId);\n          account.updateTokenBalance(token.tokenId, token.balance.toString());\n        }\n        const currentTokenIds = account.getTokenBalances().map((token) => {\n          return token.tokenId;\n        });\n        for (const tokenId of currentTokenIds) {\n          if (!idsWithBalance.includes(tokenId)) {\n            account.updateTokenBalance(tokenId, '0');\n          }\n        }\n      }\n      this.tokenBalanceUpdated.next(true);\n      this.walletService.storeWallet();\n    }\n  }\n  getAllTransactions(account: Account, counter: string): Observable<any> {\n    const knownTokenIds: string[] = this.tokenService.knownTokenIds();\n    return fromPromise(this.indexerService.getOperations(account.address, knownTokenIds, this.walletService.wallet)).pipe(\n      flatMap((resp) => {\n        const operations = resp.operations;\n        this.tokenService.searchAllMetadata(resp.unknownTokenIds);\n        if (Array.isArray(operations)) {\n          const oldActivities = account.activities;\n          const unconfirmedOps = [];\n          if (oldActivities && oldActivities.length) {\n            for (let op of oldActivities) {\n              if (op.status === OpStatus.UNCONFIRMED || op.status === OpStatus.HALF_CONFIRMED) {\n                let save = true;\n                for (const opNew of operations) {\n                  if (opNew.hash === op.hash) {\n                    save = false;\n                    break;\n                  }\n                }\n                if (save) {\n                  unconfirmedOps.push(op);\n                }\n              }\n            }\n          }\n          account.activities = unconfirmedOps.concat(operations);\n          const oldState = account.state;\n          account.state = counter;\n          this.walletService.storeWallet();\n          if (oldState !== '') {\n            // Exclude inital loading\n            this.promptNewActivities(account, oldActivities, operations);\n          }\n          for (const activity of operations) {\n            const counterParty = this.getCounterparty(activity, account, false);\n            this.lookupService.check(counterParty);\n          }\n        }\n        return of({\n          upToDate: false\n        });\n      })\n    );\n  }\n  promptNewActivities(account: Account, oldActivities: Activity[], newActivities: Activity[]) {\n    for (const activity of newActivities) {\n      const index = oldActivities.findIndex((a) => a.hash === activity.hash && a.status === OpStatus.CONFIRMED);\n      if (index === -1) {\n        const now = new Date().getTime();\n        const timeDiff = now - (activity?.timestamp ? activity.timestamp : now);\n        if (timeDiff < 1800000) {\n          // 1/2 hour\n          if (activity.hash) {\n            setTimeout(() => {\n              this.subjectService.confirmedOp.next(activity.hash);\n            }, 0);\n          }\n          if (activity.type === 'transaction') {\n            if (account.address === activity.source.address) {\n              this.messageService.addSuccess(account.shortAddress() + ': Sent ' + this.tokenService.formatAmount(activity.tokenId, activity.amount.toString()));\n            }\n            if (account.address === activity.destination.address) {\n              const ref = activity.tokenId ? Date.now().toString() + activity.tokenId : '';\n              this.messageService.addSuccess(\n                (account.shortAddress() + ': Received ' + this.tokenService.formatAmount(activity.tokenId, activity.amount.toString())).replace(\n                  '[Unknown token]',\n                  'Token'\n                ),\n                undefined,\n                ref\n              );\n              if (activity.tokenId && this.tokenService.getAsset(activity.tokenId) === null) {\n                // unknown token\n                this.subjectService.metadataUpdated.pipe(takeUntil(of(true).pipe(delay(8000)))).subscribe((token: any) => {\n                  // unsub after 8s\n                  if (token?.contractAddress && token.id !== undefined) {\n                    const tokenId = token.contractAddress + ':' + token.id.toString();\n                    if (activity.tokenId === tokenId) {\n                      this.messageService.modify(\n                        account.shortAddress() + ': Received ' + this.tokenService.formatAmount(activity.tokenId, activity.amount.toString()),\n                        ref\n                      );\n                    }\n                  }\n                });\n              }\n            }\n          } else if (activity.type === 'delegation') {\n            this.messageService.addSuccess(account.shortAddress() + ': Delegate updated');\n          } else if (activity.type === 'origination') {\n            this.messageService.addSuccess(account.shortAddress() + ': Contract originated');\n          } else if (activity.type === 'activation') {\n            this.messageService.addSuccess(account.shortAddress() + ': Account activated');\n          }\n          const counter = this.getCounterparty(activity, account, false);\n          if (counter?.address) {\n            this.lookupService.check(counter.address, true);\n          }\n        }\n      }\n    }\n  }\n  getCounterparty(transaction: Activity, account: Account, withLookup = true): any {\n    let counterParty = { address: '' };\n    if (transaction.type === 'delegation') {\n      if (transaction.destination) {\n        counterParty = transaction.destination;\n      } else {\n        counterParty = { address: '' }; // User has undelegated\n      }\n    } else if (transaction.type === 'transaction') {\n      if (account.address === transaction.source.address) {\n        counterParty = transaction.destination; // to\n      } else {\n        counterParty = transaction.source; // from\n      }\n    } else if (transaction.type === 'origination') {\n      if (account.address === transaction.source.address) {\n        counterParty = transaction.destination ? transaction.destination : { address: '' };\n      } else {\n        counterParty = transaction.source;\n      }\n    } else {\n      counterParty = { address: '' };\n    }\n    if (withLookup) {\n      return this.lookupService.resolve(counterParty);\n    } else {\n      return counterParty;\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { WalletService } from '../wallet/wallet.service';\nimport { TzrateService } from '../tzrate/tzrate.service';\nimport { OperationService } from '../operation/operation.service';\nimport { Account } from '../wallet/wallet';\n\n@Injectable()\nexport class BalanceService {\n  constructor(private walletService: WalletService, private tzrateService: TzrateService, private operationService: OperationService) {}\n\n  getBalanceAll() {\n    for (const account of this.walletService.wallet.getAccounts()) {\n      this.getAccountBalance(account);\n    }\n  }\n  getAccountBalance(account: Account) {\n    console.log('for ' + account.address);\n    this.operationService.getBalance(account.address).subscribe((ans: any) => {\n      if (ans.success) {\n        this.updateAccountBalance(account, Number(ans.payload.balance));\n      } else {\n        console.log('Balance Error: ' + JSON.stringify(ans.payload.msg));\n      }\n    });\n  }\n  updateAccountBalance(account: Account, newBalance: number) {\n    if (account && (account.balanceXTZ === null || account.balanceXTZ === undefined || newBalance !== account.balanceXTZ)) {\n      account.balanceXTZ = newBalance;\n      this.updateTotalBalance();\n      this.tzrateService.updateFiatBalances();\n      this.walletService.storeWallet();\n    }\n  }\n  updateTotalBalance() {\n    let balance = 0;\n    let change = false;\n    for (const account of this.walletService.wallet.getAccounts()) {\n      if (!(account.balanceXTZ === null || account.balanceXTZ === undefined)) {\n        balance = balance + Number(account.balanceXTZ);\n        change = true;\n      }\n    }\n    if (change) {\n      this.walletService.wallet.totalBalanceXTZ = balance;\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { MessageService } from '../../services/message/message.service';\nimport {\n  WalletClient,\n  BeaconMessageType,\n  PermissionResponseInput,\n  SignPayloadResponseInput,\n  P2PPairingRequest,\n  BeaconErrorType,\n  BEACON_VERSION,\n  ErrorResponse,\n  getSenderId\n} from '@airgap/beacon-sdk';\nimport { ExtendedP2PPairingResponse } from '@airgap/beacon-sdk/dist/cjs/types/P2PPairingResponse';\nimport { Asset } from '../token/token.service';\nimport { TzktService } from '../indexer/tzkt/tzkt.service';\n@Injectable({\n  providedIn: 'root'\n})\nexport class BeaconService {\n  client: WalletClient = null;\n  peers = [];\n  permissions = [];\n  constructor(private messageService: MessageService, private tzktService: TzktService) {}\n  preNotifyPairing(pairInfoJson: string) {\n    const pairInfo: P2PPairingRequest = JSON.parse(pairInfoJson);\n    if (this.isNewPairingRequest(pairInfo)) {\n      this.messageService.addBeaconWait(`Pairing with ${pairInfo.name}. Please wait!`);\n    }\n  }\n  isNewPairingRequest(pairInfo: P2PPairingRequest): boolean {\n    const peersJson = localStorage.getItem('beacon:communication-peers-wallet');\n    let newPublicKey = true;\n    if (peersJson) {\n      const peers = JSON.parse(peersJson);\n      if (peers && peers.length > 0 && pairInfo.publicKey) {\n        for (const peer of peers) {\n          if (peer.publicKey && peer.publicKey === pairInfo.publicKey) {\n            newPublicKey = false;\n            console.log('Existing public key found!');\n            break;\n          }\n        }\n      }\n    }\n    return newPublicKey;\n  }\n  async addPeer(pairInfoJson: string, force = true) {\n    const pairInfo = JSON.parse(pairInfoJson);\n    console.log('PairInfo', pairInfo);\n    await this.client.addPeer(pairInfo, force);\n    this.syncBeaconState();\n    this.messageService.removeBeaconMsg();\n    if (pairInfo.icon && pairInfo.icon.startsWith('https://')) {\n      this.cacheIcon(pairInfo);\n    }\n  }\n  async cacheIcon(pairInfo: any) {\n    const key = 'beacon:communication-peers-wallet';\n    const asset: Asset = pairInfo.icon;\n    const json = localStorage.getItem(key);\n    if (!json || !asset) {\n      return;\n    }\n    const peers = JSON.parse(json);\n    if (peers) {\n      for (const peer of peers) {\n        if (peer.icon === pairInfo.icon) {\n          peer.cachedIcon = asset;\n          break;\n        }\n      }\n      localStorage.setItem(key, JSON.stringify(peers));\n      this.syncBeaconState();\n    }\n  }\n  async syncBeaconState() {\n    this.peers = await this.getPeers();\n    this.permissions = await this.getPermissions();\n  }\n  async removePeers() {\n    while (this.peers.length > 0) {\n      await this.removePeer(0);\n    }\n  }\n  async removePeer(index: number) {\n    const pairInfo: P2PPairingRequest = this.peers[index];\n    const senderId = await getSenderId(pairInfo.publicKey);\n    const peerResponse: ExtendedP2PPairingResponse = {\n      ...pairInfo,\n      type: 'p2p-pairing-response',\n      senderId\n    };\n    await this.client.removePeer(peerResponse);\n    await this.client.removeAppMetadata(senderId);\n    this.syncBeaconState();\n  }\n  async removePermissions() {\n    await this.client.removeAllPermissions();\n    this.syncBeaconState();\n  }\n  async removePermission(index: number) {\n    await this.client.removePermission(this.permissions[index].accountIdentifier);\n    this.syncBeaconState();\n  }\n  async getPeers(): Promise<any> {\n    return await this.client.getPeers();\n  }\n  async getPermissions(): Promise<any> {\n    return await this.client.getPermissions();\n  }\n  async getAppMetadataList(): Promise<any> {\n    return await this.client.getAppMetadataList();\n  }\n  async rejectOnPermission(message: any) {\n    await this.respondWithError(BeaconErrorType.NOT_GRANTED_ERROR, message);\n  }\n  async rejectOnNetwork(message: any) {\n    await this.respondWithError(BeaconErrorType.NETWORK_NOT_SUPPORTED, message);\n  }\n  async rejectOnUserAbort(message: any) {\n    await this.respondWithError(BeaconErrorType.ABORTED_ERROR, message);\n  }\n  async rejectOnSourceAddress(message: any) {\n    await this.respondWithError(BeaconErrorType.NO_PRIVATE_KEY_FOUND_ERROR, message);\n  }\n  async rejectOnTooManyOps(message: any) {\n    await this.respondWithError(BeaconErrorType.TOO_MANY_OPERATIONS, message);\n  }\n  async rejectOnUnknown(message: any) {\n    await this.respondWithError(BeaconErrorType.UNKNOWN_ERROR, message);\n  }\n  async rejectOnParameters(message: any) {\n    await this.respondWithError(BeaconErrorType.PARAMETERS_INVALID_ERROR, message);\n  }\n  async rejectOnBroadcastError(message: any) {\n    await this.respondWithError(BeaconErrorType.BROADCAST_ERROR, message);\n  }\n  async respondWithError(errorType: BeaconErrorType, requestMessage: any) {\n    if (requestMessage) {\n      const response: ErrorResponse = {\n        type: BeaconMessageType.Error,\n        errorType,\n        version: BEACON_VERSION,\n        id: requestMessage.id,\n        senderId: await this.client.beaconId\n      };\n      await this.client.respond(response);\n    }\n  }\n  async approvePermissionRequest(message: any, publicKey: string) {\n    const response: PermissionResponseInput = {\n      type: BeaconMessageType.PermissionResponse,\n      network: message.network,\n      scopes: message.scopes,\n      id: message.id,\n      publicKey: publicKey\n    };\n    await this.client.respond(response);\n  }\n  async approveSignPayloadRequest(message: any, signature: string) {\n    const response: SignPayloadResponseInput = {\n      type: BeaconMessageType.SignPayloadResponse,\n      id: message.id,\n      signingType: message.signingType,\n      signature\n    };\n    await this.client.respond(response);\n  }\n  async responseSync() {\n    localStorage.setItem('beacon:request-response', 'true');\n    localStorage.removeItem('beacon:request-response');\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ChartSeries } from '../../../app/components/ui/chart/chart.component';\nimport { SwapLiquidityService } from '../swap-liquidity/swap-liquidity.service';\n\nexport enum ChartTitle {\n  XTZtzBTC = 'XTZ/tzBTC',\n  tzBTCXTZ = 'tzBTC/XTZ',\n  totalValueLocked = 'Total Value Locked'\n}\n\nlet width, height, gradient;\nfunction getGradientBackground(ctx, chartArea) {\n  const style = getComputedStyle(document.body);\n  const theme = style.getPropertyValue('--theme').replace(/[ \\\"]/g, '');\n  const chartWidth = chartArea.right - chartArea.left;\n  const chartHeight = chartArea.bottom - chartArea.top;\n  if (gradient === null || width !== chartWidth || height !== chartHeight) {\n    width = chartWidth;\n    height = chartHeight;\n    gradient = ctx.createLinearGradient(0, chartArea.bottom, 0, chartArea.top);\n    if (theme === 'dark') {\n      gradient.addColorStop(1, '#383d7d');\n      gradient.addColorStop(0.5, '#2e304f');\n      gradient.addColorStop(0, '#2a2c3f');\n    } else {\n      gradient.addColorStop(1, '#c2c5fc');\n      gradient.addColorStop(0.5, '#e0e1fb');\n      gradient.addColorStop(0, '#e8eafb');\n    }\n  }\n\n  return gradient;\n}\n\n@Injectable({ providedIn: 'root' })\nexport class ChartService {\n  ChartTitle = ChartTitle;\n  stats = null;\n  constructor(private swapLiquidityService: SwapLiquidityService) {}\n\n  async fetchLBGraphData(series: ChartSeries = ChartSeries.day): Promise<{ labels: any[]; datasets: any[] }> {\n    let tzbtc = await this.fetchHistoricalQuotesByContract(this.swapLiquidityService.tzBTCContract + '_0', series);\n    let stats = (this.stats = !this.stats ? await this.fetchHistoricalStatsByContract(this.swapLiquidityService.lqdContract, series) : this.stats);\n    let interval = 1000 * 60 * 60 * 24;\n    const a = [];\n    const b = [];\n    const d = [];\n    const labels = [];\n    let now = new Date().getTime();\n    if (series === ChartSeries.month) {\n      interval = 1000 * 60 * 60 * 24;\n      tzbtc = tzbtc.slice(0, 32);\n      stats = stats.slice(0, 32);\n    } else if (series === ChartSeries.day) {\n      interval = 1000 * 60 * 60;\n      tzbtc = tzbtc.slice(0, 25);\n      stats = stats.slice(0, 25);\n    } else if (series === ChartSeries.week) {\n      interval = 1000 * 60 * 60 * 4;\n      tzbtc = tzbtc.slice(0, 7 * 24).filter((e, i) => i % 4 === 0);\n      stats = stats.slice(0, 7 * 24).filter((e, i) => i % 4 === 0);\n    } else if (series === ChartSeries.year) {\n      interval = 1000 * 60 * 60 * 24 * 31;\n      tzbtc = tzbtc.slice(0, 365).filter((e, i) => i % 31 === 0);\n      stats = stats.slice(0, 365).filter((e, i) => i % 31 === 0);\n    }\n    tzbtc = tzbtc.reverse();\n    stats = stats.reverse();\n    for (let i = 0; i < tzbtc.length; ++i) {\n      a.push(1 / parseFloat(tzbtc[i].close));\n      b.push(parseFloat(tzbtc[i].close));\n      if (stats[i]?.tvlUsd) {\n        d.push(parseFloat(stats[i].tvlUsd));\n      }\n      const c = new Date((now -= interval));\n      if (series === ChartSeries.month) {\n        labels.push(c.toLocaleString('en-US', { month: 'short' }) + ' ' + c.getDate());\n      } else if (series === ChartSeries.day) {\n        labels.push('' + c.getHours() + ':00');\n      } else if (series === ChartSeries.week) {\n        labels.push(c.toLocaleString('en-US', { month: 'short' }) + ' ' + c.getDate() + ' ' + (c.getHours() + 1) + ':00');\n      } else if (series === ChartSeries.year) {\n        labels.push(c.toLocaleString('en-US', { month: 'short' }) + ' ' + c.getDate());\n      }\n    }\n    const defaultDatasetValues = {\n      hidden: true,\n      backgroundColor: function (context) {\n        const chart = context.chart;\n        const { ctx, chartArea } = chart;\n\n        if (!chartArea) {\n          return null;\n        }\n        return getGradientBackground(ctx, chartArea);\n      },\n      borderColor: '#5963ff88',\n      borderRadius: 1,\n      borderWidth: 3,\n      pointBorderWidth: 0,\n      pointBackgroundColor: '#5963ff88',\n      pointBorderColor: '#5963ff88',\n      pointRadius: 0,\n      pointHoverBorderWidth: 6,\n      pointHoverColor: '#5963ff88',\n      pointHitRadius: 6,\n      fill: true\n    };\n    const datasets = [\n      {\n        label: ChartTitle.XTZtzBTC,\n        data: a,\n        ...defaultDatasetValues\n      },\n      {\n        label: ChartTitle.tzBTCXTZ,\n        data: b,\n        ...defaultDatasetValues\n      },\n      {\n        label: ChartTitle.totalValueLocked,\n        data: d,\n        ...defaultDatasetValues\n      }\n    ];\n    return { datasets, labels: labels.reverse() };\n  }\n\n  async fetchHistoricalQuotesByContract(\n    contract: string = 'KT1TxqZ8QtKvLu3V3JH7Gx58n7Co8pgtpQU5',\n    series: ChartSeries = ChartSeries.day,\n    offset: number = 0\n  ): Promise<any> {\n    const baseUrl = `https://dex.dipdup.net/v1/graphql`;\n    let req;\n    if (series === ChartSeries.month || series === ChartSeries.year) {\n      req = {\n        query: `{quotes1d(offset: ${offset} limit: 100 where: {exchangeId:{_eq: \"${this.swapLiquidityService.lqdContract}\"} tokenId: {_eq: \"${contract}\"}, close: {_is_null: false}}) { close }}`\n      };\n    } else if (series === ChartSeries.day || series === ChartSeries.week) {\n      req = {\n        query: `{quotes1h(offset: ${offset} limit: 100 where: {exchangeId:{_eq: \"${this.swapLiquidityService.lqdContract}\"} tokenId: {_eq: \"${contract}\"}, close: {_is_null: false}}) { close }}`\n      };\n    }\n    try {\n      let result = await (\n        await fetch(baseUrl, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(req)\n        })\n      ).json();\n      if (series === ChartSeries.week) {\n        if (result.data?.quotes1h.length === 100) {\n          result = result?.data?.quotes1h;\n          offset += 100;\n          return result.concat(await this.fetchHistoricalQuotesByContract(this.swapLiquidityService.tzBTCContract + '_0', series, offset));\n        } else {\n          return result?.data?.quotes1h;\n        }\n      }\n      if (series === ChartSeries.month) {\n        return result?.data?.quotes1d;\n      } else if (series === ChartSeries.day) {\n        return result?.data?.quotes1h;\n      } else if (series === ChartSeries.year) {\n        if (result.data?.quotes1d.length === 100) {\n          result = result?.data?.quotes1d;\n          offset += 100;\n          return result.concat(await this.fetchHistoricalQuotesByContract(this.swapLiquidityService.tzBTCContract + '_0', series, offset));\n        } else {\n          return result?.data?.quotes1d;\n        }\n      }\n    } catch (e) {\n      return [];\n    }\n  }\n\n  async fetchHistoricalStatsByContract(\n    contract: string = 'KT1TxqZ8QtKvLu3V3JH7Gx58n7Co8pgtpQU5',\n    series: string = 'day',\n    offset: number = 0\n  ): Promise<Array<any>> {\n    const baseUrl = `https://dex.dipdup.net/v1/graphql`;\n    let req;\n    if (series === 'day') {\n      req = {\n        query: `{  stats1d(\n        where: {exchangeId: {_eq: \"${contract}\"}, bucket: {_is_null: false}, tvlUsd: {_is_null: false}}\n      ) {\n        bucket\n        exchangeId\n        interactions\n        sharePx\n        sharePxBtc\n        sharePxUsd\n        tvl\n        tvlBtc\n        tvlUsd\n        users\n      }}`\n      };\n    } else if (series === 'week') {\n      req = {\n        query: `{  stats1d(\n        where: {exchangeId: {_eq: \"${contract}\"}, bucket: {_is_null: false}, tvlUsd: {_is_null: false}}\n      ) {\n        bucket\n        exchangeId\n        interactions\n        sharePx\n        sharePxBtc\n        sharePxUsd\n        tvl\n        tvlBtc\n        tvlUsd\n        users\n      }}`\n      };\n    } else if (series === 'month') {\n      req = {\n        query: `{  stats1d(\n        where: {exchangeId: {_eq: \"${contract}\"}, bucket: {_is_null: false}, tvlUsd: {_is_null: false}}\n      ) {\n        bucket\n        exchangeId\n        interactions\n        sharePx\n        sharePxBtc\n        sharePxUsd\n        tvl\n        tvlBtc\n        tvlUsd\n        users\n      }}`\n      };\n    } else if (series === 'year') {\n      req = {\n        query: `{  stats1d(\n        where: {exchangeId: {_eq: \"${contract}\"}, bucket: {_is_null: false}, tvlUsd: {_is_null: false}}\n      ) {\n        bucket\n        exchangeId\n        interactions\n        sharePx\n        sharePxBtc\n        sharePxUsd\n        tvl\n        tvlBtc\n        tvlUsd\n        users\n      }}`\n      };\n    }\n    try {\n      let result = await (\n        await fetch(baseUrl, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(req)\n        })\n      ).json();\n      if (series === ChartSeries.week) {\n        if (result.data?.stats1d.length === 100) {\n          result = result?.data?.stats1d;\n          offset += 100;\n          return result.concat(await this.fetchHistoricalStatsByContract(this.swapLiquidityService.tzBTCContract + '_0', series, offset));\n        } else {\n          return result?.data?.stats1d;\n        }\n      }\n      if (series === ChartSeries.month) {\n        return result?.data?.stats1d;\n      } else if (series === ChartSeries.day) {\n        return result?.data?.stats1d;\n      } else if (series === ChartSeries.year) {\n        return result?.data?.stats1d;\n      }\n    } catch {\n      return [];\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HubConnectionBuilder } from '@microsoft/signalr';\nimport { CONSTANTS } from '../../../../environments/environment';\nimport { WalletService } from '../../wallet/wallet.service';\nimport { Account, OpStatus } from '../../wallet/wallet';\nimport { ActivityService } from '../../activity/activity.service';\nimport { OperationService } from '../../operation/operation.service';\nimport { BalanceService } from '../../balance/balance.service';\nimport { DelegateService } from '../../delegate/delegate.service';\nimport { timeout } from 'rxjs/operators';\nimport { of } from 'rxjs';\n@Injectable({\n  providedIn: 'root'\n})\nexport class SignalService {\n  connection: any = null;\n  constructor(\n    private walletService: WalletService,\n    private activityService: ActivityService,\n    private operationService: OperationService,\n    private balanceService: BalanceService,\n    private delegateService: DelegateService\n  ) {\n    this.init();\n  }\n  async init() {\n    this.connection = new HubConnectionBuilder().withUrl(`https://api.${CONSTANTS.NETWORK}.tzkt.io/v1/events`).build();\n    this.connection.on('operations', (msg) => {\n      for (const op of msg.data) {\n        if (op?.status === 'applied') {\n          console.log('%csignalR msg', 'color: green;', op);\n          const sender: string = op?.sender?.address ?? '';\n          const target: string = op?.target?.address ?? '';\n          const opHash: string = op?.hash ?? '';\n          const invoke: boolean = !!op?.parameter;\n          this.confirmStatus(opHash, sender, op.timestamp, invoke);\n          this.confirmStatus(opHash, target, op.timestamp, invoke);\n        }\n      }\n    });\n    this.connection.onclose(async () => {\n      await this.start();\n    });\n    this.start();\n  }\n  confirmStatus(opHash: string, address: string, timestamp: string, invoke: boolean) {\n    if (opHash && address && this.walletService.wallet) {\n      if (this.walletService.wallet) {\n        const account: Account = this.walletService.wallet.getAccount(address);\n        if (account) {\n          for (let i in account.activities) {\n            if (account.activities[i].hash === opHash && account.activities[i].status === OpStatus.UNCONFIRMED) {\n              account.activities[i].timestamp = new Date(timestamp).getTime();\n              if (invoke) {\n                account.activities[i].status = OpStatus.HALF_CONFIRMED;\n              } else {\n                account.activities[i].status = OpStatus.CONFIRMED;\n                this.activityService.promptNewActivities(account, [], [account.activities[i]]);\n                this.updateAccountData(address);\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n  updateAccountData(pkh: string) {\n    this.operationService.getAccount(pkh).subscribe((ans: any) => {\n      if (ans.success) {\n        this.balanceService.updateAccountBalance(this.walletService.wallet?.getAccount(pkh), Number(ans.payload.balance));\n        const acc = this.walletService.wallet?.getAccount(pkh);\n        this.delegateService.handleDelegateResponse(acc, ans.payload.delegate);\n      } else {\n      }\n    });\n  }\n\n  async start() {\n    try {\n      if (!!this.connection?.start) {\n        await this.connection?.start();\n        console.log('%cSignalR Connected!', 'color:green;');\n      } else {\n        setTimeout(() => {\n          this.start();\n        }, 5000);\n      }\n    } catch (err) {\n      console.log(err);\n      setTimeout(() => {\n        this.start();\n      }, 5000);\n    }\n  }\n\n  async subscribeToAccount(address: string) {\n    console.log('Listen to: ' + address);\n    await this.connection.invoke('SubscribeToOperations', {\n      address,\n      types: 'transaction,delegation,origination'\n    });\n  }\n  ngOnDestroy(): void {\n    try {\n      this.connection.stop();\n      console.log('%cSignalR Disconnected!', 'color:red;');\n    } catch (e) {}\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ActivityService } from '../activity/activity.service';\nimport { TzrateService } from '../tzrate/tzrate.service';\nimport { BalanceService } from '../balance/balance.service';\nimport { WalletService } from '../wallet/wallet.service';\nimport { DelegateService } from '../delegate/delegate.service';\nimport { OperationService } from '../operation/operation.service';\nimport { Account, OpStatus } from '../wallet/wallet';\nimport Big from 'big.js';\nimport { TokenService } from '../token/token.service';\nimport { LookupService } from '../lookup/lookup.service';\nimport { CONSTANTS } from '../../../environments/environment';\nimport { SubjectService } from '../subject/subject.service';\nimport { TeztoolsService } from '../indexer/teztools/teztools.service';\nimport { interval } from 'rxjs';\nimport { SignalService } from '../indexer/signal/signal.service';\nimport { UnlockableService } from '../unlockable/unlockable.service';\n\nexport interface ScheduleData {\n  pkh: string;\n  state: State;\n  interval: any;\n  stateCounter: number;\n}\nenum State {\n  UpToDate,\n  Wait,\n  Updating\n}\n\n@Injectable()\nexport class CoordinatorService {\n  scheduler: Map<string, any> = new Map<string, any>(); // pkh + delay\n  defaultDelayActivity = CONSTANTS.MAINNET ? 60000 : 30000; // 60/30s\n  shortDelayActivity = 5000; // 5s\n  longDelayActivity = 120000; // 2m\n  defaultDelayPrice = 300000; // 5m\n  tzrateInterval: any;\n  accounts: Account[];\n  constructor(\n    private activityService: ActivityService,\n    private tzrateService: TzrateService,\n    private walletService: WalletService,\n    private balanceService: BalanceService,\n    private delegateService: DelegateService,\n    private operationService: OperationService,\n    private tokenService: TokenService,\n    private teztoolsService: TeztoolsService,\n    private lookupService: LookupService,\n    private subjectService: SubjectService,\n    private signalService: SignalService,\n    private unlockableService: UnlockableService\n  ) {\n    this.subjectService.logout.subscribe((o) => {\n      if (!!o) {\n        this.stopAll();\n      }\n    });\n    this.subjectService.activeAccount.subscribe((activeAccount) => {\n      if (this.walletService.wallet) {\n        this.accounts = this.walletService.wallet.getAccounts();\n        this.accounts.forEach(({ address }) => {\n          if (address === activeAccount?.address) {\n            this.start(activeAccount.address, this.defaultDelayActivity);\n          } else {\n            this.start(address, this.longDelayActivity);\n          }\n        });\n        this.startXTZ();\n      }\n    });\n  }\n  startXTZ() {\n    if (!this.tzrateInterval) {\n      console.log('Start scheduler XTZ');\n      const update = () => {\n        this.tzrateService.getTzrate();\n        this.teztoolsService.getMarkets();\n        this.lookupService.recheckWalletAddresses(true);\n      };\n      this.tzrateInterval = interval(this.defaultDelayPrice).subscribe(() => update());\n      update();\n    }\n  }\n  async start(pkh: string, delay: number) {\n    this.unlockableService.restoreFeatures();\n    if (pkh && !this.scheduler.get(pkh)) {\n      this.accounts = this.walletService.wallet.getAccounts();\n      console.log('Start scheduler ' + this.scheduler.size + ' ' + pkh);\n      const scheduleData: ScheduleData = {\n        pkh: pkh,\n        state: State.UpToDate,\n        interval: interval(this.defaultDelayActivity).subscribe(() => this.update(pkh)),\n        stateCounter: 0\n      };\n      this.scheduler.set(pkh, scheduleData);\n      this.update(pkh);\n      this.updateAccountData(pkh);\n    } else if (pkh && this.scheduler.get(pkh)) {\n      this.setDelay(pkh, delay);\n    }\n  }\n  async boost(pkh: string, metadata: any = null) {\n    // Expect action\n    console.log('boost ' + pkh);\n    if (this.walletService.addressExists(pkh)) {\n      if (metadata) {\n        this.addUnconfirmedOperations(pkh, metadata);\n      }\n      if (!this.scheduler.get(pkh)) {\n        await this.start(pkh, this.defaultDelayActivity);\n      }\n      this.signalService.subscribeToAccount(pkh);\n      if (this.scheduler.get(pkh).state !== State.Wait) {\n        this.changeState(pkh, State.Wait);\n        this.update(pkh);\n        const counter = this.scheduler.get(pkh).stateCounter;\n        setTimeout(() => {\n          // Failsafe\n          if (this.scheduler?.size && this.scheduler.get(pkh).stateCounter === counter) {\n            console.log('Timeout from wait state');\n            this.changeState(pkh, State.UpToDate);\n          }\n        }, 150000);\n      }\n    }\n  }\n  async update(pkh) {\n    this.setDelay(pkh, this.defaultDelayActivity);\n    this.activityService.updateTransactions(pkh).subscribe(\n      (ans: any) => {\n        switch (this.scheduler.get(pkh) ? this.scheduler.get(pkh).state : -1) {\n          case State.UpToDate: {\n            if (!ans.upToDate) {\n              this.changeState(pkh, State.Updating);\n            } else if (ans?.balance) {\n              const balance = this.walletService.wallet?.getAccount(pkh).balanceXTZ;\n              if (balance !== ans.balance) {\n                console.log('recheck balance');\n                this.updateAccountData(pkh);\n              }\n            }\n            break;\n          }\n          case State.Wait: {\n            if (!ans.upToDate) {\n              this.changeState(pkh, State.Updating);\n            } else {\n              this.setDelay(pkh, this.shortDelayActivity);\n            }\n            break;\n          }\n          case State.Updating: {\n            if (ans.upToDate) {\n              this.changeState(pkh, State.UpToDate);\n            } else {\n              this.setDelay(pkh, this.shortDelayActivity);\n            }\n            break;\n          }\n          default: {\n            console.log('No state found!');\n            break;\n          }\n        }\n        const acc = this.walletService.wallet?.getAccount(pkh);\n        if (acc?.activities?.length) {\n          const latestActivity = acc.activities[0];\n          if (latestActivity.status === OpStatus.UNCONFIRMED) {\n            const age = new Date().getTime() - new Date(latestActivity.timestamp).getTime();\n            if (age > 1800000) {\n              // 30m\n              acc.activities.shift();\n              this.walletService.storeWallet();\n            }\n          }\n        }\n      },\n      (err) => {\n        console.log('Error in update()');\n        console.error(err);\n      },\n      () => {\n        console.log(\n          `account[${this.accounts.findIndex((a) => a.address === pkh)}][${\n            typeof this.scheduler.get(pkh)?.state !== 'undefined' ? this.scheduler.get(pkh).state : '*'\n          }]: <<`\n        );\n      }\n    );\n  }\n  changeState(pkh: string, newState: State) {\n    const scheduleData: ScheduleData = this.scheduler.get(pkh);\n    scheduleData.state = newState;\n    if (newState === State.UpToDate || newState === State.Updating) {\n      this.updateAccountData(pkh);\n    }\n    if (newState === State.Wait || newState === State.Updating) {\n      scheduleData.interval.unsubscribe();\n      scheduleData.interval = interval(this.shortDelayActivity).subscribe(() => this.update(pkh));\n    }\n    scheduleData.stateCounter++;\n    this.scheduler.set(pkh, scheduleData);\n  }\n  setDelay(pkh: string, time: number) {\n    const scheduleData: ScheduleData = this.scheduler.get(pkh);\n    if (scheduleData.interval) {\n      scheduleData.interval.unsubscribe();\n    }\n    scheduleData.interval = interval(time).subscribe(() => this.update(pkh));\n    this.scheduler.set(pkh, scheduleData);\n  }\n  stopAll() {\n    if (this.walletService.wallet) {\n      if (this.accounts?.length) {\n        console.log('Stop all schedulers');\n        for (const account of this.accounts) {\n          this.stop(account.address);\n        }\n      }\n      if (this.tzrateInterval) {\n        this.tzrateInterval.unsubscribe();\n        this.tzrateInterval = null;\n      }\n    }\n  }\n  async stop(pkh) {\n    console.log('Stop scheduler ' + this.accounts.findIndex((a) => a.address === pkh));\n    if (this.scheduler.get(pkh)) {\n      this.scheduler.get(pkh).interval.unsubscribe();\n      this.scheduler.get(pkh).interval = null;\n      this.scheduler.delete(pkh);\n    }\n  }\n  updateAccountData(pkh: string) {\n    // Maybe also check for originations to account?\n    console.log('update account data for ' + pkh);\n    this.operationService.getAccount(pkh).subscribe((ans: any) => {\n      if (ans.success) {\n        this.balanceService.updateAccountBalance(this.walletService.wallet?.getAccount(pkh), Number(ans.payload.balance));\n        const acc = this.walletService.wallet?.getAccount(pkh);\n        this.delegateService.handleDelegateResponse(acc, ans.payload.delegate);\n      } else {\n        console.log('updateAccountData -> getAccount failed ', ans.payload.msg);\n      }\n    });\n  }\n  addUnconfirmedOperations(from: string, metadata: any) {\n    if (metadata.transactions) {\n      console.log('Unconfirmed transactions:');\n      console.log(metadata.transactions);\n      const decimals =\n        metadata.tokenTransfer && this.tokenService.getAsset(metadata.tokenTransfer) ? this.tokenService.getAsset(metadata.tokenTransfer).decimals : 6;\n      for (const op of metadata.transactions) {\n        const transaction = {\n          type: 'transaction',\n          status: OpStatus.UNCONFIRMED,\n          amount: Big(op.amount)\n            .times(10 ** decimals)\n            .toString(),\n          fee: null,\n          source: { address: from },\n          destination: { address: op.destination },\n          hash: metadata.opHash,\n          block: null,\n          timestamp: new Date().getTime(),\n          tokenId: metadata.tokenTransfer ? metadata.tokenTransfer : undefined,\n          entrypoint: op.parameters?.entrypoint ? op.parameters.entrypoint : ''\n        };\n        let account = this.walletService.wallet?.getAccount(from);\n        account.activities.unshift(transaction);\n        account = this.walletService.wallet?.getAccount(op.destination);\n        if (account) {\n          account.activities.unshift({ ...transaction });\n        }\n      }\n    } else if (metadata.delegate !== undefined) {\n      const delegation = {\n        type: 'delegation',\n        status: OpStatus.UNCONFIRMED,\n        amount: null,\n        fee: null,\n        source: { address: from },\n        destination: { address: metadata.delegate },\n        hash: metadata.opHash,\n        block: null,\n        timestamp: new Date().getTime()\n      };\n      const account = this.walletService.wallet?.getAccount(from);\n      account?.activities.unshift(delegation);\n    } else if (metadata.origination !== undefined) {\n      const origination = {\n        type: 'origination',\n        status: OpStatus.UNCONFIRMED,\n        amount: metadata.origination.balance,\n        fee: null,\n        source: { address: from },\n        destination: { address: metadata.kt1 },\n        hash: metadata.opHash,\n        block: null,\n        timestamp: new Date().getTime()\n      };\n      const account = this.walletService.wallet?.getAccount(from);\n      account?.activities.unshift(origination);\n    } else {\n      console.log('Unknown metadata', metadata);\n    }\n    this.walletService.storeWallet();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Params } from '@angular/router';\nimport { OperationService } from '../operation/operation.service';\nimport { WalletService } from '../../services/wallet/wallet.service';\nimport { MessageService } from '../../services/message/message.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DeeplinkService {\n  private pairingJson = '';\n  constructor(private operationService: OperationService, private walletService: WalletService, private messageService: MessageService) {}\n  set(params: Params) {\n    console.log(params);\n    this.pairingJson = this.extractPairingJson(params);\n    if (this.pairingJson && !this.walletService.wallet) {\n      this.messageService.addWarning('Access your wallet to complete the pairing');\n    }\n    console.log(this.pairingJson);\n  }\n  extractPairingJson(params: Params): string {\n    if (params.type === 'tzip10' && params.data) {\n      try {\n        return this.operationService.b58cdecode(params.data, '').toString();\n      } catch (e) {\n        return '';\n      }\n    }\n    return '';\n  }\n  popPairingJson(): string {\n    const pairingJson = this.pairingJson;\n    this.pairingJson = '';\n    return pairingJson;\n  }\n  QRtoPairingJson(qrPayload: string): string {\n    if (qrPayload.length > 26 && qrPayload.slice(0, 26) === 'tezos://?type=tzip10&data=') {\n      qrPayload = qrPayload.slice(26);\n    }\n    try {\n      return this.operationService.b58cdecode(qrPayload, '').toString();\n    } catch {}\n    return '';\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { WalletService } from '../wallet/wallet.service';\nimport { OperationService } from '../operation/operation.service';\nimport { Account } from '../wallet/wallet';\nimport { CONSTANTS } from '../../../environments/environment';\nimport { BehaviorSubject } from 'rxjs';\nimport { take } from 'rxjs/operators';\n\n@Injectable()\nexport class DelegateService {\n  private readonly network = CONSTANTS.NETWORK.replace('edonet', 'edo2net');\n  public readonly bcd = 'https://api.baking-bad.org/v2';\n  public readonly tzkt = `https://staging.api.${this.network}.tzkt.io/v1`;\n  public delegates = new BehaviorSubject<any>([]);\n\n  constructor(private walletService: WalletService, private operationService: OperationService) {\n    this.getDelegates();\n  }\n  getDelegate(account: Account) {\n    this.operationService.getDelegate(account.address).subscribe(\n      (data: any) => {\n        if (data.success) {\n          this.handleDelegateResponse(account, data.payload.delegate);\n        }\n      },\n      (err) => console.log(JSON.stringify(err))\n    );\n  }\n  handleDelegateResponse(account: Account, data: any) {\n    if (data) {\n      if (account.delegate !== data) {\n        account.delegate = data;\n        this.walletService.storeWallet();\n      } else {\n        console.log('delegate for ' + account.address + ' up to date');\n      }\n    } else {\n      if (account.delegate !== '') {\n        account.delegate = '';\n        this.walletService.storeWallet();\n      }\n    }\n  }\n  getDelegates(): void {\n    fetch(`${this.bcd}/bakers`)\n      .then((response) => response.json())\n      .then((d) => this.delegates.next(d));\n  }\n\n  resolveDelegateByAddress(address: string): Promise<any> {\n    return new Promise((resolve) => {\n      this.delegates.pipe(take(1)).subscribe((d) => resolve(d?.find((d) => d?.address === address)));\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport * as pbkdf2 from 'pbkdf2';\nimport * as AES from 'aes-js';\nimport * as scrypt from 'scryptsy';\nimport * as cryptob from 'crypto-browserify';\nimport * as forge from 'node-forge';\ndeclare const Buffer;\n@Injectable()\nexport class EncryptionService {\n  constructor() {}\n  async encrypt(plaintext: any, password: string, version: number, salt: string = null): Promise<any> {\n    if (version === 1) {\n      throw new Error('Encryption version no longer supported');\n    } else if (version === 2) {\n      return this.encrypt_v2(plaintext, password);\n    } else if (version === 3) {\n      return this.encrypt_v2(plaintext, password, salt);\n    } else {\n      throw new Error('Unrecognized encryption format');\n    }\n  }\n  async decrypt(chiphertext: string, password: string, salt: string, version: number): Promise<any> {\n    if (version === 1) {\n      return this.decrypt_v1(chiphertext, password, salt);\n    } else if (version === 2 || version === 3) {\n      return this.decrypt_v2(chiphertext, password, salt);\n    } else {\n      throw new Error('Unrecognized encryption format');\n    }\n  }\n  // Version 1\n  async encrypt_v1(plaintext: any, password: string, salt: string): Promise<string> {\n    return new Promise((resolve) => {\n      try {\n        if (!password || !salt) {\n          throw new Error('Missing password or salt');\n        }\n        pbkdf2.pbkdf2(password, salt, 10000, 32, 'sha512', (err, key) => {\n          if (err) {\n            throw err;\n          }\n          const aesCtr = new AES.ModeOfOperation.ctr(key);\n          let chiphertext = aesCtr.encrypt(plaintext);\n          chiphertext = AES.utils.hex.fromBytes(chiphertext);\n          resolve(chiphertext);\n        });\n      } catch (e) {\n        console.warn(e);\n        resolve('');\n      }\n    });\n  }\n  async decrypt_v1(chiphertext: string, password: string, salt: string): Promise<any> {\n    return new Promise((resolve) => {\n      try {\n        if (!password || !salt) {\n          throw new Error('Missing password or salt');\n        }\n        pbkdf2.pbkdf2(password, salt, 10000, 32, 'sha512', (err, key) => {\n          if (err) {\n            throw err;\n          }\n          chiphertext = AES.utils.hex.toBytes(chiphertext);\n          const aesCtr = new AES.ModeOfOperation.ctr(key);\n          const plaintext = aesCtr.decrypt(chiphertext);\n          resolve(plaintext);\n        });\n      } catch (e) {\n        resolve('');\n      }\n    });\n  }\n  // Version 2\n  async encrypt_v2(plaintext: any, password: string, salt?: string): Promise<any> {\n    if (!password) {\n      throw new Error('Missing password');\n    }\n    let salty;\n    if (salt) {\n      salty = new Buffer(salt, 'hex');\n    } else {\n      salty = cryptob.randomBytes(16);\n    }\n    const key = await scrypt.async(password, salty, 65536, 8, 1, 32);\n    const cipher: any = forge.cipher.createCipher('AES-GCM', key.toString('binary'));\n    cipher.start({\n      iv: salty\n    });\n    const byteStringBuffer = forge.util.createBuffer(plaintext.toString('binary'), 'utf-8');\n    cipher.update(byteStringBuffer);\n    cipher.finish();\n    const chiphertext = cipher.output.toHex() + '==' + cipher.mode.tag.toHex();\n    return { chiphertext: chiphertext, iv: salty.toString('hex') };\n  }\n  async decrypt_v2(chipher: string, password: string, salt: string): Promise<string> {\n    try {\n      if (!password || !salt) {\n        throw new Error('Missing password or salt');\n      }\n      const parts = chipher.split('==');\n      const chiphertext = parts[0];\n      const tag = parts[1];\n      const key = await scrypt.async(password, new Buffer(salt, 'hex'), 65536, 8, 1, 32);\n      const decipher: any = forge.cipher.createDecipher('AES-GCM', key.toString('binary'));\n      decipher.start({\n        iv: new Buffer(salt, 'hex'),\n        tag: forge.util.createBuffer(new Buffer(tag, 'hex').toString('binary'), 'utf-8') // authentication tag from encryption\n      });\n      decipher.update(forge.util.createBuffer(new Buffer(chiphertext, 'hex').toString('binary'), 'utf-8'));\n      const pass = decipher.finish();\n      if (pass) {\n        return new Buffer(decipher.output.toHex(), 'hex');\n      } else {\n        return null;\n      }\n    } catch (err) {\n      return null;\n    }\n  }\n  shiftIV(salt: string, offset: number) {\n    if (!Number.isInteger(offset) || offset > 255 || offset < 1) {\n      throw new Error('Invalid offset for IV');\n    }\n    const buf = new Buffer(salt, 'hex');\n    buf[13] = (buf[13] + offset) % 256;\n    return buf.toString('hex');\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { OperationService } from '../operation/operation.service';\nimport { flatMap, catchError } from 'rxjs/operators';\nimport { of, Observable } from 'rxjs';\nimport { DefaultTransactionParams, OpLimits } from '../../interfaces';\nimport Big from 'big.js';\nimport { CONSTANTS } from '../../../environments/environment';\nimport { InputValidationService } from '../input-validation/input-validation.service';\n\nconst httpOptions = { headers: { 'Content-Type': 'application/json' } };\n@Injectable()\nexport class EstimateService {\n  readonly costPerByte = '250';\n  readonly revealGasLimit = 1000;\n  readonly contractsOverride: Record<string, OpLimits>;\n  queue = [];\n  nodeURL = CONSTANTS.NODE_URL;\n  pkh: string;\n  pk: string;\n  hash: string;\n  chainId: string;\n  manager: string;\n  counter: number;\n  constructor(private http: HttpClient, private operationService: OperationService, private imputValidationService: InputValidationService) {\n    this.contractsOverride = CONSTANTS.CONTRACT_OVERRIDES;\n  }\n  init(hash: string, chainId: string, counter: number, manager: string, pk: string, pkh: string) {\n    this.hash = hash;\n    this.chainId = chainId;\n    this.counter = counter;\n    this.manager = manager;\n    this.pk = pk;\n    this.pkh = pkh;\n  }\n  async preLoadData(pkh: string, pk: string) {\n    this.pkh = pkh;\n    this.pk = pk;\n    const [head, counter, manager] = await Promise.all([this.operationService.getHeader().toPromise(), this.getCounter(pkh), this.getManager(pkh)]);\n    if (head && counter && (manager || manager === null)) {\n      this.init(head.hash, head.chain_id, counter, manager, pk, pkh);\n    }\n  }\n  public async estimateTransactions(transactions: any, from: string, tokenTransfer: string = '', callback) {\n    this.estimate(transactions, from, tokenTransfer, callback, false);\n  }\n  public async estimateOrigination(origination: any, from: string, callback) {\n    this.estimate([origination], from, '', callback, true);\n  }\n  private async estimate(transactions: any, from: string, tokenTransfer: string = '', callback, isOrigination: boolean) {\n    this.queue.push({ transactions, from, callback });\n    if (this.queue.length === 1) {\n      while (this.queue.length > 0) {\n        while (this.queue.length > 1) {\n          this.queue[0].callback(null);\n          this.queue.shift();\n        }\n        let retry = false;\n        for (let i = 0; i < 1 || (retry && i < 2); i++) {\n          await this._estimate(this.queue[0].transactions, this.queue[0].from, tokenTransfer, isOrigination)\n            .then((res) => {\n              this.queue[0].callback(res);\n            })\n            .catch(async (error) => {\n              if (error.message && error.message === 'An operation assumed a contract counter in the past' && !retry) {\n                console.log('Update counter');\n                await this.preLoadData(this.pkh, this.pk);\n                retry = true;\n              } else {\n                this.queue[0].callback({ error });\n              }\n            });\n        }\n        this.queue.shift();\n      }\n    }\n  }\n  private async _estimate(operations: any, from: string, tokenTransfer: string, isOrigination: boolean = false): Promise<any> {\n    if (!this.hash) {\n      return null;\n    }\n    const simulation = {\n      fee: 0,\n      gasLimit: Math.min(\n        CONSTANTS.HARD_LIMITS.hard_gas_limit_per_operation,\n        Math.floor(CONSTANTS.HARD_LIMITS.hard_gas_limit_per_block / (operations.length + 1))\n      ),\n      storageLimit: CONSTANTS.HARD_LIMITS.hard_storage_limit_per_operation\n    };\n    for (const tx of operations) {\n      console.log(tx);\n      if (!isOrigination) {\n        if (!tx.amount) {\n          tx.amount = 0;\n        }\n        if (tx.destination.slice(0, 3) !== 'KT1' && !tokenTransfer) {\n          tx.amount = 0.000001;\n        }\n      }\n      tx.gasLimit = simulation.gasLimit;\n      tx.storageLimit = simulation.storageLimit;\n    }\n    if (this.hash && this.counter && (this.manager || this.manager === null)) {\n      const op = isOrigination\n        ? this.operationService.createOriginationObject(this.hash, this.counter, this.manager, operations[0], simulation.fee, this.pk, this.pkh)\n        : this.operationService.createTransactionObject(\n            this.hash,\n            this.counter,\n            this.manager,\n            operations,\n            this.pkh,\n            this.pk,\n            from,\n            simulation.fee,\n            tokenTransfer\n          );\n      const result = await this.simulate(op)\n        .toPromise()\n        .catch((e) => {\n          console.warn(e);\n          return null;\n        });\n      if (result && result.contents) {\n        let reveal = false;\n        const limits = [];\n        for (const i in result.contents) {\n          if (result.contents[i].kind === 'reveal') {\n            reveal = true;\n          } else if (['transaction', 'origination'].includes(result.contents[i].kind) && result.contents[i].metadata.operation_result.status === 'applied') {\n            const index: number = Number(i) + (result.contents[0]?.kind === 'reveal' ? -1 : 0);\n            const opObj = index > -1 ? operations[index] : null;\n            const { gas, storage } = this.getOpUsage(result.contents[i], opObj);\n            limits.push({ gasLimit: gas, storageLimit: storage });\n          } else {\n            return null;\n          }\n        }\n        return await this.operationService\n          .localForge(op)\n          .pipe(\n            flatMap((fop) => {\n              const bytes = fop.length / 2 + 64;\n              const gas = this.totalGasLimit(limits);\n              const storage = this.totalStorageLimit(limits);\n              const dtp: DefaultTransactionParams = {\n                customLimits: limits,\n                fee: this.recommendFee(limits, reveal, bytes),\n                burn: this.burnFee(limits),\n                gas,\n                storage,\n                reveal\n              };\n              console.log(JSON.stringify(dtp));\n              return of(dtp);\n            })\n          )\n          .toPromise();\n      } else if (typeof result?.success === 'boolean' && result.success === false) {\n        console.log(result);\n        throw new Error(result.payload.msg);\n      }\n    }\n    return null;\n  }\n  getOpUsage(content: any, op: any): OpLimits {\n    let gasUsage = 0;\n    let burn = Big(0);\n    if (content.source && content.source === this.pkh) {\n      burn = burn.minus(content.amount ? content.amount : '0');\n      burn = burn.minus(content.fee ? content.fee : '0');\n      burn = burn.minus(content.balance ? content.balance : '0');\n    }\n    if (content.destination && content.destination === this.pkh) {\n      burn = burn.plus(content.amount ? content.amount : '0');\n    }\n    if (content.metadata.operation_result.balance_updates) {\n      for (const balanceUpdate of content.metadata.operation_result.balance_updates) {\n        if (balanceUpdate.contract === this.pkh) {\n          burn = burn.minus(balanceUpdate.change);\n        }\n      }\n    }\n    if (content.metadata.balance_updates) {\n      for (const balanceUpdate of content.metadata.balance_updates) {\n        if (balanceUpdate.contract === this.pkh) {\n          burn = burn.minus(balanceUpdate.change);\n        }\n      }\n    }\n    gasUsage += content.metadata.operation_result.consumed_gas ? Number(content.metadata.operation_result.consumed_gas) : 0;\n    if (content.metadata.internal_operation_results) {\n      for (const internalResult of content.metadata.internal_operation_results) {\n        if (internalResult.result) {\n          if (internalResult.result.consumed_gas) {\n            gasUsage += internalResult.result && internalResult.result.consumed_gas ? Number(internalResult.result.consumed_gas) : 0;\n          }\n          if (internalResult.result.balance_updates) {\n            for (const balanceUpdate of internalResult.result.balance_updates) {\n              if (balanceUpdate.contract === this.pkh && balanceUpdate.change.slice(0, 1) === '-') {\n                burn = burn.minus(balanceUpdate.change);\n              }\n            }\n          }\n        }\n      }\n    }\n    const storageUsage = Math.round(burn / Number(this.costPerByte));\n    if (\n      gasUsage < 0 ||\n      gasUsage > CONSTANTS.HARD_LIMITS.hard_gas_limit_per_operation ||\n      storageUsage < 0 ||\n      storageUsage > CONSTANTS.HARD_LIMITS.hard_storage_limit_per_operation\n    ) {\n      throw new Error('InvalidUsageCalculation');\n    }\n    return this.getOpLimits(content, op, gasUsage, storageUsage);\n  }\n  /*\n    Need to be updated when fee market appear or default behavior for bakers changes\n  */\n  recommendFee(limits: any, reveal: boolean, bytes: number): number {\n    const minimalFee = 100;\n    const feePerByte = 1;\n    const feePerGasUnit = 0.1;\n    let gasUnits = 0;\n    let numberOfOperations = 0;\n    if (reveal) {\n      gasUnits += this.revealGasLimit;\n      numberOfOperations++;\n    }\n    for (const data of limits) {\n      gasUnits += data.gasLimit;\n      numberOfOperations++;\n    }\n    bytes += 10 * numberOfOperations; // add 10 extra bytes for variation in amount & fee\n    return Number(\n      Big(Math.ceil(minimalFee + feePerByte * bytes + feePerGasUnit * gasUnits))\n        .div(1000000)\n        .toString()\n    );\n  }\n  totalGasLimit(limits: any): number {\n    let totalGasLimit = 0;\n    for (const data of limits) {\n      totalGasLimit += data.gasLimit;\n    }\n    return totalGasLimit;\n  }\n  totalStorageLimit(limits: any): number {\n    let totalStorageLimit = 0;\n    for (const data of limits) {\n      totalStorageLimit += data.storageLimit;\n    }\n    return totalStorageLimit;\n  }\n  burnFee(limits: any): number {\n    let totalStorageLimit = Big(0);\n    for (const data of limits) {\n      totalStorageLimit = totalStorageLimit.plus(data.storageLimit);\n    }\n    return Number(Big(totalStorageLimit).times(this.costPerByte).div('1000000').toString());\n  }\n  simulate(op: any): Observable<any> {\n    op.signature = 'edsigtXomBKi5CTRf5cjATJWSyaRvhfYNHqSUGrn4SdbYRcGwQrUGjzEfQDTuqHhuA8b2d8NarZjz8TRf65WkpQmo423BtomS8Q';\n    return this.operationService\n      .postRpc('chains/main/blocks/head/helpers/scripts/run_operation', {\n        operation: op,\n        chain_id: this.chainId\n      })\n      .pipe(\n        flatMap((res) => {\n          this.operationService.checkApplied([res]);\n          return of(res);\n        })\n      )\n      .pipe(\n        catchError((err) => {\n          return this.operationService.errHandler(err);\n        })\n      );\n  }\n  private getOpLimits(content: any, op: any, gasUsage: number, storageUsage: number): OpLimits {\n    // check for hardcoded override\n    let limit: OpLimits = {};\n    const entrypoint = content?.parameters?.entrypoint;\n    const destination = content?.destination;\n    if (entrypoint && destination) {\n      const contractOverride: OpLimits = this.contractsOverride[`${destination}:${entrypoint}`];\n      if (contractOverride) {\n        limit = contractOverride;\n      }\n    }\n    // gas\n    if (!limit.gas) {\n      let gasRecommendation: number = 0;\n      if (op?.gasRecommendation) {\n        if (this.imputValidationService.gas(op.gasRecommendation)) {\n          gasRecommendation = Number(op.gasRecommendation);\n        } else if (this.imputValidationService.relativeLimit(op.gasRecommendation)) {\n          let percentage: number = Number(op.gasRecommendation.slice(1, -1));\n          percentage = Math.min(Math.max(percentage, 2), 900);\n          gasRecommendation = Math.round(gasUsage * (1 + percentage / 100));\n        }\n      }\n      const gasEstimation = Math.max(Math.ceil(gasUsage * 1.02), Math.round(gasUsage + 80));\n      limit.gas = Math.max(gasRecommendation, gasEstimation); // make sure dapps don't underestimate (ithaca side effect)\n    }\n    // storage\n    if (!limit.storage) {\n      let storageRecommendation: number = 0;\n      if (op?.storageRecommendation) {\n        if (this.imputValidationService.storage(op.storageRecommendation)) {\n          storageRecommendation = Number(op.storageRecommendation);\n        } else if (this.imputValidationService.relativeLimit(op.storageRecommendation)) {\n          const percentage: number = Number(op.storageRecommendation.slice(1, -1));\n          storageRecommendation = Math.round(storageUsage * (1 + percentage / 100));\n        }\n      }\n      const storageEstimation = Math.round(storageUsage);\n      limit.storage = Math.max(storageRecommendation, storageEstimation);\n    }\n    return limit;\n  }\n  private async getCounter(pkh: string): Promise<number> {\n    return this.operationService.getRpc(`chains/main/blocks/head/context/contracts/${pkh}/counter`).toPromise();\n  }\n  private async getManager(pkh: string): Promise<string> {\n    return this.operationService.getRpc(`chains/main/blocks/head/context/contracts/${pkh}/manager_key`).toPromise();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { TzktService } from './tzkt/tzkt.service';\nimport { WalletObject } from '../wallet/wallet';\nimport { Asset } from '../token/token.service';\n\nexport interface Indexer {\n  getContractAddresses(pkh: string): Promise<any>;\n  accountInfo(address: string, knownTokenIds: string[], init: boolean): Promise<any>;\n  getOperations(address: string, knownTokenIds: string[], wallet: WalletObject): Promise<any>;\n}\n@Injectable({\n  providedIn: 'root'\n})\nexport class IndexerService {\n  constructor(public tzktService: TzktService) {}\n  async isUsedAccount(address: string): Promise<boolean> {\n    return this.tzktService.isUsedAccount(address);\n  }\n  async getContractAddresses(address: string): Promise<any> {\n    return this.tzktService.getContractAddresses(address);\n  }\n  async accountInfo(address: string, knownTokenIds: string[] = []): Promise<any> {\n    return this.tzktService.accountInfo(address, knownTokenIds);\n  }\n  async getOperations(address: string, knownTokenIds: string[], wallet: WalletObject): Promise<any> {\n    return this.tzktService.getOperations(address, knownTokenIds, wallet);\n  }\n  async getTokenMetadata(contractAddress: string, id: string, skipTzkt = false): Promise<any> {\n    return this.tzktService.getTokenMetadata(contractAddress, id, skipTzkt);\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\nimport { SubjectService } from '../../subject/subject.service';\nimport { CONSTANTS } from '../../../../environments/environment';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class TeztoolsService {\n  readonly storeKey = 'teztools';\n  //public markets = new BehaviorSubject<any>([]);\n  public defiTokens = [];\n  constructor(private subjectService: SubjectService) {\n    this.rehydrate();\n  }\n  getMarkets() {\n    if (CONSTANTS.MAINNET) {\n      fetch('https://api.teztools.io/v1/prices')\n        .then((response) => response.json())\n        .then((r) => {\n          const _defiTokens = [];\n          const _markets = [];\n          for (const contract of r.contracts) {\n            const id = contract?.tokenId !== undefined ? contract.tokenId : 0;\n            if (contract?.tokenAddress) {\n              const tokenId: string = `${contract.tokenAddress}:${id}`;\n              _defiTokens.push(tokenId);\n              if (contract.usdValue) {\n                _markets.push({\n                  tokenId,\n                  usdValue: contract.usdValue\n                });\n              }\n            }\n          }\n          this.subjectService.markets.next(_markets);\n          this.defiTokens = _defiTokens;\n          this.store();\n        });\n    }\n  }\n  store() {\n    localStorage.setItem(\n      this.storeKey,\n      JSON.stringify({\n        defiTokens: this.defiTokens,\n        markets: this.subjectService.markets.value\n      })\n    );\n  }\n  rehydrate() {\n    const json = localStorage.getItem(this.storeKey);\n    if (json) {\n      const parsed = JSON.parse(json);\n      if (parsed) {\n        this.defiTokens = parsed.defiTokens;\n        this.subjectService.markets.next(parsed.markets);\n      }\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CONSTANTS, MODEL_3D_WHITELIST } from '../../../../environments/environment';\nimport { Indexer } from '../indexer.service';\nimport * as cryptob from 'crypto-browserify';\nimport { WalletObject, Activity, OpStatus, Token } from '../../wallet/wallet';\nimport { TezosToolkit } from '@taquito/taquito';\nimport { Tzip12Module, tzip12 } from '@taquito/tzip12';\nimport { TezosStorageHandler } from '@taquito/tzip16';\nimport { Handler, IpfsHttpHandler, MetadataProvider } from '@taquito/tzip16';\nimport { SubjectService } from '../../subject/subject.service';\n\ninterface TokenMetadata {\n  name: string;\n  tokenType: 'FA2' | 'FA1.2';\n  decimals: number;\n  symbol?: string;\n  description?: string;\n  artifactUri?: string;\n  displayUri?: string;\n  thumbnailUri?: string;\n  category?: string;\n  isTransferable?: boolean;\n  shouldPreferSymbol?: boolean;\n  isBooleanAmount?: boolean;\n  series?: string;\n  ttl?: number;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class TzktService implements Indexer {\n  tokenBalanceCache = {};\n  readonly network = CONSTANTS.NETWORK.replace('hangzhounet', 'hangzhou2net');\n  public readonly tzkt = `https://api.${this.network}.tzkt.io/v1`;\n  readonly TZKT_TOKEN_QUERY_SIZE: number = 10000;\n  Tezos: TezosToolkit;\n  constructor(private subjectService: SubjectService) {\n    this.Tezos = new TezosToolkit(CONSTANTS.NODE_URL);\n    const customHandlers = new Map<string, Handler>([\n      ['ipfs', new IpfsHttpHandler('cloudflare-ipfs.com')],\n      ['tezos-storage', new TezosStorageHandler()]\n    ]);\n    const customMetadataProvider = new MetadataProvider(customHandlers);\n    this.Tezos.addExtension(new Tzip12Module(customMetadataProvider));\n  }\n  async getContractAddresses(pkh: string): Promise<any> {\n    return fetch(`${this.tzkt}/operations/originations?contractManager=${pkh}`)\n      .then((response) => response.json())\n      .then((data) =>\n        data\n          .map((op: any) => {\n            return op?.status === 'applied' && op?.originatedContract?.kind === 'delegator_contract' ? op.originatedContract.address : '';\n          })\n          .filter((address: string) => address.length)\n      );\n  }\n  async getHashAndBlockById(transactionId: number, ops: any): Promise<any> {\n    try {\n      for (const op of ops) {\n        if (op.type === 'transaction' && op.id === transactionId) {\n          if (op.hash && op.block) {\n            return { hash: op.hash, block: op.block };\n          }\n          break;\n        }\n      }\n    } catch (e) {\n      console.error(e);\n    }\n    return fetch(`${this.tzkt}/operations/transactions?id=${transactionId}`)\n      .then((res) => {\n        return res.json();\n      })\n      .then((o) => {\n        return o?.length && o[0].hash && o[0].block ? { hash: o[0].hash, block: o[0].block } : '';\n      });\n  }\n  async accountInfo(address: string, knownTokenIds: string[]): Promise<any> {\n    const unknownTokenIds = [];\n    const data = await (await fetch(`${this.tzkt}/accounts/${address}`)).json();\n    const tokenBalances = address.startsWith('tz') ? await this.getAllTokenBalances(address) : [];\n    if (data) {\n      if (tokenBalances?.length) {\n        for (const token of tokenBalances) {\n          if (!knownTokenIds.includes(token.tokenId)) {\n            unknownTokenIds.push(token.tokenId);\n          }\n        }\n      }\n      tokenBalances.sort(function (a: any, b: any) {\n        if (a.tokenId < b.tokenId) {\n          return -1;\n        } else {\n          return 1;\n        }\n      });\n      const payload: string = (data.balance ? data.balance : '') + (data.counter ? data.counter : '') + (tokenBalances ? JSON.stringify(tokenBalances) : '');\n      const input = Buffer.from(payload);\n      const hash = cryptob.createHash('sha512').update(input).digest('hex');\n      if (payload && payload !== '[]') {\n        const balance = data?.balance !== undefined ? data.balance : 0;\n        return { counter: hash, unknownTokenIds, tokens: tokenBalances, balance };\n      }\n    }\n    return { counter: '', tokens: tokenBalances };\n  }\n  async isUsedAccount(address: string): Promise<boolean> {\n    const accountInfo = await (await fetch(`${this.tzkt}/accounts/${address}`)).json();\n    if (accountInfo && (accountInfo.balance || accountInfo.tokenBalancesCount)) {\n      return true;\n    } else {\n      const tokenCount = await (await fetch(`${this.tzkt}/accounts/count`)).json();\n      if (tokenCount && Object.keys(tokenCount).length > 0) {\n        return true;\n      }\n    }\n    return false;\n  }\n  async getOperations(address: string, knownTokenIds: string[], wallet: WalletObject): Promise<any> {\n    const ops = await fetch(`${this.tzkt}/accounts/${address}/operations?limit=20&type=delegation,origination,transaction`)\n      .then((response) => response.json())\n      .then((data) =>\n        data\n          .map((op) => {\n            if (!op.hasInternals || !wallet.getAccount(op.target.address)) {\n              const status: OpStatus = op.status === 'applied' ? OpStatus.CONFIRMED : OpStatus.FAILED;\n              let destination = { address: '' };\n              let amount = '0';\n              let entrypoint = '';\n              let opId = '';\n              switch (op.type) {\n                case 'transaction':\n                  if (address !== op.target.address && address !== op.sender.address) {\n                    return null;\n                  }\n                  destination = op.target;\n                  amount = op.amount.toString();\n                  entrypoint = this.extractEntrypoint(op);\n                  opId = op?.id ? `t${op.id}` : '';\n                  break;\n                case 'delegation':\n                  if (address !== op.sender.address) {\n                    return null;\n                  }\n                  destination = op.newDelegate ? op.newDelegate : { address: '' };\n                  amount = '0';\n                  opId = op?.id ? `d${op.id}` : '';\n                  break;\n                case 'origination':\n                  destination = op.originatedContract;\n                  if (op.contractBalance) {\n                    amount = op.contractBalance.toString();\n                  }\n                  opId = op?.id ? `o${op.id}` : '';\n                  break;\n                default:\n                  console.log(`Ignoring kind ${op.type}`);\n                  return null;\n              }\n              const activity: Activity = {\n                type: op.type,\n                block: op.block,\n                status,\n                amount,\n                source: op.sender,\n                destination,\n                hash: op.hash,\n                counter: op.counter,\n                timestamp: new Date(op.timestamp).getTime(),\n                entrypoint,\n                opId\n              };\n              return activity;\n            }\n          })\n          .filter((obj) => obj)\n      );\n    const unknownTokenIds: string[] = [];\n    const tokenTxs = await (await fetch(`${this.tzkt}/tokens/transfers?anyof.from.to=${address}&limit=20&offset=0&sort.desc=id`)).json();\n    const tokenArr = [];\n    for (let i = 0; i < tokenTxs.length; ++i) {\n      const tokenId = `${tokenTxs[i].token.contract.address}:${tokenTxs[i].token.tokenId}`;\n      if (tokenTxs[i].token.contract && tokenId) {\n        if (!knownTokenIds.includes(tokenId)) {\n          unknownTokenIds.push(tokenId);\n        }\n        const source: any = { address: tokenTxs[i].from?.address };\n        if (tokenTxs[i].from === '' && tokenTxs[i].token.contract) {\n          source.address = tokenTxs[i].contract.address;\n        }\n        let hash = '';\n        let block = '';\n        if (tokenTxs[i].transactionId) {\n          const o = await this.getHashAndBlockById(tokenTxs[i].transactionId, ops);\n          if (o) {\n            hash = o.hash;\n            block = o.block;\n          }\n        }\n        const activity: Activity = {\n          type: 'transaction',\n          block,\n          hash,\n          status: OpStatus.CONFIRMED,\n          amount: tokenTxs[i].amount,\n          tokenId,\n          source,\n          destination: { address: tokenTxs[i].to?.address ?? '' },\n          timestamp: new Date(tokenTxs[i].timestamp).getTime(),\n          opId: `t${tokenTxs[i].transactionId}`\n        };\n        tokenArr.push(activity);\n      }\n    }\n    let operations = tokenArr\n      .concat(ops)\n      .filter((op) => op?.entrypoint !== 'transfer' && op?.entrypoint !== 'claim')\n      .sort(function (a: any, b: any) {\n        return b.timestamp - a.timestamp;\n      });\n    return { operations, unknownTokenIds };\n  }\n  private extractEntrypoint(op: any): string {\n    return op?.entrypoint ?? op?.parameter?.entrypoint ?? '';\n  }\n  async getTokenMetadata(contractAddress: string, id: string, skipTzkt: boolean): Promise<TokenMetadata> {\n    let meta;\n    let tokenType = 'FA2';\n    const tokenId = `${contractAddress}:${id}`;\n    if (this.tokenBalanceCache[tokenId]) {\n      meta = this.tokenBalanceCache[tokenId].token.metadata;\n      tokenType = this.tokenBalanceCache[tokenId].token.standard && this.tokenBalanceCache[tokenId].token.standard === 'fa1.2' ? 'FA1.2' : 'FA2';\n    }\n    if (meta) {\n      this.normalizeMetadata(meta, contractAddress, id);\n      this.filterMetadata(meta);\n    }\n    if (!(meta && (meta.name || meta.symbol) && !isNaN(meta.decimals) && meta.decimals >= 0) || skipTzkt) {\n      meta = null;\n    }\n    if (!meta) {\n      console.log('fallback on taquito', { contractAddress, id });\n      meta = await this.getTokenMetadataWithTaquito(contractAddress, id);\n      if (meta) {\n        this.normalizeMetadata(meta, contractAddress, id);\n        this.filterMetadata(meta);\n      }\n    }\n    if (!(meta && (meta.name || meta.symbol) && !isNaN(meta.decimals) && meta.decimals >= 0)) {\n      meta = null;\n    }\n    if (!meta) {\n      console.warn(`cannot find token_id ${id} for contract: ${contractAddress}`);\n      return null;\n    }\n    return { ...meta, tokenType };\n  }\n  async getTokenMetadataWithTaquito(contractAddress, id) {\n    const contract = await this.Tezos.contract.at(contractAddress, tzip12);\n    let metadata: any;\n    if (['KT1TnVQhjxeNvLutGvzwZvYtC7vKRpwPWhc6'].includes(contractAddress)) {\n      // nl hotfix\n      const contract = await this.Tezos.contract.at(contractAddress);\n      const storage: any = await contract.storage();\n      const parsed_uri = storage.token_metadata_uri.replace('{tokenId}', id);\n      const response = await (await fetch(parsed_uri)).json();\n      if (response) {\n        response.tokenId = id;\n        metadata = response;\n      }\n    } else {\n      metadata = await contract.tzip12().getTokenMetadata(Number(id));\n    }\n    return metadata;\n  }\n  async getAllTokenBalances(address: string): Promise<Array<Token>> {\n    const fetchToken = async (offset: number): Promise<Array<any>> => {\n      let res = await (await fetch(`${this.tzkt}/tokens/balances?account=${address}&offset=${offset}&limit=${this.TZKT_TOKEN_QUERY_SIZE}&balance.ne=0`)).json();\n      if (res?.length) {\n        if (res.length === this.TZKT_TOKEN_QUERY_SIZE) {\n          // get more if limit reached\n          return [...res, ...(await fetchToken(offset + this.TZKT_TOKEN_QUERY_SIZE))];\n        } else {\n          return res;\n        }\n      } else {\n        return [];\n      }\n    };\n    let tzktTokensResponse = await fetchToken(0);\n    const tokenBalances: Token[] = [];\n    for (let i = 0; i < tzktTokensResponse.length; ++i) {\n      if (tzktTokensResponse[i]?.balance && tzktTokensResponse[i].token?.contract?.address && tzktTokensResponse[i].token?.tokenId !== undefined) {\n        const tokenId: string = `${tzktTokensResponse[i].token.contract.address}:${tzktTokensResponse[i].token.tokenId}`;\n        tokenBalances.push({ tokenId, balance: tzktTokensResponse[i].balance });\n        this.tokenBalanceCache[tokenId] = tzktTokensResponse[i];\n      }\n    }\n    return tokenBalances;\n  }\n  private filterMetadata(meta: any) {\n    const keys = [\n      { key: 'name', type: 'string' },\n      { key: 'balance', type: 'string' },\n      { key: 'symbol', type: 'string' },\n      { key: 'contractAddress', type: 'string' },\n      { key: 'id', type: 'string' },\n      { key: 'decimals', type: 'string' },\n      { key: 'description', type: 'string' },\n      { key: 'artifactUri', type: 'string', toAsset: true },\n      { key: 'displayUri', type: 'string', toAsset: true },\n      { key: 'thumbnailUri', type: 'string', toAsset: true },\n      { key: 'isTransferable', type: 'boolean' },\n      { key: 'shouldPreferSymbol', type: 'boolean' },\n      { key: 'isBooleanAmount', type: 'boolean' },\n      { key: 'series', type: 'string' },\n      { key: 'ttl', type: 'string' }\n    ];\n    let metadata: any = {};\n    for (const a of keys) {\n      if (typeof meta[a.key] === a.type) {\n        if (a.toAsset) {\n          // extract mime type\n          if (meta?.formats?.length) {\n            const index = meta.formats.findIndex((b) => b.uri === meta[a.key]);\n            if (index !== -1 && meta.formats[index].uri && meta.formats[index].mimeType) {\n              meta[a.key] = { uri: meta[a.key], mimeType: meta.formats[index].mimeType };\n            }\n          }\n          if (typeof meta[a.key] === 'string') {\n            meta[a.key] = { uri: meta[a.key], mimeType: 'unknown' };\n          }\n        }\n        metadata[a.key] = meta[a.key];\n      }\n    }\n    return metadata;\n  }\n  private normalizeMetadata(meta: any, contractAddress: string, id: string) {\n    mutableConvertObjectPropertiesSnakeToCamel(meta);\n    for (let key of Object.keys(meta)) {\n      if (typeof meta[key] === 'number') {\n        meta[key] = `${meta[key]}`;\n      }\n    }\n    this.handleMetadataExceptions(meta, contractAddress, id);\n    if (meta?.isTransferable && typeof meta?.isTransferable === 'string') {\n      meta.isTransferable = meta.isTransferable?.toLowerCase() === 'false' ? false : meta.isTransferable?.toLowerCase() === 'true' ? true : undefined;\n    }\n    if (meta?.shouldPreferSymbol && typeof meta?.shouldPreferSymbol === 'string') {\n      meta.shouldPreferSymbol =\n        meta.shouldPreferSymbol?.toLowerCase() === 'false' ? false : meta.shouldPreferSymbol?.toLowerCase() === 'true' ? true : undefined;\n    }\n    if (meta?.isBooleanAmount && typeof meta?.isBooleanAmount === 'string') {\n      meta.isBooleanAmount = meta.isBooleanAmount?.toLowerCase() === 'false' ? false : meta.isBooleanAmount?.toLowerCase() === 'true' ? true : undefined;\n    }\n  }\n  handleMetadataExceptions(meta: any, contractAddress: string, id: string) {\n    // hen\n    if (meta?.symbol === 'OBJKT') {\n      if (!meta.displayUri && meta.formats?.length) {\n        meta.displayUri = meta.formats[0].uri;\n      }\n      if (meta.displayUri && meta.thumbnailUri) {\n        delete meta.thumbnailUri;\n      }\n    }\n    if (contractAddress === 'KT1NVvPsNDChrLRH5K2cy6Sc9r1uuUwdiZQd' /* Dogami */ && meta?.formats) {\n      if (typeof meta.formats[0] === 'string') {\n        meta.formats = JSON.parse(meta.formats);\n      }\n    }\n    // fxHash\n    if (contractAddress === 'KT1U6EHmNxJTkvaWJ4ThczG4FSDaHC21ssvi' && meta?.artifactUri) {\n      delete meta.artifactUri;\n    }\n    // Plenty + HEH\n    if (!meta.displayUri && !meta.thumbnailUri && meta?.icon) {\n      meta.thumbnailUri = { uri: meta.icon, mimeType: 'unknown' };\n    }\n    if (\n      (contractAddress === 'KT1AWoUQAuUudqpc75cGukWufbfim3GRn8h6' /* Flex */ ||\n        contractAddress === 'KT1Lz7Jd6Sh1zUE66nDGS7hGnjwcyTBCiYbF' /* BV */ ||\n        contractAddress === 'KT1D1XtWFoQDPtuYzbkeRJhcDgH6CDem2FkZ' /* BV */ ||\n        contractAddress === 'KT1NVvPsNDChrLRH5K2cy6Sc9r1uuUwdiZQd') /* Dogami */ &&\n      meta?.formats?.length\n    ) {\n      meta.displayUri = meta.artifactUri = meta.formats?.find((f) => f?.mimeType?.startsWith('model/')) ?? meta.displayUri;\n    }\n    if (contractAddress === 'KT1NVvPsNDChrLRH5K2cy6Sc9r1uuUwdiZQd') {\n      // override wrong mimeType\n      meta.thumbnailUri = { uri: meta.thumbnailUri, mimeType: 'video/mp4' };\n    }\n    // Rarible\n    if (contractAddress === 'KT18pVpRXKPY2c4U2yFEGSH3ZnhB2kL8kwXS') {\n      meta.thumbnailUri = meta.displayUri = meta.formats[0].uri;\n    }\n  }\n}\nexport function mutableConvertObjectPropertiesSnakeToCamel(data: Object) {\n  for (const key in data) {\n    if (key.charAt(0).toLowerCase() !== key.charAt(0)) {\n      data[key.charAt(0).toLowerCase() + key.slice(1)] = data[key];\n    }\n    if (key.indexOf('_') !== -1) {\n      const aryCamelKey = [];\n      for (let i = 0; i < key.length; i++) {\n        const char = key.charAt(i);\n        if (char === '_') {\n          aryCamelKey.push(key.charAt(i + 1).toUpperCase());\n          i++;\n        } else {\n          aryCamelKey.push(char);\n        }\n      }\n      const camelKey = aryCamelKey.join('');\n      if (!data.hasOwnProperty(camelKey)) {\n        data[camelKey] = data[key];\n        delete data[key];\n      }\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { OperationService } from '../operation/operation.service';\nimport * as zxcvbn from 'zxcvbn';\nimport { CONSTANTS } from '../../../environments/environment';\nimport { TranslateService } from '@ngx-translate/core';\nimport { valueDecoder } from '@taquito/local-forging/dist/lib/michelson/codec';\nimport { Uint8ArrayConsumer } from '@taquito/local-forging/dist/lib/uint8array-consumer';\n\n@Injectable()\nexport class InputValidationService {\n  constructor(private operationService: OperationService, private translate: TranslateService) {}\n  /*\n    Input validations\n  */\n  mnemonics(mnemonics: string): boolean {\n    return this.operationService.validMnemonic(mnemonics);\n  }\n  password(password: string): boolean {\n    return zxcvbn(password).score === 4;\n  }\n  passwordStrengthDisplay(password: string): string {\n    if (!password) {\n      return '';\n    }\n    switch (zxcvbn(password).score) {\n      case 0: {\n        return this.translate.instant('INPUTVALIDATIONCOMPONENT.CATASTROPHIC'); // 'Catastrophic!'\n      }\n      case 1: {\n        return this.translate.instant('INPUTVALIDATIONCOMPONENT.VERYWEAK'); // 'Very weak!'\n      }\n      case 2: {\n        return this.translate.instant('INPUTVALIDATIONCOMPONENT.WEAK'); // 'Weak!'\n      }\n      case 3: {\n        return this.translate.instant('INPUTVALIDATIONCOMPONENT.WEAK'); // 'Weak!'\n      }\n      case 4: {\n        return this.translate.instant('INPUTVALIDATIONCOMPONENT.STRONG'); // 'Strong!'\n      }\n      default: {\n        return '';\n      }\n    }\n  }\n  address(address: string): Boolean {\n    return this.operationService.validAddress(address);\n  }\n  torusAccount(verifierId: string, loginType: string): Boolean {\n    switch (loginType) {\n      case 'google':\n        return this.email(verifierId);\n      case 'reddit':\n        return this.redditAccount(verifierId);\n      case 'twitter':\n        return this.twitterAccount(verifierId);\n      case 'domain':\n        return this.tezosDomain(verifierId);\n      default:\n        return false;\n    }\n  }\n  redditAccount(username: string) {\n    // Letters, numbers, dashes, and underscores only\n    // Username must be between 3 and 20 characters\n    const re = /^[0-9a-zA-Z\\-\\_]{3,20}$/;\n    return re.test(username);\n  }\n  email(email: string): Boolean {\n    const re =\n      /^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(email);\n  }\n  tezosDomain(domain: string) {\n    const a = domain.split('.');\n    // basic validation that is in the correct format\n    for (const sub of a) {\n      if (!sub.length) {\n        return false;\n      }\n    }\n    return a.length >= 2 && CONSTANTS.TEZOS_DOMAIN.TOP_DOMAINS.includes(a[a.length - 1]);\n  }\n  twitterAccount(username: string) {\n    // The only characters you can use are uppercase and lowercase letters, numbers, and the underscore character ( _ ).\n    const re = /^\\@{1}[0-9a-zA-Z\\_]{1,15}$/;\n    return re.test(username);\n  }\n  twitterId(id: string) {\n    const re = /^[0-9]+$/;\n    return re.test(id);\n  }\n  passphrase(passphrase: string): Boolean {\n    return true;\n  }\n  amount(amount: string, decimals: number = 6): Boolean {\n    const decimalsPart = decimals ? `(\\.[0-9]{1,${decimals}}){0,1}` : '';\n    const expr = new RegExp(`^(0|[1-9][0-9]*)${decimalsPart}$`, 'g');\n    if (amount === '' || amount === '0') {\n      // default value / zero\n      return true;\n    } else if (Number(amount) && amount.match(expr)) {\n      // Positive number\n      return true;\n    }\n    return false;\n  }\n  fee(fee: string): Boolean {\n    return this.amount(fee); // same as amount\n  }\n  gas(amount: string): Boolean {\n    if (amount === '' || amount === '0') {\n      // default value / zero\n      return true;\n    } else if (Number(amount) && 0 < Number(amount) && Number(amount) % 1 === 0) {\n      // Positive integer\n      return true;\n    } else {\n      return false;\n    }\n  }\n  storage(amount: string) {\n    return this.gas(amount);\n  }\n  relativeLimit(limit: string) {\n    if (limit?.length > 2 && limit.startsWith('+') && limit.endsWith('%')) {\n      return this.gas(limit.slice(1, -1));\n    }\n    return false;\n  }\n  code(code: string): Boolean {\n    if (code && code.length === 40 && code.match(/^[0-9a-f]*$/g)) {\n      // 40 hex chars\n      return true;\n    } else {\n      return false;\n    }\n  }\n  derivationPath(path: string): Boolean {\n    const m = path.match(/^44\\'\\/1729(\\'\\/[0-9]+)+\\'$/g);\n    if (m || path === \"44'/1729'\") {\n      return true;\n    }\n    return false;\n  }\n  hexString(hex: string): Boolean {\n    if (hex && hex.match(/^[a-f0-9]*$/)) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n  isMessageSigning(payload: string): boolean {\n    if (payload.match(/^0501[a-f0-9]{8}54657a6f73205369676e6564204d6573736167653a20[a-f0-9]*$/)) {\n      return true;\n    }\n    return false;\n  }\n  isMichelineExpr(hex: string) {\n    try {\n      if (!this.hexString(hex)) {\n        throw new Error('Not a hex string');\n      }\n      if (hex.slice(0, 2) !== '05') {\n        throw new Error('invalid prefix');\n      }\n      const parsedPayload = valueDecoder(Uint8ArrayConsumer.fromHexString(hex.slice(2)));\n      console.log('Parsed sign payload', parsedPayload);\n    } catch (e) {\n      console.warn(e.message ? 'Decoding: ' + e.message : e);\n      return false;\n    }\n    return true;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { OperationService } from '../../services/operation/operation.service';\nimport { TorusService } from '../../services/torus/torus.service';\nimport { WalletService } from '../../services/wallet/wallet.service';\nimport { InputValidationService } from '../../services/input-validation/input-validation.service';\nimport { TezosDomainsService } from '../../services/tezos-domains/tezos-domains.service';\n\nexport enum LookupType { // ordered in priority\n  AddressBook,\n  TezosDomains,\n  Google,\n  Reddit,\n  Twitter,\n  Alias\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class LookupService {\n  public records: {\n    address: string;\n    data: { name: string; lookupType: LookupType }[];\n  }[] = [];\n  private pendingLookups: Record<string, number> = {};\n  constructor(\n    private operationService: OperationService,\n    private torusService: TorusService,\n    private walletService: WalletService,\n    private inputValidationService: InputValidationService,\n    private tezosDomainsService: TezosDomainsService\n  ) {\n    this.initCheck();\n  }\n  initCheck() {\n    if (!this.records.length && this.walletService.wallet && this.walletService.wallet.lookups.length) {\n      console.log('### Loading lookups from memory');\n      this.records = this.walletService.wallet.lookups;\n    }\n  }\n  add(address: string, name: string, lookupType: LookupType) {\n    console.log('#name ' + name, lookupType);\n    const { x, y } = this.index(address, lookupType);\n    if (x !== -1) {\n      if (y === -1) {\n        this.records[x].data.push({ name, lookupType });\n      } else if (lookupType === LookupType.TezosDomains) {\n        this.records[x].data[y] = { name, lookupType };\n      }\n    } else {\n      this.records.push({ address, data: [{ name, lookupType }] });\n    }\n    this.walletService.wallet.lookups = this.records;\n    this.walletService.storeWallet();\n  }\n  clear() {\n    this.records = [];\n    this.pendingLookups = {};\n  }\n  mark(address: string) {\n    const { x, y } = this.indexTop(address);\n    if (x === -1) {\n      this.records.push({ address, data: [] });\n    }\n    this.walletService.storeWallet();\n  }\n  async recheckWalletAddresses(force: boolean) {\n    console.log('lookup wallet addresses');\n    for (const address of this.walletService.wallet.getImplicitAccounts()) {\n      this.check(address, force);\n    }\n  }\n  async check(address: any, force: boolean = false) {\n    if (address?.address !== undefined) {\n      address = address.address;\n    }\n    if (typeof address !== 'string') {\n      return;\n    }\n    this.initCheck();\n    if (force) {\n      console.log('Forced recheck for: ' + address);\n    }\n    if (address && !this.pendingLookups[address]) {\n      const { x } = this.index(address, 0);\n      if (x === -1 || force) {\n        // DirectAuth - disabled\n        // if (address && address.slice(0, 3) === 'tz2') {\n        //   if (x === -1) {\n        //     this.pendingLookups[address]++;\n        //     this.torusLookup(address);\n        //   }\n        // }\n        // Tezos Domains\n        this.pendingLookups[address]++;\n        let domain = '';\n        try {\n          domain = await this.tezosDomainsService.getDomainFromAddress(address);\n        } catch (e) {\n          console.log(address, e);\n          this.pendingLookups[address]--;\n          return;\n        }\n        this.pendingLookups[address]--;\n        if (domain || domain === '') {\n          this.add(address, domain, LookupType.TezosDomains);\n        } else {\n          this.mark(address);\n        }\n      }\n    }\n  }\n  torusLookup(address: string) {\n    this.operationService.torusKeyLookup(address).subscribe(async (ans: any) => {\n      if (ans) {\n        if (ans.result && ans.result.Verifiers) {\n          const keys = Object.keys(ans.result.Verifiers);\n          const verifierMap = this.torusService.verifierMap;\n          for (const key of keys) {\n            if (key === verifierMap['google'].verifier) {\n              this.add(address, ans.result.Verifiers[verifierMap['google'].verifier][0], LookupType.Google);\n            } else if (key === verifierMap['reddit'].verifier) {\n              this.add(address, ans.result.Verifiers[verifierMap['reddit'].verifier][0], LookupType.Reddit);\n            } else if (key === verifierMap['twitter'].verifier) {\n              const verifierId = ans.result.Verifiers[verifierMap['twitter'].verifier][0];\n              const verifierArray = verifierId.split('|');\n              if (verifierArray[0] === 'twitter' && this.inputValidationService.twitterId(verifierArray[1])) {\n                const twitterId = verifierArray[1];\n                const { username } = await this.torusService.twitterLookup(undefined, twitterId);\n                if (username) {\n                  this.add(address, '@' + username, LookupType.Twitter);\n                }\n              }\n            } else {\n              console.log('Unhandled verifier result', ans);\n            }\n          }\n          this.pendingLookups[address]--;\n        } else if (!ans.noReveal) {\n          this.mark(address);\n        }\n      }\n    });\n  }\n  torusEntryExist(address: string): boolean {\n    const record = this.records[address];\n    if (record) {\n      for (const entry of record) {\n        if (entry.lookupType > 1) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n  index(address: string, lookupType: LookupType) {\n    let [x, y] = Array(2).fill(-1);\n    for (let i = 0; i < this.records.length; i++) {\n      if (this.records[i].address === address) {\n        x = i;\n        for (let j = 0; j < this.records[i].data.length; j++) {\n          if (this.records[i].data[j].lookupType === lookupType) {\n            y = j;\n          }\n        }\n      }\n    }\n    return { x, y };\n  }\n  indexTop(address: string) {\n    let [x, y] = Array(2).fill(-1);\n    for (let i = 0; i < this.records.length; i++) {\n      if (this.records[i].address === address) {\n        x = i;\n        for (let j = 0; j < this.records[i].data.length; j++) {\n          if (this.records[i].data[j].lookupType < y || y === -1) {\n            if (this.records[i].data[j].lookupType !== LookupType.TezosDomains || this.records[i].data[j].name) {\n              // skip empty domain records\n              y = j;\n            }\n          }\n        }\n      }\n    }\n    return { x, y };\n  }\n  resolve(party: any): any {\n    this.initCheck();\n    const { x, y } = this.indexTop(party?.address);\n    if (x !== -1 && y !== -1) {\n      return {\n        name: this.records[x].data[y].name,\n        lookupType: this.records[x].data[y].lookupType,\n        address: party.address\n      };\n    } else if (party?.alias) {\n      this.add(party.address, party.alias, LookupType.Alias);\n      return this.resolve(party);\n    }\n    return { address: party?.address };\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { Observable, of, Subject } from 'rxjs';\n\n@Injectable()\nexport class MessageService {\n  spinnerOn = false;\n  spinnerText = '';\n  messages: any[] = [];\n  defaultTime = 10;\n  checked: Observable<boolean>;\n  beaconResponse = new Subject<boolean>();\n  readonly pairingCompleteMsg = 'Pairing complete! Waiting for permission request...';\n  add(message: string, seconds: number = this.defaultTime) {\n    const type = 'info';\n    console.log(type + ': ' + message);\n    this.messages.push({\n      type: type,\n      msg: message,\n      timeout: seconds * 1000\n    });\n  }\n  addError(message: string, seconds: number = this.defaultTime) {\n    const type = 'danger';\n    console.log(type + ': ' + message);\n    this.messages.push({\n      type: type,\n      msg: message,\n      timeout: seconds * 1000\n    });\n  }\n  addWarning(message: string, seconds: number = this.defaultTime) {\n    const type = 'warning';\n    console.log(type + ': ' + message);\n    this.messages.push({\n      type: type,\n      msg: message,\n      timeout: seconds * 1000\n    });\n  }\n  addSuccess(message: string, seconds: number = this.defaultTime, ref: string = '') {\n    if (ref) {\n      console.log('ref set', ref);\n    }\n    const type = 'success';\n    console.log(type + ': ' + message);\n    this.messages.push({\n      type: type,\n      msg: message,\n      timeout: seconds * 1000,\n      ref\n    });\n  }\n  modify(newMessage: string, ref: string) {\n    if (ref) {\n      for (const message of this.messages) {\n        if (message.ref === ref) {\n          message.msg = newMessage;\n        }\n      }\n    }\n  }\n  emailNotify(email: string, amount: string) {\n    console.log(email);\n    const type = 'success';\n    this.messages.push({\n      type: type,\n      timeout: 0,\n      msg: 'email',\n      email,\n      amount\n    });\n  }\n  redditNotify(username: string, amount: string) {\n    console.log(username);\n    const type = 'success';\n    this.messages.push({\n      type: type,\n      timeout: 0,\n      msg: 'Reddit',\n      username,\n      amount\n    });\n  }\n  twitterNotify(twitterId: string, handler: string, amount: string) {\n    console.log(twitterId);\n    const type = 'success';\n    this.messages.push({\n      type: type,\n      timeout: 0,\n      msg: 'Twitter',\n      twitterId,\n      handler,\n      amount\n    });\n  }\n  addBeaconWait(message: string) {\n    const type = 'info';\n    this.messages.push({\n      type: type,\n      msg: message,\n      timeout: 30 * 1000,\n      loader: true\n    });\n  }\n  async removeBeaconMsg(delay = false) {\n    setTimeout(\n      () => {\n        for (let i = 0; i < this.messages.length; i++) {\n          if (this.messages[i].loader) {\n            this.messages.splice(i, 1);\n            this.addSuccess(this.pairingCompleteMsg, 10);\n            break;\n          } else if (this.messages[i].msg === this.pairingCompleteMsg) {\n            this.messages.splice(i, 1);\n            break;\n          }\n        }\n      },\n      delay ? 500 : 0\n    );\n  }\n  clear() {\n    this.messages = [];\n  }\n  async startSpinner(text: string = '') {\n    this.spinnerText = text;\n    this.spinnerOn = true;\n  }\n  async stopSpinner(): Promise<void> {\n    this.spinnerText = '';\n    this.spinnerOn = false;\n    return;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { of, Observable, MonoTypeOperatorFunction, from as fromPromise, iif, throwError } from 'rxjs';\nimport { catchError, retryWhen, flatMap, timeout, delay as delayOperator, debounceTime, concatMap } from 'rxjs/operators';\nimport { Buffer } from 'buffer';\nimport { blake2b } from 'blakejs';\nimport { sign as naclSign } from 'tweetnacl';\nimport * as Bs58check from 'bs58check';\nimport * as bip39 from 'bip39';\nimport Big from 'big.js';\nimport { localForger } from '@taquito/local-forging';\nimport { CONSTANTS } from '../../../environments/environment';\nimport { ErrorHandlingPipe } from '../../pipes/error-handling.pipe';\nimport * as elliptic from 'elliptic';\nimport { instantiateSecp256k1, hexToBin, binToHex } from '@bitauth/libauth';\nimport { TokenService } from '../token/token.service';\nimport { isEqual } from 'lodash';\n\nconst httpOptions = { headers: { 'Content-Type': 'application/json' } };\n\nexport interface KeyPair {\n  sk: string | null;\n  pk: string | null;\n  pkh: string;\n}\n@Injectable()\nexport class OperationService {\n  nodeURL = CONSTANTS.NODE_URL;\n  prefix = {\n    tz1: new Uint8Array([6, 161, 159]),\n    tz2: new Uint8Array([6, 161, 161]),\n    tz3: new Uint8Array([6, 161, 164]),\n    edpk: new Uint8Array([13, 15, 37, 217]),\n    sppk: new Uint8Array([3, 254, 226, 86]),\n    edsk: new Uint8Array([43, 246, 78, 7]),\n    spsk: new Uint8Array([17, 162, 224, 201]),\n    edsig: new Uint8Array([9, 245, 205, 134, 18]),\n    spsig: new Uint8Array([13, 115, 101, 19, 63]),\n    sig: new Uint8Array([4, 130, 43]),\n    o: new Uint8Array([5, 116]),\n    B: new Uint8Array([1, 52]),\n    TZ: new Uint8Array([3, 99, 29]),\n    KT: new Uint8Array([2, 90, 121])\n  };\n  microTez = new Big(1000000);\n  feeHardCap = 100; //tez\n  constructor(private http: HttpClient, private errorHandlingPipe: ErrorHandlingPipe, private tokenService: TokenService) {}\n  /*\n    Returns an observable for the activation of an ICO identity\n  */\n  activate(pkh: string, secret: string): Observable<any> {\n    return this.getHeader()\n      .pipe(\n        flatMap((header: any) => {\n          const fop: any = {\n            branch: header.hash,\n            contents: [\n              {\n                kind: 'activate_account',\n                pkh: pkh,\n                secret: secret\n              }\n            ]\n          };\n          return this.postRpc('chains/main/blocks/head/helpers/forge/operations', fop).pipe(\n            flatMap((opbytes: any) => {\n              const sopbytes: string = opbytes + Array(129).join('0');\n              fop.protocol = header.protocol;\n              fop.signature = 'edsigtXomBKi5CTRf5cjATJWSyaRvhfYNHqSUGrn4SdbYRcGwQrUGjzEfQDTuqHhuA8b2d8NarZjz8TRf65WkpQmo423BtomS8Q';\n              return this.postRpc('chains/main/blocks/head/helpers/preapply/operations', [fop]).pipe(\n                flatMap((preApplyResult: any) => {\n                  console.log(JSON.stringify(preApplyResult));\n                  return this.postRpc('injection/operation', JSON.stringify(sopbytes)).pipe(\n                    flatMap((final: any) => {\n                      return this.opCheck(final);\n                    })\n                  );\n                })\n              );\n            })\n          );\n        })\n      )\n      .pipe(catchError((err) => this.errHandler(err)));\n  }\n  opCheck(final: any, newPkh: string = null): Observable<any> {\n    if (typeof final === 'string' && final.length === 51) {\n      return of({\n        success: true,\n        payload: {\n          opHash: final,\n          newPkh: newPkh\n        }\n      });\n    } else {\n      return of({\n        success: false,\n        payload: {\n          opHash: null,\n          msg: final\n        }\n      });\n    }\n  }\n  /*\n    Returns an observable for the origination of new accounts.\n  */\n  originate(origination: any, fee: number = 0, keys: KeyPair): Observable<any> {\n    console.log(fee, origination);\n    return this.getHeader()\n      .pipe(\n        flatMap((header: any) => {\n          return this.getRpc(`chains/main/blocks/head/context/contracts/${keys.pkh}/counter`).pipe(\n            flatMap((actions: number) => {\n              return this.getRpc(`chains/main/blocks/head/context/contracts/${keys.pkh}/manager_key`).pipe(\n                flatMap((manager: any) => {\n                  if (fee > this.feeHardCap) {\n                    throw new Error('TooHighFee');\n                  }\n                  const counter: number = Number(actions);\n                  const fop = this.createOriginationObject(header.hash, counter, manager, origination, fee, keys.pk, keys.pkh);\n                  return this.operation(fop, header, keys, true);\n                })\n              );\n            })\n          );\n        })\n      )\n      .pipe(catchError((err) => this.errHandler(err)));\n  }\n  createOriginationObject(hash: string, counter: number, manager: string, origination: any, fee: number, pk: string, pkh: string): any {\n    const fop: any = {\n      branch: hash,\n      contents: []\n    };\n    const gas_limit = origination.gasLimit.toString();\n    const storage_limit = origination.storageLimit.toString();\n    if (manager === null) {\n      // Reveal\n      fop.contents.push({\n        kind: 'reveal',\n        source: pkh,\n        fee: '0',\n        counter: (++counter).toString(),\n        gas_limit: '1000',\n        storage_limit: '0',\n        public_key: pk\n      });\n    }\n    fop.contents.push({\n      kind: 'origination',\n      source: pkh,\n      fee: this.microTez.times(fee).toString(),\n      counter: (++counter).toString(),\n      gas_limit,\n      storage_limit,\n      balance: this.microTez.times(origination.balance).toString(),\n      script: origination.script\n    });\n    return fop;\n  }\n  /*\n    Returns an observable for the transaction of tez.\n  */\n  transfer(from: string, transactions: any, fee: number, keys: KeyPair, tokenTransfer: string = ''): Observable<any> {\n    return this.getHeader()\n      .pipe(\n        flatMap((header: any) => {\n          return this.getRpc(`chains/main/blocks/head/context/contracts/${keys.pkh}/counter`).pipe(\n            flatMap((actions: any) => {\n              return this.getRpc(`chains/main/blocks/head/context/contracts/${keys.pkh}/manager_key`).pipe(\n                flatMap((manager: any) => {\n                  if (fee > this.feeHardCap) {\n                    throw new Error('TooHighFee');\n                  }\n                  const counter: number = Number(actions);\n                  const fop = this.createTransactionObject(header.hash, counter, manager, transactions, keys.pkh, keys.pk, from, fee, tokenTransfer);\n                  return this.operation(fop, header, keys);\n                })\n              );\n            })\n          );\n        })\n      )\n      .pipe(catchError((err) => this.errHandler(err)));\n  }\n  createTransactionObject(\n    hash: string,\n    counter: number,\n    manager: string,\n    transactions: any,\n    pkh: string,\n    pk: string,\n    from: string,\n    fee: number,\n    tokenTransfer: string\n  ): any {\n    const fop: any = {\n      branch: hash,\n      contents: []\n    };\n    if (manager === null) {\n      // Reveal\n      fop.contents.push({\n        kind: 'reveal',\n        source: pkh,\n        fee: '0',\n        counter: (++counter).toString(),\n        gas_limit: '1000',\n        storage_limit: '0',\n        public_key: pk\n      });\n    }\n    for (let i = 0; i < transactions.length; i++) {\n      const currentFee = i === transactions.length - 1 ? this.microTez.times(fee).toString() : '0';\n      const gasLimit = transactions[i].gasLimit.toString();\n      const storageLimit = transactions[i].storageLimit.toString();\n      if (tokenTransfer) {\n        console.log('Invoke contract: ' + tokenTransfer);\n        let invocation: any;\n        const { kind, decimals, contractAddress, id } = this.tokenService.getAsset(tokenTransfer);\n        const txAmount = Big(10 ** decimals).times(transactions[i].amount);\n        if (!txAmount.mod(1).eq(0)) {\n          throw new Error(`the amount ${transactions[i].amount} is not within ${decimals} decimals`);\n        }\n        if (kind === 'FA1.2') {\n          invocation = this.getFA12Transaction(pkh, transactions[i].destination, txAmount.toFixed(0));\n        } else if (kind === 'FA2') {\n          invocation = this.getFA2Transaction(pkh, transactions[i].destination, txAmount.toFixed(0), id);\n        } else {\n          throw new Error('Unrecognized token kind');\n        }\n        fop.contents.push({\n          kind: 'transaction',\n          source: pkh,\n          fee: currentFee,\n          counter: (++counter).toString(),\n          gas_limit: gasLimit,\n          storage_limit: storageLimit,\n          amount: '0',\n          destination: contractAddress,\n          parameters: invocation\n        });\n      } else if (from.slice(0, 2) === 'tz') {\n        const transactionOp: any = {\n          kind: 'transaction',\n          source: from,\n          fee: currentFee,\n          counter: (++counter).toString(),\n          gas_limit: gasLimit,\n          storage_limit: storageLimit,\n          amount: this.microTez.times(transactions[i].amount).toString(),\n          destination: transactions[i].destination\n        };\n        if (transactions[i].parameters) {\n          transactionOp.parameters = transactions[i].parameters;\n        }\n        fop.contents.push(transactionOp);\n      } else if (from.slice(0, 2) === 'KT') {\n        if (transactions[i].destination.slice(0, 2) === 'tz') {\n          const managerTransaction = this.getContractPkhTransaction(transactions[i].destination, this.microTez.times(transactions[i].amount).toString());\n          fop.contents.push({\n            kind: 'transaction',\n            source: pkh,\n            fee: currentFee,\n            counter: (++counter).toString(),\n            gas_limit: gasLimit,\n            storage_limit: storageLimit,\n            amount: '0',\n            destination: from,\n            parameters: managerTransaction\n          });\n        } else if (transactions[i].destination.slice(0, 2) === 'KT') {\n          const managerTransaction = this.getContractKtTransaction(transactions[i].destination, this.microTez.times(transactions[i].amount).toString());\n          fop.contents.push({\n            kind: 'transaction',\n            source: pkh,\n            fee: currentFee,\n            counter: (++counter).toString(),\n            gas_limit: gasLimit,\n            storage_limit: storageLimit,\n            amount: '0',\n            destination: from,\n            parameters: managerTransaction\n          });\n        }\n      }\n    }\n    return fop;\n  }\n  /*\n    Returns an observable for the delegation of baking rights.\n  */\n  delegate(from: string, to: string, fee: number = 0, keys: KeyPair): Observable<any> {\n    return this.getHeader()\n      .pipe(\n        flatMap((header: any) => {\n          return this.getRpc(`chains/main/blocks/head/context/contracts/${keys.pkh}/counter`).pipe(\n            flatMap((actions: any) => {\n              return this.getRpc(`chains/main/blocks/head/context/contracts/${keys.pkh}/manager_key`).pipe(\n                flatMap((manager: any) => {\n                  if (fee > this.feeHardCap) {\n                    throw new Error('TooHighFee');\n                  }\n                  let counter: number = Number(actions);\n                  let delegationOp: any;\n                  if (from.slice(0, 2) === 'tz') {\n                    delegationOp = {\n                      kind: 'delegation',\n                      source: from,\n                      fee: this.microTez.times(fee).toString(),\n                      counter: (++counter).toString(),\n                      gas_limit: '1000',\n                      storage_limit: '0'\n                    };\n                    if (to !== '') {\n                      delegationOp.delegate = to;\n                    }\n                  } else if (from.slice(0, 2) === 'KT') {\n                    delegationOp = {\n                      kind: 'transaction',\n                      source: keys.pkh,\n                      fee: this.microTez.times(fee).toString(),\n                      counter: (++counter).toString(),\n                      gas_limit: '4380',\n                      storage_limit: '0',\n                      amount: '0',\n                      destination: from,\n                      parameters: to !== '' ? this.getContractDelegation(to) : this.getContractUnDelegation()\n                    };\n                  }\n                  const fop: any = {\n                    branch: header.hash,\n                    contents: [delegationOp]\n                  };\n                  if (manager === null) {\n                    fop.contents[1] = fop.contents[0];\n                    fop.contents[0] = {\n                      kind: 'reveal',\n                      source: keys.pkh,\n                      fee: '0',\n                      counter: counter.toString(),\n                      gas_limit: '1000',\n                      storage_limit: '0',\n                      public_key: keys.pk\n                    };\n                    fop.contents[1].counter = (Number(fop.contents[1].counter) + 1).toString();\n                  }\n                  return this.operation(fop, header, keys);\n                })\n              );\n            })\n          );\n        })\n      )\n      .pipe(catchError((err) => this.errHandler(err)));\n  }\n  /*\n  Help function for operations\n  */\n  operation(fop: any, header: any, keys: KeyPair, origination: boolean = false): Observable<any> {\n    console.log('fop to send: ' + JSON.stringify(fop));\n    return this.postRpc('chains/main/blocks/head/helpers/forge/operations', fop).pipe(\n      flatMap((opbytes: any) => {\n        return this.localForge(fop).pipe(\n          flatMap((localOpbytes: string) => {\n            if (opbytes !== localOpbytes) {\n              throw new Error('ValidationError');\n            }\n            if (!keys.sk) {\n              fop.signature = 'edsigtXomBKi5CTRf5cjATJWSyaRvhfYNHqSUGrn4SdbYRcGwQrUGjzEfQDTuqHhuA8b2d8NarZjz8TRf65WkpQmo423BtomS8Q';\n              return this.postRpc('chains/main/blocks/head/helpers/scripts/run_operation', { operation: fop, chain_id: header.chain_id }).pipe(\n                flatMap((applied: any) => {\n                  console.log('applied: ' + JSON.stringify(applied));\n                  this.checkApplied([applied]);\n                  return of({\n                    success: true,\n                    payload: {\n                      unsignedOperation: opbytes\n                    }\n                  });\n                })\n              );\n            } else {\n              fop.protocol = header.protocol;\n              const signed = this.sign('03' + opbytes, keys.sk);\n              const sopbytes = signed.sbytes;\n              fop.signature = signed.edsig;\n              return this.postRpc('chains/main/blocks/head/helpers/preapply/operations', [fop]).pipe(\n                flatMap((applied: any) => {\n                  console.log('applied: ' + JSON.stringify(applied));\n                  this.checkApplied(applied);\n                  console.log('sop: ' + sopbytes);\n                  return this.postRpc('injection/operation', JSON.stringify(sopbytes))\n                    .pipe(timeout(30000))\n                    .pipe(\n                      flatMap((final: any) => {\n                        let newPkh = null;\n                        if (origination) {\n                          newPkh = applied[0].contents[fop.contents.length - 1].metadata.operation_result.originated_contracts[0];\n                        }\n                        return this.opCheck(final, newPkh);\n                      })\n                    );\n                })\n              );\n            }\n          })\n        );\n      })\n    );\n  }\n  /*\n    Broadcast a signed operation to the network\n  */\n  broadcast(sopbytes: string): Observable<any> {\n    console.log('Broadcast...');\n    const opbytes = sopbytes.slice(0, sopbytes.length - 128);\n    const edsig = this.sig2edsig(sopbytes.slice(sopbytes.length - 128));\n    return fromPromise(localForger.parse(opbytes))\n      .pipe(\n        flatMap((fop: any) => {\n          fop.signature = edsig;\n          return this.getHeader().pipe(\n            flatMap((header: any) => {\n              fop.protocol = header.protocol;\n              return this.postRpc('chains/main/blocks/head/helpers/preapply/operations', [fop]).pipe(\n                flatMap((parsed: any) => {\n                  let newPkh = null;\n                  for (let i = 0; i < parsed[0].contents.length; i++) {\n                    if (parsed[0].contents[i].kind === 'origination') {\n                      newPkh = parsed[0].contents[i].metadata.operation_result.originated_contracts[0];\n                    }\n                  }\n                  return this.postRpc('injection/operation', JSON.stringify(sopbytes)).pipe(\n                    flatMap((final: any) => {\n                      return this.opCheck(final, newPkh);\n                    })\n                  );\n                })\n              );\n            })\n          );\n        })\n      )\n      .pipe(catchError((err) => this.errHandler(err)));\n  }\n  torusKeyLookup(tz2address: string): Observable<any> {\n    // Make it into Promise\n    // Zero padding\n    if (tz2address.length !== 36 || tz2address.slice(0, 3) !== 'tz2') {\n      throw new Error('InvalidTorusAddress');\n    }\n    return this.getRpc(`chains/main/blocks/head/context/contracts/${tz2address}/manager_key`).pipe(\n      flatMap((manager: any) => {\n        if (manager === null) {\n          return of({ noReveal: true });\n        } else {\n          return fromPromise(this.decompress(manager)).pipe(\n            flatMap((pk: any) => {\n              const torusReq = {\n                jsonrpc: '2.0',\n                method: 'KeyLookupRequest',\n                id: 10,\n                params: {\n                  pub_key_X: pk.X,\n                  pub_key_Y: pk.Y\n                }\n              };\n              const url = CONSTANTS.NETWORK === 'mainnet' ? 'https://torus-19.torusnode.com/jrpc' : 'https://teal-15-1.torusnode.com/jrpc';\n              return this.http.post(url, JSON.stringify(torusReq), httpOptions).pipe(\n                flatMap((ans: any) => {\n                  try {\n                    if (ans.result.PublicKey.X === pk.X && ans.result.PublicKey.Y === pk.Y) {\n                      return of(ans);\n                    } else {\n                      return of(null);\n                    }\n                  } catch {\n                    return of(null);\n                  }\n                })\n              );\n            })\n          );\n        }\n      })\n    );\n  }\n  checkApplied(applied: any) {\n    let failed = false;\n    for (let i = 0; i < applied[0].contents.length; i++) {\n      if (applied[0].contents[i].metadata.operation_result.status !== 'applied') {\n        failed = true;\n        if (applied[0].contents[i].metadata.operation_result.errors) {\n          console.log('Error in operation_result');\n          throw applied[0].contents[i].metadata.operation_result.errors[applied[0].contents[i].metadata.operation_result.errors.length - 1];\n        } else if (applied[0].contents[i].metadata.internal_operation_results && applied[0].contents[i].metadata.internal_operation_results[0].result.errors) {\n          console.log('Error in internal_operation_results');\n          throw applied[0].contents[i].metadata.internal_operation_results[0].result.errors[\n            applied[0].contents[i].metadata.internal_operation_results[0].result.errors.length - 1\n          ];\n        }\n      }\n    }\n    if (failed) {\n      throw new Error('Uncaught error in preapply');\n    }\n  }\n  errHandler(error: any): Observable<any> {\n    console.log(error);\n    if (error.error && typeof error.error === 'string') {\n      // parsing errors\n      error = error.error;\n      const lines = error.split('\\n').map((line: string) => {\n        return line.trim();\n      });\n      if (lines?.length) {\n        for (const i in lines) {\n          if (lines[i].startsWith('At /') && !lines[i].startsWith('At /kind')) {\n            const n = Number(i) + 1;\n            if (lines[n]) {\n              error = `${lines[i]} ${lines[n]}`;\n            }\n          }\n        }\n      }\n    }\n    if (error.error && error.error[0]) {\n      error = error.error[0];\n    }\n    if (error.message) {\n      error = this.errorHandlingPipe.transform(error.message);\n    } else if (error.id) {\n      if (error.with) {\n        error = this.errorHandlingPipe.transform(error.id, error.with, error?.location);\n      } else if (error.id === 'failure' && error.msg) {\n        error = this.errorHandlingPipe.transform(error.msg);\n      } else {\n        error = this.errorHandlingPipe.transform(error.id);\n      }\n    } else if (error.statusText) {\n      error = error.statusText;\n    } else if (typeof error === 'string') {\n      error = this.errorHandlingPipe.transform(error);\n    } else {\n      console.warn('Error not categorized', error);\n      error = 'Unrecogized error';\n    }\n    return of({\n      success: false,\n      payload: {\n        msg: error\n      }\n    });\n  }\n  // Local forge with Taquito\n  localForge(operation: any): Observable<string> {\n    return fromPromise(localForger.forge(operation)).pipe(\n      flatMap((localForgedBytes: string) => {\n        return of(localForgedBytes);\n      })\n    );\n  }\n  getHeader(): Observable<any> {\n    return this.getRpc(`chains/main/blocks/head~3/header`);\n  }\n  getBalance(pkh: string): Observable<any> {\n    return this.getRpc(`chains/main/blocks/head/context/contracts/${pkh}/balance`)\n      .pipe(\n        flatMap((balance: any) => {\n          return of({\n            success: true,\n            payload: {\n              balance: balance\n            }\n          });\n        })\n      )\n      .pipe(catchError((err) => this.errHandler(err)));\n  }\n  getDelegate(pkh: string): Observable<any> {\n    return this.getRpc(`chains/main/blocks/head/context/contracts/${pkh}`)\n      .pipe(\n        flatMap((contract: any) => {\n          let delegate = '';\n          if (contract.delegate) {\n            delegate = contract.delegate;\n          }\n          return of({\n            success: true,\n            payload: {\n              delegate: delegate\n            }\n          });\n        })\n      )\n      .pipe(catchError((err) => this.errHandler(err)));\n  }\n  getVotingRights(): Observable<any> {\n    return this.getRpc(`chains/main/blocks/head/votes/listings`)\n      .pipe(\n        flatMap((listings: any) => {\n          return of({\n            success: true,\n            payload: listings\n          });\n        })\n      )\n      .pipe(catchError((err) => this.errHandler(err)));\n  }\n  isRevealed(pkh: string): Observable<boolean> {\n    return this.getRpc(`chains/main/blocks/head/context/contracts/${pkh}/manager_key`)\n      .pipe(\n        flatMap((manager: any) => {\n          if (manager === null) {\n            return of(false);\n          } else {\n            return of(true);\n          }\n        })\n      )\n      .pipe(\n        catchError((err) => {\n          return of(true);\n        })\n      ); // conservative action\n  }\n  getManager(pkh: string): Observable<string> {\n    return this.getRpc(`chains/main/blocks/head/context/contracts/${pkh}/manager_key`).pipe(\n      flatMap((pk: string) => {\n        return of(pk ?? '');\n      })\n    );\n  }\n  getAccount(pkh: string): Observable<any> {\n    return this.getRpc(`chains/main/blocks/head/context/contracts/${pkh}`)\n      .pipe(\n        flatMap((contract: any) => {\n          let delegate = '';\n          if (contract.delegate) {\n            delegate = contract.delegate;\n          }\n          return of({\n            success: true,\n            payload: {\n              balance: contract.balance,\n              manager: contract.manager,\n              delegate: delegate,\n              counter: contract.counter\n            }\n          });\n        })\n      )\n      .pipe(catchError((err) => this.errHandler(err)));\n  }\n  getVerifiedOpBytes(operationLevel, operationHash, pkh, pk): Observable<string> {\n    return this.getRpc(`chains/main/blocks/${operationLevel}/operation_hashes`).pipe(\n      flatMap((opHashes: any) => {\n        const opIndex = opHashes[3].findIndex((a) => a === operationHash);\n        return this.getRpc(`chains/main/blocks/${operationLevel}/operations`).pipe(\n          flatMap((op: any) => {\n            let ans = '';\n            op = op[3][opIndex];\n            const sig = op.signature;\n            delete op.chain_id;\n            delete op.signature;\n            delete op.hash;\n            delete op.protocol;\n            for (let i = 0; i < op.contents.length; i++) {\n              delete op.contents[i].metadata;\n              if (op.contents[i].managerPubkey) {\n                // Fix for mainnet\n                op.contents[i].manager_pubkey = op.contents[i].managerPubkey;\n                delete op.contents[i].managerPubkey;\n              }\n            }\n            return this.postRpc('chains/main/blocks/head/helpers/forge/operations', op).pipe(\n              flatMap((opBytes: any) => {\n                if (this.pk2pkh(pk) === pkh) {\n                  if (this.verify(opBytes, sig, pk)) {\n                    ans = opBytes + this.buf2hex(this.b58cdecode(sig, this.prefix.sig));\n                  } else {\n                    throw new Error('InvalidSignature');\n                  }\n                } else {\n                  throw new Error('InvalidPublicKey');\n                }\n                return of(ans);\n              })\n            );\n          })\n        );\n      })\n    );\n  }\n  getConstants(): Observable<any> {\n    return this.getRpc(`chains/main/blocks/head/context/constants`);\n  }\n  seed2keyPair(seed: Buffer): KeyPair {\n    if (!seed) {\n      throw new Error('NullSeed');\n    }\n    const keyPair = naclSign.keyPair.fromSeed(seed);\n    return {\n      sk: this.b58cencode(keyPair.secretKey, this.prefix.edsk),\n      pk: this.b58cencode(keyPair.publicKey, this.prefix.edpk),\n      pkh: this.b58cencode(blake2b(keyPair.publicKey, null, 20), this.prefix.tz1)\n    };\n  }\n  mnemonic2seed(mnemonic: string, passphrase: string = '') {\n    if (!this.validMnemonic(mnemonic)) {\n      throw new Error('InvalidMnemonic');\n    }\n    return bip39.mnemonicToSeedSync(mnemonic, passphrase).slice(0, 32);\n  }\n  mnemonic2entropy(mnemonic: string, passphrase: string = '') {\n    if (!this.validMnemonic(mnemonic)) {\n      throw new Error('InvalidMnemonic');\n    }\n    return bip39.mnemonicToEntropy(mnemonic);\n  }\n  validMnemonic(mnemonic: string) {\n    return bip39.validateMnemonic(mnemonic);\n  }\n  validAddress(address: string) {\n    try {\n      this.b58cdecode(address, this.prefix.tz1);\n      return true;\n    } catch (e) {\n      return false;\n    }\n  }\n  pk2pkh(pk: string): string {\n    if (pk.length === 54 && pk.slice(0, 4) === 'edpk') {\n      const pkDecoded = this.b58cdecode(pk, this.prefix.edpk);\n      return this.b58cencode(blake2b(pkDecoded, null, 20), this.prefix.tz1);\n    } else if (pk.length === 55 && pk.slice(0, 4) === 'sppk') {\n      const pkDecoded = this.b58cdecode(pk, this.prefix.edpk);\n      return this.b58cencode(blake2b(pkDecoded, null, 20), this.prefix.tz2);\n    }\n    throw new Error('Invalid public key');\n  }\n  spPrivKeyToKeyPair(secretKey: string) {\n    let sk;\n    if (secretKey.match(/^[0-9a-f]{64}$/g)) {\n      sk = this.b58cencode(this.hex2buf(secretKey), this.prefix.spsk);\n    } else if (secretKey.match(/^spsk[1-9a-km-zA-HJ-NP-Z]{50}$/g)) {\n      sk = secretKey;\n    } else {\n      throw new Error('Invalid private key');\n    }\n    const keyPair = new elliptic.ec('secp256k1').keyFromPrivate(new Uint8Array(this.b58cdecode(sk, this.prefix.spsk)));\n    const yArray = keyPair.getPublic().getY().toArray();\n    const prefixVal = yArray[yArray.length - 1] % 2 ? 3 : 2; // Y odd / even\n    const pad = new Array(32).fill(0); // Zero-padding\n    const publicKey = new Uint8Array([prefixVal].concat(pad.concat(keyPair.getPublic().getX().toArray()).slice(-32)));\n    const pk = this.b58cencode(publicKey, this.prefix.sppk);\n    if (yArray.length < 32 && prefixVal === 3 && this.isInvertedPk(pk)) {\n      return this.spPrivKeyToKeyPair(this.invertSpsk(sk));\n    }\n    const pkh = this.pk2pkh(pk);\n    return { sk, pk, pkh };\n  }\n  isInvertedPk(pk: string): boolean {\n    /*\n      Detect keys with flipped sign and correct them.\n    */\n    const invertedPks = [\n      'sppk7cqh7BbgUMFh4yh95mUwEeg5aBPG1MBK1YHN7b9geyygrUMZByr', // test variable\n      'sppk7bMTva1MwF7cXjrcfoj6XVfcYgjrVaR9JKP3JxvPB121Ji5ftHT',\n      'sppk7bLtXf9CAVZh5jjDACezPnuwHf9CgVoAneNXQFgHknNtCyE5k8A'\n    ];\n    return invertedPks.includes(pk);\n  }\n  invertSpsk(sk: string) {\n    const x = new Uint8Array([...new Uint8Array(32).fill(0), ...this.b58cdecode(sk, this.prefix.spsk)]).slice(-32);\n    const p = this.hex2buf('FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141'.toLowerCase());\n    let inv = []; // p - x\n    let remainder = 0;\n    for (let i = 31; i >= 0; i--) {\n      let sub = p[i] - x[i] - remainder;\n      if (sub < 0) {\n        sub += 256;\n        remainder = 1;\n      } else {\n        remainder = 0;\n      }\n      inv.push(sub);\n    }\n    if (remainder) {\n      throw new Error('Invalid X');\n    }\n    inv = inv.reverse();\n    return this.buf2hex(inv);\n  }\n  spPointsToPkh(pubX: string, pubY: string): string {\n    const key = new elliptic.ec('secp256k1').keyFromPublic({\n      x: pubX,\n      y: pubY\n    });\n    const yArray = key.getPublic().getY().toArray();\n    const prefixVal = yArray[yArray.length - 1] % 2 ? 3 : 2;\n    const pad = new Array(32).fill(0);\n    let publicKey = new Uint8Array([prefixVal].concat(pad.concat(key.getPublic().getX().toArray()).slice(-32)));\n    let pk = this.b58cencode(publicKey, this.prefix.sppk);\n    if (yArray.length < 32 && prefixVal === 3 && this.isInvertedPk(pk)) {\n      publicKey = new Uint8Array([2].concat(pad.concat(key.getPublic().getX().toArray()).slice(-32)));\n      pk = this.b58cencode(publicKey, this.prefix.sppk);\n    }\n    const pkh = this.pk2pkh(pk);\n    return pkh;\n  }\n  async decompress(pk: string): Promise<any> {\n    const decodedPk = this.b58cdecode(pk, this.prefix.sppk);\n    const hexPk = this.buf2hex(decodedPk);\n    const secp256k1 = await instantiateSecp256k1();\n    const compressed = hexToBin(hexPk);\n    const uncompressed = secp256k1.uncompressPublicKey(compressed);\n    const xy = binToHex(uncompressed).slice(2);\n    return { X: xy.slice(0, 64), Y: xy.slice(64, 128) };\n  }\n  hex2pk(hex: string): string {\n    return this.b58cencode(this.hex2buf(hex.slice(2, 66)), this.prefix.edpk);\n  }\n  hex2buf(hex) {\n    return new Uint8Array(\n      hex.match(/[\\da-f]{2}/gi).map(function (h) {\n        return parseInt(h, 16);\n      })\n    );\n  }\n  buf2hex(buffer) {\n    const byteArray = new Uint8Array(buffer),\n      hexParts = [];\n    for (let i = 0; i < byteArray.length; i++) {\n      const hex = byteArray[i].toString(16);\n      const paddedHex = ('00' + hex).slice(-2);\n      hexParts.push(paddedHex);\n    }\n    return hexParts.join('');\n  }\n  b58cencode(payload: any, prefixx?: Uint8Array) {\n    const n = new Uint8Array(prefixx.length + payload.length);\n    n.set(prefixx);\n    n.set(payload, prefixx.length);\n    return Bs58check.encode(Buffer.from(this.buf2hex(n), 'hex'));\n  }\n  b58cdecode(enc, prefixx) {\n    let n = Bs58check.decode(enc);\n    n = n.slice(prefixx.length);\n    return n;\n  }\n  ledgerPreHash(opbytes: string): string {\n    return this.buf2hex(blake2b(this.hex2buf(opbytes), null, 32));\n  }\n  sign(bytes: string, sk: string): any {\n    if (!['03', '05'].includes(bytes.slice(0, 2))) {\n      throw new Error('Invalid prefix');\n    }\n    if (sk.slice(0, 4) === 'spsk') {\n      const hash = blake2b(this.hex2buf(bytes), null, 32);\n      bytes = bytes.slice(2);\n      const key = new elliptic.ec('secp256k1').keyFromPrivate(new Uint8Array(this.b58cdecode(sk, this.prefix.spsk)));\n      let sig = key.sign(hash, { canonical: true });\n      const pad = new Array(32).fill(0);\n      const r = pad.concat(sig.r.toArray()).slice(-32);\n      const s = pad.concat(sig.s.toArray()).slice(-32);\n      sig = new Uint8Array(r.concat(s));\n      const spsig = this.b58cencode(sig, this.prefix.spsig);\n      const sbytes = bytes + this.buf2hex(sig);\n      return {\n        bytes: bytes,\n        sig: sig,\n        edsig: spsig,\n        sbytes: sbytes\n      };\n    } else {\n      const hash = blake2b(this.hex2buf(bytes), null, 32);\n      bytes = bytes.slice(2);\n      const sig = naclSign.detached(hash, this.b58cdecode(sk, this.prefix.edsk));\n      const edsig = this.b58cencode(sig, this.prefix.edsig);\n      const sbytes = bytes + this.buf2hex(sig);\n      return {\n        bytes: bytes,\n        sig: sig,\n        edsig: edsig,\n        sbytes: sbytes\n      };\n    }\n  }\n  hexsigToEdsig(hex: string): string {\n    return this.b58cencode(this.hex2buf(hex), this.prefix.edsig);\n  }\n  verify(bytes: string, sig: string, pk: string): Boolean {\n    console.log('bytes', bytes);\n    const hash = blake2b(this.hex2buf(bytes), null, 32);\n    const signature = this.b58cdecode(sig, this.prefix.edsig);\n    const publicKey = this.b58cdecode(pk, this.prefix.edpk);\n    return naclSign.detached.verify(signature, hash, publicKey);\n  }\n  sig2edsig(sig: string): any {\n    return this.b58cencode(this.hex2buf(sig), this.prefix.edsig);\n  }\n  decodeString(bytes: string): string {\n    return Buffer.from(this.hex2buf(bytes)).toString('utf-8');\n  }\n  zarithDecode(hex: string): any {\n    let count = 0;\n    let value = 0;\n    while (1) {\n      const byte = Number('0x' + hex.slice(0 + count * 2, 2 + count * 2));\n      value += (byte & 127) * 128 ** count;\n      count++;\n      if ((byte & 128) !== 128) {\n        break;\n      }\n    }\n    return {\n      value: value,\n      count: count\n    };\n  }\n  zarithDecodeInt(hex: string): any {\n    let count = 0;\n    let value = Big(0);\n    while (1) {\n      const byte = Number('0x' + hex.slice(0 + count * 2, 2 + count * 2));\n      if (count === 0) {\n        value = Big((byte & 63) * 128 ** count).add(value);\n      } else {\n        value = Big(((byte & 127) * 2) >> 1)\n          .times(64 * 128 ** (count - 1))\n          .add(value);\n      }\n      count++;\n      if ((byte & 128) !== 128) {\n        break;\n      }\n    }\n    return {\n      value: value,\n      count: count\n    };\n  }\n  getContractDelegation(pkh: string) {\n    return {\n      entrypoint: 'do',\n      value: [\n        { prim: 'DROP' },\n        {\n          prim: 'NIL',\n          args: [{ prim: 'operation' }]\n        },\n        {\n          prim: 'PUSH',\n          args: [\n            { prim: 'key_hash' },\n            {\n              string: pkh\n            }\n          ]\n        },\n        { prim: 'SOME' },\n        { prim: 'SET_DELEGATE' },\n        { prim: 'CONS' }\n      ]\n    };\n  }\n  getContractUnDelegation() {\n    return {\n      entrypoint: 'do',\n      value: [\n        { prim: 'DROP' },\n        {\n          prim: 'NIL',\n          args: [{ prim: 'operation' }]\n        },\n        {\n          prim: 'NONE',\n          args: [{ prim: 'key_hash' }]\n        },\n        { prim: 'SET_DELEGATE' },\n        { prim: 'CONS' }\n      ]\n    };\n  }\n  getContractPkhTransaction(to: string, amount: string) {\n    return {\n      entrypoint: 'do',\n      value: [\n        { prim: 'DROP' },\n        { prim: 'NIL', args: [{ prim: 'operation' }] },\n        {\n          prim: 'PUSH',\n          args: [\n            { prim: 'key_hash' },\n            {\n              string: to\n            }\n          ]\n        },\n        { prim: 'IMPLICIT_ACCOUNT' },\n        {\n          prim: 'PUSH',\n          args: [{ prim: 'mutez' }, { int: amount }]\n        },\n        { prim: 'UNIT' },\n        { prim: 'TRANSFER_TOKENS' },\n        { prim: 'CONS' }\n      ]\n    };\n  }\n  getContractKtTransaction(to: string, amount: string) {\n    return {\n      entrypoint: 'do',\n      value: [\n        { prim: 'DROP' },\n        { prim: 'NIL', args: [{ prim: 'operation' }] },\n        {\n          prim: 'PUSH',\n          args: [{ prim: 'address' }, { string: to }]\n        },\n        { prim: 'CONTRACT', args: [{ prim: 'unit' }] },\n        [\n          {\n            prim: 'IF_NONE',\n            args: [[[{ prim: 'UNIT' }, { prim: 'FAILWITH' }]], []]\n          }\n        ],\n        {\n          prim: 'PUSH',\n          args: [{ prim: 'mutez' }, { int: amount }]\n        },\n        { prim: 'UNIT' },\n        { prim: 'TRANSFER_TOKENS' },\n        { prim: 'CONS' }\n      ]\n    };\n  }\n  getManagerScript(pkh: string) {\n    let pkHex: string;\n    if (pkh.slice(0, 2) === 'tz') {\n      pkHex = '00' + this.buf2hex(this.b58cdecode(pkh, this.prefix.tz1));\n    } else {\n      pkHex = pkh;\n    }\n    return {\n      code: [\n        {\n          prim: 'parameter',\n          args: [\n            {\n              prim: 'or',\n              args: [\n                {\n                  prim: 'lambda',\n                  args: [\n                    {\n                      prim: 'unit'\n                    },\n                    {\n                      prim: 'list',\n                      args: [\n                        {\n                          prim: 'operation'\n                        }\n                      ]\n                    }\n                  ],\n                  annots: ['%do']\n                },\n                {\n                  prim: 'unit',\n                  annots: ['%default']\n                }\n              ]\n            }\n          ]\n        },\n        {\n          prim: 'storage',\n          args: [\n            {\n              prim: 'key_hash'\n            }\n          ]\n        },\n        {\n          prim: 'code',\n          args: [\n            [\n              [\n                [\n                  {\n                    prim: 'DUP'\n                  },\n                  {\n                    prim: 'CAR'\n                  },\n                  {\n                    prim: 'DIP',\n                    args: [\n                      [\n                        {\n                          prim: 'CDR'\n                        }\n                      ]\n                    ]\n                  }\n                ]\n              ],\n              {\n                prim: 'IF_LEFT',\n                args: [\n                  [\n                    {\n                      prim: 'PUSH',\n                      args: [\n                        {\n                          prim: 'mutez'\n                        },\n                        {\n                          int: '0'\n                        }\n                      ]\n                    },\n                    {\n                      prim: 'AMOUNT'\n                    },\n                    [\n                      [\n                        {\n                          prim: 'COMPARE'\n                        },\n                        {\n                          prim: 'EQ'\n                        }\n                      ],\n                      {\n                        prim: 'IF',\n                        args: [\n                          [],\n                          [\n                            [\n                              {\n                                prim: 'UNIT'\n                              },\n                              {\n                                prim: 'FAILWITH'\n                              }\n                            ]\n                          ]\n                        ]\n                      }\n                    ],\n                    [\n                      {\n                        prim: 'DIP',\n                        args: [\n                          [\n                            {\n                              prim: 'DUP'\n                            }\n                          ]\n                        ]\n                      },\n                      {\n                        prim: 'SWAP'\n                      }\n                    ],\n                    {\n                      prim: 'IMPLICIT_ACCOUNT'\n                    },\n                    {\n                      prim: 'ADDRESS'\n                    },\n                    {\n                      prim: 'SENDER'\n                    },\n                    [\n                      [\n                        {\n                          prim: 'COMPARE'\n                        },\n                        {\n                          prim: 'EQ'\n                        }\n                      ],\n                      {\n                        prim: 'IF',\n                        args: [\n                          [],\n                          [\n                            [\n                              {\n                                prim: 'UNIT'\n                              },\n                              {\n                                prim: 'FAILWITH'\n                              }\n                            ]\n                          ]\n                        ]\n                      }\n                    ],\n                    {\n                      prim: 'UNIT'\n                    },\n                    {\n                      prim: 'EXEC'\n                    },\n                    {\n                      prim: 'PAIR'\n                    }\n                  ],\n                  [\n                    {\n                      prim: 'DROP'\n                    },\n                    {\n                      prim: 'NIL',\n                      args: [\n                        {\n                          prim: 'operation'\n                        }\n                      ]\n                    },\n                    {\n                      prim: 'PAIR'\n                    }\n                  ]\n                ]\n              }\n            ]\n          ]\n        }\n      ],\n      storage: { bytes: pkHex }\n    };\n  }\n  getFA12Transaction(from: string, to: string, amount: string) {\n    return {\n      entrypoint: 'transfer',\n      value: {\n        args: [\n          {\n            string: from\n          },\n          {\n            args: [\n              {\n                string: to\n              },\n              {\n                int: amount\n              }\n            ],\n            prim: 'Pair'\n          }\n        ],\n        prim: 'Pair'\n      }\n    };\n  }\n  getFA2Transaction(from: string, to: string, amount: string, id: string) {\n    return {\n      entrypoint: 'transfer',\n      value: [\n        {\n          prim: 'Pair',\n          args: [\n            {\n              string: from\n            },\n            [\n              {\n                prim: 'Pair',\n                args: [\n                  {\n                    string: to\n                  },\n                  {\n                    prim: 'Pair',\n                    args: [\n                      {\n                        int: id.toString()\n                      },\n                      {\n                        int: amount\n                      }\n                    ]\n                  }\n                ]\n              }\n            ]\n          ]\n        }\n      ]\n    };\n  }\n  getApproveAmountParameters(from: string, amount: string) {\n    return {\n      entrypoint: 'approve',\n      value: {\n        prim: 'Pair',\n        args: [\n          {\n            string: from\n          },\n          {\n            int: amount\n          }\n        ]\n      }\n    };\n  }\n  getRevokeAmountParameters(from: string) {\n    return {\n      entrypoint: 'approve',\n      value: {\n        prim: 'Pair',\n        args: [\n          {\n            string: from\n          },\n          {\n            int: '0'\n          }\n        ]\n      }\n    };\n  }\n  getXTZToTokenParameters(from: string, minimum: string, expirationTime: string) {\n    return {\n      entrypoint: 'xtzToToken',\n      value: {\n        prim: 'Pair',\n        args: [\n          {\n            string: from\n          },\n          {\n            prim: 'Pair',\n            args: [\n              {\n                int: minimum\n              },\n              {\n                string: expirationTime\n              }\n            ]\n          }\n        ]\n      }\n    };\n  }\n  getTokenToXTZParameters(from: string, minimumToken: string, minimumXTZ: string, expirationTime: string) {\n    return {\n      entrypoint: 'tokenToXtz',\n      value: {\n        prim: 'Pair',\n        args: [\n          {\n            string: from\n          },\n          {\n            prim: 'Pair',\n            args: [\n              {\n                int: minimumToken\n              },\n              {\n                prim: 'Pair',\n                args: [\n                  {\n                    int: minimumXTZ\n                  },\n                  {\n                    string: expirationTime\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      }\n    };\n  }\n\n  getAddLiquidityParameters(from: string, minimumLqt: string, minimumToken: string, expirationTime: string) {\n    return {\n      entrypoint: 'addLiquidity',\n      value: {\n        prim: 'Pair',\n        args: [\n          {\n            string: from\n          },\n          {\n            prim: 'Pair',\n            args: [\n              {\n                int: minimumLqt\n              },\n              {\n                prim: 'Pair',\n                args: [\n                  {\n                    int: minimumToken\n                  },\n                  {\n                    string: expirationTime\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      }\n    };\n  }\n\n  getRemoveLiquidityParameters(from: string, lqtBurn: string, minXtzWithdrawn: string, minTokensWithdrawn: string, expirationTime: string) {\n    return {\n      entrypoint: 'removeLiquidity',\n\n      value: {\n        prim: 'Pair',\n        args: [\n          {\n            string: from\n          },\n          {\n            prim: 'Pair',\n            args: [\n              {\n                int: lqtBurn\n              },\n              {\n                prim: 'Pair',\n                args: [\n                  {\n                    int: minXtzWithdrawn\n                  },\n                  {\n                    prim: 'Pair',\n                    args: [\n                      {\n                        int: minTokensWithdrawn\n                      },\n                      {\n                        string: expirationTime\n                      }\n                    ]\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      }\n    };\n  }\n\n  getTezToTokenPaymentParameters(from: string, minimumToken: string) {\n    return {\n      entrypoint: 'tezToTokenPayment',\n      value: {\n        prim: 'Pair',\n        args: [\n          {\n            int: minimumToken\n          },\n          {\n            string: from\n          }\n        ]\n      }\n    };\n  }\n\n  getTokenToTezPaymentParameters(from: string, minimumXtz: string, minimumToken: string) {\n    return {\n      entrypoint: 'tokenToTezPayment',\n      value: {\n        prim: 'Pair',\n        args: [\n          {\n            prim: 'Pair',\n            args: [\n              {\n                int: minimumToken\n              },\n              {\n                int: minimumXtz\n              }\n            ]\n          },\n          {\n            string: from\n          }\n        ]\n      }\n    };\n  }\n\n  parseTokenTransfer(op: any): { tokenId: string; to: string; amount: string } {\n    const opJson = JSON.stringify(op.parameters);\n    const addresses = opJson.match(/\\{\\\"string\\\":\\\"[^\\\"]*/g)?.map((s) => {\n      return s.slice(11);\n    });\n    const amounts = opJson.match(/\\{\\\"int\\\":\\\"[^\\\"]*/g)?.map((i) => {\n      return i.slice(8);\n    });\n    if (!addresses || !amounts) {\n      return null;\n    }\n    if (addresses.length === 2) {\n      if (amounts.length === 1) {\n        const fa12ref = this.getFA12Transaction(addresses[0], addresses[1], amounts[0]);\n        if (isEqual(fa12ref, op.parameters)) {\n          return {\n            tokenId: `${op.destination}:0`,\n            to: addresses[1],\n            amount: amounts[0]\n          };\n        }\n      } else if (amounts.length === 2) {\n        const fa2ref = this.getFA2Transaction(addresses[0], addresses[1], amounts[1], String(amounts[0]));\n        if (isEqual(fa2ref, op.parameters)) {\n          return {\n            tokenId: `${op.destination}:${amounts[0]}`,\n            to: addresses[1],\n            amount: amounts[1]\n          };\n        }\n      }\n    }\n    return null;\n  }\n  postRpc(path: string, payload: any): Observable<any> {\n    return this.http.post(`${this.nodeURL}/${path}`, payload, httpOptions).pipe(this.retryPipeline(path));\n  }\n  getRpc(path: string): Observable<any> {\n    return this.http.get(`${this.nodeURL}/${path}`).pipe(this.retryPipeline(path));\n  }\n  private retryPipeline(path: string, retries: number = 3): MonoTypeOperatorFunction<unknown> {\n    const retryWithWarning = (i, e) => {\n      if (i < retries) {\n        console.warn(`Retry ${i + 1}: ${path}`, e);\n      }\n      return of(e).pipe(delayOperator(250));\n    };\n    return retryWhen((errors) =>\n      errors.pipe(concatMap((e, i) => iif(() => i >= retries || !(e?.name === 'HttpErrorResponse'), throwError(e), retryWithWarning(i, e))))\n    );\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Subject } from 'rxjs';\nimport { TokenData } from '../token/token.service';\nimport { Account } from '../wallet/wallet';\n\ninterface PrepareTokenTransfer {\n  account: Account;\n  tokenTransfer: string;\n  symbol: string;\n}\ninterface MetadataUpdated {\n  contractAddress: string;\n  id: string;\n  token: TokenData;\n}\n@Injectable({\n  providedIn: 'root'\n})\nexport class SubjectService {\n  public activeAccount = new BehaviorSubject(null);\n  public walletUpdated = new BehaviorSubject(null);\n  public metadataUpdated: BehaviorSubject<MetadataUpdated>;\n  public markets: BehaviorSubject<any>;\n  public confirmedOp: Subject<string>;\n  public prepareTokenTransfer: Subject<PrepareTokenTransfer>;\n  public nftsUpdated: BehaviorSubject<any>;\n  public origin: BehaviorSubject<string>;\n  public beaconResponse: Subject<boolean>;\n  public logout: Subject<boolean>;\n  public moonpay: Subject<boolean>;\n  constructor() {\n    this.init();\n    this.logout.subscribe((o) => {\n      if (o) {\n        this.reset();\n      }\n    });\n  }\n  init() {\n    this.metadataUpdated = new BehaviorSubject<MetadataUpdated>(null);\n    this.markets = new BehaviorSubject<any>([]);\n    this.confirmedOp = new Subject<string>();\n    this.prepareTokenTransfer = new Subject<PrepareTokenTransfer>();\n    this.nftsUpdated = new BehaviorSubject<any>(undefined);\n    this.origin = new BehaviorSubject<string>(null);\n    this.beaconResponse = new Subject<boolean>();\n    this.logout = new Subject<boolean>();\n    this.moonpay = new Subject<boolean>();\n  }\n  reset() {\n    this.metadataUpdated.next(null);\n    this.markets.next([]);\n    this.nftsUpdated.next(undefined);\n  }\n}\n","import Big from 'big.js';\n\nexport class Amount {\n  decimalPlaces: number = 6;\n  internalBigInt: Big = Big(0);\n  internalNormalised: number = 0;\n\n  constructor(c: any) {\n    if (c?.rpcAmount === undefined && c?.normalisedAmount === undefined) {\n      return;\n    }\n    this.decimalPlaces = c.decimalPlaces;\n    if (!!c?.rpcAmount) {\n      let multiplierIntValue = Math.round(Math.pow(10, this.decimalPlaces));\n      this.internalNormalised = parseFloat(Big(c.rpcAmount).div(multiplierIntValue).toString() || 0);\n      this.internalBigInt = Big(c.rpcAmount);\n    } else if (!!c?.normalisedAmount) {\n      let multiplierIntValue = Math.round(Math.pow(10, this.decimalPlaces));\n      this.internalNormalised = parseFloat(Big(c.normalisedAmount).toString() || 0);\n      this.internalBigInt = Big(c.normalisedAmount).times(multiplierIntValue);\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport dexterCalculations from 'dexCalcs/dist/index-mobile.min';\nimport { Amount } from './classes/Amount';\nimport Big from 'big.js';\nimport { ChartSeries } from '../../../app/components/ui/chart/chart.component';\n@Injectable({ providedIn: 'root' })\nexport class SwapLiquidityService {\n  readonly lqdTokenContract = 'KT1AafHA1C1vk959wvHWBispY9Y2f3fxBUUo';\n  readonly lqdContract = 'KT1TxqZ8QtKvLu3V3JH7Gx58n7Co8pgtpQU5';\n  readonly tzBTCContract = 'KT1PWx2mnDueood7fEmfbBDKx1D9BAnnXitn';\n\n  public storage = {};\n  public dipdupContracts = [];\n\n  constructor() {}\n\n  async fetchContracts(offset = 0): Promise<void> {\n    const baseUrl = `https://dex.dipdup.net/v1/graphql`;\n    const req = {\n      query: `{dipdupContract(where: {}, offset: ${offset}) {address, name, typename, updatedAt, createdAt}}`\n    };\n    try {\n      const response = await (\n        await fetch(baseUrl, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(req)\n        })\n      ).json();\n      if (response?.data?.dipdupContract?.length > 0) {\n        this.dipdupContracts.concat(response.data.dipdupContract);\n        await this.fetchContracts(offset + 100);\n      } else if (offset === 0) {\n        throw new Error();\n      }\n      return;\n    } catch (e) {\n      throw new Error();\n    }\n  }\n\n  async fetchStorage(contract): Promise<void> {\n    try {\n      return await fetch(`https://api.tzkt.io/v1/contracts/${contract}/storage`)\n        .then((r) => r.json())\n        .then((r) => {\n          this.storage[contract] = {};\n          this.storage[contract].total_pool = r['lqtTotal'];\n          this.storage[contract].tez_pool = r['xtzPool'];\n          this.storage[contract].token_pool = r['tokenPool'];\n        });\n    } catch (e) {\n      throw new Error();\n    }\n  }\n\n  settings(dex: string): {\n    fee: string;\n    burn: string;\n    includeSubsidy: boolean;\n  } {\n    switch (dex) {\n      case 'liquidityBaking':\n        return { fee: '0.1', burn: '0.1', includeSubsidy: false };\n      case 'quipuswap':\n        return { fee: '0.3', burn: '0', includeSubsidy: false };\n      default:\n        return { fee: '0.3', burn: '0', includeSubsidy: false };\n    }\n  }\n\n  createPoolAmounts(): { xtzPool: Amount; tokenPool: Amount } {\n    const xtzPool = new Amount({\n      rpcAmount: parseFloat(this.storage[this.lqdContract]?.tez_pool),\n      decimalPlaces: 6\n    });\n    const tokenPool = new Amount({\n      rpcAmount: parseFloat(this.storage[this.lqdContract]?.token_pool),\n      decimalPlaces: 8\n    });\n    return { xtzPool, tokenPool };\n  }\n\n  calculateXtzToToken(xtzToSell, xtzPool, tokenPool, maxSlippage, dex): { expected; minimum; rate; impactDouble } {\n    const expected = this.xtzToTokenExpectedReturn(xtzToSell, xtzPool, tokenPool, dex);\n    const minimum = this.xtzToTokenMinimumReturn(expected, maxSlippage);\n    const rate = this.xtzToTokenExchangeRateDisplay(xtzToSell, xtzPool, tokenPool, dex);\n    const priceImpact = this.xtzToTokenPriceImpact(xtzToSell, xtzPool, tokenPool, dex);\n    const impactDouble = priceImpact ?? 0;\n    return { expected, minimum, rate, impactDouble };\n  }\n\n  calculateXtzToTokenFromToken(tokenToSell, xtzPool, tokenPool, maxSlippage, dex): { xtz; token } {\n    const result = this.calculateTokenToXTZ(tokenToSell, xtzPool, tokenPool, maxSlippage, dex);\n    const expected = this.xtzToTokenExpectedReturn(result.expected, xtzPool, tokenPool, dex);\n    const minimum = this.xtzToTokenMinimumReturn(expected, maxSlippage);\n    const rate = this.xtzToTokenExchangeRateDisplay(result.expected, xtzPool, tokenPool, dex);\n    const priceImpact = this.xtzToTokenPriceImpact(result.expected, xtzPool, tokenPool, dex);\n    const impactDouble = priceImpact ?? 0;\n    return { xtz: result, token: { expected, minimum, rate, impactDouble } };\n  }\n\n  calculateTokenToXTZ(tokenToSell, xtzPool, tokenPool, maxSlippage, dex): { expected; minimum; rate; impactDouble } {\n    const expected = this.tokenToXtzExpectedReturn(tokenToSell, xtzPool, tokenPool, dex);\n    const minimum = this.tokenToXtzMinimumReturn(expected, maxSlippage);\n    const rate = this.tokenToXtzExchangeRateDisplay(tokenToSell, xtzPool, tokenPool, dex);\n    const priceImpact = this.tokenToXtzPriceImpact(tokenToSell, xtzPool, tokenPool, dex);\n    const impactDouble = priceImpact ?? 0;\n    return { expected, minimum, rate, impactDouble };\n  }\n\n  calculateTokenToXTZFromXTZ(xtzToSell, xtzPool, tokenPool, maxSlippage, dex): { xtz; token } {\n    const result = this.calculateXtzToToken(xtzToSell, xtzPool, tokenPool, maxSlippage, dex);\n    const expected = this.tokenToXtzExpectedReturn(result.expected, xtzPool, tokenPool, dex);\n    const minimum = this.tokenToXtzMinimumReturn(expected, maxSlippage);\n    const rate = this.tokenToXtzExchangeRateDisplay(result.expected, xtzPool, tokenPool, dex);\n    const priceImpact = this.tokenToXtzPriceImpact(result.expected, xtzPool, tokenPool, dex);\n    const impactDouble = priceImpact ?? 0;\n    return { xtz: { expected, minimum, rate, impactDouble }, token: result };\n  }\n\n  calculateAddLiquidityXTZ(xtz, xtzPool, tokenPool, totalLiquidity, maxSlippage, dex): { liquidityExpected; liquidityMinimum; tokenRequired; exchangeRate } {\n    const tokenRequired = this.addLiquidityTokenRequired(xtz, xtzPool, tokenPool, dex);\n    const liquidityReturned = this.addLiquidityReturn(xtz, xtzPool, totalLiquidity, maxSlippage, dex);\n    const exchangeRate = this.xtzToTokenExchangeRateDisplay(xtz, xtzPool, tokenPool, dex);\n    return {\n      liquidityExpected: liquidityReturned?.expected,\n      liquidityMinimum: liquidityReturned?.minimum,\n      tokenRequired,\n      exchangeRate\n    };\n  }\n\n  calculateAddLiquidityToken(token, xtzPool, tokenPool, totalLiquidity, maxSlippage, dex): { liquidityExpected; liquidityMinimum; xtzRequired; exchangeRate } {\n    const xtzRequired = this.addLiquidityXtzRequired(token, xtzPool, tokenPool, dex);\n    const liquidityReturned = this.addLiquidityReturn(xtzRequired, xtzPool, totalLiquidity, maxSlippage, dex);\n    const exchangeRate = this.xtzToTokenExchangeRateDisplay(xtzRequired, xtzPool, tokenPool, dex);\n    return {\n      liquidityExpected: liquidityReturned?.expected,\n      liquidityMinimum: liquidityReturned?.minimum,\n      xtzRequired,\n      exchangeRate\n    };\n  }\n\n  calculateRemoveLiquidity(\n    liquidityBurned,\n    xtzPool,\n    tokenPool,\n    totalLiquidity,\n    maxSlippage,\n    dex\n  ): { xtzExpected; xtzMinimum; tokenExpected; tokenMinimum; exchangeRate } {\n    const xtzOut = this.removeLiquidityXtzReceived(liquidityBurned, totalLiquidity, xtzPool, maxSlippage, dex);\n    const tokenOut = this.removeLiquidityTokenReceived(liquidityBurned, totalLiquidity, tokenPool, maxSlippage);\n    const exchangeRate = this.xtzToTokenExchangeRateDisplay(xtzOut.expected, xtzPool, tokenPool, dex);\n\n    return {\n      xtzExpected: xtzOut?.expected,\n      xtzMinimum: xtzOut?.minimum,\n      tokenExpected: tokenOut?.expected,\n      tokenMinimum: tokenOut?.minimum,\n      exchangeRate\n    };\n  }\n\n  xtzToTokenExpectedReturn(xtzToSell: Amount, xtzPool: Amount, tokenPool: Amount, dex): Amount {\n    const xtz = xtzToSell.internalBigInt;\n    const xPool = xtzPool.internalBigInt;\n    const tPool = tokenPool.internalBigInt;\n    const result = dexterCalculations.xtzToTokenTokenOutput(\n      xtz.toString(),\n      xPool.toString(),\n      tPool.toString(),\n      dex.fee.toString(),\n      dex.burn.toString(),\n      dex.includeSibsidy\n    );\n    return new Amount({\n      rpcAmount: result?.toString() || '0',\n      decimalPlaces: tokenPool.decimalPlaces\n    });\n  }\n\n  xtzToTokenMinimumReturn(tokenAmount: Amount, slippage: number): Amount {\n    const token = tokenAmount.internalBigInt;\n    if (slippage < 0 || slippage > 1) {\n      console.log(`slippage value supplied to 'xtzToTokenMinimumReturn' was not between 0 and 1: ${slippage}`);\n      return undefined;\n    }\n    const result = dexterCalculations.xtzToTokenMinimumTokenOutput(token.toString(), slippage);\n    return new Amount({\n      rpcAmount: result?.value?.toString() || '0',\n      decimalPlaces: tokenAmount.decimalPlaces\n    });\n  }\n\n  xtzToTokenRequiredXtzFor(tokenAmount: Amount, xtzPool: Amount, tokenPool: Amount, dex): Amount {\n    const tokenRequired = tokenAmount.internalBigInt;\n    const xtzPoolRpc = xtzPool.internalBigInt;\n    const tokenPoolRpc = tokenPool.internalBigInt;\n\n    const result = dexterCalculations.xtzToTokenXtzInput(\n      tokenRequired,\n      xtzPoolRpc,\n      tokenPoolRpc,\n      tokenAmount.decimalPlaces,\n      dex.fee.toString(),\n      dex.burn.toString(),\n      dex.includeSibsidy\n    );\n    return new Amount({ rpcAmount: result.toString() });\n  }\n\n  xtzToTokenExchangeRate(xtzToSell: Amount, xtzPool: Amount, tokenPool: Amount, dex): number {\n    const xtz = xtzToSell.internalBigInt;\n    const xtzPoolRpc = xtzPool.internalBigInt;\n    const tokenPoolRpc = tokenPool.internalBigInt;\n\n    const result = dexterCalculations.xtzToTokenExchangeRate(xtz, xtzPoolRpc, tokenPoolRpc, dex.fee.toString(), dex.burn.toString(), dex.includeSibsidy);\n    return parseFloat(result.toString());\n  }\n\n  xtzToTokenExchangeRateDisplay(xtzToSell: Amount, xtzPool: Amount, tokenPool: Amount, dex): string {\n    const xtz = xtzToSell.internalBigInt;\n    const xPool = xtzPool.internalBigInt;\n    const tPool = tokenPool.internalBigInt;\n    const result = dexterCalculations.xtzToTokenExchangeRateForDisplay(\n      xtz.toString(),\n      xPool.toString(),\n      tPool.toString(),\n      tokenPool.decimalPlaces,\n      dex.fee.toString(),\n      dex.burn.toString(),\n      dex.includeSibsidy\n    );\n    return result?.toString() ?? '0';\n  }\n\n  xtzToTokenPriceImpact(xtzToSell: Amount, xtzPool: Amount, tokenPool: Amount, dex): number {\n    const xtz = xtzToSell.internalBigInt;\n    const xtzPoolRpc = xtzPool.internalBigInt;\n    const tokenPoolRpc = tokenPool.internalBigInt;\n\n    const result = dexterCalculations.xtzToTokenPriceImpact(\n      xtz.toString(),\n      xtzPoolRpc.toString(),\n      tokenPoolRpc.toString(),\n      dex.fee.toString(),\n      dex.burn.toString(),\n      dex.includeSibsidy\n    );\n    return parseFloat(result?.toString() ?? 0) * 100;\n  }\n\n  tokenToXtzExpectedReturn(tokenToSell: Amount, xtzPool: Amount, tokenPool: Amount, dex): Amount {\n    const token = tokenToSell.internalBigInt;\n    const xtzPoolRpc = xtzPool.internalBigInt;\n    const tokenPoolRpc = tokenPool.internalBigInt;\n    const result = dexterCalculations.tokenToXtzXtzOutput(\n      token.toString(),\n      xtzPoolRpc.toString(),\n      tokenPoolRpc.toString(),\n      dex.fee.toString(),\n      dex.burn.toString(),\n      dex.includeSibsidy\n    );\n    return new Amount({\n      rpcAmount: result?.toString() || '0',\n      decimalPlaces: 6\n    });\n  }\n\n  tokenToXtzMinimumReturn(xtzAmount: Amount, slippage: number): Amount {\n    const xtz = xtzAmount.internalBigInt;\n\n    if (slippage < 0 || slippage > 1) {\n      console.log(`slippage value supplied to 'tokenToXtzMinimumReturn' was not between 0 and 1: ${slippage}`);\n      return undefined;\n    }\n\n    const result = dexterCalculations.tokenToXtzMinimumXtzOutput(xtz.toString(), slippage);\n    return new Amount({\n      rpcAmount: result?.toString() || '0',\n      decimalPlaces: 6\n    });\n  }\n\n  tokenToXtzRequiredTokenFor(xtzAmount: Amount, xtzPool: Amount, tokenPool: Amount, dex): Amount {\n    const xtzRequired = xtzAmount.internalBigInt;\n    const xPool = xtzPool.internalBigInt;\n    const tPool = tokenPool.internalBigInt;\n\n    const result = dexterCalculations.tokenToXtzTokenInput(\n      xtzRequired,\n      xPool,\n      tPool,\n      tokenPool.decimalPlaces,\n      dex.fee.toString(),\n      dex.burn.toString(),\n      dex.includeSibsidy\n    );\n    return new Amount({\n      rpcAmount: result.toString(),\n      decimalPlaces: tokenPool.decimalPlaces\n    });\n  }\n\n  tokenToXtzExchangeRate(tokenToSell: Amount, xtzPool: Amount, tokenPool: Amount, dex): number {\n    const token = tokenToSell.internalBigInt;\n    const xtzPoolRpc = xtzPool.internalBigInt;\n    const tokenPoolRpc = tokenPool.internalBigInt;\n\n    const result = dexterCalculations.tokenToXtzExchangeRate(\n      token.toString(),\n      xtzPoolRpc,\n      tokenPoolRpc,\n      dex.fee.toString(),\n      dex.burn.toString(),\n      dex.includeSibsidy\n    );\n    return parseFloat(result.toString());\n  }\n\n  tokenToXtzExchangeRateDisplay(tokenToSell: Amount, xtzPool: Amount, tokenPool: Amount, dex): string {\n    const token = tokenToSell.internalBigInt;\n    const xPool = xtzPool.internalBigInt;\n    const tPool = tokenPool.internalBigInt;\n\n    const result = dexterCalculations.tokenToXtzExchangeRateForDisplay(\n      token.toString(),\n      xPool.toString(),\n      tPool.toString(),\n      tokenPool.decimalPlaces,\n      dex.fee.toString(),\n      dex.burn.toString(),\n      dex.includeSibsidy\n    );\n    return result?.toString() ?? '0';\n  }\n\n  tokenToXtzMarketRate(xtzPool: Amount, tokenPool: Amount): number {\n    const xPool = xtzPool.internalBigInt;\n    const tPool = tokenPool.internalBigInt;\n\n    const result = dexterCalculations.tokenToXtzMarketRate(xPool, tPool, tokenPool.decimalPlaces);\n    return parseFloat(parseFloat(result.toString()).toFixed(tokenPool.decimalPlaces));\n  }\n\n  tokenToXtzPriceImpact(tokenToSell: Amount, xtzPool: Amount, tokenPool: Amount, dex): number {\n    const token = tokenToSell.internalBigInt;\n    const xtzPoolRpc = xtzPool.internalBigInt;\n    const tokenPoolRpc = tokenPool.internalBigInt;\n\n    const result = dexterCalculations.tokenToXtzPriceImpact(\n      token.toString(),\n      xtzPoolRpc.toString(),\n      tokenPoolRpc.toString(),\n      dex.fee.toString(),\n      dex.burn.toString(),\n      dex.includeSibsidy\n    );\n    return parseFloat(result?.toString() ?? 0) * 100;\n  }\n\n  addLiquidityReturn(xtzToDeposit: Amount, xtzPool: Amount, totalLiquidity: Amount, slippage: number, dex): { expected: Amount; minimum: Amount } {\n    if (slippage < 0 || slippage > 1) {\n      console.log(`slippage value supplied to 'addLiquidityReturn' was not between 0 and 1: ${slippage}`);\n      return undefined;\n    }\n\n    const xtzIn = xtzToDeposit.internalBigInt;\n    const xPool = xtzPool.internalBigInt;\n    const totalLqt = totalLiquidity;\n\n    const result = dexterCalculations.addLiquidityLiquidityCreated(xtzIn.toString(), xPool.toString(), totalLqt.toString(), dex.includeSubsidy);\n    const expected = new Amount({\n      rpcAmount: result?.value ?? 0,\n      decimalPlaces: 0\n    });\n    const minimum = expected.internalNormalised - expected.internalNormalised * slippage;\n    const minAmount = new Amount({\n      normalisedAmount: minimum ?? 0,\n      decimalPlaces: 0\n    });\n    return { expected, minimum: minAmount };\n  }\n\n  addLiquidityTokenRequired(xtzToDeposit: Amount, xtzPool: Amount, tokenPool: Amount, dex): Amount {\n    const xtzIn = xtzToDeposit.internalBigInt;\n    const xPool = xtzPool.internalBigInt;\n    const tPool = tokenPool.internalBigInt;\n\n    const result = dexterCalculations.addLiquidityTokenIn(xtzIn.toString(), xPool.toString(), tPool.toString(), dex.includeSubsidy);\n    return new Amount({\n      rpcAmount: result?.toString() ?? '0',\n      decimalPlaces: tokenPool.decimalPlaces\n    });\n  }\n\n  addLiquidityXtzRequired(tokenToDeposit: Amount, xtzPool: Amount, tokenPool: Amount, dex): Amount {\n    const tokenIn = tokenToDeposit.internalBigInt;\n    const xPool = xtzPool.internalBigInt;\n    const tPool = tokenPool.internalBigInt;\n\n    const result = dexterCalculations.addLiquidityXtzIn(tokenIn.toString(), xPool.toString(), tPool.toString(), dex.includeSubsidy);\n    return new Amount({ rpcAmount: result?.toString() ?? '0', decimalPlaces: xtzPool.decimalPlaces });\n  }\n\n  removeLiquidityTokenReceived(liquidityBurned: Amount, totalLiquidity: Amount, tokenPool: Amount, slippage: number): { expected: Amount; minimum: Amount } {\n    if (slippage < 0 || slippage > 1) {\n      console.log(`slippage value supplied to 'removeLiquidityTokenReceived' was not between 0 and 1: ${slippage}`);\n      return undefined;\n    }\n\n    const lqtBurned = liquidityBurned.internalBigInt;\n    const tLqt = totalLiquidity;\n    const tPool = tokenPool.internalBigInt;\n\n    const result = dexterCalculations.removeLiquidityTokenOut(lqtBurned.toString(), tLqt.toString(), tPool.toString());\n\n    if (!!Big(result?.value).toString()) {\n      const expected = new Amount({\n        rpcAmount: result?.value ?? 0,\n        decimalPlaces: 8\n      });\n      const minimum = expected.internalNormalised - expected.internalNormalised * slippage;\n      const minAmount = new Amount({\n        normalisedAmount: minimum,\n        decimalPlaces: 8\n      });\n      return { expected, minimum: minAmount };\n    } else {\n      return undefined;\n    }\n  }\n\n  removeLiquidityXtzReceived(liquidityBurned: Amount, totalLiquidity: Amount, xtzPool: Amount, slippage: number, dex): { expected: Amount; minimum: Amount } {\n    if (slippage < 0 || slippage > 1) {\n      console.log(`slippage value supplied to 'removeLiquidityXtzReceived' was not between 0 and 1: ${slippage}`);\n      return undefined;\n    }\n\n    const lqtBurned = liquidityBurned.internalBigInt;\n    const tLqt = totalLiquidity;\n    const xPool = xtzPool.internalBigInt;\n\n    const result = dexterCalculations.removeLiquidityXtzOut(lqtBurned.toString(), tLqt.toString(), xPool.toString(), dex.includeSubsidy);\n\n    if (!!Big(result?.value).toString()) {\n      const expected = new Amount({\n        rpcAmount: result?.value,\n        decimalPlaces: 6\n      });\n      const minimum = expected.internalNormalised - expected.internalNormalised * slippage;\n      const minAmount = new Amount({\n        normalisedAmount: minimum,\n        decimalPlaces: 6\n      });\n      return { expected, minimum: minAmount };\n    } else {\n      return undefined;\n    }\n  }\n  estimateLiquidityBakingAPY() {\n    return 'APY: ' + dexterCalculations.estimateLiquidityBakingAPY(this.storage[this.lqdContract]?.tez_pool).toFixed(2) + '%';\n  }\n}\n","// https://gitlab.com/tezos-domains/client\nimport { TezosToolkit } from '@taquito/taquito';\nimport { TaquitoTezosDomainsClient } from '@tezos-domains/taquito-client';\nimport { Tzip16Module } from '@taquito/tzip16';\nimport { Injectable } from '@angular/core';\nimport { CONSTANTS } from '../../../environments/environment';\nimport { SupportedNetworkType } from '@tezos-domains/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class TezosDomainsService {\n  private client: TaquitoTezosDomainsClient;\n  private queue = [];\n  pending = false;\n  constructor() {\n    const tezosToolkit = new TezosToolkit(CONSTANTS.NODE_URL);\n    tezosToolkit.addExtension(new Tzip16Module());\n    const options = { caching: { enabled: false } };\n    this.client = new TaquitoTezosDomainsClient({\n      tezos: tezosToolkit,\n      network: <SupportedNetworkType>CONSTANTS.NETWORK,\n      ...options\n    });\n  }\n  async getAddressFromDomain(domain: string) {\n    const address = await this.client.resolver.resolveNameToAddress(domain);\n    if (!address) {\n      return { pkh: '' };\n    }\n    return { pkh: address };\n  }\n  async getDomainFromAddress(address: string): Promise<string> {\n    if (!this.pending) {\n      this.pending = true;\n      this.collect();\n    }\n    return new Promise((resolve, reject) => {\n      this.queue.push({ address, resolve, reject });\n    });\n  }\n  async collect() {\n    setTimeout(async () => {\n      this.pending = false;\n      const queue = this.queue;\n      this.queue = [];\n      const addresses = queue.map((q) => {\n        return q.address;\n      });\n      const items = await this.getDomainFromAddresses(addresses).catch((e) => {\n        for (const q of queue) {\n          q.reject(e);\n          throw e;\n        }\n      });\n      while (queue.length) {\n        const promise = queue.shift();\n        if (items[promise.address]) {\n          promise.resolve(items[promise.address]);\n        } else {\n          promise.resolve('');\n        }\n      }\n    }, 100);\n  }\n  async getDomainFromAddresses(addresses: any) {\n    const baseUrl = CONSTANTS.MAINNET ? 'https://api.tezos.domains/graphql' : `https://${CONSTANTS.NETWORK}-api.tezos.domains/graphql`;\n    const req = {\n      query: `{reverseRecords(where: {address: {in: ${JSON.stringify(addresses)}}}) {items {address domain: domain {id, name}}}}`\n    };\n    const response = await (\n      await fetch(baseUrl, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(req)\n      })\n    ).json();\n    const r = {};\n    if (response.data) {\n      for (const item of response.data.reverseRecords.items) {\n        if (item?.address && item?.domain?.name) {\n          r[item.address] = item.domain.name;\n        }\n      }\n    }\n    return r;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { TokenResponseType, TokenService } from '../token/token.service';\nimport { ActivityService } from '../activity/activity.service';\nimport { WalletService } from '../wallet/wallet.service';\nimport { Account, OriginatedAccount } from '../wallet/wallet';\nimport Big from 'big.js';\nimport { CONSTANTS } from '../../../environments/environment';\nimport { decode } from 'blurhash';\nimport { combineLatest } from 'rxjs';\nimport { debounceTime } from 'rxjs/operators';\nimport { SubjectService } from '../subject/subject.service';\nimport { TeztoolsService } from '../indexer/teztools/teztools.service';\n\ninterface TokenWithBalance extends TokenResponseType {\n  balance: string;\n  price: string;\n}\ninterface ContractWithImg {\n  name: string;\n  thumbnailUrl: string;\n  visitUrl: string;\n  tokens: TokenWithBalance[];\n  hidden?: boolean;\n}\ntype ContractsWithBalance = Record<string, ContractWithImg>;\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class TokenBalancesService {\n  xtzUsdRate: number;\n  balances: TokenWithBalance[] = [];\n  nfts: ContractsWithBalance = null;\n  activeAccount: Account = null;\n  _thumbnailsToCreate = [];\n  constructor(\n    private tokenService: TokenService,\n    private activityService: ActivityService,\n    private walletService: WalletService,\n    private subjectService: SubjectService,\n    private teztoolsService: TeztoolsService\n  ) {\n    this.subjectService.markets.subscribe((markets) => {\n      if (markets) {\n        this.mergeMarket();\n      }\n    });\n    combineLatest([this.subjectService.activeAccount, this.subjectService.metadataUpdated, this.activityService.tokenBalanceUpdated])\n      .pipe(debounceTime(3))\n      .subscribe(([a, b, c]) => {\n        if (this.activeAccount !== a) {\n          this.activeAccount = a;\n        }\n        this.reload();\n      });\n    this.reload();\n    this.subjectService.logout.subscribe((o) => {\n      if (!!o) {\n        this.destroy();\n      }\n    });\n  }\n  destroy() {\n    this.balances = [];\n    this.nfts = null;\n  }\n  resolveAsset(token, balances, nfts) {\n    const asset: TokenResponseType = this.tokenService.getAsset(token.tokenId);\n    if (asset) {\n      if (this.isNFT(asset)) {\n        // token balance or NFT?\n        const contractAlias = this.getContractAlias(asset.contractAddress) ?? asset.contractAddress;\n        if (nfts[contractAlias] === undefined) {\n          const CONTRACT_ALIASES = CONSTANTS.CONTRACT_ALIASES[contractAlias as string];\n          if (!CONTRACT_ALIASES?.thumbnailUrl) {\n            if (this._thumbnailsToCreate.filter((obj) => obj.contractAlias === contractAlias).length === 0) {\n              this._thumbnailsToCreate.push({\n                contractAlias,\n                address: asset.contractAddress\n              });\n            }\n          }\n          const name = CONTRACT_ALIASES?.name ? CONTRACT_ALIASES.name : this.tokenService.getContractName(asset.contractAddress) ?? contractAlias;\n          nfts[contractAlias] = {\n            name,\n            thumbnailUrl: CONTRACT_ALIASES?.thumbnailUrl ?? this.tokenService.getContractLogo(asset.contractAddress),\n            tokens: []\n          };\n          if (CONTRACT_ALIASES?.link) {\n            nfts[contractAlias].visitUrl = CONTRACT_ALIASES.link;\n          }\n        }\n        nfts[contractAlias].tokens.push({ ...asset, balance: token.balance });\n      } else if (!isNaN(asset.decimals)) {\n        const balance = Big(token.balance)\n          .div(10 ** asset.decimals)\n          .toFixed();\n        balances.push({ ...asset, balance });\n      }\n    } else {\n      if (nfts['unknown'] === undefined) {\n        const hidden = this.nfts !== null && this.nfts['unknown'] === undefined;\n        nfts['unknown'] = {\n          name: 'Unknown tokens',\n          thumbnailUrl: '../../../assets/img/unknown-token-grayscale.svg',\n          tokens: [],\n          hidden\n        };\n        if (hidden) {\n          setTimeout(() => {\n            if (this.nfts['unknown'] !== undefined) {\n              this.nfts['unknown'].hidden = false;\n            }\n          }, 10000);\n        }\n      }\n      const placeholder = this.tokenService.getPlaceholderToken(token.tokenId);\n      placeholder.name = `${placeholder.contractAddress.slice(0, 8)}... (${placeholder.id.toString()})`;\n      delete placeholder.decimals;\n      nfts['unknown'].tokens.push(placeholder);\n    }\n  }\n  reload() {\n    if (!this.activeAccount?.tokens) {\n      return;\n    }\n    const balances: TokenWithBalance[] = [];\n    const nfts: ContractsWithBalance = {};\n    for (let token of this.walletService.wallet.getAccount(this.activeAccount.address).tokens) {\n      if (token?.balance && token?.balance != '0') {\n        this.resolveAsset(token, balances, nfts);\n      }\n    }\n    this.balances = balances;\n    this.nfts = this.orderedNfts(nfts);\n    this.mergeMarket();\n\n    if (this._thumbnailsToCreate.length) {\n      this._thumbnailsToCreate.forEach(({ contractAlias, address }) => {\n        if (!this.nfts[contractAlias].thumbnailUrl) {\n          this.nfts[contractAlias].thumbnailUrl = this.getThumbnailUrl(address);\n        }\n      });\n      this._thumbnailsToCreate = [];\n    }\n    this.subjectService.nftsUpdated.next({ nfts: this.nfts, balances: this.balances });\n  }\n  orderedNfts(nfts: ContractsWithBalance): ContractsWithBalance {\n    const _nfts: ContractsWithBalance = {};\n    const aliases = Object.keys(CONSTANTS.CONTRACT_ALIASES);\n    for (let alias of aliases) {\n      if (nfts[alias]) {\n        _nfts[alias] = nfts[alias];\n        delete nfts[alias];\n      }\n    }\n    const keys = Object.keys(nfts);\n    for (let key of keys) {\n      if (key !== 'unknown') {\n        _nfts[key] = nfts[key];\n        delete nfts[key];\n      }\n    }\n    if (nfts['unknown']) {\n      // property last\n      _nfts['unknown'] = nfts['unknown'];\n      delete nfts['unknown'];\n    }\n    return _nfts;\n  }\n  getContractAlias(address: string) {\n    const keys = Object.keys(CONSTANTS.CONTRACT_ALIASES);\n    for (const key of keys) {\n      if (CONSTANTS.CONTRACT_ALIASES[key].address.includes(address)) {\n        return key;\n      }\n    }\n    return undefined;\n  }\n  getThumbnailUrl(address: string): string {\n    const pixels = decode(address.slice(0, 22), 5, 5);\n    const canvas = document.createElement('canvas');\n    canvas.width = canvas.height = 5;\n    const ctx = canvas.getContext('2d');\n    const imageData = ctx.createImageData(5, 5);\n    imageData.data.set(pixels);\n    ctx.putImageData(imageData, 0, 0);\n    return canvas.toDataURL();\n  }\n\n  isNFT(asset: TokenResponseType): boolean {\n    if (!asset) {\n      return false;\n    }\n    if (CONSTANTS.MAINNET) {\n      return !(\n        CONSTANTS.NFT_CONTRACT_OVERRIDES.includes(`${asset.contractAddress}:${asset.id}`) ||\n        this.teztoolsService.defiTokens.includes(`${asset.contractAddress}:${asset.id}`)\n      );\n    } else {\n      return (asset?.isBooleanAmount || asset?.decimals == 0) && !CONSTANTS.NFT_CONTRACT_OVERRIDES.includes(`${asset.contractAddress}`) ? true : false;\n    }\n  }\n  mergeMarket() {\n    Object.keys(this.balances).forEach((key) => {\n      let token = undefined;\n      const tokenId: string = `${this.balances[key]?.contractAddress}:${this.balances[key]?.id}`;\n      if ((token = this.subjectService.markets.value.find((t) => t?.tokenId === tokenId))) {\n        this.balances[key].price = token?.usdValue * parseFloat(this.balances[key].balance);\n        !!token?.logo_url ? (this.balances[key].displayUrl = this.balances[key].thumbnailUrl = token?.thumbnailUri) : null;\n      }\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class ObjktService {\n  private queue = [];\n  pending = false;\n  constructor() {}\n\n  async resolveToken(contractAddress, id) {\n    const req = {\n      query: `{\n        token(where: {fa_contract: {_eq: \"${contractAddress}\"}, token_id: {_eq: \"${id}\"}}) {\n          highest_offer\n          lowest_ask\n          metadata\n          name\n          attributes {\n            attribute {\n              name\n              type\n              value\n            }\n          }\n        }\n      }`\n    };\n    try {\n      return (\n        await (\n          await fetch('https://data.objkt.com/v2/graphql', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(req)\n          })\n        ).json()\n      )?.data?.token[0];\n    } catch {\n      return undefined;\n    }\n  }\n  async resolveCollection(address): Promise<any> {\n    while (this.queue.length >= 500) {\n      // max 500 results per call\n      await this.sleep(3000);\n    }\n    if (!this.pending) {\n      this.pending = true;\n      this.collect();\n    }\n    return new Promise((resolve, reject) => {\n      this.queue.push({ address, resolve, reject });\n    });\n  }\n\n  async collect() {\n    setTimeout(async () => {\n      this.pending = false;\n      const queue = this.queue;\n      this.queue = [];\n      const addresses = queue.map((q) => {\n        return q.address;\n      });\n      const items = await this.resolveCollections(addresses).catch((e) => {\n        for (const q of queue) {\n          q.reject(e);\n          throw e;\n        }\n      });\n      while (queue.length) {\n        const promise = queue.shift();\n        if (items[promise.address]?.name) {\n          promise.resolve(items[promise.address]);\n        } else {\n          promise.resolve(null);\n        }\n      }\n    }, 3000);\n  }\n\n  async resolveCollections(contractAddresses: string[]) {\n    const req = {\n      query: `{\n        fa(where: {contract: {_in: ${JSON.stringify(contractAddresses)}}}) {\n          contract\n          name\n          logo\n        }\n      }`\n    };\n    const _objkts = (\n      await (\n        await fetch('https://data.objkt.com/v2/graphql', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(req)\n        })\n      ).json()\n    )?.data?.fa;\n    const objkts: any = {};\n    if (_objkts) {\n      for (const objkt of _objkts) {\n        objkts[objkt.contract] = { name: objkt.name, logo: objkt.logo };\n      }\n    }\n    console.log('resolveCollections', objkts);\n    return objkts;\n  }\n  private async sleep(ms) {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { CONSTANTS, TRUSTED_TOKEN_CONTRACTS, BLACKLISTED_TOKEN_CONTRACTS } from '../../../environments/environment';\nimport { IndexerService } from '../indexer/indexer.service';\nimport Big from 'big.js';\nimport { SubjectService } from '../subject/subject.service';\nimport { TeztoolsService } from '../indexer/teztools/teztools.service';\nimport { filter } from 'rxjs/operators';\nimport { NavigationEnd, Router } from '@angular/router';\nimport { ObjktService } from '../indexer/objkt/objkt.service';\n\nexport interface TokenResponseType {\n  contractAddress: string;\n  id: string;\n  decimals: number;\n  artifactAsset?: Asset;\n  displayAsset: Asset;\n  thumbnailAsset: Asset;\n  name: string;\n  symbol: string;\n  description: string;\n  category: string;\n  kind: string;\n  isTransferable?: boolean;\n  isBooleanAmount?: boolean;\n  shouldPreferSymbol?: boolean;\n  series?: string;\n  ttl?: number;\n  status: Status;\n  isUnknownToken?: boolean;\n}\nexport type Asset = string | CachedAsset;\nexport interface CachedAsset {\n  uri: string;\n  mimeType: string;\n}\n\nexport type ContractsType = Record<string, ContractType>;\nexport type ContractType = FA12 | FA2;\nexport interface TokensInterface {\n  category: string;\n  objkt?: {\n    name?: string;\n    logo?: string;\n    updated: number;\n  };\n}\nenum Status {\n  Rejected = -1,\n  Pending = 0,\n  Approved = 1\n}\nexport interface TokenData {\n  name: string;\n  symbol: string;\n  decimals: number;\n  description: string;\n  artifactAsset?: Asset;\n  displayAsset: Asset;\n  thumbnailAsset: Asset;\n  isTransferable?: boolean;\n  isBooleanAmount?: boolean;\n  shouldPreferSymbol?: boolean;\n  series?: string;\n  ttl?: number;\n  status: Status;\n}\nexport interface FA12 extends TokensInterface {\n  kind: 'FA1.2';\n  tokens: {\n    0: TokenData;\n  };\n}\nexport interface FA2 extends TokensInterface {\n  kind: 'FA2';\n  tokens: Record<number | string, TokenData>;\n}\n@Injectable({\n  providedIn: 'root'\n})\nexport class TokenService {\n  readonly AUTO_DISCOVER: boolean = true;\n  readonly version: string = '1.0.13';\n  private contracts: ContractsType = {};\n  private exploredIds: Record<string, { firstCheck: number; lastCheck: number; counter: number }> = {};\n  private pendingSave = null;\n  readonly storeKey = 'tokenMetadata';\n  readonly unlockablesKey = 'unlockables';\n  queue = [];\n  workers = 0;\n  constructor(\n    public indexerService: IndexerService,\n    private subjectService: SubjectService,\n    private teztoolsService: TeztoolsService,\n    private router: Router,\n    private objktService: ObjktService\n  ) {\n    this.contracts = JSON.parse(JSON.stringify(CONSTANTS.ASSETS));\n    this.loadMetadata();\n    this.saveMetadata();\n    this.router.events.pipe(filter((evt) => evt instanceof NavigationEnd)).subscribe(async (r: NavigationEnd) => {\n      if (r.url.indexOf('/account') === -1) {\n        document.documentElement.className = '';\n      }\n    });\n  }\n  getAsset(tokenId: string): TokenResponseType {\n    if (!tokenId || !tokenId.includes(':')) {\n      return null;\n    }\n    const tokenIdArray = tokenId.split(':');\n    const contractAddress: string = tokenIdArray[0];\n    const id: string = tokenIdArray[1] ? String(tokenIdArray[1]) : null;\n    const contract: ContractType = this.contracts[contractAddress];\n    if (id != null) {\n      if (contract) {\n        let token: TokenResponseType = contract.tokens[id];\n        if (!token) {\n          // check ranges\n          const ids = Object.keys(contract.tokens);\n          for (const idx of ids) {\n            if (idx.includes('-')) {\n              const span = idx.split('-');\n              if (span.length === 2 && !isNaN(Number(span[0])) && !isNaN(Number(span[1]))) {\n                const first = Big(span[0]);\n                const last = Big(span[1]);\n                if (first.gte(id) && last.lte(id)) {\n                  token = JSON.parse(JSON.stringify(contract.tokens[idx]));\n                  token.name = `${JSON.parse(JSON.stringify(contract.tokens[idx].name))} #${Big(id).minus(first).plus(1)}`;\n                  break;\n                }\n              }\n            }\n          }\n        }\n        if (token) {\n          if (token.status < 0) {\n            return {\n              kind: contract.kind,\n              category: contract.category,\n              id,\n              contractAddress,\n              ...token,\n              thumbnailAsset: '',\n              displayAsset: ''\n            };\n          }\n          return {\n            kind: contract.kind,\n            category: contract.category,\n            id,\n            contractAddress,\n            ...token\n          };\n        }\n      }\n    }\n    return null;\n  }\n  getContractName(contractAddress: string) {\n    return this.contracts[contractAddress]?.objkt?.name ?? null;\n  }\n  getContractLogo(contractAddress: string) {\n    return this.contracts[contractAddress]?.objkt?.logo ?? null;\n  }\n  getContractAddressFromAsset(uri: string) {\n    const contractAddresses = Object.keys(this.contracts);\n    for (const contractAddress of contractAddresses) {\n      const tokens = this.contracts[contractAddress].tokens;\n      for (const id in tokens) {\n        if (tokens[id]?.thumbnailAsset?.uri === uri || tokens[id]?.displayAsset?.uri === uri || tokens[id]?.artifactAsset?.uri === uri) {\n          return contractAddress;\n        }\n      }\n    }\n    return '';\n  }\n  isKnownTokenId(tokenId: string): boolean {\n    return this.getAsset(tokenId) !== null;\n  }\n  knownTokenIds(): string[] {\n    const tokenIds: string[] = [];\n    const contractKeys = Object.keys(this.contracts);\n    if (contractKeys) {\n      for (const contractKey of contractKeys) {\n        const tokenKeys = Object.keys(this.contracts[contractKey].tokens);\n        if (tokenKeys) {\n          for (const tokenKey of tokenKeys) {\n            tokenIds.push(`${contractKey}:${tokenKey}`);\n          }\n        }\n      }\n    }\n    return tokenIds;\n  }\n  isCategoryType(address, regex: RegExp): boolean {\n    return regex.test(this.contracts[address]?.category);\n  }\n  isKnownTokenContract(address: string): boolean {\n    return this.contracts[address] !== undefined;\n  }\n  addAsset(contractAddress: string, contract: ContractType) {\n    if (!this.contracts[contractAddress]) {\n      this.contracts[contractAddress] = contract;\n      this.checkObjktData(contractAddress, contract);\n    } else {\n      const currentKeys = Object.keys(this.contracts[contractAddress].tokens);\n      const newKeys = Object.keys(contract.tokens);\n      for (const key of newKeys) {\n        if (!currentKeys.includes(key)) {\n          this.contracts[contractAddress].tokens[key] = contract.tokens[key];\n        } else if (JSON.stringify(contract.tokens[key]) !== JSON.stringify(this.contracts[contractAddress].tokens[key])) {\n          this.contracts[contractAddress].tokens[key] = contract.tokens[key];\n        }\n      }\n    }\n  }\n  async checkObjktData(contractAddress: string, contract: ContractType) {\n    let check = false;\n    if (!contract.objkt) {\n      check = true;\n    } else if (contract?.objkt?.updated) {\n      const diff = Date.now() - contract.objkt.updated;\n      if (!contract?.objkt?.name) {\n        if (diff > 1000 * 60 * 60 * 24) {\n          check = true;\n        }\n      }\n    }\n    if (check) {\n      const _objkt = await this.objktService.resolveCollection(contractAddress);\n      const objkt: any = { updated: Date.now() };\n      if (_objkt?.name) {\n        objkt.name = _objkt.name;\n        if (_objkt.logo) {\n          objkt.logo = _objkt.logo;\n        }\n      }\n      this.contracts[contractAddress].objkt = objkt;\n      this._saveMetadata();\n    }\n  }\n  async searchAllMetadata(unknownTokenIds: any) {\n    if (unknownTokenIds.length) {\n      for (const tokenId of unknownTokenIds) {\n        this.searchMetadata(tokenId);\n      }\n    }\n  }\n  async recheckMetadata(tokens) {\n    if (tokens?.length) {\n      for (let token of tokens) {\n        const tokenObject = this.getAsset(token.tokenId);\n        if (tokenObject?.ttl) {\n          const exp = this.exploredIds[token.tokenId];\n          const now = new Date().getTime();\n          if (now - exp.lastCheck > tokenObject.ttl * 1000) {\n            console.log('recheck metadata for', token.tokenId);\n            this.exploredIds[token.tokenId].lastCheck = now;\n            this.exploredIds[token.tokenId].counter = ++exp.counter || 0;\n            this.saveMetadata();\n            if (!this.queue.includes(token.tokenId)) {\n              this.searchMetadata(token.tokenId, true);\n            }\n          }\n        }\n      }\n    }\n  }\n  private async searchMetadata(tokenId: string, force = false) {\n    if ((!this.isKnownTokenId(tokenId) && !this.queue.includes(tokenId) && this.explore(tokenId)) || force) {\n      this.queue.push(tokenId);\n      if (this.workers < 64) {\n        this.startWorker();\n      }\n    }\n  }\n  async startWorker() {\n    this.workers++;\n    while (this.queue.length) {\n      const tokenId = this.queue.shift();\n      try {\n        const a = tokenId.split(':');\n        const contractAddress = a[0];\n        const id = String(a[1]);\n        const recentDay = this.exploredIds[tokenId]?.lastCheck - this.exploredIds[tokenId]?.firstCheck < 1000 * 3600 * 24;\n        const skipTzkt = this.isKnownTokenId(tokenId) && this.exploredIds[tokenId]?.counter % 5 === 2 && recentDay;\n        const metadata = await this.indexerService.getTokenMetadata(contractAddress, id, skipTzkt);\n        this.handleMetadata(metadata, contractAddress, id);\n      } catch (e) {}\n    }\n    this.workers--;\n  }\n  handleMetadata(metadata: any, contractAddress: string, id: string) {\n    const tokenId = `${contractAddress}:${id}`;\n    if (metadata && (metadata.name || metadata.symbol) && !isNaN(metadata.decimals) && metadata.decimals >= 0) {\n      const contract: ContractType = {\n        kind: metadata.tokenType ? metadata.tokenType : 'FA2',\n        category: metadata.tokenCategory ? metadata.tokenCategory : '',\n        tokens: {}\n      };\n      const token: TokenData = {\n        name: metadata.name ? metadata.name : '',\n        symbol: metadata.symbol ? metadata.symbol : '',\n        decimals: Number(metadata.decimals),\n        description: metadata.description ? metadata.description : '',\n        artifactAsset: metadata.artifactUri ?? '',\n        displayAsset: metadata.displayUri ?? '',\n        thumbnailAsset: metadata.thumbnailUri ?? '',\n        isTransferable: metadata?.isTransferable === false ? metadata.isTransferable : true,\n        isBooleanAmount: metadata?.isBooleanAmount ? metadata.isBooleanAmount : false,\n        status:\n          TRUSTED_TOKEN_CONTRACTS.includes(contractAddress) ||\n          CONSTANTS.NFT_CONTRACT_OVERRIDES.includes(tokenId) ||\n          this.teztoolsService.defiTokens.includes(tokenId)\n            ? 1\n            : 0\n      };\n      if (metadata?.ttl) {\n        token.ttl = Math.max(Number(metadata.ttl), 30);\n      }\n      if (metadata?.series) {\n        token.series = metadata.series;\n      }\n      if (CONSTANTS.ASSETS[contractAddress]?.tokens[id]) {\n        contract.tokens[id] = { ...token, ...CONSTANTS.ASSETS[contractAddress].tokens[id] };\n      } else {\n        contract.tokens[id] = token;\n      }\n      this.addAsset(contractAddress, contract);\n      this.saveMetadata();\n      this.subjectService.metadataUpdated.next({\n        contractAddress,\n        id,\n        token\n      });\n    }\n  }\n  explore(tokenId: string): boolean {\n    const now = new Date().getTime();\n    if (!this.exploredIds[tokenId]) {\n      this.exploredIds[tokenId] = {\n        firstCheck: now,\n        lastCheck: now,\n        counter: 0\n      };\n      this.saveMetadata();\n      return true;\n    } else {\n      const token = this.exploredIds[tokenId];\n      let t1 = 2 ** token.counter * 250;\n      t1 = t1 < 20000 ? 20000 : t1;\n      const t2 = now - token.lastCheck;\n      if (t1 > t2) {\n        return false;\n      }\n      this.exploredIds[tokenId].lastCheck = now;\n      this.exploredIds[tokenId].counter = ++token.counter;\n      this.saveMetadata();\n      return true;\n    }\n  }\n  private getCounter(tokenId: string) {\n    return this.exploredIds[tokenId].counter;\n  }\n  resetCounters() {\n    const ids = Object.keys(this.exploredIds);\n    if (ids) {\n      for (const id of ids) {\n        this.exploredIds[id].counter = 0;\n      }\n      this.saveMetadata(true);\n    }\n  }\n  resetAllMetadata() {\n    this.exploredIds = {};\n    this.contracts = JSON.parse(JSON.stringify(CONSTANTS.ASSETS));\n    this.saveMetadata(true);\n    this.loadMetadata();\n    this.subjectService.metadataUpdated.next(null);\n  }\n  searchTimeMs(tokenId: string) {\n    if (this.exploredIds[tokenId]) {\n      const token = this.exploredIds[tokenId];\n      return token.lastCheck - token.firstCheck;\n    }\n    return 0;\n  }\n  getPlaceholderToken(tokenId: string): TokenResponseType {\n    const tokenIdArray = tokenId.split(':');\n    const contractAddress: string = tokenIdArray[0];\n    const id: string = tokenIdArray[1] ? String(tokenIdArray[1]) : '';\n    return {\n      contractAddress,\n      id,\n      decimals: 0,\n      displayAsset: '',\n      thumbnailAsset: '',\n      name: '[Unknown token]',\n      symbol: '',\n      description: '',\n      category: '',\n      kind: 'FA2',\n      status: 0,\n      isUnknownToken: true\n    };\n  }\n  saveMetadata(force = false) {\n    if (force) {\n      this._saveMetadata();\n      return;\n    }\n    if (!this.pendingSave) {\n      this.pendingSave = setTimeout(() => {\n        this.pendingSave = null;\n        this._saveMetadata();\n      }, 1000);\n    }\n  }\n  private _saveMetadata() {\n    localStorage.setItem(\n      this.storeKey,\n      JSON.stringify({\n        contracts: this.contracts,\n        exploredIds: this.exploredIds,\n        version: this.version\n      })\n    );\n  }\n  loadMetadata(): any {\n    const metadataJson = localStorage.getItem(this.storeKey);\n    if (metadataJson) {\n      const metadata = JSON.parse(metadataJson);\n      if (metadata?.version === this.version) {\n        if (metadata?.contracts) {\n          const contractAddresses = Object.keys(metadata.contracts);\n          for (const address of contractAddresses) {\n            for (const id of Object.keys(metadata.contracts[address].tokens)) {\n              if (metadata.contracts[address].tokens[id]?.status === 0) {\n                if (\n                  TRUSTED_TOKEN_CONTRACTS.includes(address) ||\n                  CONSTANTS.NFT_CONTRACT_OVERRIDES.includes(`${address}:${id}`) ||\n                  this.teztoolsService.defiTokens.includes(`${address}:${id}`)\n                ) {\n                  metadata.contracts[address].tokens[id].status = 1; // flip status if it have been marked as trusted\n                }\n                if (BLACKLISTED_TOKEN_CONTRACTS.includes(address)) {\n                  metadata.contracts[address].tokens[id].status = -1;\n                }\n              }\n            }\n            this.addAsset(address, metadata.contracts[address]);\n          }\n        }\n        if (metadata?.exploredIds) {\n          this.exploredIds = metadata.exploredIds;\n        }\n      } else {\n        // clear all metadata\n      }\n    }\n  }\n  formatAmount(tokenKey: string, amount: string, baseUnit = true): string {\n    if (!tokenKey) {\n      return `${Big(amount)\n        .div(10 ** (baseUnit ? 6 : 0))\n        .toFixed()} tez`;\n    } else {\n      const token = this.getAsset(tokenKey);\n      if (token) {\n        if ((!token.shouldPreferSymbol && token.name) || !token.symbol) {\n          if (token.isBooleanAmount) {\n            if (parseInt(amount) > 1) {\n              return `${amount} ${token.name}`;\n            }\n            return `${token.name}`;\n          } else {\n            return `${Big(amount)\n              .div(10 ** (baseUnit ? token.decimals : 0))\n              .toFixed()} ${token.name}`;\n          }\n        } else {\n          return `${Big(amount)\n            .div(10 ** (baseUnit ? token.decimals : 0))\n            .toFixed()} ${token.symbol}`;\n        }\n      } else {\n        return '[Unknown token]';\n      }\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport DirectWebSdk from 'customauth';\nimport FetchNodeDetails from '@toruslabs/fetch-node-details';\nimport TorusUtils from '@toruslabs/torus.js';\nimport { OperationService } from '../../services/operation/operation.service';\nimport { InputValidationService } from '../../services/input-validation/input-validation.service';\nimport { CONSTANTS } from '../../../environments/environment';\n\nconst GOOGLE = 'google';\nconst REDDIT = 'reddit';\nconst TWITTER = 'twitter';\nconst FACEBOOK = 'facebook';\nconst AUTH_DOMAIN = 'https://dev-0li4gssz.eu.auth0.com';\nconst AUTH_DOMAIN_MAINNET = 'https://kukai.eu.auth0.com';\n@Injectable({\n  providedIn: 'root'\n})\nexport class TorusService {\n  torus: any = null;\n  nodeDetails: { torusNodeEndpoints: string[]; torusNodePub: any[] } = null;\n  public readonly verifierMap: any;\n  private readonly proxy: any;\n  verifierMaps = {\n    testnet: {\n      [GOOGLE]: {\n        name: 'Google',\n        typeOfLogin: 'google',\n        clientId: '952872982551-od475jfe3ach7dghacin634rbkcqhpll.apps.googleusercontent.com',\n        verifier: 'kukai-google',\n        subVerifier: 'web-kukai',\n        caseSensitiveVerifierID: false,\n        lookups: true,\n        aggregated: true\n      },\n      [REDDIT]: {\n        name: 'Reddit',\n        typeOfLogin: 'jwt',\n        clientId: '7xLcBa3xd4VTmlGbClU3qXeBZGta3OvM',\n        verifier: 'tezos-reddit-testnet',\n        subVerifier: 'web-kukai',\n        caseSensitiveVerifierID: false,\n        lookups: true,\n        aggregated: true\n      },\n      [TWITTER]: {\n        name: 'Twitter',\n        typeOfLogin: 'twitter',\n        clientId: 'vKFgnaYZzKLUnhxnX5xqTqeMcumdVTz1',\n        verifier: 'tezos-twitter-test',\n        caseSensitiveVerifierID: false,\n        lookups: true\n      },\n      [FACEBOOK]: {\n        name: 'Facebook',\n        typeOfLogin: 'facebook',\n        clientId: '213778980232619',\n        verifier: 'tezos-facebook-testnet',\n        caseSensitiveVerifierID: false\n      }\n    },\n    mainnet: {\n      [GOOGLE]: {\n        name: 'Google',\n        typeOfLogin: 'google',\n        clientId: '952872982551-49mfvktoios59oj2kmiknlltfq9pvi6c.apps.googleusercontent.com',\n        verifier: 'tezos-google',\n        subVerifier: 'kukai-web',\n        caseSensitiveVerifierID: false,\n        lookups: true,\n        aggregated: true\n      },\n      [REDDIT]: {\n        name: 'Reddit',\n        typeOfLogin: 'jwt',\n        clientId: 'zyQ9tnKfdg3VNyj6MGhZq4dHbBzbmEvl',\n        verifier: 'tezos-reddit',\n        subVerifier: 'web-kukai',\n        caseSensitiveVerifierID: false,\n        lookups: true,\n        aggregated: true\n      },\n      [TWITTER]: {\n        name: 'Twitter',\n        typeOfLogin: 'twitter',\n        clientId: 'UJl5d4iHVgbrAaSlucXNf2F2uKlC0m25',\n        verifier: 'tezos-twitter',\n        caseSensitiveVerifierID: false,\n        lookups: true\n      },\n      [FACEBOOK]: {\n        name: 'Facebook',\n        typeOfLogin: 'facebook',\n        clientId: '523634882377310',\n        verifier: 'tezos-facebook',\n        caseSensitiveVerifierID: false\n      }\n    }\n  };\n  verifierMapKeys: any;\n  constructor(private operationService: OperationService, private inputValidationService: InputValidationService) {\n    if (CONSTANTS.MAINNET) {\n      this.verifierMap = this.verifierMaps.mainnet;\n      this.proxy = {\n        address: '0x638646503746d5456209e33a2ff5e3226d698bea',\n        network: 'mainnet'\n      };\n    } else {\n      this.verifierMap = this.verifierMaps.testnet;\n      this.proxy = {\n        address: '0x4023d2a0D330bF11426B12C6144Cfb96B7fa6183',\n        network: 'ropsten'\n      };\n    }\n    this.verifierMapKeys = Object.keys(this.verifierMap);\n  }\n  async initTorus() {\n    if (!this.torus) {\n      try {\n        const torusdirectsdk = new DirectWebSdk({\n          baseUrl: `${location.origin}/serviceworker`,\n          redirectToOpener: true,\n          enableLogging: !(this.proxy.network === 'mainnet'),\n          proxyContractAddress: this.proxy.address,\n          network: this.proxy.network === 'mainnet' ? this.proxy.network : 'testnet'\n        });\n        await torusdirectsdk.init({ skipSw: false });\n        this.torus = torusdirectsdk;\n      } catch (error) {\n        console.error(error, 'oninit caught');\n      }\n    }\n  }\n  async lookupPkh(selectedVerifier: string, verifierId: string): Promise<any> {\n    const fetchNodeDetails = new FetchNodeDetails({\n      network: this.proxy.network,\n      proxyAddress: this.proxy.address\n    });\n    const torus = new TorusUtils();\n    const verifier = this.verifierMap[selectedVerifier].verifier;\n    if (!this.nodeDetails) {\n      const { torusNodeEndpoints, torusNodePub, torusIndexes } = await fetchNodeDetails.getNodeDetails();\n      this.nodeDetails = { torusNodeEndpoints, torusNodePub }; // Cache node details\n    }\n    let sanitizedVerifierId = verifierId;\n    if (!this.verifierMap[selectedVerifier].caseSensitiveVerifierID && selectedVerifier !== 'twitter') {\n      sanitizedVerifierId = sanitizedVerifierId.toLocaleLowerCase();\n    }\n    let twitterId = '';\n    if (selectedVerifier === 'twitter') {\n      const username = sanitizedVerifierId.replace('@', '');\n      const { id } = await this.twitterLookup(username);\n      if (this.inputValidationService.twitterId(id)) {\n        sanitizedVerifierId = `twitter|${id}`;\n        twitterId = id;\n      } else {\n        throw new Error('Twitter handle not found');\n      }\n    }\n    const pk: any = await torus.getPublicAddress(\n      this.nodeDetails.torusNodeEndpoints,\n      this.nodeDetails.torusNodePub,\n      { verifier, verifierId: sanitizedVerifierId },\n      true\n    );\n    const pkh = this.operationService.spPointsToPkh(pk.X, pk.Y);\n    return { pkh, twitterId };\n  }\n  async twitterLookup(username?: string, id?: string) {\n    let req = {};\n    if ((id && username) || (!id && !username)) {\n      console.log({ username, id });\n      throw new Error('Invalid input');\n    } else if (id) {\n      req = { id };\n    } else {\n      req = { username: username.replace('@', '') };\n    }\n    return await fetch(`https://backend.kukai.network/twitter-lookup`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      referrerPolicy: 'no-referrer',\n      body: JSON.stringify(req)\n    }).then((ans) => {\n      return ans.json();\n    });\n  }\n  async loginTorus(selectedVerifier: string, verifierId = '', skipTorusKey = false): Promise<any> {\n    if (!CONSTANTS.MAINNET && document?.location?.host === 'localhost:4200' && selectedVerifier !== 'google' && selectedVerifier !== 'twitter') {\n      return this.mockLogin(selectedVerifier); // mock locally\n    }\n    try {\n      const jwtParams: any = this._loginToConnectionMap()[selectedVerifier] || {};\n      if (verifierId && selectedVerifier === GOOGLE) {\n        jwtParams.login_hint = verifierId;\n        console.log('login_hint: ' + verifierId);\n      }\n      const { typeOfLogin, clientId, verifier, aggregated } = this.verifierMap[selectedVerifier];\n      const loginDetails = aggregated\n        ? await this.torus.triggerAggregateLogin({\n            aggregateVerifierType: 'single_id_verifier',\n            verifierIdentifier: verifier,\n            subVerifierDetailsArray: [\n              {\n                clientId,\n                typeOfLogin: typeOfLogin,\n                verifier: this.verifierMap[selectedVerifier].subVerifier,\n                jwtParams\n              }\n            ],\n            skipTorusKey\n          })\n        : await this.torus.triggerLogin({\n            verifier,\n            typeOfLogin,\n            clientId,\n            jwtParams,\n            skipTorusKey\n          });\n      if (aggregated) {\n        loginDetails.userInfo = loginDetails.userInfo[0];\n      }\n      if (selectedVerifier === FACEBOOK) {\n        console.log('Invalidating access token...');\n        fetch(`https://graph.facebook.com/me/permissions?access_token=${loginDetails.userInfo.accessToken}`, { method: 'DELETE', mode: 'cors' });\n      }\n      const keyPair = skipTorusKey && !loginDetails?.privateKey ? { pk: '', pkh: '' } : this.operationService.spPrivKeyToKeyPair(loginDetails.privateKey);\n      console.log('DirectAuth KeyPair', keyPair);\n      if (loginDetails?.userInfo?.typeOfLogin === 'jwt') {\n        loginDetails.userInfo.typeOfLogin = selectedVerifier;\n      }\n      console.log('DirectAuth UserInfo', loginDetails.userInfo);\n      return { keyPair, userInfo: loginDetails.userInfo };\n    } catch (e) {\n      console.error(e, 'login caught');\n      return { keyPair: null, userInfo: null };\n    }\n  }\n  async getTorusKeyPair(selectedVerifier: string, verifierId: string): Promise<any> {\n    const { keyPair } = await this.loginTorus(selectedVerifier, verifierId);\n    return keyPair;\n  }\n  _loginToConnectionMap = () => {\n    return {\n      [TWITTER]: {\n        domain: AUTH_DOMAIN\n      },\n      [FACEBOOK]: {\n        scope: 'public_profile'\n      },\n      [REDDIT]: {\n        domain: CONSTANTS.MAINNET ? AUTH_DOMAIN_MAINNET : AUTH_DOMAIN,\n        connection: 'Reddit',\n        verifierIdField: 'name',\n        isVerifierIdCaseSensitive: false\n      }\n    };\n  };\n  private async mockLogin(typeOfLogin: string): Promise<any> {\n    const keyPair = {\n      sk: 'spsk1VfCfhixtzGvUSKDre6jwyGbXFm6aoeLGnxeVLCouueZmkgtJF',\n      pk: 'sppk7cZsZeBApsFgYEdWuSwj92YCWkJxMmBfkN3FeKRmEB7Lk5pmDrT',\n      pkh: 'tz2WKg52VqnYXH52TZbSVjT4hcc8YGVKi7Pd'\n    };\n    const userInfo = {\n      typeOfLogin,\n      verifierId: typeOfLogin !== 'google' ? 'MockUser' : 'mock@user.com',\n      name: typeOfLogin !== 'twitter' ? 'Mock User' : '@MockUser'\n    };\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        resolve({ keyPair, userInfo });\n      }, 1000);\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { WalletService } from '../wallet/wallet.service';\nimport { CONSTANTS } from '../../../environments/environment';\n\n@Injectable()\nexport class TzrateService {\n  public apiUrl = 'https://api.coingecko.com/api/v3/simple/price?ids=tezos&vs_currencies=usd';\n  constructor(private http: HttpClient, private walletService: WalletService) {}\n\n  getTzrate() {\n    if (CONSTANTS.MAINNET) {\n      this.http.get(this.apiUrl).subscribe(\n        (price: any) => {\n          this.walletService.wallet.XTZrate = price.tezos.usd;\n          this.updateFiatBalances();\n        },\n        (err) => console.log('Failed to get xtz price: ' + JSON.stringify(err))\n      );\n    } else {\n      this.walletService.wallet.XTZrate = 0;\n      this.updateFiatBalances();\n    }\n  }\n  updateFiatBalances() {\n    const accounts = this.walletService.wallet.getAccounts();\n    let tot = 0;\n    let change = false;\n    for (const account of accounts) {\n      if (account.balanceXTZ !== null) {\n        account.balanceUSD = Number((account.balanceXTZ / 1000000) * this.walletService.wallet.XTZrate);\n        tot += account.balanceUSD;\n        change = true;\n      }\n    }\n    if (change) {\n      this.walletService.wallet.totalBalanceUSD = Number(tot);\n      this.walletService.storeWallet();\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { IndexerService } from '../indexer/indexer.service';\nimport { filter } from 'rxjs/operators';\nimport { NavigationEnd, Router } from '@angular/router';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UnlockableService {\n  readonly settingsKey = 'settings';\n  unlockables: any;\n  queue = [];\n  workers = 0;\n  constructor(public indexerService: IndexerService, private router: Router) {\n    this.router.events.pipe(filter((evt) => evt instanceof NavigationEnd)).subscribe(async (r: NavigationEnd) => {\n      if (r.url.indexOf('/account') === -1) {\n        document.documentElement.className = '';\n      }\n    });\n  }\n\n  toggleFeature(type, feat): boolean {\n    this.unlockables = localStorage.getItem(this.settingsKey);\n    if (this.unlockables) {\n      try {\n        this.unlockables = JSON.parse(this.unlockables);\n        this.unlockables[type] = this.unlockables[type] === feat ? '' : feat;\n        localStorage.setItem(this.settingsKey, JSON.stringify(this.unlockables));\n        if (this.unlockables[type]) {\n          document.documentElement.classList.add(feat);\n        } else {\n          document.documentElement.classList.remove(feat);\n        }\n        return this.unlockables[type];\n      } catch (e) {\n        return false;\n      }\n    } else {\n      this.unlockables = {};\n      this.unlockables[type] = feat;\n      localStorage.setItem(this.settingsKey, JSON.stringify(this.unlockables));\n      document.documentElement.classList.add(feat);\n      return true;\n    }\n  }\n  restoreFeatures() {\n    this.unlockables = localStorage.getItem(this.settingsKey);\n    if (this.unlockables) {\n      try {\n        this.unlockables = JSON.parse(this.unlockables);\n        for (let feat of Object.keys(this.unlockables)) {\n          if (!!this.unlockables[feat]) {\n            document.documentElement.classList.add(this.unlockables[feat]);\n          }\n        }\n      } catch (e) {}\n    }\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { KeyPair, WalletType, Activity } from './../../interfaces';\nimport {\n  WalletObject,\n  HdWallet,\n  FullWallet,\n  LegacyWalletV1,\n  LegacyWalletV2,\n  LegacyWalletV3,\n  ImplicitAccount,\n  LedgerWallet,\n  TorusWallet,\n  EmbeddedTorusWallet,\n  OriginatedAccount,\n  WatchWallet\n} from './wallet';\nimport { EncryptionService } from '../encryption/encryption.service';\nimport { OperationService } from '../operation/operation.service';\nimport { TorusService } from '../torus/torus.service';\nimport { utils, hd } from '@tezos-core-tools/crypto-utils';\nimport { BehaviorSubject } from 'rxjs';\nimport { SubjectService } from '../subject/subject.service';\n\n@Injectable()\nexport class WalletService {\n  storeKey = 'kukai-wallet';\n  storageId = 0;\n  wallet: WalletObject;\n\n  constructor(\n    private encryptionService: EncryptionService,\n    private operationService: OperationService,\n    private torusService: TorusService,\n    private subjectService: SubjectService\n  ) {}\n  /*\n    Wallet creation\n  */\n  createNewWallet(): string {\n    return utils.generateMnemonic(24);\n  }\n  async createEncryptedWallet(mnemonic: string, password: string, passphrase: string = '', hdSeed: boolean): Promise<any> {\n    const seed = utils.mnemonicToSeed(mnemonic, passphrase, hdSeed);\n    const entropy: Buffer = Buffer.from(utils.mnemonicToEntropy(mnemonic));\n    let keyPair: KeyPair;\n    if (!hdSeed) {\n      keyPair = this.operationService.seed2keyPair(seed);\n    } else {\n      keyPair = hd.keyPairFromAccountIndex(seed, 0);\n    }\n    const encrypted = await this.encryptionService.encrypt(seed, password, 3);\n    const encryptedSeed: string = encrypted.chiphertext;\n    const iv: string = encrypted.iv;\n    /*\n      Warning: Make sure to never reuse IV for AES-GCM\n    */\n    const iv2: string = this.encryptionService.shiftIV(iv, 1);\n    const encryptedEntropy: string = (await this.encryptionService.encrypt(entropy, password, 3, iv2)).chiphertext;\n    return {\n      data: this.exportKeyStoreInit(hdSeed ? WalletType.HdWallet : WalletType.LegacyWallet, encryptedSeed, encryptedEntropy, iv),\n      pkh: keyPair.pkh,\n      pk: keyPair.pk,\n      seed: seed\n    };\n  }\n  async getKeys(pwd: string, pkh?: string): Promise<KeyPair> {\n    let seed;\n    if (this.wallet instanceof LegacyWalletV1) {\n      seed = await this.encryptionService.decrypt(this.wallet.encryptedSeed, pwd, this.wallet.salt, 1);\n    } else if (this.wallet instanceof LegacyWalletV2) {\n      seed = await this.encryptionService.decrypt(this.wallet.encryptedSeed, pwd, this.wallet.IV, 2);\n    } else if (this.wallet instanceof LegacyWalletV3 || this.wallet instanceof HdWallet) {\n      seed = await this.encryptionService.decrypt(this.wallet.encryptedSeed, pwd, this.wallet.IV, 3);\n    } else if (this.wallet instanceof LedgerWallet) {\n      const keyPair: KeyPair = {\n        sk: null,\n        pk: this.wallet.implicitAccounts[0].pk,\n        pkh: this.wallet.implicitAccounts[0].pkh\n      };\n      return keyPair;\n    } else if (this.wallet instanceof EmbeddedTorusWallet && this.wallet?.sk) {\n      return this.operationService.spPrivKeyToKeyPair(this.wallet.sk);\n    } else if (this.wallet instanceof TorusWallet || (this.wallet instanceof EmbeddedTorusWallet && !this.wallet?.sk)) {\n      const keyPair = await this.torusService.getTorusKeyPair(this.wallet.verifier, this.wallet.id);\n      if (this.wallet.getImplicitAccount(keyPair.pkh)) {\n        return keyPair;\n      } else {\n        throw new Error('Signed with wrong account');\n      }\n      return null;\n    } else {\n      return null;\n    }\n    if (!seed) {\n      return null;\n    }\n    if (this.wallet instanceof HdWallet) {\n      if (!pkh) {\n        throw new Error('No pkh provided');\n      }\n      const account = this.wallet.getImplicitAccount(pkh);\n      if (!account.derivationPath) {\n        throw new Error('No derivationPath found');\n      }\n      return hd.seedToKeyPair(seed, account.derivationPath);\n    } else if (this.wallet instanceof LegacyWalletV1) {\n      const keyPair = this.operationService.seed2keyPair(seed);\n      if (!keyPair.pkh || !pkh || keyPair.pkh !== pkh) {\n        return null;\n      } else {\n        return keyPair;\n      }\n    } else {\n      return this.operationService.seed2keyPair(seed);\n    }\n  }\n  async revealMnemonicPhrase(pwd: string): Promise<string> {\n    if (this.wallet && (this.wallet instanceof HdWallet || this.wallet instanceof LegacyWalletV3)) {\n      const iv = this.encryptionService.shiftIV(this.wallet.IV, 1);\n      const entropy = await this.encryptionService.decrypt(this.wallet.encryptedEntropy, pwd, iv, 3);\n      if (entropy) {\n        return utils.entropyToMnemonic(entropy);\n      } else {\n        console.log('Invalid password');\n      }\n    }\n    return '';\n  }\n  addImplicitAccount(pk: string, derivationPath?: string | number) {\n    let pkh;\n    console.log(pk);\n    if (pk && pk.slice(0, 4) === 'sppk') {\n      pkh = this.operationService.pk2pkh(pk);\n    } else {\n      pkh = utils.pkToPkh(pk);\n    }\n    if (pkh) {\n      this.wallet.implicitAccounts.push(new ImplicitAccount(pkh, pk, typeof derivationPath === 'number' ? `44'/1729'/${derivationPath}'/0'` : derivationPath));\n      console.log('Adding new implicit account...');\n      console.log(this.wallet.implicitAccounts[this.wallet.implicitAccounts.length - 1]);\n      this.storeWallet();\n    }\n  }\n  addOriginatedAccount(kt: string, manager: string) {\n    const implicitAccount = this.wallet.getImplicitAccount(manager);\n    if (implicitAccount) {\n      const origAcc = new OriginatedAccount(kt, implicitAccount.pkh, implicitAccount.pk);\n      implicitAccount.originatedAccounts.push(origAcc);\n      this.storeWallet();\n    } else {\n      console.warn(`Manager address $(manager) not found`);\n    }\n  }\n  /*addUnusedAccount(account: any) {\n    if (this.wallet instanceof HdWallet) {\n      this.wallet.unusedAccounts.push(account);\n    }\n  }*/\n  addressExists(address: string): boolean {\n    return this.wallet?.getAccounts().findIndex((a) => a.address === address) !== -1;\n  }\n  async incrementAccountIndex(password: string): Promise<string> {\n    if (this.wallet instanceof HdWallet) {\n      const seed = await this.encryptionService.decrypt(this.wallet.encryptedSeed, password, this.wallet.IV, 3);\n      if (seed) {\n        const keyPair: KeyPair = hd.seedToKeyPair(seed, `44'/1729'/${this.wallet.index}'/0'`);\n        this.addImplicitAccount(keyPair.pk, this.wallet.index);\n        this.wallet.index++;\n        this.storeWallet();\n        return keyPair.pkh;\n      } else {\n        return ''; // Wrong pwd\n      }\n    }\n  }\n  /*\n    Clear wallet data from browser\n  */\n  clearWallet(instanceId: string = '') {\n    this.wallet = null;\n    this.storageId = 0;\n    if (instanceId) {\n      sessionStorage.removeItem(instanceId);\n    } else {\n      localStorage.removeItem(this.storeKey);\n    }\n  }\n  /*\n  Used to decide wallet type\n  */\n  isFullWallet(): boolean {\n    return this.wallet instanceof FullWallet;\n  }\n  isViewOnlyWallet(): boolean {\n    return false;\n  }\n  isObserverWallet(): boolean {\n    return false;\n  }\n  isLedgerWallet(): boolean {\n    return this.wallet instanceof LedgerWallet;\n  }\n  isHdWallet(): boolean {\n    return this.wallet instanceof HdWallet;\n  }\n  isTorusWallet(): boolean {\n    return this.wallet instanceof TorusWallet;\n  }\n  isEmbeddedTorusWallet(): boolean {\n    return this.wallet instanceof EmbeddedTorusWallet;\n  }\n  isWatchWallet(): boolean {\n    return this.wallet instanceof WatchWallet;\n  }\n  isPwdWallet(): boolean {\n    return !this.isTorusWallet() && !this.isLedgerWallet() && !this.isWatchWallet();\n  }\n  exportKeyStoreInit(walletType: WalletType, encryptedSeed: string, encryptedEntropy: string, iv: string) {\n    const data: any = {\n      provider: 'Kukai',\n      version: 3.0,\n      walletType,\n      encryptedSeed,\n      encryptedEntropy,\n      iv\n    };\n    return data;\n  }\n  /*\n    Read and write to localStorage\n  */\n  initStorage(instanceId: string = '') {\n    this.storageId = Date.now();\n    if (instanceId) {\n      sessionStorage.setItem(instanceId, JSON.stringify({ localStorageId: this.storageId }));\n    } else {\n      localStorage.setItem(this.storeKey, JSON.stringify({ localStorageId: this.storageId }));\n    }\n  }\n  storeWallet() {\n    const localStorageId = this.getLocalStorageId();\n    if (this.storageId && localStorageId && this.storageId === localStorageId) {\n      let type = 'unknown';\n      if (this.wallet instanceof HdWallet) {\n        type = 'HdWallet';\n      } else if (this.wallet instanceof LegacyWalletV1) {\n        type = 'LegacyWalletV1';\n      } else if (this.wallet instanceof LegacyWalletV2) {\n        type = 'LegacyWalletV2';\n      } else if (this.wallet instanceof LegacyWalletV3) {\n        type = 'LegacyWalletV3';\n      } else if (this.wallet instanceof LedgerWallet) {\n        type = 'LedgerWallet';\n      } else if (this.wallet instanceof EmbeddedTorusWallet) {\n        type = 'EmbeddedTorusWallet';\n      } else if (this.wallet instanceof TorusWallet) {\n        type = 'TorusWallet';\n      } else if (this.wallet instanceof WatchWallet) {\n        type = 'WatchWallet';\n      }\n      this.getStorage().setItem(\n        this.wallet instanceof EmbeddedTorusWallet ? this.wallet.instanceId : this.storeKey,\n        JSON.stringify({\n          type,\n          localStorageId: this.storageId,\n          data: this.wallet\n        })\n      );\n    } else {\n      console.log('Outdated storage id');\n    }\n    this.subjectService.walletUpdated.next(null);\n  }\n  getLocalStorageId() {\n    const walletData = this.wallet instanceof EmbeddedTorusWallet ? sessionStorage.getItem(this.wallet.instanceId) : localStorage.getItem(this.storeKey);\n    if (walletData) {\n      const parsed = JSON.parse(walletData);\n      if (parsed && parsed.localStorageId) {\n        return parsed.localStorageId;\n      }\n    }\n    return 0;\n  }\n\n  loadStoredWallet(instanceId = '') {\n    const walletData = instanceId ? sessionStorage.getItem(instanceId) : localStorage.getItem(this.storeKey);\n    if (walletData && walletData !== 'undefined') {\n      const parsedWalletData = JSON.parse(walletData);\n      console.log(parsedWalletData);\n      if (parsedWalletData.type && parsedWalletData.data && parsedWalletData.localStorageId) {\n        this.storageId = parsedWalletData.localStorageId;\n        const wd = parsedWalletData.data;\n        this.deserializeStoredWallet(wd, parsedWalletData.type);\n      } else {\n        console.log('couldnt load a wallet');\n        this.clearWallet(instanceId);\n      }\n    } else {\n      console.log('couldnt load a wallet');\n      this.clearWallet(instanceId);\n    }\n  }\n  deserializeStoredWallet(wd: any, type: string) {\n    switch (type) {\n      case 'HdWallet':\n        this.wallet = new HdWallet(wd.IV, wd.encryptedSeed, wd.encryptedEntropy);\n        if (this.wallet instanceof HdWallet) {\n          this.wallet.index = wd.index;\n        }\n        break;\n      case 'LegacyWalletV1':\n        this.wallet = new LegacyWalletV1(wd.salt, wd.encryptedSeed);\n        break;\n      case 'LegacyWalletV2':\n        this.wallet = new LegacyWalletV2(wd.IV, wd.encryptedSeed);\n        break;\n      case 'LegacyWalletV3':\n        this.wallet = new LegacyWalletV3(wd.IV, wd.encryptedSeed, wd.encryptedEntropy);\n        break;\n      case 'LedgerWallet':\n        this.wallet = new LedgerWallet();\n        break;\n      case 'TorusWallet':\n        this.wallet = new TorusWallet(wd.verifier, wd.id, wd.name);\n        this.torusService.initTorus();\n        break;\n      case 'EmbeddedTorusWallet':\n        this.wallet = new EmbeddedTorusWallet(wd.verifier, wd.id, wd.name, wd.origin, wd.sk, wd.instanceId);\n        this.torusService.initTorus();\n        break;\n      case 'WatchWallet':\n        this.wallet = new WatchWallet();\n      default:\n    }\n    this.wallet.XTZrate = wd.XTZrate;\n    this.wallet.totalBalanceUSD = wd.totalBalanceUSD;\n    this.wallet.totalBalanceXTZ = wd.totalBalanceXTZ;\n    if (wd.lookups) {\n      this.wallet.lookups = wd.lookups;\n    }\n    for (const implicit of wd.implicitAccounts) {\n      const impAcc: ImplicitAccount = new ImplicitAccount(implicit.pkh, implicit.pk, implicit.derivationPath ? implicit.derivationPath : null);\n      impAcc.balanceUSD = implicit.balanceUSD;\n      impAcc.balanceXTZ = implicit.balanceXTZ;\n      impAcc.delegate = implicit.delegate;\n      impAcc.state = implicit.state;\n      impAcc.activities = implicit.activities;\n      if (implicit.tokens) {\n        impAcc.tokens = implicit.tokens;\n      }\n      for (const originated of implicit.originatedAccounts) {\n        const origAcc = new OriginatedAccount(originated.address, impAcc.pkh, impAcc.pk);\n        origAcc.balanceUSD = originated.balanceUSD;\n        origAcc.balanceXTZ = originated.balanceXTZ;\n        origAcc.delegate = originated.delegate;\n        origAcc.state = originated.state;\n        origAcc.activities = originated.activities;\n        impAcc.originatedAccounts.push(origAcc);\n      }\n      this.wallet.implicitAccounts.push(impAcc);\n    }\n  }\n  private getStorage() {\n    return this.isEmbeddedTorusWallet() ? sessionStorage : localStorage;\n  }\n}\n","export type WalletObject = LegacyWalletV1 | LegacyWalletV2 | LegacyWalletV3 | LedgerWallet | HdWallet | TorusWallet | WatchWallet;\n\nexport class Wallet {\n  totalBalanceXTZ: number | null;\n  totalBalanceUSD: number | null;\n  XTZrate: number | null;\n  implicitAccounts: ImplicitAccount[];\n  lookups: any[];\n  constructor() {\n    this.totalBalanceXTZ = null;\n    this.totalBalanceUSD = null;\n    this.XTZrate = null;\n    this.implicitAccounts = [];\n    this.lookups = [];\n  }\n  getAccounts(): Account[] {\n    const accounts: Account[] = [];\n    if (this.implicitAccounts.length) {\n      for (const implicitAccount of this.implicitAccounts) {\n        accounts.push(implicitAccount);\n        if (implicitAccount.originatedAccounts.length) {\n          for (const originatedAccount of implicitAccount.originatedAccounts) {\n            accounts.push(originatedAccount);\n          }\n        }\n      }\n    }\n    return accounts;\n  }\n  getImplicitAccounts(): ImplicitAccount[] {\n    return this.implicitAccounts;\n  }\n  getAccount(address: string): Account {\n    if (this.implicitAccounts.length) {\n      for (const implicitAccount of this.implicitAccounts) {\n        if (implicitAccount.address === address) {\n          return implicitAccount;\n        }\n        if (implicitAccount.originatedAccounts.length) {\n          for (const originatedAccount of implicitAccount.originatedAccounts) {\n            if (originatedAccount.address === address) {\n              return originatedAccount;\n            }\n          }\n        }\n      }\n    }\n    return null;\n  }\n  getImplicitAccount(pkh: string): ImplicitAccount {\n    if (this.implicitAccounts.length) {\n      for (const implicitAccount of this.implicitAccounts) {\n        if (implicitAccount.pkh === pkh) {\n          return implicitAccount;\n        }\n      }\n    }\n    return null;\n  }\n}\n\nexport class FullWallet extends Wallet {\n  encryptedSeed: string;\n  constructor(encryptedSeed: string) {\n    super();\n    this.encryptedSeed = encryptedSeed;\n  }\n}\n\nexport class LegacyWalletV1 extends FullWallet {\n  salt: string;\n  constructor(salt: string, encrypedSeed: string) {\n    super(encrypedSeed);\n    this.salt = salt;\n  }\n}\n\nexport class LegacyWalletV2 extends FullWallet {\n  IV: string;\n  constructor(IV: string, encryptedSeed: string) {\n    super(encryptedSeed);\n    this.IV = IV;\n  }\n}\n\nexport class LegacyWalletV3 extends FullWallet {\n  encryptedEntropy: string;\n  IV: string;\n  constructor(IV: string, encryptedSeed: string, encryptedEntropy: string) {\n    super(encryptedSeed);\n    this.IV = IV;\n    this.encryptedEntropy = encryptedEntropy;\n  }\n}\n\nexport class HdWallet extends FullWallet {\n  encryptedEntropy: string;\n  IV: string;\n  index: number;\n  constructor(IV: string, encryptedSeed: string, encryptedEntropy: string) {\n    super(encryptedSeed);\n    this.encryptedEntropy = encryptedEntropy;\n    this.IV = IV;\n    this.index = 0;\n  }\n}\n\nexport class TorusWallet extends Wallet {\n  verifier: string;\n  id: string;\n  name: string;\n  constructor(verifier: string, id: string, name: string) {\n    super();\n    this.verifier = verifier;\n    this.id = id;\n    this.name = name;\n  }\n  displayName() {\n    if (['twitter', 'facebook'].includes(this.verifier)) {\n      return this.name;\n    }\n    return this.id;\n  }\n}\nexport class EmbeddedTorusWallet extends TorusWallet {\n  origin: string;\n  sk: string;\n  instanceId: string;\n  constructor(verifier: string, id: string, name: string, origin: string, sk: string, instanceId: string) {\n    super(verifier, id, name);\n    this.origin = origin;\n    this.sk = sk;\n    this.instanceId = instanceId;\n  }\n}\nexport class LedgerWallet extends Wallet {\n  constructor() {\n    super();\n  }\n}\n\nexport class WatchWallet extends Wallet {\n  constructor() {\n    super();\n  }\n}\n\n// Accounts\n\nexport abstract class Account {\n  balanceXTZ: number | null;\n  balanceUSD: number | null;\n  delegate: string;\n  state: string;\n  activities: Activity[] | null;\n  tokens: Token[] | null;\n  pkh: string;\n  pk: string;\n  address: string;\n  constructor(pkh: string, pk: string, address: string) {\n    this.balanceXTZ = null;\n    this.balanceUSD = null;\n    this.activities = null;\n    this.tokens = null;\n    this.delegate = '';\n    this.state = '';\n    this.pkh = pkh;\n    this.pk = pk;\n    this.address = address;\n  }\n  public abstract isImplicit(): boolean;\n  shortAddress(): string {\n    return this.address.slice(0, 7) + '...' + this.address.slice(-4);\n  }\n  getTokenBalance(tokenId: string): string {\n    if (this.tokens?.length) {\n      for (const token of this.tokens) {\n        if (tokenId === token.tokenId) {\n          return token.balance;\n        }\n      }\n    }\n    return '';\n  }\n  getTokenBalances(): Token[] {\n    return this.tokens ?? [];\n  }\n  updateTokenBalance(tokenId: string, balance: string) {\n    if (!this.tokens || !tokenId) {\n      this.tokens = [];\n    }\n    if (tokenId && this.tokens.length) {\n      for (let i = 0; i < this.tokens.length; i++) {\n        if (tokenId === this.tokens[i].tokenId) {\n          if (this.tokens[i].balance !== balance) {\n            if (balance === '0' || (balance && balance.slice(0, 1) === '-')) {\n              this.tokens.splice(i, 1);\n            } else {\n              this.tokens[i].balance = balance;\n            }\n          }\n          return;\n        }\n      }\n    }\n    if (tokenId.length > 37 && balance && balance !== '0' && balance.slice(0, 1) !== '-') {\n      this.tokens.unshift({ tokenId, balance });\n    }\n  }\n}\n\nexport class ImplicitAccount extends Account {\n  originatedAccounts: OriginatedAccount[];\n  derivationPath?: string;\n  constructor(pkh: string, pk: string, derivationPath?: string) {\n    super(pkh, pk, pkh);\n    this.originatedAccounts = [];\n    if (derivationPath) {\n      this.derivationPath = derivationPath;\n    }\n  }\n  isImplicit(): boolean {\n    return true;\n  }\n}\n\nexport class OriginatedAccount extends Account {\n  constructor(ktAddress: string, managerPkh: string, managerPk: string) {\n    super(managerPkh, managerPk, ktAddress);\n  }\n  isImplicit(): boolean {\n    return false;\n  }\n}\n\nexport enum OpStatus {\n  FAILED = -1,\n  UNCONFIRMED = 0,\n  HALF_CONFIRMED = 0.5, // confirmed but not indexed fully yet\n  CONFIRMED = 1\n}\nexport class Activity {\n  type: string;\n  block: string;\n  status: OpStatus;\n  amount: string;\n  source: {\n    address: string;\n    alias?: string;\n  };\n  destination: {\n    address: string;\n    alias?: string;\n  };\n  fee?: string;\n  hash: string;\n  counter?: number;\n  timestamp: number | null;\n  tokenId?: string;\n  entrypoint?: string;\n  opId?: string;\n}\nexport class Token {\n  tokenId: string;\n  balance: string;\n}\n","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `.angular-cli.json`.\nimport { Constants, DisplayLinkOption } from '../app/interfaces';\n\nexport const environment = {\n  production: false\n};\nconst _CONSTANTS: Constants = {\n  NETWORK: 'jakartanet',\n  NAME: 'Testnet / Jakartanet',\n  TEZOS_DOMAIN: {\n    CONTRACT: 'KT1D6vXtKDtF2fE5uQuUkMTDGpEeTrbByX25',\n    TOP_DOMAINS: ['jak']\n  },\n  MAINNET: false,\n  NODE_URL: 'https://jakartanet.ecadinfra.com',\n  BLOCK_EXPLORER_URL: 'https://jakartanet.tzkt.io',\n  HARD_LIMITS: {\n    hard_gas_limit_per_operation: 1040000,\n    hard_gas_limit_per_block: 5200000,\n    hard_storage_limit_per_operation: 60000\n  },\n  CONTRACT_ALIASES: {},\n  ASSETS: {},\n  NFT_CONTRACT_OVERRIDES: [],\n  CONTRACT_OVERRIDES: {},\n  FEATURE_CONTRACTS: {}\n};\nconst _TRUSTED_TOKEN_CONTRACTS = [];\nconst _BLACKLISTED_TOKEN_CONTRACTS = [];\nconst _MODEL_3D_WHITELIST = [];\n\nexport const CONSTANTS = JSON.parse(JSON.stringify(_CONSTANTS));\nexport const TRUSTED_TOKEN_CONTRACTS = JSON.parse(JSON.stringify(_TRUSTED_TOKEN_CONTRACTS));\nexport const BLACKLISTED_TOKEN_CONTRACTS = JSON.parse(JSON.stringify(_BLACKLISTED_TOKEN_CONTRACTS));\nexport const MODEL_3D_WHITELIST = JSON.parse(JSON.stringify(_MODEL_3D_WHITELIST));\n","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `.angular-cli.json`.\nimport { Constants } from './../app/interfaces';\nimport {\n  CONSTANTS as _CONSTANTS,\n  TRUSTED_TOKEN_CONTRACTS as _TTC,\n  BLACKLISTED_TOKEN_CONTRACTS as _BLTC,\n  MODEL_3D_WHITELIST as _M3DW\n} from './environment.jakartanet';\n\nexport const environment = {\n  production: false\n};\nexport const CONSTANTS: Constants = _CONSTANTS;\nexport const TRUSTED_TOKEN_CONTRACTS = _TTC;\nexport const BLACKLISTED_TOKEN_CONTRACTS = _BLTC;\nexport const MODEL_3D_WHITELIST = _M3DW;\n","import { Injectable } from '@angular/core';\nimport { KeyPair, WalletType } from './../../interfaces';\nimport { WalletService } from '../wallet/wallet.service';\nimport { CoordinatorService } from '../coordinator/coordinator.service';\nimport { LegacyWalletV1, LegacyWalletV2, LegacyWalletV3, HdWallet, LedgerWallet, TorusWallet, EmbeddedTorusWallet, WatchWallet } from '../wallet/wallet';\nimport { hd, utils } from '@tezos-core-tools/crypto-utils';\nimport { EncryptionService } from '../encryption/encryption.service';\nimport { TorusService } from '../torus/torus.service';\nimport { IndexerService } from '../indexer/indexer.service';\nimport { OperationService } from '../operation/operation.service';\n\n@Injectable()\nexport class ImportService {\n  constructor(\n    private walletService: WalletService,\n    private coordinatorService: CoordinatorService,\n    private indexerService: IndexerService,\n    private encryptionService: EncryptionService,\n    private torusService: TorusService,\n    private operationService: OperationService\n  ) {}\n  pwdRequired(json: string) {\n    const walletData = JSON.parse(json);\n    if (walletData.provider !== 'Kukai') {\n      throw new Error(`Unsupported wallet format`);\n    }\n    if (walletData.walletType === WalletType.LegacyWallet || walletData.walletType === WalletType.HdWallet) {\n      return true;\n    } else {\n      return false;\n    }\n  }\n  async importWalletFromJson(json: any, pwd: string): Promise<boolean> {\n    // From file\n    let seed;\n    let walletData;\n    try {\n      walletData = JSON.parse(json);\n      if (walletData.walletType === WalletType.HdWallet && walletData.version === 3) {\n        //hd\n        seed = await this.encryptionService.decrypt(walletData.encryptedSeed, pwd, walletData.iv, 3);\n      } else if (walletData.walletType === WalletType.LegacyWallet) {\n        if (walletData.version === 1) {\n          console.log('v1');\n          seed = await this.encryptionService.decrypt(walletData.encryptedSeed, pwd, walletData.pkh.slice(3, 19), 1);\n          if (utils.seedToKeyPair(seed).pkh !== walletData.pkh) {\n            seed = '';\n          }\n        } else if (walletData.version === 2 || walletData.version === 3) {\n          seed = await this.encryptionService.decrypt(walletData.encryptedSeed, pwd, walletData.iv, walletData.version);\n        }\n      }\n    } catch (e) {\n      console.error(e);\n      throw new Error('Failed to decrypt keystore file');\n    }\n    if (seed) {\n      return this.importWalletFromObject(walletData, seed).then(\n        (ans) => {\n          return ans;\n        },\n        (e) => {\n          console.error(e);\n          throw new Error('Failed to fetch account(s). Please check your connection.');\n        }\n      );\n    } else {\n      throw new Error('Wrong password');\n    }\n  }\n  async importWalletFromObject(data: any, seed: any): Promise<boolean> {\n    this.coordinatorService.stopAll();\n    if (data.walletType === WalletType.HdWallet && data.version === 3) {\n      // HD\n      this.walletService.wallet = new HdWallet(data.iv, data.encryptedSeed, data.encryptedEntropy);\n    } else if (data.walletType === WalletType.LegacyWallet) {\n      if (data.version === 3) {\n        this.walletService.wallet = new LegacyWalletV3(data.iv, data.encryptedSeed, data.encryptedEntropy);\n      } else if (data.version === 2) {\n        this.walletService.wallet = new LegacyWalletV2(data.iv, data.encryptedSeed);\n      } else if (data.version === 1) {\n        this.walletService.wallet = new LegacyWalletV1(data.pkh.slice(3, 19), data.encryptedSeed);\n      } else {\n        throw new Error('Unsupported wallet file');\n      }\n    } else {\n      throw new Error('Unsupported wallet file');\n    }\n    let keys: KeyPair;\n    if (seed.length === 32) {\n      keys = utils.seedToKeyPair(seed);\n    } else if (seed.length === 64) {\n      keys = hd.keyPairFromAccountIndex(seed, 0);\n    } else {\n      throw new Error('Invalid seed length');\n    }\n    this.walletService.initStorage();\n    if (this.walletService.wallet instanceof HdWallet) {\n      let index = 0;\n      let isUsedAccount: boolean = true;\n      while (isUsedAccount) {\n        keys = hd.keyPairFromAccountIndex(seed, index);\n        isUsedAccount = await this.indexerService.isUsedAccount(keys.pkh);\n        if (isUsedAccount || index === 0) {\n          this.walletService.addImplicitAccount(keys.pk, index++);\n          await this.findContracts(keys.pkh);\n        }\n      }\n      this.walletService.wallet.index = index;\n    } else {\n      this.walletService.addImplicitAccount(keys.pk);\n      await this.findContracts(keys.pkh);\n    }\n    return true;\n  }\n\n  async importWalletFromPk(pk: string, derivationPath: string, verifierDetails: any = null, sk: string = '', instanceId: string = ''): Promise<boolean> {\n    this.coordinatorService.stopAll();\n    if (derivationPath) {\n      return this.ledgerImport(pk, derivationPath);\n    } else if (verifierDetails) {\n      return this.torusImport(pk, verifierDetails, sk, instanceId);\n    }\n  }\n  async watch(pkh: string) {\n    if (this.operationService.validAddress(pkh)) {\n      const pk = await this.operationService.getManager(pkh).toPromise();\n      if (pk) {\n        this.walletService.initStorage();\n        this.walletService.wallet = new WatchWallet();\n        this.walletService.addImplicitAccount(pk);\n        this.findContracts(this.walletService.wallet.implicitAccounts[0].pkh);\n      } else {\n        console.error('Public key not found');\n      }\n    }\n  }\n  async ledgerImport(pk: string, derivationPath: string) {\n    try {\n      this.walletService.initStorage();\n      this.walletService.wallet = new LedgerWallet();\n      this.walletService.addImplicitAccount(pk, derivationPath);\n      await this.findContracts(this.walletService.wallet.implicitAccounts[0].pkh);\n      return true;\n    } catch (err) {\n      console.warn(err);\n      this.walletService.clearWallet();\n      return false;\n    }\n  }\n  async torusImport(pk: string, verifierDetails: any, sk: string = '', instanceId: string = '') {\n    try {\n      if (verifierDetails.embedded) {\n        this.walletService.initStorage(instanceId);\n        this.walletService.wallet = new EmbeddedTorusWallet(\n          verifierDetails.verifier,\n          verifierDetails.id,\n          verifierDetails.name,\n          verifierDetails.origin,\n          sk,\n          instanceId\n        );\n      } else {\n        this.walletService.initStorage();\n        this.walletService.wallet = new TorusWallet(verifierDetails.verifier, verifierDetails.id, verifierDetails.name);\n      }\n      if (verifierDetails.verifier === 'twitter') {\n        this.updateTwitterName(verifierDetails.id);\n      }\n      if (pk || !verifierDetails?.embedded) {\n        this.walletService.addImplicitAccount(pk);\n      } else {\n        this.walletService.storeWallet();\n      }\n      return true;\n    } catch (err) {\n      console.warn(err);\n      this.walletService.clearWallet(instanceId);\n      return false;\n    }\n  }\n  async updateTwitterName(verifierId: string) {\n    const twitterId = verifierId.split('|')[1];\n    const { username } = await this.torusService.twitterLookup(undefined, twitterId);\n    if (username && this.walletService.wallet instanceof TorusWallet) {\n      this.walletService.wallet.name = '@' + username;\n    }\n  }\n  async findContracts(pkh: string) {\n    const addresses = await this.indexerService.getContractAddresses(pkh);\n    for (const KT of addresses) {\n      console.log('Found KT: ' + KT);\n      this.walletService.addOriginatedAccount(KT, pkh);\n    }\n    this.walletService.storeWallet();\n  }\n}\n","<div class=\"flex-row\" id=\"wrapper\">\n  <div class=\"flex-column left\">\n    <div class=\"flex-column top\">\n      <h1><ng-container *ngIf=\"isMobile\">&nbsp;</ng-container>A Secure Home&nbsp;<br />for your Digital Assets</h1>\n      <h3>Manage your digital assets and seamlessly&nbsp;<br *ngIf=\"!isMobile\" />connect with experiences and apps on Tezos.</h3>\n    </div>\n    <div class=\"flex-column login\">\n      <span>Sign in with social:</span>\n      <div class=\"flex-row social\">\n        <button class=\"flex-row google\" (click)=\"torusLogin('google')\"><img\n            src=\"../../../assets/img/google-logo.svg\">&nbsp;<span>CONTINUE WITH\n            GOOGLE</span></button>\n        <div class=\"flex-row torus\">\n          <img class=\"facebook\" src=\"../../../assets/img/facebook-logo.svg\" (click)=\"torusLogin('facebook')\">\n          <img class=\"twitter\" src=\"../../../assets//img/twitter-logo.svg\" (click)=\"torusLogin('twitter')\">\n          <img class=\"reddit\" src=\"../../../assets/img/reddit-logo.svg\" (click)=\"torusLogin('reddit')\">\n        </div>\n      </div>\n      <!-- <span>OR CONTINUE WITH EMAIL:</span>\n      <div class=\"flex-row email\">\n        <input type=email placeholder=\"Your email\">\n        <button class=\"signin\">SIGN IN</button>\n      </div> -->\n    </div>\n    <div class=\"flex-column bottom\">\n      <img src=\"../../../assets/img/landing-hero.png\" id=\"bg-mobile\">\n      <div id=\"ribbon-mobile\"></div>\n    </div>\n  </div>\n  <div class=\"flex-column right\">\n    <img src=\"../../../assets/img/landing-hero.png\" id=\"bg\">\n    <div id=\"ribbon\"></div>\n  </div>\n</div>","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { TranslateService } from '@ngx-translate/core';\nimport { WalletService } from '../../../services/wallet/wallet.service';\nimport { ActivatedRoute } from '@angular/router';\nimport 'rxjs/add/operator/filter';\nimport { TorusService } from '../../../services/torus/torus.service';\nimport { MessageService } from '../../../services/message/message.service';\nimport { ImportService } from '../../../services/import/import.service';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'app-start',\n  templateUrl: './start.component.html',\n  styleUrls: ['../../../../scss/components/views/start/start.component.scss']\n})\nexport class StartComponent implements OnInit, OnDestroy {\n  isMobile = false;\n\n  private subscriptions: Subscription = new Subscription();\n\n  constructor(\n    private walletService: WalletService,\n    public translate: TranslateService,\n    public torusService: TorusService,\n    private importService: ImportService,\n    private messageService: MessageService,\n    private router: Router,\n    private route: ActivatedRoute\n  ) {}\n\n  async ngOnInit(): Promise<void> {\n    this.subscriptions.add(\n      this.route.queryParams.subscribe(async (params) => {\n        if (params?.devtool === 'watch') {\n          const address = prompt('Enter watch address');\n          if (address) {\n            try {\n              await this.importService.watch(address);\n              this.messageService.startSpinner();\n              this.router.navigate([`/account/${address}`]);\n            } finally {\n              this.messageService.stopSpinner();\n            }\n          }\n        }\n      })\n    );\n    if (!this.walletService.wallet) {\n      this.torusService.initTorus();\n    }\n\n    const e = () => {\n      this.isMobile = !!parseInt(getComputedStyle(document.documentElement).getPropertyValue('--is-mobile'));\n    };\n    window.addEventListener('resize', e);\n    e();\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n\n  async torusLogin(verifier: string): Promise<void> {\n    await this.messageService.startSpinner('Loading wallet...');\n    // const { keyPair, userInfo } = await this.mockLogin();\n    const { keyPair, userInfo } = await this.torusService.loginTorus(verifier).catch(async (e) => await this.messageService.stopSpinner());\n    console.log('login done');\n    if (keyPair) {\n      await this.importService\n        .importWalletFromPk(keyPair.pk, '', {\n          verifier: userInfo.typeOfLogin,\n          id: userInfo.verifierId,\n          name: userInfo.name\n        })\n        .then((success: boolean) => {\n          if (success) {\n            console.log('success');\n            this.router.navigate([`/account/`]);\n            this.messageService.stopSpinner();\n          } else {\n            this.messageService.addError('Torus import failed');\n            this.messageService.stopSpinner();\n          }\n        });\n    } else {\n      await this.messageService.stopSpinner();\n    }\n  }\n\n  private async mockLogin(): Promise<any> {\n    const keyPair = {\n      sk: 'spsk1VfCfhixtzGvUSKDre6jwyGbXFm6aoeLGnxeVLCouueZmkgtJF',\n      pk: 'sppk7cZsZeBApsFgYEdWuSwj92YCWkJxMmBfkN3FeKRmEB7Lk5pmDrT',\n      pkh: 'tz2WKg52VqnYXH52TZbSVjT4hcc8YGVKi7Pd'\n    };\n    const userInfo = {\n      typeOfLogin: 'google',\n      verifierId: 'mock.user@gmail.com',\n      name: 'Mock User'\n    };\n    return new Promise((resolve) => {\n      setTimeout(() => {\n        resolve({ keyPair, userInfo });\n      }, 2000);\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { saveAs } from 'file-saver';\n\n@Injectable()\nexport class ExportService {\n  constructor() {}\n  downloadWallet(data: any) {\n    const blob = new Blob([JSON.stringify(data, null, 4)], {\n      type: 'application/json'\n    });\n    let filename = 'wallet.tez';\n    if (data.walletType === 1) {\n      filename = 'view-only_wallet.tez';\n    } else if (data.walletType === 2) {\n      filename = 'observer_wallet.tez';\n    } else if (data.walletType === 3) {\n      filename = 'ledger_wallet.tez';\n    } else if (data.walletType === 4) {\n      filename = 'hd-wallet.tez';\n    }\n    saveAs(blob, filename);\n  }\n\n  downloadOperationData(hex: string, signed: boolean) {\n    const data = {\n      hex: hex,\n      signed: signed\n    };\n    let filename;\n    if (signed) {\n      filename = 'signed.tzop';\n    } else {\n      filename = 'unsigned.tzop';\n    }\n    const blob = new Blob([JSON.stringify(data, null, 4)], {\n      type: 'application/json'\n    });\n    saveAs(blob, filename);\n  }\n}\n","<form autocomplete=\"off\">\n  <div class=\"flex-column card\">\n    <a routerLink=\"/\"><button class=\"flex-row back\"><img\n          src=\"../../../../../assets/img/left-arrow.svg\">BACK</button></a>\n    <div *ngIf=\"activePanel==1\" class=\"flex-column body\">\n      <h1>Back up your seed</h1>\n      <p class=\"description\">When you create a new wallet, new Tezos Recovery (Seed) Words are generated.<br />Your seed\n        words are\n        the\n        master key of your wallet accounts and any value they hold.</p>\n      <div class=\"whitebox\" (mouseout)=\"mouseOut($event)\" (touchstart)=\"$event.stopPropagation(); this.hideBlur = true;\"\n        (touchend)=\"checkSelection($event)\" (click)=\"$event.stopPropagation()\" (mouseup)=\"checkSelection($event)\">\n        {{ MNEMONIC.string }}<div *ngIf=\"!hideBlur\" class=\"flex-row seed-blur\"\n          (click)=\"$event.stopPropagation(); this.hideBlur = true;\">\n          <span>CLICK HERE TO REVEAL YOUR SEED WORDS</span>\n        </div>\n      </div>\n      <p class=\"description red\">\n        <span *ngIf=\"isSelectedMnemonic\" style=\"margin-top: -4rem\" class=\"warning red\">\n          WARNING: Copying the seed words to your clipboard can result in sensitive leakage. The clipboard is a shared\n          resource that can be monitored by other web pages or browser extensions.<br />\n        </span> Be sure sure to back it up (seed words), write it down, and keep it incredibly safe.\n      </p>\n      <button class=\"button next\" (click)=\"verifyView()\">Next</button>\n    </div>\n    <div *ngIf=\"activePanel==2\" class=\"flex-column body\">\n      <h1>Verify your seed</h1>\n      <p class=\"description\">{{ MNEMONIC.verify.length ? 'Fill in the ' + formatVerifyDescription(MNEMONIC.verify[0] +\n        1)\n        + ' to verify\n        your seed backup' : 'Recovery Words (seed) have been verified' }}</p>\n      <progress max=\"{{ MNEMONIC.wordsToVerify }}\"\n        value=\"{{ MNEMONIC.wordsToVerify - MNEMONIC.verify.length }}\"></progress>\n      <div *ngIf=\"MNEMONIC.verify.length\" class=\"flex-row word-verify\">\n        <div class=\"flex-column word-hint\">\n          <span class=\"word-index\">{{ indexFormat(MNEMONIC.verify[0] - 1) }}</span>\n          <span class=\"word-value\"><b>{{ valueFormat(MNEMONIC.verify[0] - 1) }}</b></span>\n        </div>\n        <div class=\"flex-column word-input\">\n          <span class=\"word-index\">\n            <ng-container *ngIf=\"MNEMONIC.verify.length\">Word {{ MNEMONIC.verify[0] + 1 }}</ng-container>\n          </span>\n          <input id=\"wordInput\" class=\"text\" name=\"none\" type=\"text\" (input)=\"checkWord()\" (change)=\"checkWord()\"\n            [(ngModel)]=\"wordInput\" [disabled]=\"!MNEMONIC.verify.length\" autofocus>\n        </div>\n        <div class=\"flex-column word-hint\">\n          <span class=\"word-index\">{{ indexFormat(MNEMONIC.verify[0] + 1) }}</span>\n          <span class=\"word-value\"><b>{{ valueFormat(MNEMONIC.verify[0] + 1) }}</b></span>\n        </div>\n      </div>\n      <button *ngIf=\"!MNEMONIC.verify.length\" class=\"button next\" (click)=\"pwdView()\">Next</button>\n    </div>\n    <div *ngIf=\"activePanel==3\" class=\"flex-column body\">\n      <h1>Set a password</h1>\n      <p class=\"description bold blue\">This password will be used to create an encrypted keystore file.</p>\n      <p class=\"description\">When performing operations that need to be signed with your\n        secret key, this password will be required</p>\n      <input name=\"none\" type=\"password\" placeholder=\"{{ 'NEWWALLETCOMPONENT.PASSWORD' | translate }}\" class=\"text\"\n        autocomplete=\"new-password\" [(ngModel)]=\"pwd1\" (keyup)=\"calcStrength()\">\n      <small class=\"strength\"> {{ 'NEWWALLETCOMPONENT.PASSWORDSTRENGTH' | translate }}  <b\n          [style.color]=\"pwdStrength === 'Catastrophic!' ? 'darkred' : pwdStrength === 'Very weak!' ? 'red' : pwdStrength === 'Weak!' ? 'orange' : pwdStrength === 'Strong!' ? 'green' : 'red'\">{{\n          pwdStrength }}</b></small>\n      <input name=\"none\" type=\"password\" placeholder=\"{{ 'NEWWALLETCOMPONENT.CONFIRMPASSWORD' | translate }}\" class=\"text\"\n        autocomplete=\"new-password\" [(ngModel)]=\"pwd2\">\n      <button class=\"button next\" [style.visibility]=\"!pwd1 ? 'hidden' : ''\" (click)=\"encryptWallet()\">Next</button>\n    </div>\n    <div *ngIf=\"activePanel==4\" class=\"flex-column body\">\n      <h1>Wallet created!</h1>\n      <p class=\"description bold\">Your wallet is now set up and ready to be used.</p>\n      <p class=\"description\">Download your encrypted keystore file and import it when you want to access your wallet.\n      </p>\n      <div class=\"whitebox final\">\n        <p class=\"description bold pkh\">Your public account address:<br />{{ getPkh() }}</p>\n      </div>\n      <button class=\"button next\" (click)=\"download()\">Download</button>\n      <button class=\"button next\" [style.visibility]=\"!ekfDownloaded ? 'hidden' : ''\" (click)=\"done()\">Open\n        Wallet</button>\n    </div>\n    <span class=\"flex-row step-counter\">\n      <ng-container *ngFor=\"let _ of [1, 2, 3, 4]\">\n        <div class=\"dot\" [class]=\"_ === activePanel ? 'selected' : ''\"></div>\n      </ng-container>\n    </span>\n  </div>\n</form>","import { Component, OnInit, Input, HostBinding } from '@angular/core';\nimport { WalletService } from '../../../../../services/wallet/wallet.service';\nimport { MessageService } from '../../../../../services/message/message.service';\nimport { ExportService } from '../../../../../services/export/export.service';\nimport { ImportService } from '../../../../../services/import/import.service';\nimport { InputValidationService } from '../../../../../services/input-validation/input-validation.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Router } from '@angular/router';\n\n@Component({\n  selector: 'app-new-wallet',\n  templateUrl: './new-wallet.component.html',\n  styleUrls: ['../../../../../../scss/components/views/start/login.component.scss']\n})\nexport class NewWalletComponent implements OnInit {\n  wordInput: string;\n  @HostBinding('class.tacos') showTacos = false;\n  @Input() pwd1 = '';\n  @Input() pwd2 = '';\n  @Input() userMnemonic = '';\n  hideBlur = false;\n  isSelectedMnemonic = false;\n  pwdStrength = '';\n  ekfDownloaded = false;\n  activePanel = 0;\n  data: any;\n  seed: any;\n  pkh: string;\n  pk: string;\n  MNEMONIC: {\n    string: string;\n    array: string[];\n    verify: number[];\n    wordsToVerify: number;\n  };\n  longClickTs = 0;\n  constructor(\n    private translate: TranslateService,\n    private walletService: WalletService,\n    private messageService: MessageService,\n    private exportService: ExportService,\n    private importService: ImportService,\n    private inputValidationService: InputValidationService,\n    private router: Router\n  ) {}\n\n  ngOnInit(): void {\n    this.generateSeed();\n  }\n  generateSeed(): void {\n    const mnemonic = this.walletService.createNewWallet();\n    this.MNEMONIC = {\n      string: mnemonic,\n      array: mnemonic.split(' '),\n      verify: [],\n      wordsToVerify: 5\n    };\n    // shuffle\n    const mnemonicLength = this.MNEMONIC.array.length;\n    while (this.MNEMONIC.verify.length < this.MNEMONIC.wordsToVerify) {\n      const index = Math.floor(Math.random() * Math.floor(mnemonicLength));\n      if (!this.MNEMONIC.verify.includes(index)) {\n        this.MNEMONIC.verify.push(index);\n      }\n    }\n    this.MNEMONIC.verify.sort((a, b) => a - b);\n    this.activePanel++;\n  }\n  checkWord(): void {\n    this.wordInput = this.wordInput.toLowerCase().trim();\n    if (this.wordInput === this.MNEMONIC.array[this.MNEMONIC.verify[0]]) {\n      this.MNEMONIC.verify.shift();\n      this.wordInput = '';\n    }\n    if (!this.MNEMONIC.verify) {\n      // Remove focus from input box\n      document.getElementById('wordInput').blur();\n    }\n  }\n  formatVerifyDescription(index: number): string {\n    if (this.MNEMONIC.verify.length === 0) {\n      return 'Seed backup has been verified!';\n    }\n    switch (index) {\n      case 1:\n      case 21:\n        return `${index}st word`;\n      case 2:\n      case 22:\n        return `${index}nd word`;\n      case 3:\n      case 23:\n        return `${index}rd word`;\n      default:\n        return `${index}th word`;\n    }\n  }\n  indexFormat(index: number): string {\n    if (this.MNEMONIC.verify.length === 0) {\n      return '';\n    } else if (index < 0 || index >= this.MNEMONIC.array.length) {\n      return '';\n    } else {\n      return 'Word ' + (index + 1);\n    }\n  }\n  valueFormat(index: number): string {\n    if (this.MNEMONIC.verify.length === 0) {\n      return '';\n    } else if (index < 0 || index > this.MNEMONIC.array.length) {\n      return '';\n    } else {\n      return this.MNEMONIC.array[index];\n    }\n  }\n  verifyView(): void {\n    if (this.MNEMONIC.verify.length) {\n      this.activePanel++;\n    } else {\n      throw new Error('Unexpected verify array');\n    }\n  }\n  pwdView(): void {\n    this.activePanel++;\n    this.userMnemonic = '';\n  }\n\n  mnemonicMatch(): boolean {\n    return this.MNEMONIC.string === this.userMnemonic;\n  }\n  async encryptWallet(): Promise<void> {\n    if (this.validPwd()) {\n      this.messageService.startSpinner('Encrypting wallet...');\n      const pwd = this.pwd1;\n      this.pwd1 = '';\n      this.pwd2 = '';\n      const ans = await this.walletService.createEncryptedWallet(this.MNEMONIC.string, pwd, '', true);\n      this.seed = ans.seed;\n      this.data = ans.data;\n      this.pkh = ans.pkh;\n      this.pk = ans.pk;\n      this.MNEMONIC.string = '';\n      this.MNEMONIC.array = [];\n      this.MNEMONIC.verify = [];\n      this.activePanel++;\n      this.messageService.stopSpinner();\n      if (document.body.offsetWidth >= 480) {\n        this.showTacos = true;\n      }\n    }\n  }\n  validPwd(): boolean {\n    if (!this.inputValidationService.password(this.pwd1)) {\n      this.messageService.addWarning(this.translate.instant('MNEMONICIMPORTCOMPONENT.PASSWORDWEAK'), 5);\n      return false;\n    } else if (this.pwd1 !== this.pwd2) {\n      this.messageService.addWarning(this.translate.instant('MNEMONICIMPORTCOMPONENT.NOMATCHPASSWORDS'), 5);\n      return false;\n    } else {\n      return true;\n    }\n  }\n  calcStrength(): void {\n    this.pwdStrength = this.inputValidationService.passwordStrengthDisplay(this.pwd1);\n  }\n  async done(): Promise<void> {\n    const seed = this.seed;\n    this.seed = null;\n    await this.importService.importWalletFromObject(this.data, seed);\n    this.walletService.storeWallet();\n    this.data = null;\n    this.messageService.addSuccess('Your new wallet is now set up and ready to use!');\n    this.router.navigate([`/account/`]);\n  }\n  export(): string {\n    return JSON.stringify(this.data);\n  }\n  getPkh(): string {\n    return this.pkh;\n  }\n  download(): void {\n    this.exportService.downloadWallet(this.data);\n    this.ekfDownloaded = true;\n  }\n  mouseOut(e): void {\n    e.stopPropagation();\n    this.hideBlur = false;\n    window.getSelection()?.removeAllRanges();\n  }\n  checkSelection(ev): void {\n    ev.stopPropagation();\n    if (this.isTextSelected()) {\n      this.isSelectedMnemonic = true;\n    }\n  }\n  private isTextSelected(): boolean {\n    let selection: Selection;\n    if (window.getSelection) {\n      selection = window.getSelection();\n    } else if (document.getSelection) {\n      selection = document.getSelection();\n    } else return false;\n    return !selection?.isCollapsed;\n  }\n}\n","<div class=\"flex-column card\">\n  <a routerLink=\"/\"><button class=\"flex-row back\"><img src=\"../../../../../assets/img/left-arrow.svg\">BACK</button></a>\n  <div *ngIf=\"activePanel === 0\" class=\"flex-column body\">\n    <h1>Import wallet</h1>\n    <div class=\"flex-row import-options\">\n      <span [class.selected]=\"importOption===0\" (click)=\"reset(); importOption = 0\">Keystore File</span>\n      <span [class.selected]=\"importOption===1\" (click)=\"reset(); importOption = 1\">Seed Words</span>\n      <span [class.selected]=\"importOption===2\" (click)=\"reset(); importOption = 2\">Fundraiser</span>\n    </div>\n    <ng-container *ngIf=\"importOption === 0\">\n      <form autocomplete=\"off\">\n        <p class=\"description\">\n          Import your wallet from an encrypted keystore file (<span style=\"text-transform: lowercase;\">.tez</span>)\n        </p>\n        <input #keyStore name=\"none\" type=\"file\" (change)=\"handleFileInput($event.target.files)\"\n          accept=\".tez{{ firefox ? ', application/json' : '' }}\" id=\"file\" name=\"file\">\n        <div class=\"flex-row button input-file-wrapper\">\n          <label for=\"file\" class=\"flex-row button input-file\" [class.loaded]=\"walletJson\"\n            (click)=\"keyStore?.nativeElement?.click();\">\n            <ng-container *ngIf=\"!walletJson\"><span class=\"b\">Browse</span><img\n                src=\"../../../../../assets/img/import-plus.png\" /></ng-container>\n            <ng-container *ngIf=\"walletJson\">\n              <div class=\"flex-row body\"><img src=\"../../../../../assets/img/lock.png\" />&nbsp;&nbsp;<span\n                  class=\"flex-row filename\">{{\n                  fileName\n                  }}</span>\n              </div>\n              <span class=\"b\">Browse</span>\n            </ng-container>\n          </label>\n        </div>\n        <input *ngIf=\"walletJson\" name=\"none\" type=\"password\" class=\"text\" autocomplete=\"current-password\"\n          (keydown.enter)='!messageService.spinnerOn ? checkImportPwd() : null' id=\"pwd\" [(ngModel)]=\"pwd\" placeholder=\"Password\">\n        <button class=\"button next\" [style.visibility]=\"!walletJson ? 'hidden' : ''\"\n          (click)='!messageService.spinnerOn ? checkImportPwd() : null'>Import</button>\n      </form>\n    </ng-container>\n    <ng-container *ngIf=\"importOption > 0\">\n      <form autocomplete=\"off\">\n        <p class=\"description faucet\" *ngIf=\"importOption === 2\"><span>Please make sure to first <a\n              routerLink=\"/activate\">activate</a> your fundraiser wallet.</span></p>\n        <span class=\"description label\">RECOVERY (SEED) WORDS <span style=\"color: #98a0ab\">12-24 WORDS</span></span>\n        <textarea name=\"none\" class=\"text seed-word\" [(ngModel)]=\"mnemonic\" autocomplete=\"off\"\n          [placeholder]=\"'Seed Words (required)'\"></textarea>\n      </form>\n      <ng-container *ngIf=\"importOption === 1\">\n        <app-ui-toggle-advanced style=\"width: 13rem;\" [default]=\"false\" (stateChange)=\"advancedForm = $event\">\n        </app-ui-toggle-advanced>\n        <br /><br />\n        <form autocomplete=\"off\" *ngIf=\"advancedForm\" class=\"flex-row-wrap import-option-1\">\n          <div class=\"flex-column\">\n            <span class=\"label\"><b>If your seed words are protected by a passphrase, it needs to be entered\n                here</b></span>\n            <input name=\"none\" class=\"text\" type=\"password\" name=\"passphrase\" autocomplete=\"one-time-code\"\n              [(ngModel)]=\"passphrase\" [placeholder]=\"'Passphrase (optional)'\" readonly=\"true\"\n              (click)=\"clickPassword($event)\" (blur)=\"blurPassword($event)\">\n          </div>\n          <div class=\"flex-column\">\n            <span class=\"label\"><b>Provide the public key hash<br /> to verify your passphrase is correct</b></span>\n            <input name=\"none\" type=\"text\" class=\"text\" [(ngModel)]=\"pkh\" [placeholder]=\"'tz1... (recommended)'\">\n          </div>\n          <div class=\"flex-row radios\" *ngIf=\"importOption === 1\">\n            <div class=\"flex-row\">\n              <input name=\"none\" (change)=\"hdImport = !hdImport\" type=\"radio\" name=\"walletType\" value=\"hd\" checked>\n              <span>HD wallet</span>\n            </div>\n            <div class=\"flex-row\">\n              <input name=\"none\" (change)=\"hdImport = !hdImport\" type=\"radio\" name=\"walletType\" value=\"legacy\">\n              <span>Legacy wallet</span>\n            </div>\n          </div>\n        </form>\n      </ng-container>\n      <ng-container *ngIf=\"importOption === 2\">\n        <form autocomplete=\"off\">\n          <span class=\"label\">The email used during the fundraiser</span>\n          <input name=\"none\" class=\"text\" type=\"text\" [(ngModel)]=\"email\" [placeholder]=\"'Email (required)'\">\n          <span class=\"label\">The password you chose during the fundraiser</span>\n          <input name=\"none\" class=\"text\" type=\"password\" name=\"tge-password\" autocomplete=\"one-time-code\"\n            [(ngModel)]=\"password\" [placeholder]=\"'Password (required)'\" readonly=\"true\" (click)=\"clickPassword($event)\"\n            (blur)=\"blurPassword($event)\">\n          <span class=\"label\">Provide the public key hash to verify your email and password are correct</span>\n          <input name=\"none\" type=\"text\" class=\"text\" [(ngModel)]=\"pkh\" [placeholder]=\"'tz1... (recomended)'\">\n        </form>\n      </ng-container>\n      <button class=\"button next\" (click)=\"retrieve()\">Import</button>\n    </ng-container>\n  </div>\n  <div *ngIf=\"activePanel==1\" class=\"flex-column body\">\n    <form autocomplete=\"off\">\n      <h1>Set a password</h1>\n      <p class=\"description bold blue\">This password will be used to create an encrypted keystore file.</p>\n      <p class=\"description\">When performing operations that need to be signed with your\n        secret key, this password will be required</p>\n      <input name=\"none\" type=\"password\" placeholder=\"{{ 'NEWWALLETCOMPONENT.PASSWORD' | translate }}\" class=\"text\"\n        autocomplete=\"new-password\" [(ngModel)]=\"pwd1\" (keyup)=\"calcStrength()\">\n      <small class=\"strength\"> {{ 'NEWWALLETCOMPONENT.PASSWORDSTRENGTH' | translate }}  <b\n          [style.color]=\"pwdStrength === 'Catastrophic!' ? 'darkred' : pwdStrength === 'Very weak!' ? 'red' : pwdStrength === 'Weak!' ? 'orange' : pwdStrength === 'Strong!' ? 'green' : 'red'\">{{\n          pwdStrength }}</b></small>\n      <input name=\"none\" type=\"password\" placeholder=\"{{ 'NEWWALLETCOMPONENT.CONFIRMPASSWORD' | translate }}\"\n        class=\"text\" autocomplete=\"new-password\" [(ngModel)]=\"pwd2\">\n      <button class=\"button next\" [style.visibility]=\"!pwd1 ? 'hidden' : ''\" (click)=\"setPwd()\">Next</button>\n    </form>\n  </div>\n  <div *ngIf=\"activePanel==2\" class=\"flex-column body\">\n    <h1>Wallet created!</h1>\n    <p class=\"description bold\">Your wallet is now set up and ready to be used.</p>\n    <p class=\"description\">Download your encrypted keystore file and import it when you want to access your wallet.\n    </p>\n    <div class=\"whitebox final\">\n      <p class=\"description bold pkh\">Your public account address:<br />{{ showPkh() }}</p>\n    </div>\n    <button class=\"button next\" (click)=\"download()\">Download</button>\n    <button class=\"button next\" [style.visibility]=\"!Downloaded ? 'hidden' : ''\" (click)=\"done()\">Open Wallet</button>\n  </div>\n</div>","import { Component, OnInit, HostBinding, Input, OnDestroy, AfterViewInit } from '@angular/core';\nimport { NavigationEnd, Router } from '@angular/router';\nimport { TranslateService } from '@ngx-translate/core'; // Multiple instances created ?\nimport { ImportService } from '../../../../../services/import/import.service';\nimport { MessageService } from '../../../../../services/message/message.service';\nimport { WalletService } from '../../../../../services/wallet/wallet.service';\nimport { ExportService } from '../../../../../services/export/export.service';\nimport { InputValidationService } from '../../../../../services/input-validation/input-validation.service';\nimport { utils, hd } from '@tezos-core-tools/crypto-utils';\nimport { filter } from 'rxjs/operators';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'app-mnemonic-import-wallet',\n  templateUrl: './mnemonic-import.component.html',\n  styleUrls: ['../../../../../../scss/components/views/start/login.component.scss']\n})\nexport class MnemonicImportComponent implements OnInit, AfterViewInit, OnDestroy {\n  @HostBinding('class.tacos') showTacos = false;\n  @Input('keyStore') keyStore;\n  MIN_PWD_LENGTH = 9;\n  mnemonic: string;\n  email: string;\n  password: string;\n  passphrase: string;\n  pkh: string;\n  importOption = 0;\n  activePanel = 0;\n  hdImport = true;\n  wallet: any;\n  walletJson: string;\n  pwd = '';\n  pwd1: string;\n  pwd2: string;\n  pwdStrength = '';\n  Downloaded = false;\n  fileName = '';\n  showWrongFileUploadMsg: false;\n  browser = 'unknown';\n  advancedForm = false;\n\n  private subscriptions: Subscription = new Subscription();\n\n  constructor(\n    private translate: TranslateService,\n    private importService: ImportService,\n    private router: Router,\n    private messageService: MessageService,\n    private walletService: WalletService,\n    private exportService: ExportService,\n    private inputValidationService: InputValidationService\n  ) {\n    this.subscriptions.add(\n      this.router.events.pipe(filter((e) => e instanceof NavigationEnd && e.url.startsWith('/import'))).subscribe(() => {\n        const navigation = this.router.getCurrentNavigation();\n        this.importOption = navigation.extras?.state?.option ? navigation.extras.state.option : 0;\n      })\n    );\n  }\n\n  ngOnInit(): void {}\n\n  ngAfterViewInit(): void {\n    document.documentElement.addEventListener('dragover', this.allowDrop.bind(this));\n    document.documentElement.addEventListener('drop', this.handleFileDragAndDrop.bind(this));\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n\n  clickPassword(e): void {\n    e.target.removeAttribute('readonly');\n    e.target.focus();\n  }\n\n  blurPassword(e): void {\n    e.target.setAttribute('readonly', true);\n  }\n\n  retrieve(): void {\n    if (this.mnemonic) {\n      this.mnemonic = this.mnemonic\n        .toLowerCase()\n        .replace(/(\\r\\n|\\n|\\r)/gm, ' ')\n        .trim();\n    }\n    if (this.importOption === 2) {\n      this.passphrase = this.email + this.password;\n    }\n    if (!this.inputValidationService.mnemonics(this.mnemonic)) {\n      this.subscriptions.add(this.translate.get('MNEMONICIMPORTCOMPONENT.INVALIDMNEMONIC').subscribe((res: string) => this.messageService.addWarning(res, 10)));\n    } else if (this.importOption === 2 && !this.inputValidationService.email(this.email)) {\n      this.subscriptions.add(\n        this.translate.get('MNEMONICIMPORTCOMPONENT.INVALIDEMAIL').subscribe(\n          (res: string) => this.messageService.addWarning(res, 10) // 'Invalid email!'\n        )\n      );\n    } else if (this.importOption === 2 && !this.password) {\n      this.subscriptions.add(\n        this.translate.get('MNEMONICIMPORTCOMPONENT.INVALIDPASSWORD').subscribe(\n          (res: string) => this.messageService.addWarning(res, 10) // 'Invalid password!'\n        )\n      );\n    } else if (!this.inputValidationService.passphrase(this.passphrase)) {\n      this.subscriptions.add(\n        this.translate.get('MNEMONICIMPORTCOMPONENT.INVALIDPASSPHRASE').subscribe(\n          (res: string) => this.messageService.addWarning(res, 10) // 'Invalid passphrase!'\n        )\n      );\n    } else if (this.pkh && !this.inputValidationService.address(this.pkh)) {\n      this.subscriptions.add(\n        this.translate.get('MNEMONICIMPORTCOMPONENT.INVALIDPKH').subscribe(\n          (res: string) => this.messageService.addWarning(res, 10) // 'Invalid public key hash!'\n        )\n      );\n    } else {\n      let pkh = '';\n      if (this.pkh) {\n        if (this.importOption === 1 && this.hdImport) {\n          pkh = hd.keyPairFromAccountIndex(utils.mnemonicToSeed(this.mnemonic, this.passphrase, true), 0).pkh;\n        } else {\n          pkh = utils.seedToKeyPair(utils.mnemonicToSeed(this.mnemonic, this.passphrase, false)).pkh;\n        }\n      }\n      if (this.pkh && pkh !== this.pkh) {\n        if (this.importOption === 2) {\n          this.subscriptions.add(\n            this.translate.get('MNEMONICIMPORTCOMPONENT.INVALIDEMAILPASSWORD').subscribe((res: string) => this.messageService.addWarning(res, 5))\n          );\n        } else {\n          this.subscriptions.add(\n            this.translate.get('MNEMONICIMPORTCOMPONENT.INVALIDPASSPHRASE').subscribe((res: string) => this.messageService.addWarning(res, 5))\n          );\n        }\n      } else {\n        this.activePanel++;\n      }\n    }\n  }\n  async setPwd(): Promise<void> {\n    if (this.validPwd()) {\n      const password = this.pwd1;\n      this.pwd1 = '';\n      this.pwd2 = '';\n      await this.messageService.startSpinner('Encrypting wallet...');\n      try {\n        this.wallet = await this.walletService.createEncryptedWallet(this.mnemonic, password, this.passphrase, this.importOption === 1 && this.hdImport);\n      } finally {\n        this.messageService.stopSpinner();\n      }\n      this.mnemonic = '';\n      this.passphrase = '';\n      this.email = '';\n      this.password = '';\n      this.activePanel++;\n    }\n  }\n\n  validPwd(): boolean {\n    if (!this.inputValidationService.password(this.pwd1)) {\n      this.subscriptions.add(\n        this.translate.get('MNEMONICIMPORTCOMPONENT.PASSWORDWEAK').subscribe(\n          (res: string) => this.messageService.addWarning(res, 10) // 'Password is too weak!'\n        )\n      );\n      return false;\n    } else if (this.pwd1 !== this.pwd2) {\n      this.subscriptions.add(\n        this.translate.get('MNEMONICIMPORTCOMPONENT.NOMATCHPASSWORDS').subscribe(\n          (res: string) => this.messageService.addWarning(res, 10) // Passwords don't match!\n        )\n      );\n      return false;\n    } else {\n      return true;\n    }\n  }\n  calcStrength(): void {\n    this.pwdStrength = this.inputValidationService.passwordStrengthDisplay(this.pwd1);\n  }\n  export(): string {\n    return JSON.stringify(this.wallet.data);\n  }\n  showPkh(): string {\n    return this.wallet.pkh;\n  }\n  download(): void {\n    this.exportService.downloadWallet(this.wallet.data);\n    this.Downloaded = true;\n  }\n  async done(): Promise<void> {\n    await this.messageService.startSpinner('Loading wallet...');\n    try {\n      await this.importService.importWalletFromObject(this.wallet.data, this.wallet.seed);\n    } finally {\n      this.messageService.stopSpinner();\n    }\n    this.wallet = null;\n    this.router.navigate([`/account/`]);\n    this.subscriptions.add(this.translate.get('MNEMONICIMPORTCOMPONENT.WALLETREADY').subscribe((res: string) => this.messageService.addSuccess(res)));\n  }\n  /* Keystore handling */\n  importPreCheck(keyFile: string): void {\n    this.typeCheckFile(keyFile);\n    if (this.importService.pwdRequired(keyFile)) {\n      this.walletJson = keyFile;\n    } else {\n      throw new Error('Unsupported wallet file');\n    }\n  }\n  typeCheckFile(keyFile: string): void {\n    const obj = JSON.parse(keyFile);\n    // Required\n    try {\n      if (typeof obj.provider !== 'string') {\n        throw new Error('provider not a string!');\n      }\n      if (typeof obj.version !== 'number') {\n        throw new Error('version not a number!');\n      }\n      if (typeof obj.walletType !== 'number') {\n        throw new Error('walletType not a number!');\n      }\n      // Optional\n      if (obj.encryptedSeed && typeof obj.encryptedSeed !== 'string') {\n        throw new Error('encryptedSeed not a string!');\n      }\n      if (obj.pkh && typeof obj.pkh !== 'string') {\n        throw new Error('pkh not a string!');\n      }\n      if (obj.iv && typeof obj.iv !== 'string') {\n        throw new Error('iv not a string!');\n      }\n      if (obj.pk && typeof obj.pk !== 'string') {\n        throw new Error('pk not a string!');\n      }\n      if (obj.encryptedEntropy && typeof obj.encryptedEntropy !== 'string') {\n        throw new Error('encryptedEntropy not a string!');\n      }\n    } catch (e) {\n      this.messageService.addError(e);\n      throw e;\n    }\n  }\n  async checkImportPwd(): Promise<void> {\n    if (!this.walletJson) {\n      this.messageService.addWarning('No keystore file imported', 5);\n    } else if (this.pwd) {\n      await this.messageService.startSpinner('Importing wallet...');\n      try {\n        await this.import(this.walletJson, this.pwd);\n        this.pwd = '';\n      } finally {\n        this.messageService.stopSpinner();\n      }\n    } else {\n      this.messageService.addWarning('No password provided', 5);\n    }\n  }\n  async import(keyFile: string, pwd: string): Promise<void> {\n    this.typeCheckFile(keyFile);\n    await this.importService\n      .importWalletFromJson(keyFile, pwd)\n      .then((success: boolean) => {\n        if (success) {\n          this.router.navigate(['/account/']);\n        } else {\n          console.log(success);\n          this.messageService.addError('Something went wrong');\n        }\n      })\n      .catch((e) => {\n        this.messageService.addError(e);\n        this.walletService.clearWallet();\n        this.messageService.stopSpinner();\n      });\n  }\n  allowDrop(e): void {\n    e.stopPropagation();\n    e.preventDefault();\n  }\n  handleFileDragAndDrop(e): void {\n    e.preventDefault();\n    this.handleFileInput(e.dataTransfer.files);\n  }\n  handleFileInput(files: FileList): boolean {\n    let fileToUpload = files.item(0);\n    if (!fileToUpload) {\n      return false;\n    } else if (!this.validateFile(fileToUpload.name)) {\n      let fileNotSupported = '';\n      this.subscriptions.add(this.translate.get('IMPORTCOMPONENT.FILENOTSUPPORTED').subscribe((res: string) => (fileNotSupported = res)));\n      this.messageService.add(fileNotSupported);\n\n      console.log('Selected file format is not supported');\n      fileToUpload = null;\n      this.walletJson = null;\n      return false;\n    } else {\n      const reader = new FileReader();\n      reader.readAsText(fileToUpload);\n      reader.onload = () => {\n        if (typeof reader.result === 'string') {\n          try {\n            this.importPreCheck(reader.result);\n          } catch (e) {\n            this.messageService.addError(e, 5);\n            this.walletJson = null;\n          }\n          if (this.walletJson) {\n            this.fileName = fileToUpload.name;\n          }\n        } else {\n          this.walletJson = null;\n          throw new Error('Not a string import');\n        }\n      };\n    }\n  }\n  validateFile(name: string): boolean {\n    const ext = name.substring(name.lastIndexOf('.') + 1);\n    if (ext.toLowerCase() === 'tez' || ext.toLowerCase() === 'json') {\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  reset(): void {\n    this.advancedForm = false;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport 'babel-polyfill';\nimport TransportU2F from '@ledgerhq/hw-transport-u2f';\nimport TransportWebHID from '@ledgerhq/hw-transport-webhid';\nimport Tezos from '@obsidiansystems/hw-app-xtz';\nimport { OperationService } from '../operation/operation.service';\nimport { MessageService } from '../message/message.service';\n\n@Injectable()\nexport class LedgerService {\n  transport: any;\n  constructor(private operationService: OperationService, private messageService: MessageService) {}\n  async setTransport() {\n    if (!this.transport) {\n      console.log('Trying to use WebHID for transport...');\n      try {\n        this.transport = await TransportWebHID.create();\n        console.log('Transport is now set to use WebHID!');\n      } catch (e) {\n        this.transport = null;\n        console.warn(\"Couldn't set WebHID as transport!\");\n        console.error(e);\n      }\n    }\n    if (!this.transport) {\n      try {\n        this.transport = await TransportU2F.create();\n        console.warn('Transport is now set to use U2F!');\n      } catch (e) {\n        this.transport = null;\n        console.log(\"Couldn't set U2F as transport!\");\n        console.error(e);\n      }\n    }\n  }\n  async transportCheck() {\n    if (!this.transport) {\n      await this.setTransport();\n    }\n    if (!this.transport) {\n      this.messageService.addError('Failed to set transport. Please make sure your browser supports WebHID or U2F');\n      throw new Error('NO_TRANSPORT_FOUND');\n    }\n  }\n  async getPublicAddress(path: string) {\n    await this.transportCheck();\n    const xtz = new Tezos(this.transport);\n    const result = await xtz\n      .getAddress(path, true)\n      .then((res) => {\n        return this.sanitize(res, true);\n      })\n      .catch((e) => {\n        if (e.message) {\n          this.messageService.addError(e.message);\n        } else {\n          this.messageService.addError(e);\n        }\n        throw e;\n      });\n    const pk = this.operationService.hex2pk(result.publicKey);\n    return pk;\n  }\n  async signOperation(op: string, path: string) {\n    if (!['03', '05'].includes(op.slice(0, 2))) {\n      throw new Error('Invalid prefix');\n    }\n    await this.transportCheck();\n    const xtz = new Tezos(this.transport);\n    console.log('op', op);\n    const result = await xtz\n      .signOperation(path, op)\n      .then((res) => {\n        return this.sanitize(res, false);\n      })\n      .catch((e) => {\n        console.warn(e);\n        this.messageService.addError(e, 0);\n        return null;\n      });\n    console.log(JSON.stringify(result));\n    if (result?.signature) {\n      return result.signature;\n    } else {\n      return null;\n    }\n  }\n  async signHash(hash: string, path: string) {\n    if (hash.length !== 64) {\n      throw new Error('Invalid hash!');\n    }\n    await this.transportCheck();\n    const xtz = new Tezos(this.transport);\n    const result = await xtz\n      .signHash(path, hash)\n      .then((res) => {\n        return this.sanitize(res, false);\n      })\n      .catch((e) => {\n        console.warn(e);\n        this.messageService.addError(e, 0);\n        return null;\n      });\n    console.log(JSON.stringify(result));\n    if (result?.signature) {\n      return result.signature;\n    } else {\n      return null;\n    }\n  }\n  private sanitize(res: any, getPk: boolean) {\n    res = JSON.parse(JSON.stringify(res));\n    if (getPk && typeof res?.publicKey !== 'string') {\n      throw Error('Invalid pk');\n    }\n    if (!getPk && typeof res?.signature !== 'string') {\n      throw Error('Invalid signature');\n    }\n    return res;\n  }\n}\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { LedgerService } from '../../../../../services/ledger/ledger.service';\nimport { ImportService } from '../../../../../services/import/import.service';\nimport { MessageService } from '../../../../../services/message/message.service';\nimport { InputValidationService } from '../../../../../services/input-validation/input-validation.service';\nimport { utils } from '@tezos-core-tools/crypto-utils';\n\n@Component({\n  selector: 'app-connect-ledger',\n  templateUrl: './connect-ledger.component.html',\n  styleUrls: ['../../../../../../scss/components/views/start/login.component.scss']\n})\nexport class ConnectLedgerComponent implements OnInit {\n  activePanel = 0;\n  defaultPath = \"44'/1729'/0'/0'\";\n  defaultText = 'Default derivation path';\n  path: string;\n  pendingLedgerConfirmation = false;\n  isHDDerivationPathCustom = false;\n  browser = 'unknown';\n\n  constructor(\n    private router: Router,\n    private ledgerService: LedgerService,\n    private importService: ImportService,\n    private messageService: MessageService,\n    private inputValidationService: InputValidationService\n  ) {}\n\n  ngOnInit(): void {\n    this.path = this.defaultText;\n    this.checkBrowser();\n  }\n  checkBrowser(): void {\n    try {\n      if (navigator.userAgent.toLowerCase().indexOf('firefox') > -1) {\n        this.browser = 'firefox';\n      } else if ((navigator as any)?.userAgentData?.brands?.some((b) => b.brand === 'Google Chrome' || 'Chromium')) {\n        this.browser = 'chromium';\n      } else if ((navigator as any)?.userAgent.toLowerCase().indexOf('safari') > -1 && navigator.platform.indexOf('Mac') === -1) {\n        this.browser = 'safari';\n      }\n    } catch (e) {\n      console.warn(e);\n    }\n  }\n  async getPk(): Promise<void> {\n    const path: string = this.path.replace(this.defaultText, this.defaultPath);\n    if (this.inputValidationService.derivationPath(path)) {\n      this.pendingLedgerConfirmation = true;\n      try {\n        this.messageService.startSpinner('Waiting for Ledger confirmation...');\n        const pk = await this.ledgerService.getPublicAddress(path);\n        console.log('getPK => ' + pk);\n        await this.importFromPk(pk, path);\n      } catch (e) {\n        throw e;\n      } finally {\n        this.pendingLedgerConfirmation = false;\n        this.messageService.stopSpinner();\n      }\n    } else {\n      this.messageService.addWarning('Invalid derivation path');\n    }\n  }\n  async importFromPk(pk: string, path: string): Promise<void> {\n    if (utils.validPublicKey(pk)) {\n      if (await this.importService.importWalletFromPk(pk, path)) {\n        this.router.navigate([`/account/`]);\n      } else {\n        this.messageService.addError('Failed to import Ledger wallet');\n      }\n    } else {\n      this.messageService.addError('Not a valid public key');\n    }\n  }\n  setDefaultPath(v): void {\n    if (this.isHDDerivationPathCustom) {\n      this.path = this.defaultText;\n    } else {\n      this.path = this.defaultPath;\n    }\n    this.isHDDerivationPathCustom = v;\n  }\n}\n","<form autocomplete=\"off\">\n  <div class=\"flex-column card\">\n    <a routerLink=\"/\"><button class=\"flex-row back\"><img\n          src=\"../../../../../assets/img/left-arrow.svg\">BACK</button></a>\n    <div class=\"flex-column body\">\n      <h1>Connect your Ledger</h1>\n      <p class=\"description\">Keep the private keys safely on your Ledger device and use Kukai to access the Tezos\n        blockchain.</p>\n      <p class=\"description\">You need to open the Tezos Wallet app on your Ledger device and set the derivation path.\n      </p>\n      <input name=\"none\" type=\"text\" class=\"text\" [disabled]=\"!isHDDerivationPathCustom\" [(ngModel)]=\"path\"\n        value=\"'44\\'/1729\\'/0\\'/0\\''\">\n      <app-ui-toggle-advanced style=\"width: 24rem;\" [default]=\"false\" [text]=\"'Use custom HD derivation path:'\"\n        (stateChange)=\"setDefaultPath($event)\"></app-ui-toggle-advanced>\n      <br /><br /><br />\n      <button class=\"button next\" (click)=\"getPk()\" [disabled]=\"browser === 'safari'\">{{ browser !== 'safari' ?\n        'Connect' : 'Ledger support with Safari is currently unavailable' }}</button>\n    </div>\n  </div>\n</form>","import { Component } from '@angular/core';\n\n@Component({\n  templateUrl: '404.component.html',\n  styleUrls: ['../../../../scss/components/views/error/error.scss']\n})\nexport class P404Component {\n  constructor() {}\n}\n","<div id=\"error\" class=\"flex-column\">\n  <h1>404</h1>\n  <h4>Oops! You're lost.</h4>\n  <p>The page you are looking for was not found.</p>\n</div>","import { Component } from '@angular/core';\n\n@Component({\n  templateUrl: '500.component.html',\n  styleUrls: ['../../../../scss/components/views/error/error.scss']\n})\nexport class P500Component {\n  constructor() {}\n}\n","<div id=\"error\" class=\"flex-column\">\n  <h1>500</h1>\n  <h4>Houston, we have a problem!</h4>\n  <p>The page you are looking for is temporarily unavailable.</p>\n</div>","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-privacy-policy',\n  templateUrl: './privacy-policy.component.html',\n  styleUrls: ['../../../../../../scss/components/views/start/agreement/terms-of-use/terms-of-use.component.scss']\n})\nexport class PrivacyPolicyComponent implements OnInit {\n  constructor() {}\n\n  ngOnInit(): void {}\n  getHostName(): string {\n    return location.hostname;\n  }\n}\n","<div class=\"legal\">\n  <H1>Privacy Policy</H1>\n  <H5>Introduction</H5>\n  <p>Kukai Digital Wallet (hereinafter Kukai, collectively encompassing {{getHostName()}}) is committed to ensuring the\n    privacy of all our users. We take our duty to process your personal data very seriously. This policy represents our\n    commitment to your right to privacy, giving you a clear explanation about how we use your information and your\n    rights over that information.</p>\n\n  <p>Its possible to use {{getHostName()}} (hereinafter website) without submitting any personal information.</p>\n\n  <H5>Scope of Privacy Policy</H5>\n  <p>This privacy policy applies only to your use of our Tezos digital wallet, Kukai. Our website may contain links to\n    other websites, which are not hosted by Kukai. Please note that we have no control over how your data is collected,\n    stored, or used by other websites and we advise you to check the privacy policies of any such websites before\n    providing any data to them.</p>\n\n  <H5>What types of information do we collect and how?</H5>\n  <p>Kukai does not keep, process, or store any user data, however some services that Kukai relies on may store some\n    user data. Kukai uses Cloudflare services, which collects anonymized website traffic data.</p>\n\n  <p>Data protection laws require us to have a legal justification to process your personal information. Please note,\n    that to use Kukai digital wallet, no personal information is needed to use or access our website or to use our\n    digital wallet. Once again, Kukai does not store user data on any servers.</p>\n\n  <p>Please note, our website and forum may contain links to other websites which are not hosted by Kukai. Please note\n    that we have no control over how your data is collected, stored, or used by other websites and we advise you to\n    check the privacy policies of any such websites before providing any data to them.</p>\n\n  <H5>Legal obligation</H5>\n  <p>As Kukai does not keep, maintain, or process any personal information, Kukai will attempt to fulfill any legal\n    obligations placed upon us, through a lawfully valid legal order by a court of competent jurisdiction.</p>\n\n  <H5>Jurisdiction</H5>\n  <p>Our website is under Swedish jurisdiction and is subject to Swedish laws (which would negate the above retention\n    rules), and similar. Furthermore, our service providers could also be subject to similar orders without our\n    knowledge.</p>\n\n  <p>We take appropriate security measures to ensure that your digital wallet is secured, accurate and up to date.\n    However the transmission of information over the Internet is never completely secure, so while we do our best to\n    protect any information, however, we cannot guarantee the security of information transmitted to our website.</p>\n\n  <H5>Retention Period For Data</H5>\n  <p>We do not hold, store, maintain, or use any personal information as no personal information is needed to use our\n    digital wallet.</p>\n\n  <H5>Access to and your rights over your personal information and removal of User data:</H5>\n  <p>We do not hold, store, use, or maintain any personal user information. For a User to delete any data from the use\n    of our digital wallet please follow the following instructions: </p>\n\n  <p>Log out from the app to remove all user data from the browser cache.</p>\n\n  <p>For more information please see: <a href=\"https://www.tezos.help/kukai-data-removal/index.html\">https://www.tezos.help/kukai-data-removal/index.html</a></p>\n\n  <H5>Complaints</H5>\n  <p>If you wish to lodge a complaint about our handling of your personal data please get in touch with us on the\n    details above with the details of your complaint at contact@kukai.app. We aim to respond to all complaints within 14\n    working days. All legal requests will be reviewed by our legal department and appropriate action will be taken. If\n    you have a legal request, please contact us at: legal@kukai.app.</p>\n\n</div>","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-terms-of-use',\n  templateUrl: './terms-of-use.component.html',\n  styleUrls: ['../../../../../../scss/components/views/start/agreement/terms-of-use/terms-of-use.component.scss']\n})\nexport class TermsOfUseComponent implements OnInit {\n  constructor() {}\n\n  ngOnInit(): void {}\n}\n","<div class=\"legal\">\n  <H1>TERMS OF USE</H1>\n  <p><i>Last Updated: June 30, 2020</i></p>\n  <p class=\"notice\">IMPORTANT NOTICE: THIS AGREEMENT IS SUBJECT TO BINDING ARBITRATION AND A WAIVER OF CLASS ACTION RIGHTS AS DETAILED\n    IN SECTION 13. PLEASE READ THE AGREEMENT CAREFULLY.</p>\n\n  <H4>1. Acceptance of terms</H4>\n  <p>Kukai Wallet (hereinafter Kukai, we, us, or our) provides a platform for managing Tezos accounts, and\n    allowing ordinary websites and applications to interact with the blockchain network, while keeping the user in\n    control over what transactions they approve, through our website located at https://kukai.app/ (the Site), which\n    includes text, images, audio, code and other materials (collectively, the Content) and all of the features, and\n    services provided. The Site and any other features, tools, materials, or other services offered from time to time by\n    Kukai Wallet are referred to here as the Services. Please read these Terms of Use (the Terms) carefully before\n    using the Services. By using or otherwise accessing the Services, or clicking to accept or agree to these Terms\n    where that option is made available, you (1) accept and agree to these Terms, (2) consent to the collection, use,\n    disclosure and other handling of information as described in our Privacy Policy and (3) agree to any additional\n    terms, rules and conditions of participation issued by Kukai Wallet from time to time. If you do not agree to any of\n    the Terms, then you may not access or use the Content or Services.</p>\n\n  <H4>2. Modification of Terms of Use</H4>\n  <p>Except for Section 13, providing for arbitration and waiver of class action rights, Kukai Wallet reserves the\n    right, at its sole discretion, to modify or replace the Terms at any time without notice. We will always try to\n    provide advance notice, however, we reserve the right to modify or replace the Terms at our discretion. The most\n    current version of these Terms will be posted on our Site. You shall be responsible for reviewing and becoming\n    familiar with any such modifications. Use of the Services by you after any modification to the Terms constitutes\n    your acceptance of the Terms as modified.</p>\n\n  <H4>3. Eligibility</H4>\n  <p>You hereby represent and warrant that you are fully able and competent to enter into the terms, conditions,\n    obligations, affirmations, representations and warranties set forth in these Terms and to abide by and comply with\n    these Terms.</p>\n\n  <p>Kukai Wallet is a global platform and by accessing the Content or Services, you are representing and warranting\n    that you are of the legal age of majority in your jurisdiction as is required to access such Services and Content\n    and enter into arrangements as provided by the Services. You further represent that you are otherwise legally\n    permitted to use the service in your jurisdiction including owning cryptographic tokens of value, and interacting\n    with the Services or Content in any way. You further represent you are responsible for ensuring compliance with the\n    laws of your jurisdiction and acknowledge that Kukai Wallet is not liable for your compliance with such laws.</p>\n\n  <p>In addition, you represent to us that you and your financial institutions, or any party that owns or controls you\n    or your financial institutions, are (1) not subject to sanctions or otherwise designated on any list of prohibited\n    or restricted parties, including but not limited to the lists maintained by the United Nations Security Council, the\n    U.S. Government (e.g., the Specially Designated Nationals List and Foreign Sanctions Evaders List of the U.S.\n    Department of Treasury and the Entity List of the U.S. Department of Commerce), the European Union or its Member\n    States, or other applicable government authority and (2) not located in any country to which the United States has\n    embargoed goods or has otherwise applied any sanctions.</p>\n\n  <H4>4. Account Password and Security</H4>\n  <p>When setting up an account within Kukai Wallet, you will be responsible for keeping your own account secrets, which\n    may be a word seed phrase, an account file, or other locally stored secret information. Kukai Wallet encrypts this\n    information locally with a password you provide, that we never send to our servers. You agree to (a) never use the\n    same password for Kukai Wallet that you have ever used outside of this service, (b) keep your secret information and\n    password confidential and do not share them with anyone else and (c) immediately notify Kukai Wallet of any\n    unauthorized use of your account or breach of security. Kukai Wallet cannot and will not be liable for any loss or\n    damage arising from your failure to comply with this section.\n\n  <H4>5. DISCLAIMERS- RISKS</H4>\n\n  <H5>5.1. Warranty Disclaimer</H5>\n  <p>You expressly understand and agree that your use of the Services is at your sole risk. The Services (including the\n    Site and the Content) are provided on an as is and as available basis, without warranties of any kind, either\n    express or implied, including, without limitation, implied warranties of merchantability, fitness for a particular\n    purpose or non-infringement. You acknowledge that Kukai Wallet has no control over, and no duty to take any action\n    regarding: which users gain access to or use the Services; what effects the Content may have on you; how you may\n    interpret or use the Content; or what actions you may take as a result of having been exposed to the Content. You\n    release Kukai Wallet from any and all liability for you having acquired or not acquired Content through the\n    Services. Kukai Wallet makes no representations concerning any Content contained in or accessed through the\n    Services, and Kukai Wallet will not be responsible or liable for the accuracy, copyright compliance, legality or\n    decency of material contained in or accessed through the Services.</p>\n\n  <p>We do not represent or warrant that access to the Services will be continuous, uninterrupted, timely or secure. You\n    acknowledge and accept that the Services (a) may contain bugs, errors and defects, (b) may function improperly or be\n    subject to periods of downtime and unavailability, (c) may result in total or partial loss or corruption of data and\n    (d) may be modified at any time, including through the release of subsequent versions, all with or without notice to\n    you.</p>\n\n  <p>You acknowledge that Kukai Wallet is not responsible for transferring, safeguarding, or maintaining your private\n    keys or any digital currency associated therewith. If you lose, mishandle or have stolen associated digital currency\n    private keys, you acknowledge that you may not be able to recover associated digital currency, and that Kukai Wallet\n    is not responsible for such loss. You acknowledge that Kukai Wallet is not responsible for any loss, damage or\n    liability arising from your failure to comply with the terms hereunder.</p>\n\n  <H5>5.2 Sophistication and Risk of Cryptographic Systems</H5>\n  <p>By utilizing the Services or interacting with the Content or platform in any way, you represent that you understand\n    the inherent risks associated with cryptographic systems; and warrant that you have an understanding of the usage\n    and intricacies of the native cryptographic token Tezos (xtz), smart contract based tokens, and blockchain-based\n    software systems.</p>\n\n  <H5>5.3 Risk of Regulatory Actions in One or More Jurisdictions</H5>\n  <p>Kukai Wallet and any supported cryptographic token and blockchain could be impacted by one or more regulatory\n    inquiries or regulatory action, which could impede or limit the ability of Kukai Wallet to continue to develop, or\n    which could impede or limit your ability to access or use the Services or the underlying blockchain network.</p>\n\n  <H5>5.4 Risk of Weaknesses or Exploits in the Field of Cryptography</H5>\n  <p>You acknowledge and understand that Cryptography is a progressing field. Advances in code cracking or technical\n    advances such as the development of quantum computers may present risks to cryptocurrencies and Services of Content,\n    which could result in the theft or loss of your cryptographic tokens or property. To the extent possible, Kukai\n    Wallet intends to update the protocol underlying Services to account for any advances in cryptography and to\n    incorporate additional security measures, but does not guarantee or otherwise represent full security of the system.\n    By using the Services or accessing Content, you acknowledge these inherent risks.</p>\n\n  <H5>5.5 Volatility of Cryptocurrencies</H5>\n  <p>You understand that Tezos and other blockchain technologies and associated cryptographic tokens are highly volatile\n    due to many factors including but not limited to adoption, speculation, technology and security risks. You also\n    acknowledge that the cost of transacting on such technologies is variable and may increase at any time causing\n    impact to any activities taking place on the blockchain network. You acknowledge these risks and agree that Kukai\n    Wallet cannot be held liable for such fluctuations or increased costs.</p>\n\n  <H5>5.6 Application Security</H5>\n  <p>You further acknowledge that blockchain applications are code subject to flaws and acknowledge that you are solely\n    responsible for evaluating any code provided by the Services or Content and the trustworthiness of any third-party\n    websites, products, smart-contracts, or Content you access or use through the Services. You further expressly\n    acknowledge and represent that blockchain applications can be written maliciously or negligently, that Kukai Wallet\n    cannot be held liable for your interaction with such applications and that such applications may cause the loss of\n    property or even identity. This warning and others later provided by Kukai Wallet in no way evidence or represent an\n    on-going duty to alert you to all of the potential risks of utilizing the Services or Content. The code to Kukai\n    Wallet can be found at: https://github.com/kukai-wallet/kukai.</p>\n\n  <H4>6. Indemnity</H4>\n  <p>You agree to release and to indemnify, defend and hold harmless Kukai Wallet and its principles, subsidiaries,\n    affiliates and agencies, as well as the officers, directors, employees, shareholders and representatives of any of\n    the foregoing entities, from and against any and all losses, liabilities, expenses, damages, costs (including\n    attorneys fees and court costs) claims or actions of any kind whatsoever arising or resulting from your use of the\n    Services, your violation of these Terms, and any of your acts or omissions that implicate publicity rights,\n    defamation or invasion of privacy, and privacy laws. Kukai Wallet reserves the right, at its own expense, to assume\n    exclusive defense and control of any matter otherwise subject to indemnification by you and, in such case, you agree\n    to cooperate with Kukai Wallet in the defense of such matter.</p>\n\n  <H4>7. Limitation on Liability</H4>\n  <p>YOU ACKNOWLEDGE AND AGREE THAT YOU ASSUME FULL RESPONSIBILITY FOR YOUR USE OF THE SITE AND THE SERVICES. YOU\n    ACKNOWLEDGE AND AGREE THAT ANY INFORMATION YOU SEND OR RECEIVE DURING YOUR USE OF THE SITE AND THE SERVICES MAY NOT\n    BE SECURE AND MAY BE INTERCEPTED OR LATER ACQUIRED BY UNAUTHORIZED PARTIES. YOU ACKNOWLEDGE AND AGREE THAT YOUR USE\n    OF THE SITE AND THE SERVICES IS AT YOUR OWN RISK. RECOGNIZING SUCH, YOU UNDERSTAND AND AGREE THAT, TO THE FULLEST\n    EXTENT PERMITTED BY APPLICABLE LAW, NEITHER KUKAI WALLET NOR ITS SUPPLIERS OR LICENSORS WILL BE LIABLE TO YOU FOR\n    ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, CONSEQUENTIAL, PUNITIVE, EXEMPLARY OR OTHER DAMAGES OF ANY KIND,\n    INCLUDING WITHOUT LIMITATION DAMAGES FOR LOSS OF PROFITS, GOODWILL, USE, DATA OR OTHER TANGIBLE OR INTANGIBLE LOSSES\n    OR ANY OTHER DAMAGES BASED ON CONTRACT, TORT, STRICT LIABILITY OR ANY OTHER THEORY (EVEN IF KUKAI WALLET HAD BEEN\n    ADVISED OF THE POSSIBILITY OF SUCH DAMAGES), RESULTING FROM THE SITE OR SERVICES; THE USE OR THE INABILITY TO USE\n    THE SITE OR THE SERVICES; UNAUTHORIZED ACCESS TO OR ALTERATION OF YOUR TRANSMISSIONS OR DATA; STATEMENTS OR CONDUCT\n    OF ANY THIRD PARTY ON THE SITE OR THE SERVICES; ANY ACTIONS WE TAKE OR FAIL TO TAKE AS A RESULT OF COMMUNICATIONS\n    YOU SEND TO US; HUMAN ERRORS; TECHNICAL MALFUNCTIONS; FAILURES, INCLUDING PUBLIC UTILITY OR TELEPHONE OUTAGES;\n    OMISSIONS, INTERRUPTIONS, LATENCY, DELETIONS OR DEFECTS OF ANY DEVICE OR NETWORK, PROVIDERS, OR SOFTWARE (INCLUDING,\n    BUT NOT LIMITED TO, THOSE THAT DO NOT PERMIT PARTICIPATION IN THE SERVICES); ANY INJURY OR DAMAGE TO COMPUTER\n    EQUIPMENT; INABILITY TO FULLY ACCESS THE SITE OR THE SERVICES OR ANY OTHER WEBSITE; THEFT, TAMPERING, DESTRUCTION,\n    OR UNAUTHORIZED ACCESS TO, IMAGES OR OTHER CONTENT OF ANY KIND; DATA THAT IS PROCESSED LATE OR INCORRECTLY OR IS\n    INCOMPLETE OR LOST; TYPOGRAPHICAL, PRINTING OR OTHER ERRORS, OR ANY COMBINATION THEREOF; OR ANY OTHER MATTER\n    RELATING TO THE SITE OR ANY OTHER ASPECT OF THE SERVICES.</p>\n\n  <p>SOME JURISDICTIONS DO NOT ALLOW THE EXCLUSION OF CERTAIN WARRANTIES OR THE LIMITATION OR EXCLUSION OF LIABILITY FOR\n    INCIDENTAL OR CONSEQUENTIAL DAMAGES. ACCORDINGLY, SOME OF THE ABOVE LIMITATIONS MAY NOT APPLY TO YOU.</p>\n\n  <H4>8. Intellectual Property</H4>\n  <H5>8.1 Our Proprietary Rights</H5>\n  <p>All title, ownership and intellectual property rights in and to the Services are owned by Kukai Wallet or its\n    licensors. You acknowledge and agree that the Services contains proprietary and confidential information that is\n    protected by applicable intellectual property and other laws. Except as expressly authorized by Kukai Wallet, you\n    agree not to copy, modify, rent, lease, loan, sell, distribute, perform, display or create derivative works based on\n    the Site, or the Services, in whole or in part.</p>\n\n  <H5>8.2 Limited License</H5>\n  <p>We grant you limited, non-exclusive, revocable permission to make use of the Site, and the Services (collectively\n    referred to as, Access). This Access shall remain in effect until and unless terminated by you or us. You promise\n    and agree that you will not redistribute or transfer the Services.</p>\n\n  <p>The Kukai Wallet software application, including without limitation the Site, and the Services, are not sold or\n    transferred to you, and Kukai Wallet and its licensors retain ownership of all copies of the software applications\n    even after installation on your personal computers, mobile handsets, tablets, wearable devices, speakers and/or\n    other devices (Devices).</p>\n\n  <p>All Kukai Wallet trademarks, service marks, trade names, logos, domain names, and any other features of the Kukai\n    Wallet brand (Kukai Wallet Brand Features) are the sole property of Kukai Wallet or its licensors. The Terms do\n    not grant you any rights to use any Kukai Wallet Brand Features whether for commercial or non-commercial use.</p>\n\n  <p>You agree to abide by our user guidelines and not to use the Services or any part thereof in any manner not\n    expressly permitted by the Terms. Except for the rights expressly granted to you in the Terms, Kukai Wallet grants\n    no right, title, or interest to you in the Site or the Services.</p>\n\n  <p>Third party software (for example, open source software libraries) included in the Services are made available to\n    you under the relevant third party software librarys license terms.</p>\n\n  <p>Notwithstanding anything herein to the contrary, nothing in the Terms entitles you to copy, modify, fork, merge,\n    combine with another program or create a derivative work of the Services, including without limitation the Site.</p>\n\n  <H4>9. Links</H4>\n  <p>The Services provide, or third parties may provide, links to other World Wide Web or accessible sites, applications\n    or resources. Because Kukai Wallet has no control over such sites, applications and resources, you acknowledge and\n    agree that Kukai Wallet is not responsible for the availability of such external sites, applications or resources,\n    and does not endorse and is not responsible or liable for any content, advertising, products or other materials on\n    or available from such sites or resources. You further acknowledge and agree that Kukai Wallet shall not be\n    responsible or liable, directly or indirectly, for any damage or loss caused or alleged to be caused by or in\n    connection with use of or reliance on any such content, goods or services available on or through any such site or\n    resource.</p>\n\n  <H4>10. Termination and Suspension</H4>\n  <p>Kukai Wallet may terminate or suspend all or part of the Services and your Kukai Wallet access immediately, without\n    prior notice or liability, if you breach any of the terms or conditions of the Terms. Upon termination of your\n    access, your right to use the Services will immediately cease.</p>\n\n  <p>The following provisions of the Terms survive any termination of these Terms: INDEMNITY; WARRANTY DISCLAIMERS;\n    LIMITATION ON LIABILITY; OUR PROPRIETARY RIGHTS; LINKS; TERMINATION; NO THIRD PARTY BENEFICIARIES; BINDING\n    ARBITRATION AND CLASS ACTION WAIVER; GENERAL INFORMATION.</p>\n\n  <H4>11. No Third Party Beneficiaries</H4>\n  <p>You agree that, except as otherwise expressly provided in these Terms, there shall be no third party beneficiaries\n    to the Terms.</p>\n\n  <H4>12. Notice and Procedure For Making Claims of Copyright Infringement</H4>\n  <p>If you believe that your copyright or the copyright of a person on whose behalf you are authorized to act has been\n    infringed, please provide Kukai Wallets Copyright Agent a written Notice containing the following information:</p>\n\n  <p>- an electronic or physical signature of the person authorized to act on behalf of the owner of the copyright or\n    other intellectual property interest;\n    <BR>- a description of the copyrighted work or other intellectual property that you claim has been infringed;\n    <BR>- a description of where the material that you claim is infringing is located on the Services;\n    your address, telephone number, and email address;\n    <BR>- a statement by you that you have a good faith belief that the disputed use is not authorized by the copyright\n    owner, its agent, or the law;\n    <BR>- a statement by you, made under penalty of perjury, that the above information in your Notice is accurate and\n    that you are the copyright or intellectual property owner or authorized to act on the copyright or intellectual\n    property owners behalf.</p>\n\n  <p>Kukai Wallets Copyright Agent can be reached at:</p>\n\n  <p>Email: legal@kukai.app</p>\n\n  <H4>13. Binding Arbitration and Class Action Waiver</H4>\n\n  <p>PLEASE READ THIS SECTION CAREFULLY  IT MAY SIGNIFICANTLY AFFECT YOUR LEGAL RIGHTS, INCLUDING YOUR RIGHT TO FILE A\n    LAWSUIT IN COURT</p>\n\n  <H5>13.1 Initial Dispute Resolution</H5>\n\n  <p>The parties shall use their best efforts to engage directly to settle any dispute, claim, question, or disagreement\n    and engage in good faith negotiations which shall be a condition to either party initiating a lawsuit or\n    arbitration.</p>\n\n  <H5>13.2 Binding Arbitration</H5>\n\n  <p>If the parties do not reach an agreed upon solution within a period of 30 days from the time informal dispute\n    resolution under the Initial Dispute Resolution provision begins, then either party may initiate arbitration as the\n    sole means to resolve all claims, subject to the terms set forth below. Specifically, all claims arising out of or\n    relating to these Terms (including their formation, performance and breach), the parties relationship with each\n    other and/or your use of the Services shall be finally settled by binding arbitration administered by the American\n    Arbitration Association in accordance with the provisions of its Commercial Arbitration Rules and the supplementary\n    procedures for consumer related disputes of the American Arbitration Association (the AAA), excluding any rules or\n    procedures governing or permitting class actions.</p>\n\n  <p>The arbitrator, and not any federal, state or local court or agency, shall have exclusive authority to resolve all\n    disputes arising out of or relating to the interpretation, applicability, enforceability or formation of these\n    Terms, including, but not limited to any claim that all or any part of these Terms are void or voidable, or whether\n    a claim is subject to arbitration. The arbitrator shall be empowered to grant whatever relief would be available in\n    a court under law or in equity. The arbitrators award shall be written, and binding on the parties and may be\n    entered as a judgment in any court of competent jurisdiction.</p>\n\n  <p>The parties understand that, absent this mandatory provision, they would have the right to sue in court and have a\n    jury trial. They further understand that, in some instances, the costs of arbitration could exceed the costs of\n    litigation and the right to discovery may be more limited in arbitration than in court.</p>\n\n  <H5>13.3 Location</H5>\n\n  <p>Binding arbitration shall take place in Louisiana. You agree to submit to the personal jurisdiction of any federal\n    or state court in Orleans Parish, Louisiana, in order to compel arbitration, to stay proceedings pending\n    arbitration, or to confirm, modify, vacate or enter judgment on the award entered by the arbitrator.</p>\n\n  <H5>13.4 Class Action Waiver</H5>\n\n  <p>The parties further agree that any arbitration shall be conducted in their individual capacities only and not as a\n    class action or other representative action, and the parties expressly waive their right to file a class action or\n    seek relief on a class basis. YOU AND KUKAI WALLET AGREE THAT EACH MAY BRING CLAIMS AGAINST THE OTHER ONLY IN YOUR\n    OR ITS INDIVIDUAL CAPACITY, AND NOT AS A PLAINTIFF OR CLASS MEMBER IN ANY PURPORTED CLASS OR REPRESENTATIVE\n    PROCEEDING. If any court or arbitrator determines that the class action waiver set forth in this paragraph is void\n    or unenforceable for any reason or that an arbitration can proceed on a class basis, then the arbitration provision\n    set forth above shall be deemed null and void in its entirety and the parties shall be deemed to have not agreed to\n    arbitrate disputes.</p>\n\n  <H5>13.5 Exception - Litigation of Intellectual Property and Small Claims Court Claims</H5>\n\n  <p>Notwithstanding the parties decision to resolve all disputes through arbitration, either party may bring an action\n    in state or federal court to protect its intellectual property rights (intellectual property rights means patents,\n    copyrights, moral rights, trademarks, and trade secrets, but not privacy or publicity rights). Either party may also\n    seek relief in a small claims court for disputes or claims within the scope of that courts jurisdiction.</p>\n\n  <H5>13.6 Choice of Law</H5>\n\n  <p>The Terms and the relationship between you and Kukai Wallet shall be governed by the laws of the State of Louisiana\n    without regard to conflict of law provisions.</p>\n\n  <H4>14. GENERAL INFORMATION</H4>\n\n  <H5>14.1 Entire Agreement</H5>\n\n  <p>These Terms (and any additional terms, rules and conditions of participation that Kukai Wallet may post on the\n    Services) constitute the entire agreement between you and Kukai Wallet with respect to the Services and supersedes\n    any prior agreements, oral or written, between you and Kukai Wallet. In the event of a conflict between these Terms\n    and the additional terms, rules and conditions of participation, the latter will prevail over the Terms to the\n    extent of the conflict.</p>\n\n  <H5>14.2 Waiver and Severability of Terms</H5>\n\n  <p>The failure of Kukai Wallet to exercise or enforce any right or provision of the Terms shall not constitute a\n    waiver of such right or provision. If any provision of the Terms is found by an arbitrator or court of competent\n    jurisdiction to be invalid, the parties nevertheless agree that the arbitrator or court should endeavor to give\n    effect to the parties intentions as reflected in the provision, and the other provisions of the Terms remain in\n    full force and effect.</p>\n\n  <H5>14.3 Statute of Limitations</H5>\n\n  <p>You agree that regardless of any statute or law to the contrary, any claim or cause of action arising out of or\n    related to the use of the Services or the Terms must be filed within one (1) year after such claim or cause of\n    action arose or be forever barred.</p>\n\n  <H5>14.4 Section Titles</H5>\n\n  <p>The section titles in the Terms are for convenience only and have no legal or contractual effect.</p>\n\n  <H5>14.5 Communications</H5>\n\n  <p>Users with questions, complaints or claims with respect to the Services may contact us using the relevant contact\n    information set forth above or email us at: contact@kukai.app</p>\n</div>","import { Injectable } from '@angular/core';\nimport { KeyPair } from '../../interfaces';\nimport { WalletService } from '../wallet/wallet.service';\nimport { CONSTANTS } from '../../../environments/environment';\nimport { Parser } from '@taquito/michel-codec';\nimport { valueEncoder } from '@taquito/local-forging/dist/lib/michelson/codec';\nimport { OperationService } from '../operation/operation.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class EmbeddedAuthService {\n  constructor(private walletService: WalletService, private operationService: OperationService) {}\n  async authenticate(authReq: any, origin: string, keyPair: KeyPair = null): Promise<{ message: string; signature: string }> {\n    if (!origin) {\n      throw new Error('NO_DOMAIN_FOUND');\n    } else if ((!this.walletService?.wallet || !this.walletService.isEmbeddedTorusWallet()) && !keyPair) {\n      throw new Error('NO_WALLET_FOUND');\n    }\n    if (!keyPair) {\n      keyPair = await this.walletService.getKeys('', this.walletService.wallet.implicitAccounts[0].pkh).catch((e) => {\n        throw new Error('NO_KEYS_FOUND');\n      });\n    }\n    const authMessage: string = this.createAuthMessage(authReq?.id, authReq?.nonce, origin, keyPair.pk, keyPair.pkh);\n    const signature = this.signMessage(authMessage, keyPair.sk);\n    return { message: authMessage, signature };\n  }\n  async signExprSilent(hexExpr: string): Promise<string> {\n    const keyPair = await this.walletService.getKeys('', this.walletService.wallet.implicitAccounts[0].pkh).catch((e) => {\n      throw new Error('NO_KEYS_FOUND');\n    });\n    const signature: string = this.operationService.sign(hexExpr, keyPair.sk).edsig;\n    return signature;\n  }\n  private createAuthMessage(requestId: string = '', nonce: string = '', domain: string, publicKey: string, address: string): string {\n    if (typeof requestId !== 'string') {\n      throw new Error('INVALID_REQUEST_ID');\n    } else if (typeof nonce !== 'string') {\n      throw new Error('INVALID_NONCE');\n    }\n    const authPayload: any = {\n      requestId,\n      purpose: 'authentication',\n      currentTime: Math.floor(Date.now() / 1000).toString(), // UNIX timestamp\n      nonce,\n      network: this._network(),\n      publicKey,\n      address,\n      domain\n    };\n    if (!requestId) {\n      delete authPayload.requestId;\n    }\n    if (!nonce) {\n      delete authPayload.nonce;\n    }\n    return `Tezos Signed Message: ${JSON.stringify(authPayload)}`;\n  }\n  _network(): string {\n    return CONSTANTS.NETWORK;\n  }\n  private signMessage(message: string, sk: string): string {\n    const parser = new Parser();\n    const expr = parser.parseMichelineExpression(`\"${message.replace(/\"/g, '\\\\\"')}\"`);\n    const hexMessage = `05${valueEncoder(expr)}`;\n    const signature: string = this.operationService.sign(hexMessage, sk).edsig;\n    return signature;\n  }\n}\n","import { Account } from '../../../services/wallet/wallet';\nimport { Template } from 'kukai-embed';\nexport interface PrepareRequest {\n  account: Account;\n  tokenTransfer: string;\n  symbol: string;\n}\nexport interface TemplateRequest {\n  template: Template;\n  ops?: FullyPreparedTransaction[];\n  partialOps?: PartiallyPreparedTransaction[];\n  fee?: TemplateFee;\n}\nexport interface TemplateFee {\n  network: string;\n  storage: string;\n  total: string;\n}\n\nexport interface ConfirmSwapRequest {\n  account: Account;\n  transactions: FullyPreparedTransaction[];\n  externalReq: boolean;\n}\n\nexport enum LqdEntrypoints {\n  addLiquidity = 'addLiquidity',\n  removeLiquidity = 'removeLiquidity',\n  xtzToToken = 'xtzToToken',\n  tokenToXtz = 'tokenToXtz'\n}\n\nexport interface ConfirmRequest {\n  account: Account;\n  tokenTransfer: string;\n  transactions: FullyPreparedTransaction[];\n  externalReq: boolean;\n}\nexport interface PartiallyPreparedTransaction {\n  kind: 'transaction';\n  amount: string;\n  destination: string;\n  parameters?: any;\n  meta?: {\n    alias: string;\n    verifier: string;\n    twitterId?: string;\n  };\n  gasRecommendation?: string;\n  storageRecommendation?: string;\n}\nexport interface FullyPreparedTransaction extends PartiallyPreparedTransaction {\n  fee: string;\n  gasLimit: string;\n  storageLimit: string;\n}\n","<div *ngIf=\"isOpen\" class=\"flex-column kukai-modal\">\n  <div class=\"flex-row content\">\n    <div class=\"flex-column liquidity-baking\">\n      <div class=\"flex-row main-container\">\n        <div class=\"flex-column right\" [class.expanded]=\"advancedForm\" [class.loaded]=\"chartInit\" [class.expanded-00]=\"moreInfo && mode === Mode.swap\" [class.expanded-01]=\"advancedForm && mode === Mode.swap\" [class.expanded-10]=\"moreInfo && advancedForm && mode === Mode.swap\" [class.expanded-11]=\"mode === Mode.liquidity && entrypoint === LqdEntrypoints.addLiquidity\" [class.expanded-100]=\"moreInfo && mode === Mode.liquidity && entrypoint === LqdEntrypoints.addLiquidity\" [class.expanded-101]=\"advancedForm && mode === Mode.liquidity && entrypoint === LqdEntrypoints.addLiquidity\" [class.expanded-110]=\"moreInfo && advancedForm && mode === Mode.liquidity && entrypoint === LqdEntrypoints.addLiquidity\" [class.expanded-111]=\"mode === Mode.liquidity && entrypoint === LqdEntrypoints.removeLiquidity\" [class.expanded-1000]=\"moreInfo && mode === Mode.liquidity && entrypoint === LqdEntrypoints.removeLiquidity\" [class.expanded-1001]=\"advancedForm && mode === Mode.liquidity && entrypoint === LqdEntrypoints.removeLiquidity\" [class.expanded-1010]=\"moreInfo && advancedForm && mode === Mode.liquidity && entrypoint === LqdEntrypoints.removeLiquidity\">\n          <app-ui-chart #leftChart class=\"popout\" [design]=\"'default'\" [type]=\"'line'\" [units]=\"units\" [datas]=\"chartDatas\"\n            [attributes]=\"attributes\" (drawn)=\"chartInit = true;\"></app-ui-chart>\n            <div class=\"filler\" [style.display]=\"chartInit ? '' : 'none'\"></div>\n        </div>\n        <div class=\"flex-column left\" [class.expanded]=\"advancedForm\">\n          <div class=\"flex-column top\">\n            <div class=\"flex-row container-toggle\">\n              <button [class.active]=\"mode === Mode.swap\" (click)=\"toggleMode(Mode.swap)\">SWAP</button>\n              <button [class.active]=\"mode === Mode.liquidity\" (click)=\"toggleMode(Mode.liquidity)\">LIQUIDITY</button>\n            </div>\n            <div class=\"flex-row button close\" (click)=\"close()\"><img class=\"x\"\n                src=\"../../../../../assets/img/close-btn-x.png\" />\n            </div>\n          </div>\n          <app-ui-chart #miniChart class=\"popout-mini\" [design]=\"'mini'\" [type]=\"'line'\" [units]=\"units\"\n            [data]=\"chartData\" [datas]=\"chartDatas\" [attributes]=\"attributes\">\n          </app-ui-chart>\n          <ng-container *ngIf=\"mode === Mode.liquidity\">\n            <form autocomplete=\"off\">\n              <div class=\"flex-column container-toggle-secondary\">\n                <div class=\"flex-row buttons\">\n                  <button [class.active]=\"entrypoint === LqdEntrypoints.addLiquidity\" (click)=\"toggleDirection(0)\">\n                    ADD\n                  </button>\n                  <button [class.active]=\"entrypoint === LqdEntrypoints.removeLiquidity\" (click)=\"toggleDirection(1)\">\n                    REMOVE\n                  </button>\n                </div>\n              </div>\n              <div class=\"flex-column container-inputs\" [class.liquidity]=\"entrypoint === LqdEntrypoints.addLiquidity\">\n                <div class=\"flex-column currency\">\n                  <div class=\"flex-row inputs\">\n                    <div class=\"flex-row right\">\n                      <input type=\"text\" inputmode=\"decimal\" [value]=\"qtyRaw\" [placeholder]=\"'0'\" value=\"\"\n                        (paste)=\"sanitizeNumberInput($event, qty.decimalPlaces, 'qtyRaw')\"\n                        (input)=\"sanitizeNumberInput($event, qty.decimalPlaces, 'qtyRaw')\" />\n                    </div>\n                    <div class=\"flex-row left\">\n                      <span class=\"symbol\">{{ entrypoint === LqdEntrypoints.addLiquidity ? 'XTZ' : 'LBT' }}</span>\n                      <img\n                        [src]=\"entrypoint === LqdEntrypoints.addLiquidity ? 'assets/img/tezos-xtz-logo.svg' : 'assets/img/tokens/lbt.png'\" />\n                    </div>\n                  </div>\n                  <div class=\"tag\">{{ entrypoint === LqdEntrypoints.addLiquidity ? 'Add' : 'Remove' }}</div>\n                  <span *ngIf=\"entrypoint === LqdEntrypoints.removeLiquidity\" class=\"hint\" (click)=\"updateMaxAmount('qtyRaw')\">Balance: <span class=\"max\">{{lqdBalance}}</span></span>\n                  <span *ngIf=\"entrypoint === LqdEntrypoints.addLiquidity\" class=\"hint\">Balance: {{xtzBalance}}</span>\n                </div>\n                <div *ngIf=\"entrypoint === LqdEntrypoints.addLiquidity\" class=\"seperator files add\">\n                  <span class=\"img-wrap\"><img\n                      [src]=\"semaphore ? 'assets/img/feeLoader.gif' : 'assets/img/lb-plus.svg'\" /></span>\n                </div>\n                <div *ngIf=\"entrypoint === LqdEntrypoints.addLiquidity\" class=\"flex-column currency\">\n                  <div class=\"flex-row inputs\">\n                    <div class=\"flex-row right\">\n                      <input type=\"text\" inputmode=\"decimal\" [value]=\"qtyRawOut\" placeholder=\"0\" [value]=\"qtyRawOut\"\n                        (input)=\"sanitizeNumberInput($event, 8, 'qtyRawOut')\"\n                        (paste)=\"sanitizeNumberInput($event, 8, 'qtyRawOut')\" />\n                    </div>\n                    <div class=\"flex-row left\">\n                      <span class=\"symbol\">{{ 'tzBTC' }}</span>\n                      <img [src]=\"'assets/img/tokens/tzbtc.png'\" />\n                    </div>\n                  </div>\n                  <div class=\"tag\">Add</div>\n                  <span class=\"hint\" (click)=\"updateMaxAmount('qtyRawOut')\">Balance: <span class=\"max\">{{ tzBTCBalance\n                      }}</span></span>\n                </div>\n              </div>\n            </form>\n          </ng-container>\n          <ng-container *ngIf=\"mode === Mode.swap\">\n            <form autocomplete=\"off\">\n              <div class=\"flex-column container-inputs\">\n                <div class=\"flex-column currency\">\n                  <div class=\"flex-row inputs\">\n                    <div class=\"flex-row right\">\n                      <input type=\"text\" inputmode=\"decimal\" [value]=\"qtyRaw\" [placeholder]=\"'0'\" value=\"\"\n                        (paste)=\"sanitizeNumberInput($event, qty.decimalPlaces, 'qtyRaw')\"\n                        (input)=\"sanitizeNumberInput($event, qty.decimalPlaces, 'qtyRaw')\" />\n                    </div>\n                    <div class=\"flex-row left\">\n                      <span class=\"symbol\">{{ entrypoint === LqdEntrypoints.xtzToToken ? 'XTZ' : 'tzBTC' }}</span>\n                      <img\n                        [src]=\"entrypoint === LqdEntrypoints.xtzToToken ? 'assets/img/tezos-xtz-logo.svg' : 'assets/img/tokens/tzbtc.png'\" />\n                    </div>\n                  </div>\n                  <div class=\"tag\">From</div>\n                  <span *ngIf=\"entrypoint === LqdEntrypoints.xtzToToken\" class=\"hint\">Balance: {{ xtzBalance}}</span>\n                  <span *ngIf=\"entrypoint === LqdEntrypoints.tokenToXtz\" class=\"hint\" (click)=\"updateMaxAmount('qtyRaw')\">Balance: <span class=\"max\">{{tzBTCBalance}}</span></span>\n                </div>\n                <div class=\"seperator files add\" (click)=\"toggleDirection()\">\n                  <span class=\"img-wrap\"><img\n                      [src]=\"simSemaphore ? 'assets/img/feeLoader.gif' : 'assets/img/swap.svg'\" /></span>\n                </div>\n                <div class=\"flex-column currency\">\n                  <div class=\"flex-row inputs\">\n                    <div class=\"flex-row right\">\n                      <input type=\"text\" inputmode=\"decimal\" [value]=\"qtyRawOut\" [placeholder]=\"'0'\"\n                        (paste)=\"sanitizeNumberInput($event, qtyOut.decimalPlaces, 'qtyRawOut')\"\n                        (input)=\"sanitizeNumberInput($event, qtyOut.decimalPlaces, 'qtyRawOut')\" />\n                    </div>\n                    <div class=\"flex-row left\">\n                      <span class=\"symbol\">{{ entrypoint === LqdEntrypoints.xtzToToken ? 'tzBTC' : 'XTZ' }}</span>\n                      <img\n                        [src]=\"entrypoint === LqdEntrypoints.xtzToToken ? 'assets/img/tokens/tzbtc.png' : 'assets/img/tezos-xtz-logo.svg'\" />\n                    </div>\n                  </div>\n                  <div class=\"tag\">Expected</div>\n                      <span *ngIf=\"entrypoint === LqdEntrypoints.tokenToXtz\" class=\"hint\">Balance: {{ xtzBalance }}</span>\n                      <span *ngIf=\"entrypoint === LqdEntrypoints.xtzToToken\" class=\"hint\">Balance: {{ tzBTCBalance }}</span>\n                </div>\n              </div>\n            </form>\n          </ng-container>\n          <div *ngIf=\"expectedRate\" class=\"flex-row item expected-rate\">\n            <span class=\"flex-row key\">Exchange Rate:</span>\n            <span class=\"value\">{{ expectedRate }}</span>\n          </div>\n          <div class=\"flex-column more-info-toggle\" [class.expanded]=\"moreInfo\">\n            <div class=\"flex-row item\" (click)=\"moreInfo = !moreInfo\">\n              <span class=\"value\">{{ 'View Details' }} <span *ngIf=\"impactDouble >= 0.04\" class=\"price-impact\">Price\n                  Impact {{ impactDouble | percent:'1.2-2' }}</span></span>\n              <div class=\"flex-row\"><img src=\"assets/img/chevron-down.svg\"></div>\n            </div>\n          </div>\n          <div *ngIf=\"moreInfo\" class=\"more-info-body\"\n            [class.expanded]=\"moreInfo\">\n            <div class=\"flex-row item\">\n              <span class=\"flex-row key\">Price Impact:&nbsp;<img src=\"assets/img/information-circle-outline.svg\"\n                  class=\"info-button\" />\n                <div class=\"body\">\n                  The impact your transaction is expected to make on the exchange rate. The size of your swap relative to the size of the pool determines the impact. Note: This impact is what you are accepting in addition to the slippage.\n                </div>\n              </span>\n              <span class=\"value\" [class.warning]=\"impactDouble > 0.04\">{{impactDouble > 0.005 ? (impactDouble | percent:'1.2-2') : \"<0.5%\"}}</span>\n            </div>\n            <div *ngIf=\"(LqdEntrypoints.xtzToToken === entrypoint)\" class=\"flex-row item\">\n              <span class=\"flex-row key\">Minimum Received:&nbsp;<img src=\"assets/img/information-circle-outline.svg\"\n                  class=\"info-button\" />\n                <div class=\"body\">\n                  The minimum amount you are guaranteed to receive. If the exchange rate changes unfavorably such that you can no longer receive at least this amount, then your transaction will not be completed.\n                </div>\n              </span>\n              <span class=\"value\">{{(minimumToken?.internalNormalised | number:'1.2-8') || 0}} tzBTC</span>\n            </div>\n            <div *ngIf=\"(LqdEntrypoints.tokenToXtz === entrypoint)\" class=\"flex-row item\">\n              <span class=\"flex-row key\">Minimum Received:&nbsp;<img src=\"assets/img/information-circle-outline.svg\"\n                  class=\"info-button\" />\n                <div class=\"body\">\n                  The minimum amount you are guaranteed to receive. If the exchange rate changes unfavorably such that you can no longer receive at least this amount, then your transaction will not be completed.\n                </div>\n              </span>\n              <span class=\"value\">{{(minimumXtz?.internalNormalised | number:'1.6-6') || 0}} XTZ</span>\n            </div>\n            <div\n              *ngIf=\"(LqdEntrypoints.removeLiquidity === entrypoint)\"\n              class=\"item\">\n              <span class=\"flex-row key\">Minimum Received:&nbsp;<img src=\"assets/img/information-circle-outline.svg\"\n                  class=\"info-button\" />\n                <div class=\"body\">\n                  The minimum amount you are guaranteed to receive. If the exchange rate changes unfavorably such that you can no longer receive at least this amount, then your transaction will not be completed.\n                </div>\n              </span><br />\n              <span class=\"value\">{{(minimumXtz?.internalNormalised | number:'1.6-6') || 0}} XTZ + {{\n                (minimumToken?.internalNormalised | number:'1.2-8') || 0}} tzBTC</span>\n            </div>\n            <div *ngIf=\"(LqdEntrypoints.addLiquidity === entrypoint)\" class=\"flex-row item\">\n              <span class=\"flex-row key\">Minimum Received:&nbsp;<img src=\"assets/img/information-circle-outline.svg\"\n                  class=\"info-button\" />\n                <div class=\"body\">\n                  The minimum amount you are guaranteed to receive. If the exchange rate changes unfavorably such that you can no longer receive at least this amount, then your transaction will not be completed.\n                </div>\n              </span>\n              <span class=\"value\">{{(minimumLqd?.internalNormalised | number:'1.0-0') || 0}} LBT</span>\n            </div>\n            <div class=\"flex-column slippage\">\n              <span class=\"flex-row label\">Slippage&nbsp;<img src=\"assets/img/information-circle-outline.svg\"\n                  class=\"info-button\" />\n                <div class=\"body\">\n                  Your transaction will not complete if the exchange rate changes unfavorably by more than this slippage percentage. The slippage does not include the Price Impact, when swapping you are accepting both the Price Impact % and the Slippage %.\n                </div>\n              </span>\n              <div class=\"flex-row inputs\">\n                <button [class.active]=\"slippage === 0.005\" (click)=\"slippage = 0.005; update()\">\n                  0.5%\n                </button>\n                <button [class.active]=\"slippage === 0.01\" (click)=\"slippage = 0.01; update()\">\n                  1%\n                </button>\n                <button [class.active]=\"slippage === 0.03\" (click)=\"slippage = 0.03; update()\">\n                  3%\n                </button>\n                <form autocomplete=\"off\">\n                  <input inputmode=\"decimal\" [class.active]=\"slippage !== 0.03 && slippage !== 0.01 && slippage !== 0.005\"\n                    (input)=\"customSlippage($event)\" (focus)=\"customSlippageFocus($event)\" (blur)=\"customSlippageBlur($event)\"\n                    [placeholder]=\"slippage * 100\" value=\"\" />\n                  <span class=\"placeholder-secondary\">%</span>\n                </form>\n              </div>\n            </div>\n          </div>\n          <div class=\"flex-column more-info-toggle\" [class.expanded]=\"advancedForm\">\n            <div class=\"flex-row item\" (click)=\"advancedForm = !advancedForm\">\n              <span class=\"value\">{{ 'Advanced' }}</span>\n              <div class=\"flex-row\"><img src=\"assets/img/chevron-down.svg\"></div>\n            </div>\n          </div>\n          <form *ngIf=\"advancedForm\" autocomplete=\"off\" class=\"more-info-body\" [class.expanded]=\"advancedForm\">\n            <div class=\"flex-row\">\n              <div class=\"flex-column entity\">\n                <label class=\"label\">Gas limit</label>\n                <input inputmode=\"decimal\" type=\"text\" class=\"text\" (input)=\"sanitizeNumberInput($event, 0, 'customGasLimit')\"\n                  (paste)=\"sanitizeNumberInput($event, 0, 'customGasLimit')\"\n                  placeholder={{this.defaultTransactionParams.gas.toString()}} [value]=\"customGasLimit\">\n              </div>\n              <div class=\"flex-column entity\">\n                <label class=\"label\">Fee</label>\n                <input inputmode=\"decimal\" type=\"text\" (input)=\"sanitizeNumberInput($event, 6, 'customFee')\"\n                  (paste)=\"sanitizeNumberInput($event, 6, 'customFee')\" class=\"text\"\n                  placeholder={{this.defaultTransactionParams.fee.toString()}} [value]=\"customFee\">\n              </div>\n            </div>\n            <div class=\"flex-row\">\n              <div class=\"flex-column entity\">\n                <label class=\"label\">Storage limit</label>\n                <input inputmode=\"decimal\" type=\"text\" (input)=\"sanitizeNumberInput($event, 0, 'customStorageLimit')\"\n                  (paste)=\"sanitizeNumberInput($event, 0, 'customStorageLimit')\" class=\"text\"\n                  placeholder={{this.defaultTransactionParams.storage.toString()}} [value]=\"customStorageLimit\">\n              </div>\n              <div class=\"flex-column entity\">\n                <label class=\"label\">Max Storage cost</label>\n                <input inputmode=\"decimal\" type=\"text\" class=\"text read-only\" [value]=\"burnAmount() ? burnAmount() : '0 tez'\" tabindex=-1\n                  readonly>\n              </div>\n            </div>\n          </form>\n          <div class=\"flex-column bottom\">\n            <div class=\"seperator\"></div>\n            <span class=\"form-validity error\">{{ formInvalid || latestSimError }}</span>\n            <button class=\"confirm\" [disabled]=\"formInvalid || latestSimError\" (click)=\"preview()\">Preview</button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>","import { Component, ElementRef, EventEmitter, Output, ViewChild } from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { FullyPreparedTransaction, PartiallyPreparedTransaction, LqdEntrypoints } from '../../misc/send/interfaces';\nimport { EstimateService } from '../../../services/estimate/estimate.service';\nimport { SubjectService } from '../../../services/subject/subject.service';\nimport { TezosDomainsService } from '../../../services/tezos-domains/tezos-domains.service';\nimport { TokenBalancesService } from '../../../services/token-balances/token-balances.service';\nimport { TokenService } from '../../../services/token/token.service';\nimport { WalletService } from '../../../services/wallet/wallet.service';\nimport { SwapLiquidityService } from '../../../services/swap-liquidity/swap-liquidity.service';\nimport { Amount } from '../../../services/swap-liquidity/classes/Amount';\nimport { ModalComponent } from '../modal.component';\nimport { OperationService } from '../../../services/operation/operation.service';\nimport { DefaultTransactionParams } from '../../../interfaces';\nimport Big from 'big.js';\nimport { Account } from '../../../services/wallet/wallet';\nimport assert from 'assert';\nimport { TranslateService } from '@ngx-translate/core';\nimport { InputValidationService } from '../../../services/input-validation/input-validation.service';\nimport { TorusService } from '../../../services/torus/torus.service';\nimport { MessageService } from '../../../services/message/message.service';\nimport { take } from 'rxjs/operators';\nimport { ChartComponent, ChartSeries } from '../../ui/chart/chart.component';\nimport { ChartData } from 'chart.js';\nimport { ChartService, ChartTitle } from '../../../services/chart/chart.service';\n\nenum Mode {\n  swap = 'swap',\n  liquidity = 'liquidity'\n}\n\nconst zeroTxParams: DefaultTransactionParams = {\n  gas: 0,\n  storage: 0,\n  fee: 0,\n  burn: 0\n};\n\n@Component({\n  selector: 'app-swap-liquidity',\n  templateUrl: './swap-liquidity.component.html',\n  styleUrls: ['../../../../scss/components/modals/modal.scss']\n})\nexport class SwapLiquidityComponent extends ModalComponent {\n  @ViewChild('leftChart') leftChart: ChartComponent;\n  @ViewChild('miniChart') miniChart: ChartComponent;\n  @Output() prepareResponse = new EventEmitter();\n  LqdEntrypoints = LqdEntrypoints;\n  Mode = Mode;\n  Object = Object;\n  mode = Mode.swap;\n  entrypoint: string = LqdEntrypoints.xtzToToken;\n  advancedForm = false;\n\n  defaultTransactionParams: DefaultTransactionParams = zeroTxParams;\n\n  readonly lqdTokenContract = 'KT1AafHA1C1vk959wvHWBispY9Y2f3fxBUUo';\n  readonly lqdContract = 'KT1TxqZ8QtKvLu3V3JH7Gx58n7Co8pgtpQU5';\n  readonly tzBTCContract = 'KT1PWx2mnDueood7fEmfbBDKx1D9BAnnXitn';\n\n  readonly costPerByte: string = this.estimateService.costPerByte;\n\n  moreInfo = false;\n\n  formInvalid = '';\n  latestSimError = '';\n\n  customFee = '';\n  customGasLimit = '';\n  customStorageLimit = '';\n\n  minimumLqd: Amount = null;\n  minimumXtz: Amount = null;\n  minimumToken: Amount = null;\n  xtzRequired: Amount = null;\n  expectedRate: string;\n  impactDouble: number;\n  qty: Amount = new Amount({\n    normalisedAmount: '',\n    decimalPlaces: 6\n  });\n  qtyRaw = '';\n  qtyOut: Amount = new Amount({\n    normalisedAmount: '',\n    decimalPlaces: 8\n  });\n  qtyRawOut = '';\n  slippage = 0.005;\n\n  xtzBalance = '0';\n  lqdBalance = '0';\n  tzBTCBalance = '0';\n\n  activeAccount = null;\n  transactions: PartiallyPreparedTransaction[] = [];\n\n  balances: any[];\n  name = 'swap-liquidity';\n\n  private subscriptions: Subscription = new Subscription();\n  simSemaphore = 0;\n\n  tooltipValue: string = '--';\n  titleColor = '#333';\n  series = 'day';\n  units = 'tzBTC';\n  attributes: any = {};\n  chartData: ChartData;\n  chartDatas: Array<ChartData> = [];\n  chartOptions = null;\n  popoutOptions: any;\n  chartInit = false;\n\n  constructor(\n    public tokenService: TokenService,\n    public walletService: WalletService,\n    private estimateService: EstimateService,\n    public tezosDomainService: TezosDomainsService,\n    public tokenBalancesService: TokenBalancesService,\n    private subjectService: SubjectService,\n    private swapLiquidityService: SwapLiquidityService,\n    private operationService: OperationService,\n    public torusService: TorusService,\n    private translate: TranslateService,\n    public tezosDomains: TezosDomainsService,\n    private inputValidationService: InputValidationService,\n    private messageService: MessageService,\n    private chartService: ChartService\n  ) {\n    super();\n    const setTokenBalances = () => {\n      this.xtzBalance = Big(this.activeAccount?.balanceXTZ ?? 0)\n        .div(10 ** 6)\n        .toString();\n      this.lqdBalance = this.balances.find((b) => b.contractAddress === this.lqdTokenContract && b.id == 0)?.balance ?? '0';\n      this.tzBTCBalance = this.balances.find((b) => b.contractAddress === this.tzBTCContract && b.id == 0)?.balance ?? '0';\n    };\n    this.subscriptions.add(\n      this.subjectService.activeAccount.subscribe((activeAccount) => {\n        if (!!activeAccount) {\n          this.activeAccount = activeAccount;\n          this.balances = this.tokenBalancesService?.balances;\n          setTokenBalances();\n        }\n      })\n    );\n    this.subscriptions.add(\n      this.subjectService.nftsUpdated.subscribe((p) => {\n        this.balances = p?.balances ?? this.tokenBalancesService?.balances;\n        setTokenBalances();\n      })\n    );\n    this.subscriptions.add(\n      this.subjectService.walletUpdated.subscribe(() => {\n        this.balances = this.tokenBalancesService?.balances;\n        setTokenBalances();\n      })\n    );\n  }\n\n  async initChartsMobile(): Promise<void> {\n    Promise.all([\n      this.chartService.fetchLBGraphData(ChartSeries.day),\n      this.chartService.fetchLBGraphData(ChartSeries.week),\n      this.chartService.fetchLBGraphData(ChartSeries.month),\n      this.chartService.fetchLBGraphData(ChartSeries.year)\n    ]).then((arr) => {\n      this.chartDatas[ChartSeries.day] = arr[0];\n      this.chartDatas[ChartSeries.week] = arr[1];\n      this.chartDatas[ChartSeries.month] = arr[2];\n      this.chartDatas[ChartSeries.year] = arr[3];\n      //prevents race cond\n      if (this.entrypoint === LqdEntrypoints.xtzToToken) {\n        this.leftChart?.toggleSet(ChartTitle.XTZtzBTC);\n        this.miniChart?.toggleSet(ChartTitle.XTZtzBTC);\n      } else if (this.entrypoint === LqdEntrypoints.tokenToXtz) {\n        this.leftChart?.toggleSet(ChartTitle.tzBTCXTZ);\n        this.miniChart?.toggleSet(ChartTitle.tzBTCXTZ);\n      } else if (this.entrypoint === LqdEntrypoints.addLiquidity || this.entrypoint === LqdEntrypoints.removeLiquidity) {\n        this.leftChart?.toggleSet(ChartTitle.totalValueLocked);\n        this.miniChart?.toggleSet(ChartTitle.totalValueLocked);\n      }\n      this.leftChart?.toggleSeries(ChartSeries.day);\n      this.miniChart?.toggleSeries(ChartSeries.week);\n    });\n  }\n\n  async initChartsDesktop(): Promise<void> {\n    Promise.all([\n      this.chartService.fetchLBGraphData(ChartSeries.day),\n      this.chartService.fetchLBGraphData(ChartSeries.week),\n      this.chartService.fetchLBGraphData(ChartSeries.month),\n      this.chartService.fetchLBGraphData(ChartSeries.year)\n    ]).then((arr) => {\n      this.chartDatas[ChartSeries.day] = arr[0];\n      this.chartDatas[ChartSeries.week] = arr[1];\n      this.chartDatas[ChartSeries.month] = arr[2];\n      this.chartDatas[ChartSeries.year] = arr[3];\n      //prevents race cond\n      if (this.entrypoint === LqdEntrypoints.xtzToToken) {\n        this.leftChart?.toggleSet(ChartTitle.XTZtzBTC);\n        this.leftChart?.toggleSeries(ChartSeries.day);\n      } else if (this.entrypoint === LqdEntrypoints.tokenToXtz) {\n        this.leftChart?.toggleSet(ChartTitle.tzBTCXTZ);\n        this.leftChart?.toggleSeries(ChartSeries.day);\n      } else if (this.entrypoint === LqdEntrypoints.addLiquidity || this.entrypoint === LqdEntrypoints.removeLiquidity) {\n        this.leftChart?.toggleSet(ChartTitle.totalValueLocked);\n        this.leftChart?.toggleSeries(ChartSeries.month);\n      }\n    });\n  }\n\n  async initCharts(): Promise<void> {\n    const isMobile = document.documentElement.style.getPropertyValue('--is-mobile');\n    const style = getComputedStyle(document.body);\n    this.titleColor = style.getPropertyValue('--base-font-color');\n    if (isMobile === '1') {\n      await this.initChartsMobile();\n    } else {\n      await this.initChartsDesktop();\n    }\n  }\n\n  birthExchangeRate(): void {\n    let qty = new Amount({\n      normalisedAmount: 1,\n      decimalPlaces: 6\n    });\n    const { xtzPool, tokenPool } = this.swapLiquidityService.createPoolAmounts();\n    const rate = this.swapLiquidityService.xtzToTokenExchangeRateDisplay(qty, xtzPool, tokenPool, this.swapLiquidityService.settings('liquidityBaking'));\n    this.expectedRate = `1 XTZ ($${this.walletService?.wallet?.XTZrate.toFixed(2)}) = ${Big(rate).toFixed(tokenPool.decimalPlaces)} tzBTC`;\n  }\n\n  async init(): Promise<boolean> {\n    this.qtyRaw = '';\n    this.qty = new Amount({\n      normalisedAmount: 0,\n      decimalPlaces: 6\n    });\n    this.balances = this.tokenBalancesService?.balances;\n    const r = await this.hydratePools();\n    this.attributes = { APY: this.swapLiquidityService.estimateLiquidityBakingAPY() };\n    this.initCharts();\n    this.birthExchangeRate();\n    return r;\n  }\n\n  async open(): Promise<void> {\n    this.subjectService.activeAccount.pipe(take(1)).subscribe(async (activeAccount) => {\n      this.activeAccount = activeAccount;\n      await this.estimateService.preLoadData(this.activeAccount.pkh, this.activeAccount.pk);\n      if (await this.init()) {\n        super.open();\n      }\n      this.messageService.stopSpinner();\n    });\n  }\n\n  close(): void {\n    this.reset();\n    this.mode = Mode.swap;\n    this.entrypoint = LqdEntrypoints.xtzToToken;\n    this.chartInit = false;\n    super.close();\n  }\n\n  calculateXtzToToken(): void {\n    this.qty = new Amount({\n      normalisedAmount: parseFloat(this.qtyRaw),\n      decimalPlaces: 6\n    });\n    this.qtyOut = new Amount({\n      normalisedAmount: parseFloat(this.qtyRawOut),\n      decimalPlaces: 8\n    });\n    const xtzToSell = this.qty;\n    const { xtzPool, tokenPool } = this.swapLiquidityService.createPoolAmounts();\n    const result = this.swapLiquidityService.calculateXtzToToken(\n      xtzToSell,\n      xtzPool,\n      tokenPool,\n      this.slippage,\n      this.swapLiquidityService.settings('liquidityBaking')\n    );\n    this.minimumToken = result.minimum;\n    this.expectedRate = `1 XTZ ($${this.walletService?.wallet?.XTZrate.toFixed(2)}) = ${Big(result.rate).toFixed(tokenPool.decimalPlaces)} tzBTC`;\n    this.impactDouble = result.impactDouble;\n    this.qtyOut = result.expected;\n    this.qtyRawOut = result.expected?.internalNormalised.toFixed(result.expected?.decimalPlaces).toString();\n  }\n\n  calculateTokenToXTZFromXTZ(): void {\n    this.qty = new Amount({\n      normalisedAmount: parseFloat(this.qtyRaw),\n      decimalPlaces: 8\n    });\n    this.qtyOut = new Amount({\n      normalisedAmount: parseFloat(this.qtyRawOut),\n      decimalPlaces: 6\n    });\n    const xtzToBuy = this.qtyOut;\n    const { xtzPool, tokenPool } = this.swapLiquidityService.createPoolAmounts();\n    const result = this.swapLiquidityService.calculateTokenToXTZFromXTZ(\n      xtzToBuy,\n      xtzPool,\n      tokenPool,\n      this.slippage,\n      this.swapLiquidityService.settings('liquidityBaking')\n    );\n    this.minimumXtz = result.xtz.minimum;\n    this.expectedRate = `1 tzBTC ($${Big(result.xtz.rate).times(this.walletService?.wallet?.XTZrate).toFixed(2)}) = ${Big(result.xtz.rate).toFixed(\n      xtzPool.decimalPlaces\n    )} XTZ`;\n    this.impactDouble = result.xtz.impactDouble;\n    this.qty = result.token.expected;\n    this.qtyRaw = result.token.expected?.internalNormalised.toFixed(result.token.expected?.decimalPlaces).toString();\n  }\n\n  calculateTokenToXTZ(): void {\n    this.qty = new Amount({\n      normalisedAmount: parseFloat(this.qtyRaw),\n      decimalPlaces: 8\n    });\n    this.qtyOut = new Amount({\n      normalisedAmount: parseFloat(this.qtyRawOut),\n      decimalPlaces: 6\n    });\n    const tokenToSell = this.qty;\n    const { xtzPool, tokenPool } = this.swapLiquidityService.createPoolAmounts();\n    const result = this.swapLiquidityService.calculateTokenToXTZ(\n      tokenToSell,\n      xtzPool,\n      tokenPool,\n      this.slippage,\n      this.swapLiquidityService.settings('liquidityBaking')\n    );\n    this.minimumXtz = result.minimum;\n    this.expectedRate = `1 tzBTC ($${Big(result.rate).times(this.walletService?.wallet?.XTZrate).toFixed(2)}) = ${Big(result.rate).toFixed(\n      xtzPool.decimalPlaces\n    )} XTZ`;\n    this.impactDouble = result.impactDouble;\n    this.qtyOut = result.expected;\n    this.qtyRawOut = result.expected?.internalNormalised.toFixed(result.expected?.decimalPlaces).toString();\n  }\n\n  calculateXtzToTokenFromToken(): void {\n    this.qty = new Amount({\n      normalisedAmount: parseFloat(this.qtyRaw),\n      decimalPlaces: 6\n    });\n    this.qtyOut = new Amount({\n      normalisedAmount: parseFloat(this.qtyRawOut),\n      decimalPlaces: 8\n    });\n    const tokenToBuy = this.qtyOut;\n    const { xtzPool, tokenPool } = this.swapLiquidityService.createPoolAmounts();\n    const result = this.swapLiquidityService.calculateXtzToTokenFromToken(\n      tokenToBuy,\n      xtzPool,\n      tokenPool,\n      this.slippage,\n      this.swapLiquidityService.settings('liquidityBaking')\n    );\n    this.minimumToken = result.token.minimum;\n    this.expectedRate = `1 XTZ ($${this.walletService?.wallet?.XTZrate.toFixed(2)}) = ${Big(result.token.rate).toFixed(tokenPool.decimalPlaces)} tzBTC`;\n    this.impactDouble = result.token.impactDouble;\n    this.qty = result.xtz.expected;\n    this.qtyRaw = result.xtz.expected?.internalNormalised.toFixed(result.xtz.expected?.decimalPlaces).toString();\n  }\n\n  calcSwap(type: string = 'qtyRaw'): void {\n    if (type === 'qtyRaw' && this.entrypoint === LqdEntrypoints.xtzToToken) {\n      this.calculateXtzToToken();\n    } else if (type === 'qtyRawOut' && this.entrypoint === LqdEntrypoints.tokenToXtz) {\n      this.calculateTokenToXTZFromXTZ();\n    } else if (type === 'qtyRaw' && this.entrypoint === LqdEntrypoints.tokenToXtz) {\n      this.calculateTokenToXTZ();\n    } else if (type === 'qtyRawOut' && this.entrypoint === LqdEntrypoints.xtzToToken) {\n      this.calculateXtzToTokenFromToken();\n    }\n  }\n\n  calcAddLiquidity(type: string): void {\n    const { xtzPool, tokenPool } = this.swapLiquidityService.createPoolAmounts();\n    if (type === 'qtyRaw') {\n      const toSell = this.qty;\n      const result = this.swapLiquidityService.calculateAddLiquidityXTZ(\n        toSell,\n        xtzPool,\n        tokenPool,\n        parseFloat(this.swapLiquidityService.storage[this.lqdContract]?.total_pool),\n        this.slippage,\n        this.swapLiquidityService.settings('liquidityBaking')\n      );\n      this.minimumLqd = result.liquidityMinimum;\n      this.qtyOut = result.tokenRequired;\n      this.qtyRawOut = result.tokenRequired?.internalNormalised.toFixed(result.tokenRequired?.decimalPlaces).toString();\n      this.expectedRate = `1 XTZ ($${this.walletService?.wallet?.XTZrate.toFixed(2)}) = ${Big(result.exchangeRate).toFixed(tokenPool.decimalPlaces)} tzBTC`;\n    } else {\n      const toSell = this.qtyOut;\n      const result = this.swapLiquidityService.calculateAddLiquidityToken(\n        toSell,\n        xtzPool,\n        tokenPool,\n        parseFloat(this.swapLiquidityService.storage[this.lqdContract]?.total_pool),\n        this.slippage,\n        this.swapLiquidityService.settings('liquidityBaking')\n      );\n      this.minimumLqd = result.liquidityMinimum;\n      this.qty = this.xtzRequired = result.xtzRequired;\n      this.qtyRaw = result.xtzRequired?.internalNormalised.toFixed(result.xtzRequired?.decimalPlaces).toString();\n      this.expectedRate = `1 XTZ ($${this.walletService?.wallet?.XTZrate.toFixed(2)}) = ${Big(result.exchangeRate).toFixed(tokenPool.decimalPlaces)} tzBTC`;\n    }\n  }\n\n  calcRemoveLiquidity(): void {\n    const lqtToBurn = this.qty;\n    const { xtzPool, tokenPool } = this.swapLiquidityService.createPoolAmounts();\n    const result = this.swapLiquidityService.calculateRemoveLiquidity(\n      lqtToBurn,\n      xtzPool,\n      tokenPool,\n      parseFloat(this.swapLiquidityService.storage[this.lqdContract]?.total_pool),\n      this.slippage,\n      this.swapLiquidityService.settings('liquidityBaking')\n    );\n    this.minimumXtz = result.xtzMinimum;\n    this.minimumToken = result.tokenMinimum;\n  }\n\n  reset(): void {\n    this.minimumLqd = null;\n    this.minimumXtz = null;\n    this.minimumToken = null;\n    this.expectedRate = '';\n    this.impactDouble = undefined;\n    this.xtzRequired = null;\n\n    this.qty = new Amount({\n      normalisedAmount: '',\n      decimalPlaces: 6\n    });\n    this.qtyRaw = '';\n    this.qtyOut = new Amount({\n      normalisedAmount: '',\n      decimalPlaces: 8\n    });\n    this.qtyRawOut = '';\n\n    this.advancedForm = false;\n    this.customFee = '';\n    this.customGasLimit = '';\n    this.customStorageLimit = '';\n    this.defaultTransactionParams = zeroTxParams;\n    this.formInvalid = '';\n    this.latestSimError = '';\n\n    this.slippage = 0.005;\n    this.transactions = [];\n\n    this.moreInfo = false;\n  }\n  async hydratePools(): Promise<boolean> {\n    try {\n      await this.swapLiquidityService.fetchStorage(this.lqdContract);\n    } catch (e) {\n      this.messageService.addError(this.translate.instant('SWAPCOMPONENT.CONTRACTSTORAGEFAILED'));\n      return false;\n    }\n    return true;\n  }\n\n  async update(type: string = 'qtyRaw'): Promise<void> {\n    this.xtzBalance = Big(this.activeAccount?.balanceXTZ ?? 0)\n      .div(10 ** 6)\n      .toString();\n    this.lqdBalance = this.balances.find((b) => b.contractAddress === this.lqdTokenContract && b.id == 0)?.balance ?? '0';\n    this.tzBTCBalance = this.balances.find((b) => b.contractAddress === this.tzBTCContract && b.id == 0)?.balance ?? '0';\n    if (this.entrypoint === LqdEntrypoints.xtzToToken || this.entrypoint === LqdEntrypoints.tokenToXtz) {\n      this.calcSwap(type);\n    } else if (this.entrypoint === LqdEntrypoints.addLiquidity) {\n      this.qty = new Amount({\n        normalisedAmount: parseFloat(this.qtyRaw),\n        decimalPlaces: 6\n      });\n      this.qtyOut = new Amount({\n        normalisedAmount: parseFloat(this.qtyRawOut),\n        decimalPlaces: 8\n      });\n      this.calcAddLiquidity(type);\n    } else if (this.entrypoint === LqdEntrypoints.removeLiquidity) {\n      this.qty = new Amount({\n        normalisedAmount: parseFloat(this.qtyRaw),\n        decimalPlaces: 0\n      });\n      this.qtyOut = new Amount({\n        normalisedAmount: parseFloat(this.qtyRawOut),\n        decimalPlaces: 0\n      });\n      this.calcRemoveLiquidity();\n    }\n    if (this.qty && this.qty.internalNormalised) {\n      this.estimateFees();\n    }\n  }\n\n  preview(): void {\n    if (!this.qtyRaw) {\n      return;\n    }\n    try {\n      this.prepareResponse.emit(this.getFullyPreparedTxs());\n      ModalComponent.currentModel.next({ name: '', data: {} });\n      this.reset();\n    } catch (e) {\n      this.formInvalid = e.message;\n    }\n  }\n  toggleMode(mode): void {\n    if (mode === this.mode) {\n      return;\n    }\n    this.reset();\n    const chartToggle = (label) => {\n      const style = getComputedStyle(document.body);\n      this.titleColor = style.getPropertyValue('--base-font-color');\n      this.miniChart.toggleSet(label);\n      this.leftChart.toggleSet(label);\n      if (label === ChartTitle.totalValueLocked) {\n        this.miniChart.toggleSeries(ChartSeries.month);\n        this.leftChart.toggleSeries(ChartSeries.month);\n      } else {\n        this.miniChart.toggleSeries(ChartSeries.week);\n        this.leftChart.toggleSeries(ChartSeries.day);\n      }\n    };\n    if (mode === Mode.swap) {\n      this.mode = Mode.swap;\n      this.entrypoint = LqdEntrypoints.xtzToToken;\n      chartToggle(ChartTitle.XTZtzBTC);\n    } else if (mode === Mode.liquidity) {\n      this.mode = Mode.liquidity;\n      this.entrypoint = LqdEntrypoints.addLiquidity;\n      chartToggle(ChartTitle.totalValueLocked);\n    }\n    this.qty = new Amount({\n      normalisedAmount: 0,\n      decimalPlaces: 6\n    });\n    this.birthExchangeRate();\n  }\n  toggleDirection(dir): void {\n    if (this.mode === 'swap') {\n      const chartToggle = (label) => {\n        const style = getComputedStyle(document.body);\n        this.titleColor = style.getPropertyValue('--base-font-color');\n        this.leftChart.toggleSet(label);\n        this.miniChart.toggleSet(label);\n        this.miniChart.toggleSeries(ChartSeries.week);\n      };\n      this.qtyRaw = this.qtyRawOut;\n      if (this.entrypoint === LqdEntrypoints.tokenToXtz) {\n        this.entrypoint = LqdEntrypoints.xtzToToken;\n        chartToggle(ChartTitle.XTZtzBTC);\n      } else if (this.entrypoint === LqdEntrypoints.xtzToToken) {\n        this.entrypoint = LqdEntrypoints.tokenToXtz;\n        chartToggle(ChartTitle.tzBTCXTZ);\n      }\n      this.evalAmount();\n    } else {\n      if (dir === 0 && this.entrypoint !== LqdEntrypoints.addLiquidity) {\n        this.reset();\n        this.entrypoint = LqdEntrypoints.addLiquidity;\n        this.qty = new Amount({\n          normalisedAmount: parseFloat(this.qtyRaw),\n          decimalPlaces: 6\n        });\n      } else if (dir === 1 && this.entrypoint !== LqdEntrypoints.removeLiquidity) {\n        this.reset();\n        this.entrypoint = LqdEntrypoints.removeLiquidity;\n        this.qty = new Amount({\n          normalisedAmount: parseFloat(this.qtyRaw),\n          decimalPlaces: 0\n        });\n      }\n      this.birthExchangeRate();\n    }\n  }\n  getTotalFee(): number {\n    if (this.customFee !== '' && Number(this.customFee)) {\n      return Number(this.customFee);\n    }\n    return Number(this.defaultTransactionParams.fee);\n  }\n  getTotalBurn(): number {\n    if (this.customStorageLimit !== '' && Number(this.customStorageLimit)) {\n      return Number(Big(this.customStorageLimit).mul(this.transactions.length).times(this.costPerByte).div(1000000).toString());\n    }\n    return this.defaultTransactionParams.burn;\n  }\n  burnAmount(): string {\n    const burn = this.customStorageLimit ? Number(Big(this.customStorageLimit).times(this.costPerByte).div(1000000)) : this.defaultTransactionParams.burn;\n    if (burn) {\n      return burn + ' tez';\n    }\n    return '';\n  }\n  customSlippage(e): void {\n    e.target.value = e.target.value.replace(/[^0-9\\.]+/g, '');\n    this.slippage = Math.max(Math.min(100, parseFloat(e.target.value || 0) / 100.0), 0);\n    // this.slippageInput.nativeElement.value = this.slippage;\n    this.update();\n  }\n  customSlippageFocus(e): void {\n    if (e.target.value !== '') {\n      e.target.value = e.target.value.replace(/[^0-9\\.]+/g, '');\n      this.slippage = Math.max(Math.min(100, parseFloat(e.target.value || 0) / 100.0), 0);\n      this.update();\n    }\n  }\n  customSlippageBlur(e): void {\n    if (!Number.isNaN(Number(e.target.value)) && e.target.value !== '') {\n      e.target.value = Math.max(Math.min(100, e.target.value), 0);\n    } else {\n      e.target.value = '';\n      this.slippage = 0.005;\n      this.update();\n    }\n  }\n  getMaxAmount(account: Account): { tez; lqd; tzBTC } {\n    if (account) {\n      let accountBalance = Big(this.xtzBalance);\n      accountBalance = accountBalance.minus(this.customFee && Number(this.customFee) ? Number(this.customFee) : this.defaultTransactionParams.fee);\n      accountBalance = accountBalance.minus(\n        this.customStorageLimit && Number(this.customStorageLimit)\n          ? Number(Big(this.customStorageLimit).times(this.costPerByte).div('1000000'))\n          : this.defaultTransactionParams.burn\n      );\n      accountBalance = accountBalance.minus(0.000001); // dust\n      return {\n        tez: accountBalance.toFixed(),\n        lqd: Big(this.lqdBalance).toFixed(),\n        tzBTC: Big(this.tzBTCBalance).toFixed()\n      };\n    }\n  }\n  async estimateFees(): Promise<void> {\n    console.log('estimate..');\n    const prevSimError = this.latestSimError;\n    this.latestSimError = '';\n    let txs: PartiallyPreparedTransaction[] = [];\n    try {\n      txs = this.getMinimalPreparedTxs();\n      this.transactions = txs;\n    } catch (e) {\n      console.log(e);\n    }\n    if (txs?.length) {\n      this.simSemaphore++;\n      this.latestSimError = '';\n      const callback = (res) => {\n        if (res) {\n          this.formInvalid = this.checkBalances();\n          if (res.error) {\n            this.latestSimError = res.error;\n          } else {\n            this.defaultTransactionParams = res;\n            this.latestSimError = '';\n          }\n          console.log(res, txs);\n        } else {\n          console.log('no res');\n        }\n        this.simSemaphore--;\n      };\n      this.estimateService.estimateTransactions(JSON.parse(JSON.stringify(txs)), this.activeAccount.address, undefined, callback);\n    } else {\n      this.latestSimError = prevSimError;\n    }\n  }\n  updateMaxAmount(input: string = 'qtyRaw'): void {\n    if (this.activeAccount) {\n      const balances = this.getMaxAmount(this.activeAccount);\n      if (!balances) {\n        return;\n      }\n      let balance: string = '0.0';\n      if (this.entrypoint === this.LqdEntrypoints.removeLiquidity) {\n        balance = balances?.lqd;\n        this.qtyRaw = balance;\n        this.update('qtyRaw');\n      } else if (this.entrypoint === this.LqdEntrypoints.tokenToXtz) {\n        if (input === 'qtyRaw') {\n          balance = balances?.tzBTC;\n          this.qtyRaw = balance;\n          this.update('qtyRaw');\n        } else {\n          balance = balances?.tez;\n          this.qtyRawOut = balance;\n          this.update('qtyRawOut');\n        }\n      } else if (this.entrypoint === this.LqdEntrypoints.xtzToToken || this.entrypoint === this.LqdEntrypoints.addLiquidity) {\n        if (input === 'qtyRawOut') {\n          balance = balances?.tzBTC;\n          this.qtyRawOut = balance;\n          this.update('qtyRawOut');\n        } else {\n          balance = balances?.tez;\n          this.qtyRaw = balance;\n          this.update('qtyRaw');\n        }\n      }\n    }\n  }\n  getMinimalPreparedTxs(): PartiallyPreparedTransaction[] {\n    if (this.entrypoint === LqdEntrypoints.xtzToToken) {\n      return (this.transactions = [\n        {\n          kind: 'transaction',\n          amount: this.qty.internalNormalised.toString(),\n          destination: this.lqdContract,\n          parameters: this.operationService.getXTZToTokenParameters(\n            this.activeAccount.address,\n            this.minimumToken.internalBigInt.toFixed(0).toString(),\n            (Date.now() + 60 * 60 * 1000).toString()\n          )\n        }\n      ]);\n    } else if (this.entrypoint === LqdEntrypoints.tokenToXtz) {\n      return (this.transactions = [\n        {\n          kind: 'transaction',\n          amount: '0',\n          destination: this.tzBTCContract,\n          parameters: this.operationService.getRevokeAmountParameters(this.lqdContract)\n        },\n        {\n          kind: 'transaction',\n          amount: '0',\n          destination: this.tzBTCContract,\n          parameters: this.operationService.getApproveAmountParameters(this.lqdContract, this.qty.internalBigInt.toFixed(0).toString())\n        },\n        {\n          kind: 'transaction',\n          amount: '0',\n          destination: this.lqdContract,\n          parameters: this.operationService.getTokenToXTZParameters(\n            this.activeAccount.address,\n            this.qty.internalBigInt.toFixed(0).toString(),\n            this.minimumXtz.internalBigInt.toFixed(0).toString(),\n            (Date.now() + 60 * 60 * 1000).toString()\n          )\n        },\n        {\n          kind: 'transaction',\n          amount: '0',\n          destination: this.tzBTCContract,\n          parameters: this.operationService.getRevokeAmountParameters(this.lqdContract)\n        }\n      ]);\n    } else if (this.entrypoint === LqdEntrypoints.removeLiquidity) {\n      return (this.transactions = [\n        {\n          kind: 'transaction',\n          amount: '0',\n          destination: this.lqdContract,\n          parameters: this.operationService.getRemoveLiquidityParameters(\n            this.activeAccount.address,\n            this.qty.internalBigInt.toFixed(0).toString(),\n            this.minimumXtz.internalBigInt.toFixed(0).toString(),\n            this.minimumToken.internalBigInt.toFixed(0).toString(),\n            (Date.now() + 60 * 60 * 1000).toString()\n          )\n        }\n      ]);\n    } else if (this.entrypoint === LqdEntrypoints.addLiquidity) {\n      return (this.transactions = [\n        {\n          kind: 'transaction',\n          amount: '0',\n          destination: this.tzBTCContract,\n          parameters: this.operationService.getRevokeAmountParameters(this.lqdContract)\n        },\n        {\n          kind: 'transaction',\n          amount: '0',\n          destination: this.tzBTCContract,\n          parameters: this.operationService.getApproveAmountParameters(this.lqdContract, this.qtyOut.internalBigInt.toFixed(0))\n        },\n        {\n          kind: 'transaction',\n          amount: this.qty.internalNormalised.toString(),\n          destination: this.lqdContract,\n          parameters: this.operationService.getAddLiquidityParameters(\n            this.activeAccount.address,\n            this.minimumLqd.internalBigInt.toFixed(0).toString(),\n            this.qtyOut.internalBigInt.toFixed(0).toString(),\n            (Date.now() + 60 * 60 * 1000).toString()\n          )\n        },\n        {\n          kind: 'transaction',\n          amount: '0',\n          destination: this.tzBTCContract,\n          parameters: this.operationService.getRevokeAmountParameters(this.lqdContract)\n        }\n      ]);\n    }\n  }\n  getFullyPreparedTxs(): FullyPreparedTransaction[] {\n    assert(!this.simSemaphore, 'Awaiting request');\n    const minimalTxs = this.getMinimalPreparedTxs();\n    this.transactions = minimalTxs;\n    assert(this.inputValidationService.fee(this.customFee), 'Invalid fee');\n    assert(this.inputValidationService.gas(this.customGasLimit), 'Invalid gas limit');\n    assert(this.inputValidationService.gas(this.customStorageLimit), 'Invalid storage limit');\n    assert(!this.checkBalances(), this.checkBalances());\n    assert(minimalTxs.length === this.defaultTransactionParams.customLimits?.length, 'Simulation error');\n    return this.opsWithCustomLimits();\n  }\n  opsWithCustomLimits(): FullyPreparedTransaction[] {\n    let extraGas: number = 0;\n    let extraStorage: number = 0;\n    if (this.customGasLimit && this.customGasLimit !== this.defaultTransactionParams.gas.toString()) {\n      extraGas = Number(this.customGasLimit) - this.defaultTransactionParams.gas;\n    }\n    if (this.customStorageLimit && this.customStorageLimit !== this.defaultTransactionParams.storage.toString()) {\n      extraStorage = Number(this.customStorageLimit) - this.defaultTransactionParams.storage;\n    }\n    const extraGasPerOp: number = Math.round(extraGas / this.transactions.length);\n    const extraStoragePerOp: number = Math.round(extraStorage / this.transactions.length);\n    const txs: FullyPreparedTransaction[] = [];\n    for (let i = 0; i < this.transactions.length; i++) {\n      let gasLimit: string = extraGas\n        ? (Number(this.defaultTransactionParams.customLimits[i].gasLimit) + extraGasPerOp).toString()\n        : this.defaultTransactionParams.customLimits[i].gasLimit.toString();\n      let storageLimit = extraStorage\n        ? (Number(this.defaultTransactionParams.customLimits[i].storageLimit) + extraStoragePerOp).toString()\n        : this.defaultTransactionParams.customLimits[i].storageLimit.toString();\n      gasLimit = !(Number(gasLimit) < 0) ? gasLimit : '0';\n      storageLimit = !(Number(storageLimit) < 0) ? storageLimit : '0';\n      const fullyTx: FullyPreparedTransaction = {\n        ...this.transactions[i],\n        fee: i === this.transactions.length - 1 ? this.getTotalFee().toString() : '0',\n        gasLimit,\n        storageLimit\n      };\n      txs.push(fullyTx);\n    }\n    return txs;\n  }\n  checkBalances(): string {\n    if (this.transactions.length > 0 && this.activeAccount) {\n      const balances = this.getMaxAmount(this.activeAccount);\n      if (balances) {\n        const maxTez = Big(balances?.tez).minus(0.000001);\n        const maxLQD = Big(balances.lqd).plus(0.0);\n        const maxtzBTC = Big(balances.tzBTC).plus(0.0);\n        let amount = Big(0);\n        for (const tx of this.transactions) {\n          amount = amount.plus(Big(tx.amount));\n        }\n        if (this.entrypoint === LqdEntrypoints.xtzToToken) {\n          if (!!maxTez && amount.gt(maxTez)) {\n            return this.translate.instant('SWAPCOMPONENT.TOOHIGHFEEORAMOUNT');\n          }\n          if (this.minimumToken && this.minimumToken.internalNormalised === 0) {\n            return this.translate.instant('SWAPCOMPONENT.TOOSMALLAMOUNT');\n          }\n        } else if (this.entrypoint === LqdEntrypoints.tokenToXtz) {\n          if (Big(this.qty.internalNormalised).gt(maxtzBTC)) {\n            return this.translate.instant('SWAPCOMPONENT.TOOHIGHAMOUNT');\n          }\n          if (this.minimumXtz && this.minimumXtz.internalNormalised === 0) {\n            return this.translate.instant('SWAPCOMPONENT.TOOSMALLAMOUNT');\n          }\n        } else if (this.entrypoint === LqdEntrypoints.addLiquidity) {\n          if (!!maxTez && amount.gt(maxTez)) {\n            return this.translate.instant('SWAPCOMPONENT.TOOHIGHAMOUNT');\n          }\n          if (this.qtyOut && Big(this.qtyOut.internalNormalised).gt(maxtzBTC)) {\n            return this.translate.instant('SWAPCOMPONENT.TOOHIGHAMOUNT');\n          }\n          if (this.xtzRequired && this.xtzRequired.internalNormalised === 0) {\n            return this.translate.instant('SWAPCOMPONENT.TOOSMALLAMOUNT');\n          }\n          if (this.minimumLqd && this.minimumLqd.internalNormalised === 0) {\n            return this.translate.instant('SWAPCOMPONENT.TOOSMALLAMOUNT');\n          }\n        } else if (this.entrypoint === LqdEntrypoints.removeLiquidity) {\n          if (Big(this.qty.internalNormalised).gt(maxLQD)) {\n            return this.translate.instant('SWAPCOMPONENT.TOOHIGHAMOUNT');\n          }\n          if (this.minimumXtz && this.minimumXtz.internalNormalised === 0) {\n            return this.translate.instant('SWAPCOMPONENT.TOOSMALLAMOUNT');\n          }\n        }\n      }\n    }\n    return '';\n  }\n  sanitizeNumberInput(e, decimalPlaces: number, type = ''): void {\n    const exp = new RegExp(`^\\\\d{0,}(\\\\.\\\\d{0,${decimalPlaces}})?\\$`, 'g');\n    if (type === 'qtyRaw') {\n      if (exp.test(e?.target?.value)) {\n        this.qtyRaw = e?.target?.value;\n      } else {\n        e.target.value = this.qtyRaw;\n      }\n      this.evalAmount('qtyRaw');\n    } else if (type === 'qtyRawOut') {\n      if (exp.test(e?.target?.value)) {\n        this.qtyRawOut = e?.target?.value;\n      } else {\n        e.target.value = this.qtyRawOut;\n      }\n      this.evalAmount('qtyRawOut');\n    } else {\n      if (exp.test(e?.target?.value)) {\n        this[type] = e?.target?.value;\n      } else {\n        e.target.value = this[type];\n      }\n    }\n  }\n  evalAmount(type: string = 'qtyRaw'): void {\n    let qty = this[type];\n    if (parseFloat(qty) < 0.0 || !qty) {\n      this.qtyRawOut = this.qtyRaw = '';\n      return;\n    } else if (isNaN(parseFloat(qty)) && parseFloat(qty) === 0.0) {\n      return;\n    } else if (!isNaN(parseFloat(qty))) {\n      this.update(type);\n    }\n  }\n  openInfoModal(title: string): void {\n    switch (title) {\n      case 'slippage':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message:\n              'Token prices in a pool may change significantly within seconds. Slippage tolerance defines the difference between the expected and current exchange rate that you find acceptable. The higher the slippage tolerance, the more likely a transaction will go through.',\n            title: 'Slippage Information'\n          },\n          forceClose: false\n        });\n        break;\n      case 'pricerate':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'The amount of token B you receive for 1 token A, per the current exchange rate.',\n            title: 'Price Rate Information'\n          },\n          forceClose: false\n        });\n        break;\n      case 'impactdouble':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'The impact your transaction is expected to make on the exchange rate.',\n            title: 'Price Impact'\n          },\n          forceClose: false\n        });\n        break;\n      case 'minimumxtz':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'The minimum amount of XTZ to be received from the transaction.',\n            title: 'Minimum XTZ'\n          },\n          forceClose: false\n        });\n        break;\n      case 'requiredtoken':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'Required tzBTC needed for transaction.',\n            title: 'Required tzBTC'\n          },\n          forceClose: false\n        });\n        break;\n      case 'minimumtoken':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'The minimum amount of tzBTC to be received from the transaction.',\n            title: 'Minimum tzBTC'\n          },\n          forceClose: false\n        });\n        break;\n      case 'minimumlqt':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'The minimum amount of LBT to be received from the transaction.',\n            title: 'Minimum LBT'\n          },\n          forceClose: false\n        });\n        break;\n      default:\n        break;\n    }\n  }\n}\n","<div *ngIf=\"isOpen\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-row top\">\n      <div class=\"flex-row button close\" (click)=\"closeModalAction()\"><img class=\"x\"\n          src=\"../../../assets/img/close-btn-x.png\" /></div>\n      <h1 class=\"title\">Confirmation</h1>\n    </div>\n    <div class=\"flex-column confirm-send\" [class.image]=\"tokenBalanceService.isNFT(token)\" [class.batch]=\"parameters\">\n      <form autocomplete=\"off\">\n        <div class=\"flex-row top\">\n          <div class=\"flex-column left\" [style.minHeight]=\"!tokenBalanceService.isNFT(token) ? 'unset' : ''\">\n            <span *ngIf=\"!tokenBalanceService.isNFT(token)\" class=\"key\">SEND AMOUNT:</span>\n            <app-asset class=\"token-image\" [class.balance]=\"!tokenBalanceService.isNFT(token)\"\n              [assets]=\"token ? {displayAsset: token?.displayAsset, thumbnailAsset: token?.thumbnailAsset} : {thumbnailAsset: 'assets/img/tezos-xtz-logo.svg'}\"\n              [priorityList]=\"['thumbnailAsset', 'displayAsset']\" [class.sd]=\"!token\"></app-asset>\n          </div>\n          <div class=\"flex-column right\">\n            <span class=\"flex-row amount\"><span class=\"tez value\">{{ formatAmount(token, totalAmount(),\n                false)\n                }}</span>\n              <ng-container *ngIf=\"!tokenTransfer\"><span class=\"fiat key\">USD: <span class=\"value\">{{'$' +\n                    (totalAmount()\n                    *\n                    walletService.wallet.XTZrate | number:'1.2-2')\n                    }}</span></span>\n              </ng-container>\n            </span>\n            <div class=\"flex-column items\">\n              <span *ngIf=\"tokenBalanceService.isNFT(token)\" class=\"key amount-quantity\">QUANTITY:&nbsp;&nbsp;<span\n                  class=\"value\">{{ getQuantity(totalAmount())\n                  }}</span></span>\n              <span class=\"key\">FEE:&nbsp;&nbsp;<span class=\"value\">{{ (getTotalFee() | number:'1.0-6') + ' tez'\n                  }}</span></span>\n              <span *ngIf=\"getTotalBurn(); let totalBurn\" class=\"key\">STORAGE COST:&nbsp;<span class=\"value\">{{\n                  (totalBurn\n                  |\n                  number:'1.0-6') + ' tez'\n                  }}</span></span>\n            </div>\n          </div>\n        </div>\n        <div class=\"flex-row from\">\n          <div class=\"flex-column left\">\n            <span class=\"key\">FROM: </span>\n          </div>\n          <div class=\"flex-column right\">\n            <div *ngIf=\"getUsername(); let displayName\" class=\"flex-row torus-name\"><img class=\"verifier-logo\"\n                src=\"../../../assets/img/{{ getVerifier() }}-logo.svg\">{{ displayName }}</div>\n            <span class=\"address\">{{\n              activeAccount?.address\n              }}</span>\n          </div>\n        </div>\n        <div *ngIf=\"!parameters\" class=\"flex-row divider\">\n          <span></span><img class=\"icon\" src=\"../../../assets/img/send-down-arrow.png\" /><span></span>\n        </div>\n        <div class=\"flex-row to\">\n          <div class=\"flex-column left\">\n            <span class=\"key\">SEND TO<ng-container *ngIf=\"parameters && transactions?.length > 1\">&nbsp;BATCH\n              </ng-container>: </span>\n          </div>\n          <div class=\"flex-column right\">\n            <div *ngFor=\"let transaction of transactions | slice:0:showAll; index as i\"\n              (click)=\"updateParameters(i, transaction.parameters)\" class=\"flex-column transaction\">\n              <span *ngIf=\"transaction?.meta && transaction.meta?.verifier\" class=\"flex-row torus-to value\"><img\n                  src=\"../../../assets/img/{{ transaction.meta.verifier }}-logo.svg\" class=\"icon\">\n                {{ transaction.meta?.alias }}</span>\n              <span class=\"flex-row single-to\" [class.default]=\"transactions.length === 1\"\n                [class.selectable]=\"transactions.length > 1 && parameters\"\n                [class.active]=\"batchParamIndex === i && transactions.length > 1 && parameters\"><span>{{\n                  transaction?.destination\n                  }}</span></span>\n              <p class=\"previewAttention\" *ngIf=\"tokenTransfer && transaction?.destination.slice(0, 3) === 'KT1'\">\n                Warning:\n                Verify the contract can manage tokens</p>\n            </div>\n            <div *ngIf=\"transactions?.length > 10\" class=\"button show-all\"\n              (click)=\"showAll = showAll === 10 ? undefined : 10\">{{ showAll === 10 ? 'Show All' : 'Show Less' }}</div>\n          </div>\n        </div>\n        <br />\n        <br />\n        <span *ngIf=\"parameters && transactions.length > 1\" class=\"flex-row transfer-amount\"><span class=\"key\">TRANSFER\n            AMOUNT: </span><span class=\"key\">{{ (transactions[batchParamIndex]?.amount | number:'1.0-6')\n            }}</span></span>\n        <div *ngIf=\"parameters && parameters?.entrypoint\" class=\"flex-row contract-call\"><span class=\"key\">CONTRACT\n            CALL:\n          </span><span class=\"key\">{{ parameters?.entrypoint }}</span></div>\n        <app-ui-toggle-advanced style=\"width: calc(100% - 1em);margin: 0 0 2.5em 0;\" *ngIf=\"externalReq\"\n          [default]=\"false\" (stateChange)=\"advancedForm = $event\">\n        </app-ui-toggle-advanced>\n      </form>\n      <div *ngIf=\"advancedForm\" class=\"advanced-form\">\n        <ng-container *ngIf=\"parameters\">\n          <div class=\"tabs-container\">\n            <ul class=\"flex-row tabs\">\n              <li class=\"tab\" [class.active]=\"parametersFormat === 0\" (click)=\"setParametersFormat(0)\">Micheline</li>\n              <li class=\"tab\" [class.active]=\"parametersFormat === 1\" (click)=\"setParametersFormat(1)\">JSON</li>\n            </ul>\n          </div>\n          <textarea *ngIf=\"parameters\" name=\"none\" rows=\"10\" readonly>{{ parametersDisplay }}</textarea>\n        </ng-container>\n        <form autocomplete=\"off\" *ngIf=\"externalReq && (!walletService.isLedgerWallet()) || ledgerError\">\n          <div class=\"flex-row\">\n            <div class=\"flex-column\">\n              <label class=\"label\">Gas limit</label>\n              <input inputmode=\"decimal\" name=\"none\" type=\"text\" class=\"text\" (input)=\"sanitizeNumberInput($event, 'gas')\"\n                (paste)=\"sanitizeNumberInput($event, 'gas')\" [placeholder]=\"getTotalDefaultGas() || '0'\"\n                [(ngModel)]=\"customGasLimit\">\n            </div>\n            <div class=\"flex-column\">\n              <label class=\"label\">Fee</label>\n              <input inputmode=\"decimal\" name=\"none\" type=\"text\" class=\"text\" [placeholder]=\"getTotalFee() || '0'\"\n                (paste)=\"sanitizeNumberInput($event)\" (input)=\"sanitizeNumberInput($event)\" [(ngModel)]=\"customFee\">\n            </div>\n          </div>\n          <div class=\"flex-row\">\n            <div class=\"flex-column\">\n              <label class=\"label\">Storage limit</label>\n              <input inputmode=\"decimal\" name=\"none\" type=\"text\" class=\"text\" (input)=\"sanitizeNumberInput($event, 'storage')\"\n                (paste)=\"sanitizeNumberInput($event, 'storage')\" [placeholder]=\"getTotalDefaultStorage() || '0'\"\n                [(ngModel)]=\"customStorageLimit\">\n            </div>\n            <div class=\"flex-column\">\n              <label class=\"label\">Max storage cost</label>\n              <input inputmode=\"decimal\" name=\"none\" type=\"text\" class=\"text read-only\" [placeholder]=\"(getTotalBurn() || '0') + ' tez'\"\n                tabindex=-1 readonly>\n            </div>\n          </div>\n        </form>\n      </div>\n      <div class=\"flex-column bottom\">\n        <span [style.visibility]=\"!pwdInvalid ? 'hidden' : ''\" [style.margin]=\"!pwdInvalid ? '0' : ''\"\n          class=\"label danger\">{{ this.pwdInvalid }}</span>\n        <ng-container *ngIf=\"walletService.isPwdWallet()\">\n          <span class=\"label\">ENTER YOUR\n            PASSWORD TO CONFIRM:</span>\n          <input name=\"none\" [(ngModel)]=\"password\" autocomplete=\"current-password\" placeholder=\"Password\"\n            class=\"text password\" type=\"password\" (input)=\"this.pwdInvalid = ''\" (change)=\"this.pwdInvalid = ''\"\n            (keydown.enter)='!messageService.spinnerOn ? inject() : null'>\n        </ng-container>\n        <button class=\"confirm\" *ngIf=\"walletService.isLedgerWallet() && ledgerError; else elseBlock\"\n          (click)=\"ledgerRetry()\">Sign with\n          Ledger</button>\n        <ng-template #elseBlock>\n          <button class=\"confirm\" (click)=\"!messageService.spinnerOn ? inject() : null\"\n            [disabled]=\"(walletService.isLedgerWallet() && (!sendResponse || !sendResponse.payload || !sendResponse.payload.signedOperation)) || walletService.isWatchWallet()\">\n            {{ walletService.isLedgerWallet() ? 'Broadcast' : 'Confirm'}}</button>\n        </ng-template>\n      </div>\n    </div>\n  </div>\n</div>","import { EventEmitter, Input, OnChanges, OnDestroy, Output } from '@angular/core';\nimport { Component, OnInit, SimpleChanges } from '@angular/core';\nimport { FullyPreparedTransaction, PrepareRequest } from '../../../misc/send/interfaces';\nimport { TokenService } from '../../../../services/token/token.service';\nimport { WalletService } from '../../../../services/wallet/wallet.service';\nimport { EstimateService } from '../../../../services/estimate/estimate.service';\nimport { OperationService } from '../../../../services/operation/operation.service';\nimport { MessageService } from '../../../../services/message/message.service';\nimport { CoordinatorService } from '../../../../services/coordinator/coordinator.service';\nimport { LookupService } from '../../../../services/lookup/lookup.service';\nimport { LedgerService } from '../../../../services/ledger/ledger.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport { KeyPair } from '../../../../interfaces';\nimport { emitMicheline, assertMichelsonData } from '@taquito/michel-codec';\nimport Big from 'big.js';\nimport { LedgerWallet, TorusWallet } from '../../../../services/wallet/wallet';\nimport { InputValidationService } from '../../../../services/input-validation/input-validation.service';\nimport { ModalComponent } from '../../modal.component';\nimport { Subscription } from 'rxjs';\nimport { TezosDomainsService } from '../../../../services/tezos-domains/tezos-domains.service';\nimport { TokenBalancesService } from '../../../../services/token-balances/token-balances.service';\nimport { SubjectService } from '../../../../services/subject/subject.service';\n\n@Component({\n  selector: 'app-confirm-send',\n  templateUrl: './send-confirmation.component.html',\n  styleUrls: ['../../../../../scss/components/modals/modal.scss']\n})\nexport class ConfirmSendComponent extends ModalComponent implements OnInit, OnChanges, OnDestroy {\n  @Input() confirmRequest: PrepareRequest = null;\n  @Output() operationResponse = new EventEmitter();\n  syncSub: Subscription;\n  tokenTransfer = '';\n  activeAccount = null;\n  externalReq: boolean = false;\n  transactions: FullyPreparedTransaction[] = [];\n  costPerByte: string = this.estimateService.costPerByte;\n\n  customFee = '';\n  customGasLimit = '';\n  customStorageLimit = '';\n\n  parameters: any = null;\n  batchParamIndex = 0;\n  micheline: any = null;\n  batchParameters: { num: number; parameters: any }[] = [];\n  parametersFormat = 0;\n  parametersDisplay = '';\n  showAll = 10;\n\n  showFullBatch = false;\n  sendResponse = null;\n  ledgerError = '';\n  password = '';\n  pwdInvalid = '';\n  advancedForm = false;\n  name = 'confirm-send';\n  token = null;\n  domain = undefined;\n\n  private subscriptions: Subscription = new Subscription();\n\n  constructor(\n    private translate: TranslateService,\n    public tokenService: TokenService,\n    public walletService: WalletService,\n    private estimateService: EstimateService,\n    private operationService: OperationService,\n    private messageService: MessageService,\n    private coordinatorService: CoordinatorService,\n    private lookupService: LookupService,\n    private ledgerService: LedgerService,\n    private inputValidationService: InputValidationService,\n    public tezosDomainService: TezosDomainsService,\n    public tokenBalanceService: TokenBalancesService,\n    private subjectService: SubjectService\n  ) {\n    super();\n  }\n\n  ngOnInit(): void {}\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes?.confirmRequest?.currentValue) {\n      this.reset(true);\n      this.externalReq = changes.confirmRequest.currentValue.externalReq;\n      this.tokenTransfer = changes.confirmRequest.currentValue.tokenTransfer;\n      this.activeAccount = changes.confirmRequest.currentValue.account;\n      this.tezosDomainService.getDomainFromAddress(this.activeAccount?.address).then((domain) => {\n        this.domain = domain;\n      });\n      this.transactions = changes.confirmRequest.currentValue.transactions;\n      this.token = this.tokenService.getAsset(this.tokenTransfer);\n      console.log('transactions', this.transactions);\n      if (this.externalReq) {\n        ModalComponent.currentModel.next({\n          name: this.name,\n          data: null\n        });\n      }\n      this.init();\n      if (this.externalReq) {\n        this.syncSub = this.subjectService.beaconResponse.subscribe((response) => {\n          if (response) {\n            this.closeModalAction('silent');\n          }\n        });\n      }\n    }\n  }\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n  open(data: any): void {\n    this.customFee = data?.customFee;\n    this.customGasLimit = data?.customGasLimit;\n    this.customStorageLimit = data?.customStorageLimit;\n    super.open();\n  }\n  async init(): Promise<void> {\n    await this.loadParameters();\n    if (this.walletService.wallet instanceof LedgerWallet) {\n      this.ledgerError = '?';\n    }\n  }\n  async loadParameters(): Promise<void> {\n    if (this.transactions.length > 1) {\n      for (const [i, op] of this.transactions.entries()) {\n        if (op.parameters) {\n          this.batchParameters.push({\n            num: i + 1,\n            parameters: op.parameters\n          });\n          if (!this.parameters) {\n            this.updateParameters(0, op.parameters);\n          }\n        }\n      }\n    } else if (this.transactions[0].parameters) {\n      this.updateParameters(0, this.transactions[0].parameters);\n    }\n  }\n  updateParameters(index: number, parameters: any): void {\n    if (!parameters) {\n      return;\n    }\n    this.batchParamIndex = index;\n    this.parameters = parameters;\n    this.parametersToMicheline();\n    this.parametersDisplay = this.parametersTextboxDisplay();\n  }\n  parametersTextboxDisplay(): string {\n    return !this.parametersFormat ? this.micheline.value : JSON.stringify(this.parameters.value, null, 2);\n  }\n  setParametersFormat(id: number): void {\n    this.parametersFormat = id;\n    this.parametersDisplay = this.parametersTextboxDisplay();\n  }\n  beaconTokenTransfer(op: any): null | { tokenId: string; to: string; amount: string } {\n    if (op.parameters && this.tokenService.isKnownTokenContract(op.destination)) {\n      return this.operationService.parseTokenTransfer(op);\n    }\n    return null;\n  }\n  parametersToMicheline(): void {\n    if (this.parameters) {\n      try {\n        if (!this.parameters.value || !this.parameters.entrypoint) {\n          throw new Error('entrypoint and value expected');\n        }\n        assertMichelsonData(this.parameters.value);\n        const res = emitMicheline(this.parameters.value, {\n          indent: '  ',\n          newline: '\\n'\n        });\n        this.micheline = {\n          entrypoint: this.parameters.entrypoint,\n          value: res\n        };\n      } catch (e) {\n        console.warn(e);\n        this.micheline = null;\n      }\n    }\n  }\n  getTotalAmount(): string {\n    let totalSent = Big(0);\n    for (const tx of this.transactions) {\n      totalSent = totalSent.add(tx.amount);\n    }\n    return totalSent.toFixed();\n  }\n  getTotalCost(display: boolean = false): string {\n    const totalFee = Big(this.getTotalFee()).plus(Big(this.getTotalBurn())).toString();\n    if (display && totalFee === '0') {\n      return '-';\n    }\n    return totalFee;\n  }\n  getTotalFee(): string {\n    if (this.customFee) {\n      return this.customFee;\n    }\n    let totalFee = Big(0);\n    for (const tx of this.transactions) {\n      totalFee = totalFee.add(tx.fee ? tx.fee : 0);\n    }\n    return totalFee.toFixed();\n  }\n  getTotalBurn(): number {\n    const totalActiveStorageLimit: number =\n      this.customStorageLimit !== '' && Number(this.customStorageLimit) ? Number(this.customStorageLimit) : this.getTotalDefaultStorage();\n    return Number(Big(totalActiveStorageLimit).times(this.costPerByte).div(1000000).toString());\n  }\n  getTotalDefaultGas(): number {\n    let totalGas = Big(0);\n    for (const tx of this.transactions) {\n      totalGas = totalGas.plus(tx.gasLimit);\n    }\n    return totalGas.toFixed();\n  }\n  getTotalDefaultStorage(): number {\n    let totalStorage = Big(0);\n    for (const tx of this.transactions) {\n      totalStorage = totalStorage.plus(tx.storageLimit);\n    }\n    return totalStorage.toFixed();\n  }\n  getQuantity(amount): number {\n    return Big(amount)\n      .div(10 ** (false ? this.token.decimals : 0))\n      .toFixed();\n  }\n  totalAmount(): string {\n    let totalSent = Big(0);\n    for (const tx of this.transactions) {\n      totalSent = totalSent.add(tx.amount);\n    }\n    return totalSent.toFixed();\n  }\n  formatAmount(token, amount: string, baseUnit = true): string {\n    if (!token) {\n      return `${Big(amount)\n        .div(10 ** (baseUnit ? 6 : 0))\n        .toFixed()} tez`;\n    } else {\n      if (token) {\n        if (this.tokenBalanceService.isNFT(token)) {\n          return `${token.name}`;\n        } else {\n          return `${Big(amount)\n            .div(10 ** (baseUnit ? token.decimals : 0))\n            .toFixed()} ${token.symbol}`;\n        }\n      } else {\n        return '[Unknown token]';\n      }\n    }\n  }\n  async ledgerRetry(): Promise<void> {\n    if (!this.inputValidationService.fee(this.getTotalFee().toString())) {\n      this.messageService.addError('Invalid fee');\n      return;\n    }\n    this.messageService.startSpinner('Preparing transaction...');\n    const keys = await this.walletService.getKeys('');\n    if (keys) {\n      await this.sendTransaction(keys);\n    } else {\n      this.messageService.stopSpinner();\n    }\n  }\n  async inject(): Promise<void> {\n    if (this.walletService.isLedgerWallet()) {\n      await this.broadCastLedgerTransaction();\n      this.sendResponse = null;\n      ModalComponent.currentModel.next({ name: '', data: null });\n    } else {\n      if (!this.inputValidationService.fee(this.getTotalFee().toString())) {\n        this.messageService.addError('Invalid fee');\n        return;\n      }\n      const pwd = this.password;\n      this.password = '';\n      this.messageService.startSpinner('Signing transaction...');\n      let keys;\n      try {\n        keys = await this.walletService.getKeys(pwd, this.activeAccount.pkh);\n      } catch {\n        this.messageService.stopSpinner();\n      }\n      if (keys) {\n        this.pwdInvalid = '';\n        this.messageService.startSpinner('Sending transaction...');\n        await this.sendTransaction(keys);\n        ModalComponent.currentModel.next({ name: '', data: null });\n      } else {\n        this.messageService.stopSpinner();\n        if (this.walletService.wallet instanceof TorusWallet) {\n          this.pwdInvalid = `Authorization failed`;\n        } else {\n          this.pwdInvalid = this.translate.instant('SENDCOMPONENT.WRONGPASSWORD'); // 'Wrong password!';\n        }\n      }\n    }\n  }\n  async sendTransaction(keys: KeyPair): Promise<void> {\n    const txs: FullyPreparedTransaction[] = this.opsWithCustomLimits();\n    this.subscriptions.add(\n      this.operationService.transfer(this.activeAccount.address, txs, Number(this.getTotalFee()), keys, this.tokenTransfer).subscribe(\n        async (ans: any) => {\n          this.sendResponse = ans;\n          if (ans.success === true) {\n            console.log('Transaction successful ', ans);\n            if (ans.payload.opHash) {\n              await this.messageService.stopSpinner();\n              this.operationResponse.emit(ans.payload.opHash);\n              const metadata = {\n                transactions: this.transactions,\n                opHash: ans.payload.opHash,\n                tokenTransfer: this.tokenTransfer\n              };\n              await this.coordinatorService.boost(this.activeAccount.address, metadata);\n              if (this.transactions[0].meta) {\n                this.torusNotification(this.transactions[0]);\n              }\n              for (const transaction of this.transactions) {\n                if (this.walletService.addressExists(transaction.destination)) {\n                  await this.coordinatorService.boost(transaction.destination);\n                }\n              }\n            } else if (this.walletService.wallet instanceof LedgerWallet) {\n              await this.requestLedgerSignature();\n              return;\n            }\n          } else {\n            await this.messageService.stopSpinner();\n            console.log('Transaction error id ', ans.payload.msg);\n            this.messageService.addError(ans.payload.msg, 0);\n            this.operationResponse.emit('broadcast_error');\n          }\n          this.reset();\n        },\n        (err) => {\n          this.messageService.stopSpinner();\n          console.log('Error Message ', JSON.stringify(err));\n          if (this.walletService.isLedgerWallet()) {\n            this.messageService.addError('Failed to create transaction', 0);\n            this.operationResponse.emit('broadcast_error');\n          }\n          this.reset();\n        }\n      )\n    );\n  }\n  opsWithCustomLimits(): FullyPreparedTransaction[] {\n    let extraGas: number = 0;\n    let extraStorage: number = 0;\n    if (this.customGasLimit && this.customGasLimit !== this.getTotalDefaultGas().toString()) {\n      extraGas = Number(this.customGasLimit) - this.getTotalDefaultGas();\n    }\n    if (this.customStorageLimit && this.customStorageLimit !== this.getTotalDefaultStorage().toString()) {\n      extraStorage = Number(this.customStorageLimit) - this.getTotalDefaultStorage();\n    }\n    const extraGasPerOp: number = Math.round(extraGas / this.transactions.length);\n    const extraStoragePerOp: number = Math.round(extraStorage / this.transactions.length);\n    const txs: FullyPreparedTransaction[] = [];\n    for (let i = 0; i < this.transactions.length; i++) {\n      let gasLimit: string = extraGas ? (Number(this.transactions[i].gasLimit) + extraGasPerOp).toString() : this.transactions[i].gasLimit.toString();\n      let storageLimit = extraStorage\n        ? (Number(this.transactions[i].storageLimit) + extraStoragePerOp).toString()\n        : this.transactions[i].storageLimit.toString();\n      gasLimit = !(Number(gasLimit) < 0) ? gasLimit : '0';\n      storageLimit = !(Number(storageLimit) < 0) ? storageLimit : '0';\n      const fullyTx: FullyPreparedTransaction = {\n        ...this.transactions[i],\n        fee: i === this.transactions.length - 1 ? this.getTotalFee().toString() : '0',\n        gasLimit,\n        storageLimit\n      };\n      txs.push(fullyTx);\n    }\n    return txs;\n  }\n  async requestLedgerSignature(): Promise<void> {\n    if (this.walletService.wallet instanceof LedgerWallet) {\n      await this.messageService.startSpinner('Waiting for Ledger signature...');\n      try {\n        const op = this.sendResponse.payload.unsignedOperation;\n        let signature = '';\n        if (op.length <= 2290) {\n          signature = await this.ledgerService.signOperation('03' + op, this.walletService.wallet.implicitAccounts[0].derivationPath);\n        } else {\n          signature = await this.ledgerService.signHash(\n            this.operationService.ledgerPreHash('03' + op),\n            this.walletService.wallet.implicitAccounts[0].derivationPath\n          );\n        }\n        if (signature) {\n          const signedOp = op + signature;\n          this.sendResponse.payload.signedOperation = signedOp;\n          this.ledgerError = '';\n        } else {\n          this.ledgerError = 'Failed to sign transaction';\n        }\n      } finally {\n        this.messageService.stopSpinner();\n      }\n    }\n  }\n  async broadCastLedgerTransaction(): Promise<void> {\n    this.subscriptions.add(\n      this.operationService.broadcast(this.sendResponse.payload.signedOperation).subscribe(async (ans: any) => {\n        this.sendResponse = ans;\n        if (ans.success && this.activeAccount) {\n          const metadata = {\n            transactions: this.transactions,\n            opHash: ans.payload.opHash,\n            tokenTransfer: this.tokenTransfer\n          };\n          if (this.transactions[0].meta) {\n            this.torusNotification(this.transactions[0]);\n          }\n          await this.coordinatorService.boost(this.activeAccount.address, metadata);\n          if (this.walletService.addressExists(this.transactions[0].destination)) {\n            await this.coordinatorService.boost(this.transactions[0].destination);\n          }\n          this.operationResponse.emit(ans.payload.opHash);\n        } else {\n          console.log('sendResponse', JSON.stringify(this.sendResponse));\n          this.operationResponse.emit('broadcast_error');\n        }\n        console.log('ans: ' + JSON.stringify(ans));\n        this.reset();\n      })\n    );\n  }\n  async torusNotification(transaction: FullyPreparedTransaction): Promise<void> {\n    if (transaction.meta) {\n      const amount = this.tokenService.formatAmount(this.tokenTransfer, transaction.amount.toString(), false);\n      if (transaction.meta.verifier === 'google') {\n        this.messageService.emailNotify(transaction.meta.alias, amount);\n        this.lookupService.add(transaction.destination, transaction.meta.alias, 2);\n      } else if (transaction.meta.verifier === 'reddit') {\n        this.messageService.redditNotify(transaction.meta.alias, amount);\n        this.lookupService.add(transaction.destination, transaction.meta.alias, 3);\n      } else if (transaction.meta.verifier === 'twitter') {\n        this.messageService.twitterNotify(transaction.meta.twitterId, transaction.meta.alias, amount);\n        this.lookupService.add(transaction.destination, transaction.meta.alias, 4);\n      }\n    }\n  }\n  getUsername(): string {\n    if (this.walletService.wallet instanceof TorusWallet) {\n      return this.walletService.wallet.displayName();\n    } else if (this.activeAccount) {\n      const party = this.lookupService.resolve({\n        address: this.activeAccount.address\n      });\n      if (party?.name) {\n        return party.name;\n      }\n    }\n    return '';\n  }\n  getVerifier(): string {\n    if (this.walletService.wallet instanceof TorusWallet) {\n      return this.walletService.wallet.verifier;\n    } else {\n      return 'domain';\n    }\n  }\n  previewAttention(): string {\n    if (this.transactions[0]?.meta?.verifier) {\n      if (!this.tokenTransfer && new Big(this.totalAmount()).gt('50')) {\n        let recipientKind = '';\n        switch (this.transactions[0].meta.verifier) {\n          case 'google':\n            recipientKind = 'Google account email address';\n            break;\n          case 'reddit':\n            recipientKind = 'Reddit username';\n            break;\n          case 'twitter':\n            recipientKind = 'Twitter handle';\n            break;\n          default:\n            recipientKind = 'information';\n        }\n        return `Carefully review the recipient's ${recipientKind}! Spelling mistakes can lead to permanent loss of the transferred funds.`;\n      }\n    }\n    return '';\n  }\n  // Only Numbers with Decimals\n  sanitizeNumberInput(e, type = ''): void {\n    console.dir(this.token?.decimals, e.target);\n    if (['gas', 'storage'].includes(type) || (type === 'amount' && this.token?.decimals == 0)) {\n      e.target.value = e.target.value.replace(/[^0-9]/g, '');\n    } else {\n      e.target.value = e.target.value.replace(/[^0-9\\.]/g, '');\n      if ((e.target.value.match(/\\./g) || []).length > 1) {\n        const tmp = e.target.value.split('');\n        tmp.splice(tmp.lastIndexOf('.'), 1);\n        e.target.value = tmp.join('');\n      }\n      if (e.target.value.charAt(0) === '.') {\n        e.target.value = '0' + e.target.value;\n      }\n    }\n  }\n  closeModalAction(emit: string = null): void {\n    ModalComponent.currentModel.next({ name: '', data: null });\n    this.operationResponse.emit(emit);\n    this.reset();\n  }\n  reset(init = false): void {\n    if (!init) {\n      this.confirmRequest = null;\n      if (this.syncSub) {\n        this.syncSub.unsubscribe();\n        this.syncSub = undefined;\n      }\n    }\n    this.tokenTransfer = '';\n    this.transactions = [];\n    this.activeAccount = null;\n\n    this.customFee = '';\n    this.customGasLimit = '';\n    this.customStorageLimit = '';\n\n    this.token = null;\n    this.domain = undefined;\n\n    this.parameters = null;\n    this.batchParamIndex = 0;\n    this.micheline = null;\n    this.batchParameters = [];\n    this.parametersFormat = 0;\n\n    this.showFullBatch = false;\n    this.sendResponse = null;\n    this.ledgerError = '';\n    this.password = '';\n    this.pwdInvalid = '';\n    this.advancedForm = false;\n    this.customFee = '';\n    this.externalReq = false;\n  }\n}\n","<div class=\"flex-row dropdown\" [class.expanded]=\"isOpen\" (click)=\"toggleDropdown()\" [id]=\"ecmpId\">\n  <img class=\"button icon-torus\"\n    [src]=\"torusVerifier === '' ? 'assets/img/tezos-xtz-logo.svg' :  'assets/img/' + torusVerifier.toLowerCase() + '-logo.svg'\" />\n  <input readonly [(ngModel)]=\"torusVerifierName\" /><img class=\"button icon-db\"\n    src=\"../../../assets/img/down-arrow.svg\" />\n  <div class=\"flex-column dropdown-content\">\n    <a [class.selected]=\"torusVerifierName === 'Tezos Address'\"\n      (click)=\"torusVerifier = ''; torusVerifierName = 'Tezos Address';\">\n      Tezos Address\n    </a>\n    <a [class.selected]=\"torusVerifierName === 'Tezos Domains'\"\n      (click)=\"torusVerifier = 'domain'; torusVerifierName = 'Tezos Domains'\">\n      Tezos Domains\n    </a>\n    <ng-container *ngFor=\"let key of torusService.verifierMapKeys\">\n      <ng-container *ngIf=\"torusService.verifierMap[key].lookups\">\n        <a [class.selected]=\"torusVerifierName === torusService.verifierMap[key].name\"\n          (click)=\"torusVerifier = key; torusVerifierName = torusService.verifierMap[key].name\">\n          {{ torusService.verifierMap[key].name }}\n        </a>\n      </ng-container>\n    </ng-container>\n  </div>\n</div>","import { Component, Input, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { TorusService } from '../../../../services/torus/torus.service';\nimport { DropdownComponent } from '../dropdown.component';\n\n@Component({\n  selector: 'app-ui-dropdown-prepare-send',\n  templateUrl: './prepare-send-dropdown.component.html',\n  styleUrls: ['../../../../../scss/components/ui/dropdown/prepare-send-dropdown.component.scss']\n})\nexport class PrepareSendDropdownComponent extends DropdownComponent implements OnInit {\n  @Input() torusVerifierName = 'Tezos Address';\n  @Input() torusVerifier = '';\n\n  constructor(public router: Router, public torusService: TorusService) {\n    super();\n  }\n\n  ngOnInit(): void {}\n\n  toggleDropdown(): void {\n    this.dropdownResponse.emit({\n      torusVerifierName: this.torusVerifierName,\n      torusVerifier: this.torusVerifier\n    });\n    this.isOpen = !this.isOpen;\n  }\n}\n","<div *ngIf=\"isOpen\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-row top\">\n      <div class=\"flex-row button close\" (click)=\"closeModalAction()\"><img class=\"x\"\n          src=\"../../../assets/img/close-btn-x.png\" /></div>\n      <h1 class=\"title\">{{ !isNFT ? getTitle() : 'Send Token'}}</h1>\n    </div>\n    <div class=\"flex-column prepare-send\">\n      <form autocomplete=\"off\">\n        <div *ngIf=\"!this.isMultipleDestinations\" class=\"flex-column top\">\n          <div *ngIf=\"isNFT\" class=\"flex-row token\">\n            <app-asset class=\"asset\" [priorityList]=\"['thumbnailAsset', 'displayAsset']\" [assets]=\"token\"></app-asset>\n            <span class=\"title\">{{token?.name}}</span>\n          </div>\n          <span *ngIf=\"!this.token || !(this.token?.isBooleanAmount || this.token?.balance == 1)\"\n            class=\"flex-row label title\">ENTER {{!isNFT ? 'AMOUNT' :\n            'QUANTITY'}}:</span>\n          <div *ngIf=\"!this.token || !(this.token?.isBooleanAmount || this.token?.balance == 1)\"\n            class=\"flex-row amount\">\n            <input #amountInput inputmode=\"decimal\" name=\"none\" [placeholder]=\"token?.decimals == 0 ? '0' : '0.00'\" [(ngModel)]=\"amount\"\n              name=\"none\" (mousedown)=\"sendMax = false; default\"\n              (input)=\"sanitizeNumberInput($event, 'amount'); amountChange()\"\n              (paste)=\"sanitizeNumberInput($event, 'amount')\" (change)=\"amountChange()\"\n              [disabled]=\"isMultipleDestinations\" />\n            <button *ngIf=\"!this.isMultipleDestinations\" tabindex=-1 class=\"small\" [class.max]=\"sendMax\"\n              (click)=\"sendEntireBalance($event)\">MAX</button>\n          </div>\n          <div class=\"flex-row fees\">\n            <span *ngIf=\"!tokenTransfer\" class=\"amount-usd\">\n              <span>USD:&nbsp;</span>{{'$' + (getTotalAmount() * walletService.wallet.XTZrate | number:'1.2-2' ||\n              '0.00')\n              }}\n            </span>\n            <span class=\"amount-fee\"><span>FEE{{ getTotalBurn() > 0 ? ' & STORAGE COST' : ''}}:&nbsp;</span><img\n                *ngIf=\"simSemaphore\" src=\"../../../../assets/img/feeLoader.gif\">{{ getTotalCost() != 0 ? (getTotalCost()\n              |\n              number:'1.0-6') + ' tez' : '--'\n              }}</span>\n          </div>\n        </div>\n      </form>\n      <form class=\"to\" autocomplete=\"off\">\n        <div *ngIf=\"!this.isMultipleDestinations\" class=\"flex-column\">\n          <span class=\"label title\">SEND TO:</span>\n          <div class=\"address\">\n            <div *ngIf=\"!toPkh\" class=\"flex-column tool\" id=\"paste\" (click)=\"pasteToPkh()\">\n              <img src=\"assets/img/paste.svg\" />\n            </div>\n            <app-qr-scanner *ngIf=\"!toPkh\" [override]=\"true\" class=\"flex-column tool\" id=\"qr\" (scanResponse)=\"handleScanResponse($event)\"></app-qr-scanner>\n            <app-ui-dropdown-prepare-send [torusVerifier]=\"torusVerifier\" [torusVerifierName]=\"torusVerifierName\"\n              (dropdownResponse)=\"dropdownResponse($event)\"></app-ui-dropdown-prepare-send>\n            <input type=\"text\" placeholder=\"Recipient\" class=\"text\" (input)=\"updateDefaultValues($event)\"\n              (change)=\"toPkhChange()\" name=\"toPkh\" [(ngModel)]=\"toPkh\">\n          </div>\n          <div class=\"flex-row address-display\">\n            <span [style.display]=\"!torusPendingLookup && torusLookupAddress ? '' : 'none'\">{{ torusLookupAddress\n              }}</span><span [style.display]=\"torusPendingLookup ? '' : 'none'\"><img\n                src=\"../../../../assets/img/feeLoader.gif\"></span>\n          </div>\n        </div>\n        <div *ngIf=\"this.isMultipleDestinations\" class=\"flex-column\">\n          <label class=\"label\">Addresses and amounts <span class=\"batchInfo\">{{ batchSpace() }}</span></label>\n          <textarea name=\"none\" type=\"text\" class=\"text\" (input)=\"updateDefaultValues()\" rows=\"3\"\n            [(ngModel)]=\"toMultipleDestinationsString\" name=\"none\"\n            placeholder=\"address1 amount1 ; &#10;address2 amount2 ; &#10;address3 ...\"></textarea>\n        </div>\n        <div class=\"flex-column\">\n          <app-ui-toggle-advanced style=\"width: calc(100% - 1.5em);margin: 1rem 0;\" [default]=\"false\"\n            (stateChange)=\"advancedForm = $event\"></app-ui-toggle-advanced>\n          <button *ngIf=\"!isNFT && advancedForm\" class=\"small multiple-destinations\" (click)=\"toggleDestination()\">\n            <span>\n              <ng-container *ngIf=\"!this.isMultipleDestinations\">Multiple transactions</ng-container>\n              <ng-container *ngIf=\"this.isMultipleDestinations\">Single transaction</ng-container>\n            </span>\n          </button>\n        </div>\n      </form>\n      <form autocomplete=\"off\" *ngIf=\"advancedForm\" class=\"flex-column advanced-form\">\n        <div class=\"flex-row\">\n          <div class=\"flex-column\">\n            <label class=\"label\">Gas limit</label>\n            <input inputmode=\"decimal\" name=\"none\" type=\"text\" class=\"text\" (input)=\"sanitizeNumberInput($event, 'gas')\"\n              (paste)=\"sanitizeNumberInput($event, 'gas')\" placeholder={{this.defaultTransactionParams.gas.toString()}}\n              [(ngModel)]=\"customGasLimit\" name=\"none\">\n          </div>\n          <div class=\"flex-column\">\n            <label class=\"label\">Fee</label>\n            <input inputmode=\"decimal\" name=\"none\" type=\"text\" (input)=\"sanitizeNumberInput($event); updateMaxAmount()\"\n              (paste)=\"sanitizeNumberInput($event); updateMaxAmount()\" class=\"text\"\n              placeholder={{this.defaultTransactionParams.fee.toString()}} [(ngModel)]=\"customFee\" name=\"none\">\n          </div>\n        </div>\n        <div class=\"flex-row\">\n          <div class=\"flex-column\">\n            <label class=\"label\">Storage limit</label>\n            <input inputmode=\"decimal\" name=\"none\" type=\"text\" (input)=\"sanitizeNumberInput($event, 'storage'); updateMaxAmount()\"\n              (paste)=\"sanitizeNumberInput($event, 'storage'); updateMaxAmount()\" class=\"text\"\n              placeholder={{this.defaultTransactionParams.storage.toString()}} [(ngModel)]=\"customStorageLimit\"\n              name=\"none\">\n          </div>\n          <div class=\"flex-column\">\n            <label class=\"label\">Max storage cost</label>\n            <input inputmode=\"decimal\" name=\"none\" type=\"text\" class=\"text read-only\" [value]=\"burnAmount() ? burnAmount() : '0 tez'\"\n              tabindex=-1 readonly>\n          </div>\n        </div>\n      </form>\n      <br />\n      <div class=\"flex-column bottom\">\n        <div class=\"seperator\"></div>\n        <span *ngIf=\"formInvalid !== ''\" class=\"label danger\">\n          {{ formInvalid }}\n        </span>\n        <button class=\"confirm\" (click)=\"preview()\">Preview</button>\n      </div>\n    </div>\n  </div>\n</div>","import { Component, OnInit, Input, ViewChild, ElementRef, Output, EventEmitter, OnChanges, SimpleChanges } from '@angular/core';\nimport { TokenService } from '../../../../services/token/token.service';\nimport { EstimateService } from '../../../../services/estimate/estimate.service';\nimport { DefaultTransactionParams } from '../../../../interfaces';\nimport { FullyPreparedTransaction, PartiallyPreparedTransaction, PrepareRequest } from '../../../misc/send/interfaces';\nimport { Account, ImplicitAccount, OriginatedAccount } from '../../../../services/wallet/wallet';\nimport { TorusService } from '../../../../services/torus/torus.service';\nimport Big from 'big.js';\nimport { TranslateService } from '@ngx-translate/core';\nimport { WalletService } from '../../../../services/wallet/wallet.service';\nimport { InputValidationService } from '../../../../services/input-validation/input-validation.service';\nimport assert from 'assert';\nimport { TezosDomainsService } from '../../../../services/tezos-domains/tezos-domains.service';\nimport { ModalComponent } from '../../modal.component';\nimport { TokenBalancesService } from '../../../../services/token-balances/token-balances.service';\n\nconst zeroTxParams: DefaultTransactionParams = {\n  gas: 0,\n  storage: 0,\n  fee: 0,\n  burn: 0\n};\n@Component({\n  selector: 'app-prepare-send',\n  templateUrl: './prepare-send.component.html',\n  styleUrls: ['../../../../../scss/components/modals/modal.scss']\n})\nexport class PrepareSendComponent extends ModalComponent implements OnInit, OnChanges {\n  @Input() prepareRequest: PrepareRequest = null;\n  @Output() prepareResponse = new EventEmitter();\n  @ViewChild('destType') public destType: ElementRef;\n  activeAccount: Account = null;\n  tokenTransfer: string = null;\n  token = null;\n  costPerByte: string = this.estimateService.costPerByte;\n\n  defaultTransactionParams: DefaultTransactionParams = zeroTxParams;\n  active = false;\n  isMultipleDestinations = false;\n  advancedForm = false;\n  hideAmount = false;\n  simSemaphore = 0;\n  isNFT = false;\n  accountDropdownIsOpen = false;\n\n  torusVerifierName = 'Tezos Address';\n  torusVerifier = '';\n  torusLookupId = '';\n  torusLookupAddress = '';\n  torusTwitterId = '';\n  torusPendingLookup = false;\n\n  transactions = [];\n  toMultipleDestinationsString = '';\n\n  formInvalid = '';\n  latestSimError = '';\n  prevEquiClass = '';\n\n  sendMax = null;\n\n  amount = '';\n  toPkh = '';\n  customFee = '';\n  customGasLimit = '';\n  customStorageLimit = '';\n\n  name = 'prepare-send';\n\n  constructor(\n    private tokenService: TokenService,\n    private estimateService: EstimateService,\n    public torusService: TorusService,\n    private translate: TranslateService,\n    private walletService: WalletService,\n    public tezosDomains: TezosDomainsService,\n    private inputValidationService: InputValidationService,\n    private tokenBalancesService: TokenBalancesService\n  ) {\n    super();\n  }\n\n  ngOnInit(): void {}\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes?.prepareRequest?.currentValue) {\n      this.reset(true);\n      this.tokenTransfer = changes.prepareRequest.currentValue.tokenTransfer ?? null;\n      this.token = this.tokenService.getAsset(this.tokenTransfer);\n      this.isNFT = this.tokenBalancesService.isNFT(this.token);\n      this.activeAccount = changes.prepareRequest.currentValue.account;\n      this.amount = !this.token || !(this.token?.isBooleanAmount || this.token?.balance == 1) ? '' : '1';\n      if (!this.isOpen) {\n        this.openModal();\n      }\n    }\n  }\n  openModal() {\n    ModalComponent.currentModel.next({ name: this.name, data: null });\n    this.estimateService.preLoadData(this.activeAccount.pkh, this.activeAccount.pk);\n  }\n  closeModalAction() {\n    this.prepareResponse.emit(null);\n    ModalComponent.currentModel.next({ name: '', data: null });\n    this.reset();\n  }\n\n  reset(init = false) {\n    if (!init) {\n      this.prepareRequest = null;\n    }\n\n    this.defaultTransactionParams = zeroTxParams;\n    this.active = false;\n    this.isMultipleDestinations = false;\n    this.advancedForm = false;\n    this.hideAmount = false;\n    this.simSemaphore = 0;\n\n    this.tokenTransfer = null;\n    this.token = null;\n    this.isNFT = null;\n    this.accountDropdownIsOpen = false;\n\n    this.transactions = [];\n    this.toMultipleDestinationsString = '';\n\n    this.formInvalid = '';\n    this.latestSimError = '';\n    this.prevEquiClass = '';\n    this.torusVerifierName = 'Tezos Address';\n    this.torusVerifier = '';\n\n    this.sendMax = null;\n\n    this.amount = '';\n    this.toPkh = '';\n    this.customFee = '';\n    this.customGasLimit = '';\n    this.customStorageLimit = '';\n    this.clearTorus();\n  }\n  getTitle(): string {\n    return `Send ${this.getAssetName(true)}`;\n  }\n  getAssetName(short = true): string {\n    if (this.tokenTransfer) {\n      return this.token?.symbol ?? this.token?.name ?? 'Unknown';\n    } else {\n      return !this.prepareRequest.symbol ? 'tez' : this.prepareRequest.symbol;\n    }\n  }\n  getTotalAmount(): string {\n    let totalSent = Big(0);\n    for (const tx of this.transactions) {\n      totalSent = totalSent.add(tx.amount);\n    }\n    return totalSent.toFixed();\n  }\n  getTotalCost(display: boolean = false): number | string {\n    const totalFee = Big(this.getTotalFee()).plus(Big(this.getTotalBurn())).toString();\n    if (display && totalFee === '0') {\n      return '-';\n    }\n    return Number(totalFee);\n  }\n  getTotalFee(): number {\n    if (this.customFee !== '' && Number(this.customFee)) {\n      return Number(this.customFee);\n    }\n    return Number(this.defaultTransactionParams.fee);\n  }\n  getTotalBurn(): number {\n    if (this.customStorageLimit !== '' && Number(this.customStorageLimit)) {\n      return Number(Big(this.customStorageLimit).mul(this.transactions.length).times(this.costPerByte).div(1000000).toString());\n    }\n    return this.defaultTransactionParams.burn;\n  }\n  burnAmount(): string {\n    const burn = this.customStorageLimit ? Number(Big(this.customStorageLimit).times(this.costPerByte).div(1000000)) : this.defaultTransactionParams.burn;\n    if (burn) {\n      return burn + ' tez';\n    }\n    return '';\n  }\n  amountChange(): void {\n    this.estimateFees();\n  }\n  async estimateFees(): Promise<void> {\n    console.log('estimate..');\n    const prevSimError = this.latestSimError;\n    this.latestSimError = '';\n    let txs: PartiallyPreparedTransaction[] = [];\n    try {\n      txs = this.getMinimalPreparedTxs();\n      this.transactions = txs;\n    } catch (e) {\n      console.log(e);\n    }\n    if (txs?.length) {\n      const equiClass = this.equiClass(this.activeAccount.address, txs);\n      if (this.prevEquiClass !== equiClass || (this.tokenTransfer && this.checkBalance())) {\n        this.latestSimError = '';\n        this.prevEquiClass = equiClass;\n        this.simSemaphore++; // Put lock on 'Preview and 'Send max'\n        const callback = (res) => {\n          if (res) {\n            if (res.error) {\n              this.formInvalid = res.error;\n              this.latestSimError = res.error;\n            } else {\n              this.defaultTransactionParams = res;\n              this.formInvalid = '';\n              this.latestSimError = '';\n              this.updateMaxAmount();\n            }\n          } else {\n            console.log('no res');\n          }\n          this.simSemaphore--;\n        };\n        this.estimateService.estimateTransactions(JSON.parse(JSON.stringify(txs)), this.activeAccount.address, this.tokenTransfer, callback);\n      } else {\n        this.latestSimError = prevSimError;\n        this.formInvalid = this.latestSimError;\n      }\n    } else {\n      this.latestSimError = prevSimError;\n      if (this.isMultipleDestinations ? !this.toMultipleDestinationsString : !this.toPkh) {\n        this.defaultTransactionParams = zeroTxParams;\n        this.updateMaxAmount();\n        this.prevEquiClass = '';\n      }\n    }\n  }\n  equiClass(sender: string, transactions: any): string {\n    let data = sender;\n    if (this.tokenTransfer) {\n      data += transactions[0].to + transactions[0].amount.toString();\n    } else {\n      for (const tx of transactions) {\n        data += tx.to;\n      }\n    }\n    return data;\n  }\n  /*\n    1. input validation\n      strict checks that\n    2. create basic transaction array\n  */\n  sanitizeNumberInput(e, type = ''): void {\n    console.dir(this.token?.decimals, e.target);\n    if (['gas', 'storage'].includes(type) || (type === 'amount' && this.token?.decimals == 0)) {\n      e.target.value = e.target.value.replace(/[^0-9]/g, '');\n    } else {\n      e.target.value = e.target.value.replace(/[^0-9\\.]/g, '');\n      if ((e.target.value.match(/\\./g) || []).length > 1) {\n        const tmp = e.target.value.split('');\n        tmp.splice(tmp.lastIndexOf('.'), 1);\n        e.target.value = tmp.join('');\n      }\n      if (e.target.value.charAt(0) === '.') {\n        e.target.value = '0' + e.target.value;\n      }\n    }\n  }\n  updateDefaultValues(ev?: any): void {\n    const val = ev?.target.value.trim();\n    if (val && !this.torusVerifier) {\n      if (this.inputValidationService.twitterAccount(val)) {\n        this.torusVerifier = 'twitter';\n        this.torusVerifierName = 'Twitter';\n      } else if (this.inputValidationService.tezosDomain(val)) {\n        this.torusVerifier = 'domain';\n        this.torusVerifierName = 'Tezos Domains';\n      }\n      ev.target.value = ev.target.value.trim();\n    }\n\n    if (!this.torusVerifier) {\n      this.estimateFees();\n      if (this.isMultipleDestinations) {\n        this.amount = this.getTotalAmount();\n      }\n    }\n  }\n  toPkhChange(): void {\n    if (this.torusVerifier) {\n      this.torusLookup();\n    }\n  }\n  // Will return PartiallyPreparedTransaction or throw an error\n  getMinimalPreparedTxs(finalCheck = false): PartiallyPreparedTransaction[] {\n    if (!this.isMultipleDestinations) {\n      if (this.torusVerifier) {\n        assert(!this.invalidTorusAccount(), this.invalidTorusAccount());\n        assert(this.torusReady(), 'Pending lookup');\n        this.checkTx(this.torusLookupAddress, this.amount, finalCheck);\n        const meta: any = {\n          verifier: this.torusVerifier,\n          alias: this.torusLookupId\n        };\n        if (this.torusTwitterId) {\n          meta.twitterId = this.torusTwitterId;\n        }\n        return [\n          {\n            kind: 'transaction',\n            destination: this.torusLookupAddress,\n            amount: this.amount ? this.amount : '0',\n            meta\n          }\n        ];\n      } else {\n        this.checkTx(this.toPkh, this.amount, finalCheck);\n      }\n      return [\n        {\n          kind: 'transaction',\n          destination: this.toPkh,\n          amount: this.amount ? this.amount : '0'\n        }\n      ];\n      //this.checkGasStorageFee();\n    } else {\n      return this.getBatch(finalCheck);\n      //assert(false, 'not supported yet')\n    }\n  }\n  checkTx(toPkh: string, amount: string, finalCheck: boolean): void {\n    assert(\n      this.torusVerifier || !(!this.inputValidationService.address(toPkh) || toPkh === this.activeAccount.address),\n      this.translate.instant('SENDCOMPONENT.INVALIDRECEIVERADDRESS')\n    );\n    assert(\n      !this.torusVerifier ||\n        !(!this.inputValidationService.torusAccount(this.toPkh, this.torusVerifier) || this.torusLookupAddress === this.activeAccount.address),\n      'Invalid recipient'\n    );\n    assert(\n      !(\n        !this.inputValidationService.amount(amount, this.token ? this.token.decimals : undefined) ||\n        (finalCheck && (amount === '0' || amount === '') && toPkh.slice(0, 3) !== 'KT1')\n      ),\n      this.translate.instant('SENDCOMPONENT.INVALIDAMOUNT')\n    );\n  }\n  getBatch(finalCheck = false): PartiallyPreparedTransaction[] {\n    const txs: PartiallyPreparedTransaction[] = this.toMultipleDestinationsString\n      .trim()\n      .split(';')\n      .map((row, i) => {\n        if (row.trim()) {\n          const cols = row\n            .trim()\n            .split(' ')\n            .map((col) => col.trim())\n            .filter((col) => col);\n          assert(cols?.length === 2, `Transaction ${i + 1} has invalid number of arguments. Expected 2, but got ${cols?.length}.`);\n          assert(this.inputValidationService.address(cols[0]), `Transaction ${i + 1} contains an invalid destination.`);\n          assert(this.inputValidationService.amount(cols[1]), `Transaction ${i + 1} contains an invalid amount.`);\n          this.checkTx(cols[0], cols[1], finalCheck);\n          const tx: PartiallyPreparedTransaction = {\n            kind: 'transaction',\n            destination: cols[0],\n            amount: cols[1]\n          };\n          return tx;\n        }\n      })\n      .filter((row) => row);\n    return txs;\n  }\n  getFullyPreparedTxs(): FullyPreparedTransaction[] {\n    assert(!this.simSemaphore && (!this.torusVerifier || this.torusReady()), this.formInvalid ? this.formInvalid : 'Awaiting request');\n    const minimalTxs = this.getMinimalPreparedTxs(true);\n    this.transactions = minimalTxs;\n    assert(this.inputValidationService.fee(this.customFee), 'Invalid fee');\n    assert(this.inputValidationService.gas(this.customGasLimit), 'Invalid gas limit');\n    assert(this.inputValidationService.gas(this.customStorageLimit), 'Invalid storage limit');\n    assert(!this.checkBalance(), this.checkBalance());\n    assert(minimalTxs.length === this.defaultTransactionParams.customLimits?.length, 'Simulation error');\n    return this.opsWithCustomLimits();\n  }\n  opsWithCustomLimits(): FullyPreparedTransaction[] {\n    let extraGas: number = 0;\n    let extraStorage: number = 0;\n    if (this.customGasLimit && this.customGasLimit !== this.defaultTransactionParams.gas.toString()) {\n      extraGas = Number(this.customGasLimit) - this.defaultTransactionParams.gas;\n    }\n    if (this.customStorageLimit && this.customStorageLimit !== this.defaultTransactionParams.storage.toString()) {\n      extraStorage = Number(this.customStorageLimit) - this.defaultTransactionParams.storage;\n    }\n    const extraGasPerOp: number = Math.round(extraGas / this.transactions.length);\n    const extraStoragePerOp: number = Math.round(extraStorage / this.transactions.length);\n    const txs: FullyPreparedTransaction[] = [];\n    for (let i = 0; i < this.transactions.length; i++) {\n      let gasLimit: string = extraGas\n        ? (Number(this.defaultTransactionParams.customLimits[i].gasLimit) + extraGasPerOp).toString()\n        : this.defaultTransactionParams.customLimits[i].gasLimit.toString();\n      let storageLimit = extraStorage\n        ? (Number(this.defaultTransactionParams.customLimits[i].storageLimit) + extraStoragePerOp).toString()\n        : this.defaultTransactionParams.customLimits[i].storageLimit.toString();\n      gasLimit = !(Number(gasLimit) < 0) ? gasLimit : '0';\n      storageLimit = !(Number(storageLimit) < 0) ? storageLimit : '0';\n      const fullyTx: FullyPreparedTransaction = {\n        ...this.transactions[i],\n        fee: i === this.transactions.length - 1 ? this.getTotalFee().toString() : '0',\n        gasLimit,\n        storageLimit\n      };\n      txs.push(fullyTx);\n    }\n    return txs;\n  }\n  invalidTorusAccount(): string {\n    const torusError = {\n      google: 'Invalid Google email address',\n      reddit: 'Invalid Reddit username',\n      twitter: 'Invalid Twitter username',\n      domain: 'Tezos Domains must be valid url'\n    };\n    if (!this.inputValidationService.torusAccount(this.toPkh, this.torusVerifier) && this.toPkh !== '') {\n      return torusError[this.torusVerifier];\n    }\n  }\n  sendEntireBalance(event: Event): void {\n    event.stopPropagation();\n    this.sendMax = true;\n    this.checkMaxAmount();\n    this.amountChange();\n  }\n  toggleDestination(): void {\n    this.defaultTransactionParams = zeroTxParams;\n    this.sendMax = false;\n    this.prevEquiClass = '';\n    this.isMultipleDestinations = !this.isMultipleDestinations;\n    this.transactions = [];\n    this.toMultipleDestinationsString = '';\n    this.formInvalid = '';\n    this.toPkh = '';\n    this.amount = '';\n    this.customFee = '';\n    this.customGasLimit = '';\n    this.customStorageLimit = '';\n    this.clearTorus();\n    this.updateDefaultValues();\n  }\n  clearTorus(): void {\n    this.torusVerifier = '';\n    this.torusPendingLookup = false;\n    this.torusLookupAddress = '';\n    this.torusLookupId = '';\n    this.torusTwitterId = '';\n  }\n  checkMaxAmount(): void {\n    if (this.sendMax) {\n      const max = this.maxToSend(this.activeAccount);\n      if (max.length && max.slice(0, 1) !== '-') {\n        this.amount = max;\n      } else {\n        this.amount = '0';\n      }\n    }\n  }\n  checkBalance(): string {\n    if (this.transactions.length > 0) {\n      if (this.activeAccount && this.activeAccount instanceof ImplicitAccount) {\n        const max = Big(this.maxToSend(this.activeAccount)).plus(this.tokenTransfer ? 0 : 0.000001);\n        let amount = Big(0);\n        for (const tx of this.transactions) {\n          amount = amount.plus(Big(tx.amount));\n        }\n        if (amount.gt(max)) {\n          return this.translate.instant('SENDCOMPONENT.TOOHIGHFEEORAMOUNT');\n        }\n      } else if (this.activeAccount && this.activeAccount instanceof OriginatedAccount) {\n        const maxKt = Big(this.maxToSend(this.activeAccount));\n        const maxTz = Big(this.maxToSend(this.walletService.wallet.getImplicitAccount(this.activeAccount.pkh))).plus(0.000001);\n        let amount = Big(0);\n        for (const tx of this.transactions) {\n          amount = amount.plus(Big(tx.amount));\n        }\n        if (amount.gt(maxKt)) {\n          return this.translate.instant('SENDCOMPONENT.TOOHIGHAMOUNT');\n        } else if (new Big('0').gt(maxTz)) {\n          return this.translate.instant('SENDCOMPONENT.TOOHIGHFEE');\n        }\n      }\n    }\n    return '';\n  }\n  updateMaxAmount(): void {\n    if (this.sendMax) {\n      const max = this.maxToSend(this.activeAccount);\n      let maxAmount = '0';\n      if (max.length && max.slice(0, 1) !== '-') {\n        maxAmount = max;\n      }\n      if (this.amount !== maxAmount) {\n        this.amount = maxAmount;\n      }\n    }\n  }\n  maxToSend(account: Account): string {\n    if (account && account instanceof ImplicitAccount && !this.tokenTransfer) {\n      let accountBalance = Big(account.balanceXTZ).div(1000000);\n      accountBalance = accountBalance.minus(this.customFee && Number(this.customFee) ? Number(this.customFee) : this.defaultTransactionParams.fee);\n      if (!this.isMultipleDestinations) {\n        accountBalance = accountBalance.minus(\n          this.customStorageLimit && Number(this.customStorageLimit)\n            ? Number(Big(this.customStorageLimit).times(this.costPerByte).div('1000000'))\n            : this.defaultTransactionParams.burn\n        );\n      } else {\n        accountBalance = accountBalance.minus(this.defaultTransactionParams.burn);\n      }\n      accountBalance = accountBalance.minus(0.000001); // dust\n      return accountBalance.toString();\n    } else {\n      if (this.tokenTransfer) {\n        if (account instanceof ImplicitAccount) {\n          return Big(account.getTokenBalance(this.tokenTransfer))\n            .div(10 ** this.token.decimals)\n            .toFixed();\n        }\n      } else {\n        return Big(account.balanceXTZ).div(1000000).toString();\n      }\n    }\n  }\n\n  async verifierChange(): Promise<void> {\n    this.torusLookupAddress = '';\n    if (this.torusVerifier) {\n      this.torusLookup();\n    } else {\n      this.formInvalid = '';\n      this.estimateFees();\n    }\n    // this.validateReceiverAddress();\n    // resimulate?\n  }\n  async torusLookup(): Promise<any> {\n    if (!this.torusService.verifierMapKeys.includes(this.torusVerifier) && this.torusVerifier !== 'domain') {\n      this.formInvalid = 'Invalid verifier';\n    } else if (this.invalidTorusAccount()) {\n      this.formInvalid = this.invalidTorusAccount();\n    } else if (this.toPkh) {\n      this.torusPendingLookup = true;\n      this.torusLookupId = this.toPkh;\n\n      const { pkh, twitterId } =\n        this.torusVerifier === 'domain'\n          ? await this.tezosDomains\n              .getAddressFromDomain(this.toPkh)\n              .then((ans) => {\n                if (ans?.pkh === '') {\n                  this.formInvalid = 'Could not find the domain';\n                }\n                return ans;\n              })\n              .catch((e) => {\n                console.error(e);\n                this.formInvalid = e;\n                return '';\n              })\n          : await this.torusService.lookupPkh(this.torusVerifier, this.toPkh).catch((e) => {\n              console.error(e);\n              this.formInvalid = e;\n              return '';\n            });\n\n      this.torusPendingLookup = false;\n      if (pkh) {\n        this.torusLookupAddress = pkh;\n        this.torusTwitterId = twitterId ? twitterId : '';\n        this.estimateFees();\n      } else {\n        this.torusLookupAddress = '';\n      }\n    }\n  }\n  batchSpace(txs = 0): boolean | string {\n    if (this.isMultipleDestinations && this.defaultTransactionParams.customLimits && this.defaultTransactionParams.customLimits.length) {\n      const numberOfTxs = txs ? txs : this.defaultTransactionParams.customLimits.length;\n      const txsLimit = 294 + (this.defaultTransactionParams.reveal ? 0 : 2); // Max transactions in a batch is 296 (294 with a reveal)\n      return !txs ? this.numberWithCommas(numberOfTxs + ' / ' + txsLimit) : numberOfTxs <= txsLimit;\n    }\n    return !txs ? '' : true;\n  }\n  numberWithCommas(x: string): string {\n    const parts: Array<string> = x.split('.');\n    parts[0] = parts[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',');\n    return parts.join('.');\n  }\n  torusReady(): boolean {\n    return !this.torusPendingLookup && this.torusLookupAddress !== '';\n  }\n  preview(): void {\n    let txs: FullyPreparedTransaction[];\n    try {\n      txs = this.getFullyPreparedTxs();\n      this.prepareResponse.emit(txs);\n      ModalComponent.currentModel.next({\n        name: 'confirm-send',\n        data: {\n          customFee: this.customFee,\n          customGasLimit: this.customGasLimit,\n          customStorageLimit: this.customStorageLimit\n        }\n      });\n      this.reset();\n    } catch (e) {\n      this.formInvalid = e.message;\n    }\n  }\n  dynSize(): string {\n    const size = this.amount ? this.amount.length : 0;\n    if (size < 7) {\n      return '5';\n    } else if (size < 9) {\n      return '4';\n    } else if (size < 12) {\n      return '3';\n    } else if (size < 17) {\n      return '2';\n    }\n    return '1.5';\n  }\n\n  dropdownResponse(data): void {\n    if (data?.torusVerifier !== this.torusVerifier) {\n      console.log(this.torusVerifier + ' -> ' + data.torusVerifier);\n      this.torusVerifier = data.torusVerifier;\n      this.torusVerifierName = data.torusVerifierName;\n      this.verifierChange();\n    }\n  }\n  pasteToPkh(): void {\n    navigator.clipboard.readText().then((clipText) => {\n      this.toPkh = clipText;\n      this.updateDefaultValues({ target: { value: this.toPkh } });\n    });\n  }\n  handleScanResponse(ev): void {\n    this.toPkh = ev?.pkh || '';\n    this.updateDefaultValues({ target: { value: this.toPkh } });\n  }\n}\n","<div *ngIf=\"active && template === 'gap'\" class=\"flex-column kukai-modal gap\">\n  <div class=\"content\">\n    <div class=\"flex-column top\">\n      <img class=\"flex-row button close\" (click)=\"cancel()\" src=\"../../../../assets/img/add-minterpop.svg\" />\n      <h1 class=\"title\">Confirmation</h1>\n    </div>\n    <div class=\"seperator\"></div>\n    <div class=\"flex-column confirm-send\">\n        <div class=\"asset-name\">{{ templateRequest.template.descriptions[0].text }}</div>\n        <div class=\"flex-row transaction\">\n          <div class=\"flex-column left\">\n            <span class=\"default-text\">Send</span>\n            <span class=\"default-text amount\">{{ (templateRequest.partialOps[0].amount | number:'1.0-6') + ' tez'\n              }}</span>\n            <span class=\"default-text\">USD&nbsp;{{'$' +\n              (templateRequest.partialOps[0].amount\n              *\n              walletService.wallet.XTZrate | number:'1.0-2')\n              }}</span>\n            <span class=\"default-text\">From:</span>\n            <div class=\"flex-row torus\" *ngIf=\"this.walletService.wallet.verifier\">\n              <img class=\"icon\" src=\"../../../assets/img/{{ this.walletService.wallet.verifier }}-logo.svg\">\n              <div class=\"flex-column\">\n                <span class=\"name\">{{ this.walletService.wallet.displayName() }}</span><span class=\"address\">{{\n                  activeAccount.address }}</span>\n              </div>\n            </div>\n            <span *ngIf=\"!this.walletService.wallet.verifier\" class=\"default-text single-to\">{{ activeAccount.address\n              }}</span>\n          </div>\n          <div *ngIf=\"templateRequest.template.descriptions[0]?.imgUrl\" class=\"flex-column right\">\n            <img class=\"token-image\" [src]=\"templateRequest.template.descriptions[0]?.imgUrl\" />\n          </div>\n        </div>\n      <br />\n      <div class=\"seperator\"></div>\n      <div class=\"flex-column bottom\">\n        <div class=\"flex-row default-text more-info\" [class]=\"showMore ? 'open' : ''\" (click)=\"toggle()\">{{ !showMore ?\n          'Show More' : 'Show Less' }}<img src=\"../../../../assets/img/gap-arrow.svg\"></div>\n        <div *ngIf=\"showMore\" class=\"info\">\n          <div class=\"flex-column\">\n            <div class=\"default-text\">\n              Send to:\n            </div>\n            <div class=\"default-text\">\n              {{ templateRequest.ops[0].destination }}\n            </div>\n          </div>\n          <div class=\"seperator\"></div>\n          <div class=\"flex-column\">\n            <div class=\"flex-row\">\n              <div class=\"default-text\">\n                Fee\n              </div>\n              <div class=\"default-text\">\n                {{ templateRequest.fee.network + ' tez' }}\n              </div>\n            </div>\n            <div class=\"flex-row\">\n              <div class=\"default-text\">\n                Max Storage Cost\n              </div>\n              <div class=\"default-text\">\n                {{ templateRequest.fee.storage + ' tez' }}\n              </div>\n            </div>\n          </div>\n          <div class=\"seperator\"></div>\n          <div class=\"flex-column\">\n            <div class=\"flex-row\">\n              <div class=\"default-text\">\n                Contract Call\n              </div>\n              <div class=\"default-text\">\n                {{ templateRequest.ops[0]?.parameters?.entrypoint }}\n              </div>\n            </div>\n            <br/>\n          </div>\n        </div>\n      </div>\n      <br />\n      <div class=\"flex-row buttons\">\n        <button (click)=\"approve()\" [disabled]=\"templateRequest?.partialOps?.length !== 1\">\n          <ng-container *ngIf=\"templateRequest.template.button; else defaultButtonText\">\n            {{templateRequest.template.button}}</ng-container>\n          <ng-template #defaultButtonText>PURCHASE</ng-template>\n        </button>\n      </div>\n      <div class=\"footer\">\n        <span>Powered by</span><img class=\"logo\" src=\"../../../../assets/img/header-logo-grey.svg\">\n      </div>\n    </div>\n  </div>\n</div>\n\n<div *ngIf=\"active && template === 'minterpop'\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-column top\">\n      <img class=\"flex-row button close\" (click)=\"cancel()\" src=\"../../../../assets/img/add-minterpop.svg\" />\n      <h1 class=\"title\">Confirmation</h1>\n    </div>\n    <div class=\"seperator\"></div>\n    <div class=\"flex-column confirm-send\">\n        <div class=\"asset-name\">{{ templateRequest.template.descriptions[0].text }}</div>\n        <div class=\"flex-row transaction\">\n          <div class=\"flex-column left\">\n            <span class=\"default-text\">Send</span>\n            <span class=\"default-text amount\">{{ (templateRequest.partialOps[0].amount | number:'1.0-6') + ' tez'\n              }}</span>\n            <span class=\"default-text\">USD&nbsp;{{'$' +\n              (templateRequest.partialOps[0].amount\n              *\n              walletService.wallet.XTZrate | number:'1.0-2')\n              }}</span>\n            <span class=\"default-text\">From:</span>\n            <div class=\"flex-row torus\" *ngIf=\"this.walletService.wallet.verifier\">\n              <img class=\"icon\" src=\"../../../assets/img/{{ this.walletService.wallet.verifier }}-logo.svg\">\n              <div class=\"flex-column\">\n                <span class=\"name\">{{ this.walletService.wallet.displayName() }}</span><span class=\"address\">{{\n                  activeAccount.address }}</span>\n              </div>\n            </div>\n            <span *ngIf=\"!this.walletService.wallet.verifier\" class=\"default-text single-to\">{{ activeAccount.address\n              }}</span>\n          </div>\n          <div *ngIf=\"templateRequest.template.descriptions[0]?.imgUrl\" class=\"flex-column right\">\n            <img class=\"token-image\" [src]=\"templateRequest.template.descriptions[0]?.imgUrl\" />\n          </div>\n        </div>\n      <br />\n      <div class=\"seperator\"></div>\n      <div class=\"flex-column bottom\">\n        <div class=\"flex-row default-text more-info\" [class]=\"showMore ? 'open' : ''\" (click)=\"toggle()\">{{ !showMore ?\n          'Show More' : 'Show Less' }}<img src=\"../../../../assets/img/dropdown-minterpop.svg\"></div>\n        <div *ngIf=\"showMore\" class=\"info\">\n          <div class=\"flex-column\">\n            <div class=\"default-text\">\n              Send to:\n            </div>\n            <div class=\"default-text\">\n              {{ templateRequest.ops[0].destination }}\n            </div>\n          </div>\n          <div class=\"seperator\"></div>\n          <div class=\"flex-column\">\n            <div class=\"flex-row\">\n              <div class=\"default-text\">\n                Fee\n              </div>\n              <div class=\"default-text\">\n                {{ templateRequest.fee.network + ' tez' }}\n              </div>\n            </div>\n            <div class=\"flex-row\">\n              <div class=\"default-text\">\n                Max Storage Cost\n              </div>\n              <div class=\"default-text\">\n                {{ templateRequest.fee.storage + ' tez' }}\n              </div>\n            </div>\n          </div>\n          <div class=\"seperator\"></div>\n          <div class=\"flex-column\">\n            <div class=\"flex-row\">\n              <div class=\"default-text\">\n                Contract Call\n              </div>\n              <div class=\"default-text\">\n                {{ templateRequest.ops[0]?.parameters?.entrypoint }}\n              </div>\n            </div>\n            <br/>\n          </div>\n        </div>\n      </div>\n      <br />\n      <div class=\"flex-row buttons\">\n        <button (click)=\"approve()\" [disabled]=\"templateRequest?.partialOps?.length !== 1\">\n          <ng-container *ngIf=\"templateRequest.template.button; else defaultButtonText\">\n            {{templateRequest.template.button}}</ng-container>\n          <ng-template #defaultButtonText>Send</ng-template>\n        </button>\n      </div>\n      <div class=\"footer\">\n        <span>Powered by</span><img class=\"logo\" src=\"../../../../assets/img/header-logo-grey.svg\">\n      </div>\n    </div>\n  </div>\n</div>\n\n\n<div *ngIf=\"active && template === 'default'\" class=\"kukai-template\">\n  <div *ngIf=\"templateRequest.template\" class=\"flex-column card\">\n    <H1>You are about to<BR><b\n        *ngIf=\"templateRequest.template.action; else defaultAction\">{{templateRequest.template.action}}</b>\n      <ng-template #defaultAction><b>send</b></ng-template>\n    </H1>\n    <ng-container *ngFor=\"let description of templateRequest.template.descriptions\">\n      <ng-container *ngIf=\"!description.imgUrl\">\n        <p class=\"single\" *ngIf=\"description.text\">{{ description.text }}</p>\n      </ng-container>\n      <ng-container *ngIf=\"description.imgUrl\">\n        <img *ngIf=\"description.imgUrl\" src=\"{{description.imgUrl}}\" height=\"150\">\n        <p class=\"img-text\" *ngIf=\"description.text\">{{description.text}}</p>\n      </ng-container>\n    </ng-container>\n    <div class=\"buttons\" [class.horizontally]=\"!templateRequest.template.buttonsVertically\"\n      [class.vertically]=\"templateRequest.template.buttonsVertically\">\n      <button class=\"secondary\" (click)=\"cancel()\">Cancel</button>\n      <button (click)=\"approve()\">\n        <ng-container *ngIf=\"templateRequest.template.button; else defaultButtonText\">\n          {{templateRequest.template.button}}</ng-container>\n        <ng-template #defaultButtonText>Send</ng-template>\n      </button>\n    </div>\n    <p class=\"fee\">Estimated fee <b *ngIf=\"templateRequest.fee\">{{templateRequest.fee.total}} tez</b><img\n        *ngIf=\"!templateRequest.fee\" src=\"../../../../assets/img/feeLoader.gif\"></p>\n    <div class=\"footer\">\n      <span>Powered by</span><img class=\"logo\" src=\"../../../../assets/img/header-logo-grey.svg\">\n    </div>\n  </div>\n</div>","import { Component, EventEmitter, Input, OnInit, Output, SimpleChanges, OnChanges } from '@angular/core';\nimport { TemplateRequest, TemplateFee, FullyPreparedTransaction } from '../../../misc/send/interfaces';\nimport { Template, BaseTemplate } from 'kukai-embed';\nimport { WalletService } from '../../../../services/wallet/wallet.service';\nimport { MessageService } from '../../../../services/message/message.service';\nimport { SubjectService } from '../../../../services/subject/subject.service';\n\n@Component({\n  selector: 'app-confirm-send-embed',\n  templateUrl: './confirm-send.component.html',\n  styleUrls: ['./confirm-send.component.scss']\n})\nexport class ConfirmSendEmbedComponent implements OnInit, OnChanges {\n  @Input() templateRequest: TemplateRequest = null;\n  @Output() isApproved = new EventEmitter();\n  @Input() activeAccount = null;\n  active = false;\n  showMore = false;\n  template = 'default';\n  constructor(public walletService: WalletService, public messageService: MessageService, private subjectService: SubjectService) {}\n\n  ngOnInit(): void {\n    this.subjectService.origin.subscribe((origin) => {\n      if (origin && origin.indexOf('gap') !== -1) {\n        // (m)interpop\n        this.template = 'gap';\n      } else if (origin && origin.indexOf('interpop') !== -1) {\n        // (m)interpop\n        this.template = 'minterpop';\n      } else {\n        this.template = 'default';\n      }\n    });\n  }\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes?.templateRequest?.currentValue) {\n      console.log(this.templateRequest);\n      if ((<BaseTemplate>this.templateRequest?.template)?.descriptions?.length) {\n        this.hideScrollbar();\n        this.active = true;\n      } else {\n        console.warn('No template descriptions');\n        this.cancel();\n      }\n    }\n  }\n  cancel() {\n    this.reset();\n    this.isApproved.emit(null);\n  }\n  approve() {\n    if (this.templateRequest.ops && this.templateRequest.fee) {\n      this.isApproved.emit(this.templateRequest.ops);\n      this.reset();\n    }\n  }\n  toggle() {\n    if (this.templateRequest.ops) {\n      this.showMore = !this.showMore;\n    }\n  }\n  reset() {\n    this.resetScrollbar();\n    this.active = false;\n  }\n  hideScrollbar() {\n    const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\n    document.body.style.marginRight = scrollBarWidth.toString();\n    document.body.style.overflow = 'hidden';\n  }\n  resetScrollbar() {\n    document.body.style.marginRight = '';\n    document.body.style.overflow = '';\n  }\n}\n","<div *ngIf=\"isOpen\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-column top\">\n      <div class=\"flex-row button close\" (click)=\"closeModalAction()\"><img class=\"x\"\n          src=\"../../../../../assets/img/close-btn-x.png\" />\n      </div>\n      <h1 class=\"title\">Confirmation</h1>\n    </div>\n    <div class=\"flex-column liquidity-baking-confirm\">\n      <ng-container *ngIf=\"entrypoint === 'addLiquidity'\">\n        <div class=\"flex-column container-inputs alt from\">\n          <div class=\"flex-row currency from\">\n            <span class=\"amount\">{{ expectedXtz | number:'1.0-6' }}</span>\n            <div class=\"flex-row left\">\n              <span class=\"symbol\">{{ 'XTZ' }}</span>\n              <img [src]=\"'assets/img/tezos-xtz-logo.svg'\" />\n            </div>\n          </div>\n          <div class=\"seperator arrow plus\">\n            <span class=\"img-wrap\"><img [src]=\"semaphore ? 'assets/img/feeLoader.gif' : 'assets/img/lb-plus.svg'\" /></span>\n          </div>\n          <div class=\"flex-row currency from\">\n            <span class=\"amount\">{{ expectedToken | number:'1.0-8' }}</span>\n            <div class=\"flex-row left\">\n              <span class=\"symbol\">{{ 'tzBTC' }}</span>\n              <img [src]=\"'assets/img/tokens/tzbtc.png'\" />\n            </div>\n          </div>\n        </div>\n        <div class=\"seperator arrow\">\n          <div class=\"backdrop\"></div>\n          <span class=\"img-wrap\"><img [src]=\"semaphore ? 'assets/img/feeLoader.gif' : 'assets/img/lb-down-arrow.svg'\" /></span>\n        </div>\n        <div class=\"flex-column container-inputs alt to\">\n          <div class=\"flex-row currency to\">\n            <span class=\"amount\"> {{ expectedLqd ? (expectedLqd | number:'1.0-0') : \"&nbsp;\" }}</span>\n            <div class=\"flex-row left\">\n              <span class=\"symbol\">{{ 'LBT' }}</span>\n              <img [src]=\"'assets/img/tokens/lbt.png'\" />\n            </div>\n          </div>\n        </div>\n      </ng-container>\n      <ng-container *ngIf=\"entrypoint === 'removeLiquidity'\">\n        <div class=\"flex-column container-inputs alt from\">\n          <div class=\"flex-row currency from\">\n            <span class=\"amount\">{{ expectedLqd | number:'1.0-0' }}</span>\n            <div class=\"flex-row left\">\n              <span class=\"symbol\">{{ 'LBT' }}</span>\n              <img [src]=\"'assets/img/tokens/lbt.png'\" />\n            </div>\n          </div>\n        </div>\n        <div class=\"seperator arrow\">\n          <div class=\"backdrop\"></div>\n          <span class=\"img-wrap\"><img [src]=\"semaphore ? 'assets/img/feeLoader.gif' : 'assets/img/lb-down-arrow.svg'\" /></span>\n        </div>\n        <div class=\"flex-column container-inputs alt to\">\n          <div class=\"flex-row currency to\">\n            <span class=\"amount\"> {{expectedXtz ? (expectedXtz | number:'1.0-6') : \"&nbsp;\"}}</span>\n            <div class=\"flex-row left\">\n              <span class=\"symbol\">{{ 'XTZ' }}</span>\n              <img [src]=\"'assets/img/tezos-xtz-logo.svg'\" />\n            </div>\n          </div>\n          <div class=\"seperator arrow plus\">\n            <span class=\"img-wrap\"><img [src]=\"semaphore ? 'assets/img/feeLoader.gif' : 'assets/img/lb-plus.svg'\" /></span>\n          </div>\n          <div class=\"flex-row currency to\">\n            <span class=\"amount\"> {{expectedToken ? (expectedToken | number:'1.0-8') : \"&nbsp;\"}}</span>\n            <div class=\"flex-row left\">\n              <span class=\"symbol\">{{ 'tzBTC' }}</span>\n              <img [src]=\"'assets/img/tokens/tzbtc.png'\" />\n            </div>\n          </div>\n        </div>\n      </ng-container>\n      <ng-container *ngIf=\"entrypoint === 'xtzToToken'\">\n        <div class=\"flex-column container-inputs\">\n          <div *ngIf=\"expectedXtz\" class=\"flex-row currency from\">\n            <span class=\"amount\">{{expectedXtz | number:'1.0-6'}}</span>\n            <div class=\"flex-row left\">\n              <span class=\"symbol\">{{ 'XTZ' }}</span>\n              <img [src]=\"'assets/img/tezos-xtz-logo.svg'\" />\n            </div>\n          </div>\n          <div class=\"seperator arrow\">\n            <div class=\"backdrop\"></div>\n            <span class=\"img-wrap\"><img [src]=\"semaphore ? 'assets/img/feeLoader.gif' : 'assets/img/lb-down-arrow.svg'\" /></span>\n          </div>\n          <div class=\"flex-row currency to\">\n            <span class=\"amount\"> {{expectedToken ? (expectedToken | number:'1.0-8') : \"&nbsp;\"}}</span>\n            <div class=\"flex-row left\">\n              <span class=\"symbol\">{{ 'tzBTC' }}</span>\n              <img [src]=\"'assets/img/tokens/tzbtc.png'\" />\n            </div>\n            <span class=\"flex-row hint\">Expected</span>\n          </div>\n        </div>\n      </ng-container>\n      <ng-container *ngIf=\"entrypoint === 'tokenToXtz'\">\n        <div class=\"flex-column container-inputs\">\n          <div class=\"flex-row currency from\">\n            <span class=\"amount\">{{expectedToken | number:'1.0-8'}}</span>\n            <div class=\"flex-row left\">\n              <span class=\"symbol\">{{ 'tzBTC' }}</span>\n              <img [src]=\"'assets/img/tokens/tzbtc.png'\" />\n            </div>\n          </div>\n          <div class=\"seperator arrow\">\n            <div class=\"backdrop\"></div>\n            <span class=\"img-wrap\"><img [src]=\"semaphore ? 'assets/img/feeLoader.gif' : 'assets/img/lb-down-arrow.svg'\" /></span>\n          </div>\n          <div class=\"flex-row currency to\">\n            <span class=\"amount\"> {{expectedXtz ? (expectedXtz | number:'1.0-6') : \"&nbsp;\"}}</span>\n            <div class=\"flex-row left\">\n              <span class=\"symbol\">{{ 'XTZ' }}</span>\n              <img [src]=\"'assets/img/tezos-xtz-logo.svg'\" />\n            </div>\n            <span class=\"flex-row hint\">Expected</span>\n          </div>\n        </div>\n      </ng-container>\n      <div class=\"output\">\n        <div *ngIf=\"minimumToken && !minimumXtz\" class=\"flex-row item\">\n          <span class=\"flex-row key\">Minimum Received:&nbsp;\n          </span>\n          <img src=\"assets/img/information-circle-outline.svg\" class=\"info-button\" />\n          <div class=\"body\">\n            The minimum amount you are guaranteed to receive. If the exchange rate changes unfavorably such that you can no longer receive at least this amount, then your transaction will not be completed.\n          </div>\n          <span class=\"value\">{{minimumToken | number:'1.2-8'}} tzBTC</span>\n        </div>\n        <div *ngIf=\"minimumXtz && !minimumToken\" class=\"flex-row item\">\n          <span class=\"flex-row key\">Minimum Received:&nbsp;\n          </span>\n          <img src=\"assets/img/information-circle-outline.svg\"\n              class=\"info-button\" />\n          <div class=\"body\">\n            The minimum amount you are guaranteed to receive. If the exchange rate changes unfavorably such that you can no longer receive at least this amount, then your transaction will not be completed.\n          </div>\n          <span class=\"value\">{{minimumXtz | number:'1.6-6'}} XTZ</span>\n        </div>\n        <div\n          *ngIf=\"minimumXtz && minimumToken\"\n          class=\"item\">\n          <span class=\"flex-row key\" style=\"margin: 0 0 0.5em 0\">Minimum Received:&nbsp;\n          </span>\n          <img src=\"assets/img/information-circle-outline.svg\" class=\"info-button\" />\n          <div class=\"body\">\n            The minimum amount you are guaranteed to receive. If the exchange rate changes unfavorably such that you can no longer receive at least this amount, then your transaction will not be completed.\n          </div>\n          <span class=\"value\">{{minimumXtz | number:'1.6-6'}} XTZ + {{\n            minimumToken | number:'1.2-8'}} tzBTC</span>\n        </div>\n        <div *ngIf=\"minimumLqd\" class=\"flex-row item\">\n          <span class=\"flex-row key\">Minimum Received:&nbsp;\n          </span>\n          <img src=\"assets/img/information-circle-outline.svg\" class=\"info-button\" />\n          <div class=\"body\">\n            The minimum amount you are guaranteed to receive. If the exchange rate changes unfavorably such that you can no longer receive at least this amount, then your transaction will not be completed.\n          </div>\n          <span class=\"value\">{{minimumLqd | number:'1.0-0'}} LBT</span>\n        </div>\n        <div class=\"flex-row item\">\n          <span class=\"flex-row key\">Fee:</span>\n          <span class=\"value\">&nbsp;{{getTotalFee() | number:'1.0-6'}} tez</span>\n        </div>\n        <div class=\"flex-row item\" *ngIf=\"getTotalBurn(); let storageCost\">\n          <span class=\"flex-row key\">Max Storage Cost:</span>\n          <span class=\"value\">&nbsp;{{storageCost | number:'1.0-6'}} tez</span>\n        </div>\n      </div>\n      <div *ngIf=\"(externalReq && (!walletService.isLedgerWallet() || ledgerError))\" class=\"flex-column more-info-toggle\" [class.expanded]=\"advancedForm\">\n        <div class=\"flex-row item\" (click)=\"advancedForm = !advancedForm\">\n          <span class=\"value\">{{ 'Advanced' }}</span>\n          <div class=\"flex-row\"><img src=\"assets/img/chevron-down.svg\"></div>\n        </div>\n      </div>\n      <form *ngIf=\"advancedForm && (externalReq && (!walletService.isLedgerWallet() || ledgerError))\" autocomplete=\"off\" class=\"more-info-body\" [class.expanded]=\"advancedForm\">\n        <div class=\"flex-row\">\n          <div class=\"flex-column entity\">\n            <label class=\"label\">Gas limit</label>\n            <input type=\"text\" inputmode=\"decimal\" class=\"text\" (input)=\"sanitizeNumberInput($event, 0, 'customGasLimit')\"\n              (paste)=\"sanitizeNumberInput($event, 0, 'customGasLimit')\" [placeholder]=\"getTotalDefaultGas() || '0'\"\n              [value]=\"customGasLimit\">\n          </div>\n          <div class=\"flex-column entity\">\n            <label class=\"label\">Fee</label>\n            <input type=\"text\" inputmode=\"decimal\" class=\"text\" [placeholder]=\"getTotalFee() || '0'\" (paste)=\"sanitizeNumberInput($event, 6, 'customFee')\"\n              (input)=\"sanitizeNumberInput($event, 6, 'customFee')\" [value]=\"customFee\">\n          </div>\n        </div>\n        <div class=\"flex-row\">\n          <div class=\"flex-column entity\">\n            <label class=\"label\">Storage limit</label>\n            <input type=\"text\" inputmode=\"decimal\" class=\"text\" (input)=\"sanitizeNumberInput($event, 0, 'customStorageLimit')\"\n              (paste)=\"sanitizeNumberInput($event, 0, 'customStorageLimit')\" [placeholder]=\"getTotalDefaultStorage() || '0'\"\n              [value]=\"customStorageLimit\">\n          </div>\n          <div class=\"flex-column entity\">\n            <label class=\"label\">Max storage cost</label>\n            <input type=\"text\" inputmode=\"decimal\" class=\"text read-only\" [placeholder]=\"(getTotalBurn() || '0') + ' tez'\" tabindex=-1\n              readonly>\n          </div>\n        </div>\n      </form>\n      <div class=\"flex-column bottom\">\n        <div class=\"seperator\"></div>\n        <span class=\"form-validity\" [class.error]=\"formInvalid !== 'Awaiting Request'\">{{ formInvalid }}</span>\n        <button *ngIf=\"walletService.isLedgerWallet() && ledgerError; else elseBlock\" class=\"confirm\"\n          [disabled]=\"!!formInvalid\" (click)=\"ledgerRetry()\">Sign with Ledger</button>\n        <ng-template #elseBlock>\n          <span *ngIf=\"this.pwdInvalid\" class=\"label danger\">{{ pwdInvalid }}</span>\n          <input *ngIf=\"walletService.isPwdWallet()\" [(ngModel)]=\"password\" autocomplete=\"current-password\"\n            placeholder=\"Password\" class=\"text password\" type=\"password\" (input)=\"this.pwdInvalid = ''\"\n            (change)=\"this.pwdInvalid = ''\" (keydown.enter)='inject()'>\n          <button class=\"confirm\" (click)=\"inject()\"\n            [disabled]=\"(walletService.isLedgerWallet() && (!sendResponse || !sendResponse.payload || !sendResponse.payload.signedOperation)) || walletService.isWatchWallet()\">\n            {{ walletService.isLedgerWallet() ? 'Broadcast' : confirmTitle}}</button>\n        </ng-template>\n      </div>\n    </div>\n  </div>\n</div>","import { EventEmitter, Input, OnChanges, OnDestroy, Output } from '@angular/core';\nimport { Component, OnInit, SimpleChanges } from '@angular/core';\nimport { ConfirmSwapRequest, FullyPreparedTransaction, PrepareRequest, LqdEntrypoints, PartiallyPreparedTransaction } from '../../misc/send/interfaces';\nimport { TokenService } from '../../../services/token/token.service';\nimport { WalletService } from '../../../services/wallet/wallet.service';\nimport { EstimateService } from '../../../services/estimate/estimate.service';\nimport { OperationService } from '../../../services/operation/operation.service';\nimport { MessageService } from '../../../services/message/message.service';\nimport { CoordinatorService } from '../../../services/coordinator/coordinator.service';\nimport { LookupService } from '../../../services/lookup/lookup.service';\nimport { LedgerService } from '../../../services/ledger/ledger.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport { DefaultTransactionParams, KeyPair } from '../../../interfaces';\nimport Big from 'big.js';\nimport { LedgerWallet, TorusWallet } from '../../../services/wallet/wallet';\nimport { InputValidationService } from '../../../services/input-validation/input-validation.service';\nimport { ModalComponent } from '../modal.component';\nimport { Subscription } from 'rxjs';\nimport { TezosDomainsService } from '../../../services/tezos-domains/tezos-domains.service';\nimport { TokenBalancesService } from '../../../services/token-balances/token-balances.service';\nimport { SubjectService } from '../../../services/subject/subject.service';\nimport { Amount } from '../../../services/swap-liquidity/classes/Amount';\nimport assert from 'assert';\nimport { SwapLiquidityService } from '../../../services/swap-liquidity/swap-liquidity.service';\n\nconst zeroTxParams: DefaultTransactionParams = {\n  gas: 0,\n  storage: 0,\n  fee: 0,\n  burn: 0\n};\n\n@Component({\n  selector: 'app-swap-liquidity-confirm',\n  templateUrl: './swap-liquidity-confirm.component.html',\n  styleUrls: ['../../../../scss/components/modals/modal.scss']\n})\nexport class SwapLiquidityConfirmComponent extends ModalComponent implements OnInit, OnChanges, OnDestroy {\n  readonly lqdTokenContract = 'KT1AafHA1C1vk959wvHWBispY9Y2f3fxBUUo';\n  readonly lqdContract = 'KT1TxqZ8QtKvLu3V3JH7Gx58n7Co8pgtpQU5';\n  readonly tzBTCContract = 'KT1PWx2mnDueood7fEmfbBDKx1D9BAnnXitn';\n\n  @Input() confirmRequest: PrepareRequest = null;\n  @Output() operationResponse = new EventEmitter();\n  syncSub: Subscription;\n  activeAccount = null;\n  externalReq: boolean = false;\n  transactions: FullyPreparedTransaction[] = [];\n  semaphore = false;\n\n  defaultTransactionParams: DefaultTransactionParams = zeroTxParams;\n\n  customFee = '';\n  customGasLimit = '';\n  customStorageLimit = '';\n\n  sendResponse = null;\n  ledgerError = '';\n  password = '';\n  pwdInvalid = '';\n  advancedForm = false;\n  name = 'swap-liquidity-confirm';\n\n  expectedLqd: number;\n  minimumLqd: number;\n  expectedXtz: number;\n  minimumXtz: number;\n  expectedToken: number;\n  minimumToken: number;\n  entrypoint: string;\n\n  confirmTitle = '';\n\n  private subscriptions: Subscription = new Subscription();\n\n  constructor(\n    private translate: TranslateService,\n    public tokenService: TokenService,\n    public walletService: WalletService,\n    private estimateService: EstimateService,\n    private operationService: OperationService,\n    private messageService: MessageService,\n    private coordinatorService: CoordinatorService,\n    private lookupService: LookupService,\n    private ledgerService: LedgerService,\n    private inputValidationService: InputValidationService,\n    public tezosDomainService: TezosDomainsService,\n    public tokenBalanceService: TokenBalancesService,\n    private subjectService: SubjectService,\n    private swapLiquidityService: SwapLiquidityService\n  ) {\n    super();\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes?.confirmRequest?.currentValue) {\n      this.reset(true);\n      this.parseTransactions(changes.confirmRequest.currentValue);\n      this.init();\n      ModalComponent.currentModel.next({ name: this.name, data: null });\n      if (this.externalReq) {\n        this.syncSub = this.subjectService.beaconResponse.subscribe((response) => {\n          if (response) {\n            this.closeModalAction('silent');\n          }\n        });\n      }\n    }\n  }\n  parseTransactions(csr: ConfirmSwapRequest): void {\n    let hasTrailingZeroApproval = false;\n    this.externalReq = csr.externalReq;\n    this.activeAccount = csr.account;\n    this.transactions = csr.transactions;\n    this.entrypoint = this.transactions.find((t) => Object.values(LqdEntrypoints).includes(t?.parameters?.entrypoint))?.parameters.entrypoint;\n    switch (this.entrypoint) {\n      case LqdEntrypoints.xtzToToken:\n        this.confirmTitle = 'Confirm Swap';\n        this.expectedXtz = parseFloat(this.transactions[0]?.amount);\n        this.minimumToken = new Amount({ rpcAmount: this.transactions[0]?.parameters.value.args[1].args[0].int, decimalPlaces: 8 }).internalNormalised;\n        this.calculateXtzToToken();\n        break;\n      case LqdEntrypoints.tokenToXtz:\n        this.confirmTitle = 'Confirm Swap';\n        const tokenToXtz = this.transactions.find((t) => t?.parameters?.entrypoint === LqdEntrypoints.tokenToXtz);\n        hasTrailingZeroApproval =\n          this.transactions[this.transactions.length - 1].parameters.entrypoint === 'approve' &&\n          this.transactions[this.transactions.length - 1]?.parameters?.value.args[1].int === '0';\n        this.expectedToken = new Amount({ rpcAmount: tokenToXtz?.parameters.value.args[1].args[0].int, decimalPlaces: 8 }).internalNormalised;\n        this.minimumXtz = new Amount({ rpcAmount: tokenToXtz?.parameters.value.args[1].args[1].args[0].int, decimalPlaces: 6 }).internalNormalised;\n        this.calculateTokenToXTZ();\n        break;\n      case LqdEntrypoints.addLiquidity:\n        this.confirmTitle = 'Add Liquidity';\n        const addLiquidity = this.transactions.find((t) => t?.parameters?.entrypoint === LqdEntrypoints.addLiquidity);\n        hasTrailingZeroApproval =\n          this.transactions[this.transactions.length - 1].parameters.entrypoint === 'approve' &&\n          this.transactions[this.transactions.length - 1]?.parameters?.value.args[1].int === '0';\n        this.expectedToken = new Amount({ rpcAmount: addLiquidity?.parameters.value.args[1].args[1].args[0].int, decimalPlaces: 8 }).internalNormalised;\n        this.expectedXtz = parseFloat(addLiquidity?.amount);\n        this.minimumLqd = new Amount({ rpcAmount: addLiquidity?.parameters.value.args[1].args[0].int, decimalPlaces: 0 }).internalNormalised;\n        this.calcAddLiquidity();\n        break;\n      case LqdEntrypoints.removeLiquidity:\n        this.confirmTitle = 'Remove Liquidity';\n        this.expectedLqd = new Amount({ rpcAmount: this.transactions[0]?.parameters.value.args[1].args[0].int, decimalPlaces: 0 }).internalNormalised;\n        this.minimumXtz = new Amount({ rpcAmount: this.transactions[0]?.parameters.value.args[1].args[1].args[0].int, decimalPlaces: 6 }).internalNormalised;\n        this.minimumToken = new Amount({\n          rpcAmount: this.transactions[0]?.parameters.value.args[1].args[1].args[1].args[0].int,\n          decimalPlaces: 8\n        }).internalNormalised;\n        this.calcRemoveLiquidity();\n        break;\n    }\n  }\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n  open(): void {\n    super.open();\n  }\n  async init(): Promise<void> {\n    if (this.walletService.wallet instanceof LedgerWallet) {\n      this.ledgerError = '?';\n    }\n  }\n  getTotalAmount(): string {\n    let totalSent = Big(0);\n    for (const tx of this.transactions) {\n      totalSent = totalSent.add(tx.amount);\n    }\n    return totalSent.toFixed();\n  }\n  getTotalCost(display: boolean = false): string {\n    const totalFee = Big(this.getTotalFee()).plus(Big(this.getTotalBurn())).toString();\n    if (display && totalFee === '0') {\n      return '-';\n    }\n    return totalFee;\n  }\n  getTotalFee(): string {\n    if (this.customFee) {\n      return this.customFee;\n    }\n    let totalFee = Big(0);\n    for (const tx of this.transactions) {\n      totalFee = totalFee.add(tx.fee ? tx.fee : 0);\n    }\n    return totalFee.toFixed();\n  }\n  getTotalBurn(): number {\n    const totalActiveStorageLimit: number =\n      this.customStorageLimit !== '' && Number(this.customStorageLimit) ? Number(this.customStorageLimit) : this.getTotalDefaultStorage();\n    return Number(Big(totalActiveStorageLimit).times(this.estimateService.costPerByte).div(1000000).toString());\n  }\n  getTotalDefaultGas(): number {\n    let totalGas = Big(0);\n    for (const tx of this.transactions) {\n      totalGas = totalGas.plus(tx.gasLimit);\n    }\n    return totalGas.toFixed();\n  }\n  getTotalDefaultStorage(): number {\n    let totalStorage = Big(0);\n    for (const tx of this.transactions) {\n      totalStorage = totalStorage.plus(tx.storageLimit);\n    }\n    return totalStorage.toFixed();\n  }\n  totalAmount(): string {\n    let totalSent = Big(0);\n    for (const tx of this.transactions) {\n      totalSent = totalSent.add(tx.amount);\n    }\n    return totalSent.toFixed();\n  }\n  async ledgerRetry(): Promise<void> {\n    if (!this.inputValidationService.fee(this.getTotalFee().toString())) {\n      this.messageService.addError('Invalid fee');\n      return;\n    }\n    this.messageService.startSpinner('Preparing transaction...');\n    const keys = await this.walletService.getKeys('');\n    if (keys) {\n      await this.sendTransaction(keys);\n    } else {\n      this.messageService.stopSpinner();\n    }\n  }\n  async inject(): Promise<void> {\n    if (this.semaphore) {\n      return;\n    }\n    if (this.walletService.isLedgerWallet()) {\n      await this.broadCastLedgerTransaction();\n      this.sendResponse = null;\n      ModalComponent.currentModel.next({ name: '', data: null });\n    } else {\n      if (!this.inputValidationService.fee(this.getTotalFee().toString())) {\n        this.messageService.addError('Invalid fee');\n        return;\n      }\n      const pwd = this.password;\n      this.password = '';\n      this.messageService.startSpinner('Signing transaction...');\n      let keys;\n      try {\n        keys = await this.walletService.getKeys(pwd, this.activeAccount.pkh);\n      } catch {\n        this.messageService.stopSpinner();\n      }\n      if (keys) {\n        this.pwdInvalid = '';\n        this.messageService.startSpinner('Sending transaction...');\n        await this.sendTransaction(keys);\n        ModalComponent.currentModel.next({ name: '', data: null });\n      } else {\n        this.messageService.stopSpinner();\n        if (this.walletService.wallet instanceof TorusWallet) {\n          this.pwdInvalid = `Authorization failed`;\n        } else {\n          this.pwdInvalid = this.translate.instant('SENDCOMPONENT.WRONGPASSWORD'); // 'Wrong password!';\n        }\n      }\n    }\n  }\n  async sendTransaction(keys: KeyPair): Promise<void> {\n    const txs: FullyPreparedTransaction[] = this.opsWithCustomLimits();\n    this.subscriptions.add(\n      this.operationService.transfer(this.activeAccount.address, txs, Number(this.getTotalFee()), keys, '').subscribe(\n        async (ans: any) => {\n          this.sendResponse = ans;\n          if (ans.success === true) {\n            console.log('Transaction successful ', ans);\n            if (ans.payload.opHash) {\n              await this.messageService.stopSpinner();\n              this.operationResponse.emit(ans.payload.opHash);\n              const metadata = {\n                transactions: this.transactions,\n                opHash: ans.payload.opHash\n              };\n              await this.coordinatorService.boost(this.activeAccount.address, metadata);\n              for (const transaction of this.transactions) {\n                if (this.walletService.addressExists(transaction.destination)) {\n                  await this.coordinatorService.boost(transaction.destination);\n                }\n              }\n            } else if (this.walletService.wallet instanceof LedgerWallet) {\n              await this.requestLedgerSignature();\n              return;\n            }\n          } else {\n            await this.messageService.stopSpinner();\n            console.log('Transaction error id ', ans.payload.msg);\n            this.messageService.addError(ans.payload.msg, 0);\n            this.operationResponse.emit('broadcast_error');\n          }\n          this.reset();\n        },\n        (err) => {\n          this.messageService.stopSpinner();\n          console.log('Error Message ', JSON.stringify(err));\n          if (this.walletService.isLedgerWallet()) {\n            this.messageService.addError('Failed to create transaction', 0);\n            this.operationResponse.emit('broadcast_error');\n          }\n          this.reset();\n        }\n      )\n    );\n  }\n  opsWithCustomLimits(): FullyPreparedTransaction[] {\n    let extraGas: number = 0;\n    let extraStorage: number = 0;\n    if (this.customGasLimit && this.customGasLimit !== this.getTotalDefaultGas().toString()) {\n      extraGas = Number(this.customGasLimit) - this.getTotalDefaultGas();\n    }\n    if (this.customStorageLimit && this.customStorageLimit !== this.getTotalDefaultStorage().toString()) {\n      extraStorage = Number(this.customStorageLimit) - this.getTotalDefaultStorage();\n    }\n    const extraGasPerOp: number = Math.round(extraGas / this.transactions.length);\n    const extraStoragePerOp: number = Math.round(extraStorage / this.transactions.length);\n    const txs: FullyPreparedTransaction[] = [];\n    for (let i = 0; i < this.transactions.length; i++) {\n      let gasLimit: string = extraGas ? (Number(this.transactions[i].gasLimit) + extraGasPerOp).toString() : this.transactions[i].gasLimit.toString();\n      let storageLimit = extraStorage\n        ? (Number(this.transactions[i].storageLimit) + extraStoragePerOp).toString()\n        : this.transactions[i].storageLimit.toString();\n      gasLimit = !(Number(gasLimit) < 0) ? gasLimit : '0';\n      storageLimit = !(Number(storageLimit) < 0) ? storageLimit : '0';\n      const fullyTx: FullyPreparedTransaction = {\n        ...this.transactions[i],\n        fee: i === this.transactions.length - 1 ? this.getTotalFee().toString() : '0',\n        gasLimit,\n        storageLimit\n      };\n      txs.push(fullyTx);\n    }\n    return txs;\n  }\n  sanitizeNumberInput(e, decimalPlaces: number, type = ''): void {\n    const exp = new RegExp(`^\\\\d{0,}(\\\\.\\\\d{0,${decimalPlaces}})?\\$`, 'g');\n    if (exp.test(e?.target?.value)) {\n      this[type] = e?.target?.value;\n    } else {\n      e.target.value = this[type];\n    }\n  }\n  async requestLedgerSignature(): Promise<void> {\n    if (this.walletService.wallet instanceof LedgerWallet) {\n      await this.messageService.startSpinner('Waiting for Ledger signature...');\n      try {\n        const op = this.sendResponse.payload.unsignedOperation;\n        let signature = '';\n        if (op.length <= 2290) {\n          signature = await this.ledgerService.signOperation('03' + op, this.walletService.wallet.implicitAccounts[0].derivationPath);\n        } else {\n          signature = await this.ledgerService.signHash(\n            this.operationService.ledgerPreHash('03' + op),\n            this.walletService.wallet.implicitAccounts[0].derivationPath\n          );\n        }\n        if (signature) {\n          const signedOp = op + signature;\n          this.sendResponse.payload.signedOperation = signedOp;\n          this.ledgerError = '';\n        } else {\n          this.ledgerError = 'Failed to sign transaction';\n        }\n      } finally {\n        this.messageService.stopSpinner();\n      }\n    }\n  }\n  async broadCastLedgerTransaction(): Promise<void> {\n    this.subscriptions.add(\n      this.operationService.broadcast(this.sendResponse.payload.signedOperation).subscribe(async (ans: any) => {\n        this.sendResponse = ans;\n        if (ans.success && this.activeAccount) {\n          const metadata = {\n            transactions: this.transactions,\n            opHash: ans.payload.opHash\n          };\n          await this.coordinatorService.boost(this.activeAccount.address, metadata);\n          if (this.walletService.addressExists(this.transactions[0].destination)) {\n            await this.coordinatorService.boost(this.transactions[0].destination);\n          }\n          this.operationResponse.emit(ans.payload.opHash);\n        } else {\n          console.log('sendResponse', JSON.stringify(this.sendResponse));\n          this.operationResponse.emit('broadcast_error');\n        }\n        console.log('ans: ' + JSON.stringify(ans));\n        this.reset();\n      })\n    );\n  }\n  closeModalAction(emit: string = null): void {\n    ModalComponent.currentModel.next({ name: '', data: null });\n    this.operationResponse.emit(emit);\n    this.reset();\n  }\n  reset(init = false): void {\n    if (!init) {\n      this.confirmRequest = null;\n      if (this.syncSub) {\n        this.syncSub.unsubscribe();\n        this.syncSub = undefined;\n      }\n    }\n    this.transactions = [];\n    this.activeAccount = null;\n\n    this.customFee = '';\n    this.customGasLimit = '';\n    this.customStorageLimit = '';\n\n    this.sendResponse = null;\n    this.ledgerError = '';\n    this.password = '';\n    this.pwdInvalid = '';\n    this.advancedForm = false;\n    this.externalReq = false;\n\n    this.expectedLqd = undefined;\n    this.minimumLqd = undefined;\n    this.expectedXtz = undefined;\n    this.minimumXtz = undefined;\n    this.expectedToken = undefined;\n    this.minimumToken = undefined;\n  }\n  openInfoModal(title: string): void {\n    switch (title) {\n      case 'fee':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'Expected fee for this transaction charged by the Tezos blockchain.',\n            title: 'Fee'\n          },\n          forceClose: false\n        });\n        break;\n      case 'minimumxtz':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'The minimum amount of XTZ to be received from the transaction.',\n            title: 'Minimum XTZ'\n          },\n          forceClose: false\n        });\n        break;\n      case 'expectedxtz':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'The expected amount of XTZ to be received from the transaction.',\n            title: 'Expected XTZ'\n          },\n          forceClose: false\n        });\n        break;\n      case 'requiredtoken':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'Required tzBTC needed for transaction.',\n            title: 'Required tzBTC'\n          },\n          forceClose: false\n        });\n        break;\n      case 'minimumtoken':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'The minimum amount of tzBTC to be received from the transaction.',\n            title: 'Minimum tzBTC'\n          },\n          forceClose: false\n        });\n        break;\n      case 'expectedtoken':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'The expected amount of tzBTC to be received from the transaction.',\n            title: 'Expected tzBTC'\n          },\n          forceClose: false\n        });\n        break;\n      case 'minimumlqt':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'The minimum amount of LBT to be received from the transaction.',\n            title: 'Minimum LBT'\n          },\n          forceClose: false\n        });\n        break;\n      case 'expectedlqt':\n        ModalComponent.currentModel.next({\n          name: 'info',\n          data: {\n            message: 'The expected amount of LBT to be received from the transaction.',\n            title: 'Expected LBT'\n          },\n          forceClose: false\n        });\n        break;\n      default:\n        break;\n    }\n  }\n  async calculateXtzToToken(): Promise<void> {\n    this.semaphore = true;\n    const xtzToSell = new Amount({\n      normalisedAmount: this.expectedXtz,\n      decimalPlaces: 6\n    });\n    await this.swapLiquidityService.fetchStorage(this.lqdContract);\n    const { xtzPool, tokenPool } = this.swapLiquidityService.createPoolAmounts();\n    const result = this.swapLiquidityService.calculateXtzToToken(xtzToSell, xtzPool, tokenPool, 0.005, this.swapLiquidityService.settings('liquidityBaking'));\n    this.expectedToken = result.expected?.internalNormalised.toFixed(result.expected?.decimalPlaces).toString();\n    this.semaphore = false;\n  }\n  async calculateTokenToXTZ(): Promise<void> {\n    this.semaphore = true;\n    const tokenToSell = new Amount({\n      normalisedAmount: this.expectedToken,\n      decimalPlaces: 8\n    });\n    await this.swapLiquidityService.fetchStorage(this.lqdContract);\n    const { xtzPool, tokenPool } = this.swapLiquidityService.createPoolAmounts();\n    const result = this.swapLiquidityService.calculateTokenToXTZ(tokenToSell, xtzPool, tokenPool, 0.005, this.swapLiquidityService.settings('liquidityBaking'));\n    this.expectedXtz = result.expected?.internalNormalised.toFixed(result.expected?.decimalPlaces).toString();\n    this.semaphore = false;\n  }\n  async calcAddLiquidity(): Promise<void> {\n    this.semaphore = true;\n    const toSell = new Amount({\n      normalisedAmount: this.expectedXtz,\n      decimalPlaces: 6\n    });\n    await this.swapLiquidityService.fetchStorage(this.lqdContract);\n    const { xtzPool, tokenPool } = this.swapLiquidityService.createPoolAmounts();\n    const result = this.swapLiquidityService.calculateAddLiquidityXTZ(\n      toSell,\n      xtzPool,\n      tokenPool,\n      parseFloat(this.swapLiquidityService.storage[this.lqdContract]?.total_pool),\n      0.005,\n      this.swapLiquidityService.settings('liquidityBaking')\n    );\n    this.expectedLqd = result.liquidityExpected?.internalNormalised.toFixed(result.liquidityExpected?.decimalPlaces).toString();\n    this.semaphore = false;\n  }\n  async calcRemoveLiquidity(): Promise<void> {\n    this.semaphore = true;\n    const lqtToBurn = new Amount({\n      normalisedAmount: this.expectedLqd,\n      decimalPlaces: 0\n    });\n    await this.swapLiquidityService.fetchStorage(this.lqdContract);\n    const { xtzPool, tokenPool } = this.swapLiquidityService.createPoolAmounts();\n    const result = this.swapLiquidityService.calculateRemoveLiquidity(\n      lqtToBurn,\n      xtzPool,\n      tokenPool,\n      parseFloat(this.swapLiquidityService.storage[this.lqdContract]?.total_pool),\n      0.005,\n      this.swapLiquidityService.settings('liquidityBaking')\n    );\n    this.expectedXtz = result.xtzExpected?.internalNormalised.toFixed(result.xtzExpected?.decimalPlaces).toString();\n    this.expectedToken = result.tokenExpected?.internalNormalised.toFixed(result.tokenExpected?.decimalPlaces).toString();\n    this.semaphore = false;\n  }\n}\n","<app-prepare-send *ngIf=\"!embedded\" [prepareRequest]=\"prepareRequest\" (prepareResponse)=\"handlePrepareResponse($event)\"></app-prepare-send>\n<app-confirm-send [confirmRequest]=\"confirmRequest\" (operationResponse)=\"handleConfirmResponse($event)\"></app-confirm-send>\n<app-confirm-send-embed *ngIf=\"embedded\" [templateRequest]=\"templateRequest\" (isApproved)=\"handleTemplateApproval($event)\" [activeAccount]=\"activeAccount\"></app-confirm-send-embed>\n<app-swap-liquidity (prepareResponse)=\"handlePrepareResponse($event)\"></app-swap-liquidity>\n<app-swap-liquidity-confirm [confirmRequest]=\"confirmSwapLiquidityRequest\" (operationResponse)=\"handleConfirmResponse($event)\"></app-swap-liquidity-confirm>\n","import { Component, OnInit, Input, Output, EventEmitter, OnChanges, SimpleChanges, OnDestroy } from '@angular/core';\nimport { Account, EmbeddedTorusWallet } from '../../../services/wallet/wallet';\nimport {\n  PrepareRequest,\n  ConfirmRequest,\n  FullyPreparedTransaction,\n  PartiallyPreparedTransaction,\n  TemplateRequest,\n  TemplateFee,\n  ConfirmSwapRequest,\n  LqdEntrypoints\n} from './interfaces';\nimport { Template } from 'kukai-embed';\nimport { TokenService } from '../../../services/token/token.service';\nimport { EstimateService } from '../../../services/estimate/estimate.service';\nimport { MessageService } from '../../../services/message/message.service';\nimport { assertMichelsonData } from '@taquito/michel-codec';\nimport { OperationService } from '../../../services/operation/operation.service';\nimport Big from 'big.js';\nimport { WalletService } from '../../../services/wallet/wallet.service';\nimport { CoordinatorService } from '../../../services/coordinator/coordinator.service';\nimport { CONSTANTS } from '../../../../environments/environment';\nimport { SubjectService } from '../../../services/subject/subject.service';\nimport { Subscription } from 'rxjs';\nimport { ExternalRequest } from '../../../interfaces';\n\n@Component({\n  selector: 'app-send',\n  templateUrl: './send.component.html'\n})\nexport class SendComponent implements OnInit, OnChanges, OnDestroy {\n  LqdEntrypoints = LqdEntrypoints;\n  @Input() embedded: boolean;\n  activeAccount: Account;\n  @Input() tokenTransfer: string;\n  @Input() externalRequest: ExternalRequest;\n  @Input() template: Template;\n  @Output() operationResponse = new EventEmitter();\n  prepareRequest: PrepareRequest = null;\n  confirmRequest: ConfirmRequest = null;\n  templateRequest: TemplateRequest = null;\n  confirmSwapLiquidityRequest: ConfirmSwapRequest = null;\n  symbol: string;\n  readonly thresholdUSD = 50;\n  private subscriptions: Subscription = new Subscription();\n  private swapLiquidityEntrypoints = ['addLiquidity', 'removeLiquidity', 'xtzToToken', 'tokenToXtz'];\n\n  readonly lqdContract = 'KT1TxqZ8QtKvLu3V3JH7Gx58n7Co8pgtpQU5';\n  readonly tzBTCContract = 'KT1PWx2mnDueood7fEmfbBDKx1D9BAnnXitn';\n\n  constructor(\n    public tokenService: TokenService,\n    private estimateService: EstimateService,\n    private messageService: MessageService,\n    private operationService: OperationService,\n    private walletService: WalletService,\n    private coordinatorService: CoordinatorService,\n    private subjectService: SubjectService\n  ) {}\n\n  ngOnInit(): void {\n    this.subscriptions.add(\n      this.subjectService.prepareTokenTransfer.subscribe((t) => {\n        this.prepareRequest = t;\n        this.tokenTransfer = t?.tokenTransfer;\n        this.activeAccount = t?.account;\n        this.symbol = t?.symbol;\n      })\n    );\n  }\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes?.externalRequest?.currentValue) {\n      this.activeAccount = changes.externalRequest.currentValue.selectedAccount;\n      this.checkOpReq(changes.externalRequest.currentValue.operationRequest);\n    }\n  }\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n  private async checkOpReq(opReq: any): Promise<void | {\n    kind;\n    destination;\n    amount;\n    parameters;\n    gasRecommendation;\n    storageRecommendation;\n  }> {\n    if (opReq.operationDetails) {\n      opReq = opReq.operationDetails;\n    }\n    if (this.walletService.wallet instanceof EmbeddedTorusWallet && !this.walletService.wallet?.sk && this.template?.silent) {\n      this.operationResponse.emit('invalid_parameters');\n      return;\n    }\n    if (opReq[0].kind === 'transaction') {\n      const txs: PartiallyPreparedTransaction[] = opReq.map((tx) => {\n        if (tx.kind !== 'transaction') {\n          throw new Error('Invalid op kind');\n        }\n        // identify token transfers\n        return {\n          kind: 'transaction',\n          destination: tx.destination,\n          amount: Big(tx.amount)\n            .div(10 ** 6)\n            .toFixed(), // handle token decimals here\n          parameters: tx.parameters ? tx.parameters : undefined,\n          gasRecommendation: tx.gas_limit ? tx.gas_limit : undefined,\n          storageRecommendation: tx.storage_limit ? tx.storage_limit : undefined\n        };\n      });\n      if (this.validParameters(txs)) {\n        if (txs.length === 1 && !this.template) {\n          const tokenTransferObj: any = this.getTokenTransferObj(txs[0]);\n          if (tokenTransferObj) {\n            const asset = this.tokenService.getAsset(tokenTransferObj.tokenId);\n            txs[0].amount = Big(tokenTransferObj.amount)\n              .div(10 ** asset.decimals)\n              .toFixed();\n            txs[0].destination = tokenTransferObj.to;\n            this.tokenTransfer = tokenTransferObj.tokenId;\n            delete txs[0].parameters;\n          } else {\n            this.tokenTransfer = '';\n          }\n          this.simulateRequest(txs, tokenTransferObj?.tokenId);\n        } else {\n          this.tokenTransfer = '';\n          this.simulateRequest(txs, '');\n        }\n      } else {\n        this.operationResponse.emit('invalid_parameters');\n      }\n    }\n  }\n  getTokenTransferObj(op: any): null | { tokenId: string; to: string; amount: string } {\n    if (op.parameters && this.tokenService.isKnownTokenContract(op.destination)) {\n      const tokenTransfer = this.operationService.parseTokenTransfer(op);\n      if (tokenTransfer && this.tokenService.isKnownTokenId(tokenTransfer?.tokenId)) {\n        return tokenTransfer;\n      }\n    }\n    return null;\n  }\n  validParameters(txs: PartiallyPreparedTransaction[]): boolean {\n    for (const tx of txs) {\n      if (tx.parameters) {\n        try {\n          if (!tx.parameters.value || !tx.parameters.entrypoint) {\n            throw new Error('entrypoint and value expected');\n          }\n          assertMichelsonData(tx.parameters.value);\n        } catch (e) {\n          this.messageService.addError(`Invalid parameters: ${e.message}`);\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n  async simulateRequest(\n    txs: PartiallyPreparedTransaction[],\n    tokenTransfer: string\n  ): Promise<void | {\n    tx: PartiallyPreparedTransaction;\n    fee;\n    gasLimit;\n    storageLimit;\n  }> {\n    if (this.template) {\n      if (this.template.silent) {\n        console.log('Silent signing');\n      } else {\n        this.templateRequest = {\n          template: this.template,\n          partialOps: txs\n        };\n      }\n    } else {\n      await this.messageService.startSpinner('Preparing transaction...');\n    }\n    try {\n      await this.estimateService.preLoadData(this.activeAccount.pkh, this.activeAccount.pk);\n      const callback = (res) => {\n        if (res) {\n          if (res.error) {\n            this.messageService.addError(`Simulation error: ${res.error.message}`, 0);\n            this.operationResponse.emit({\n              error: 'invalid_parameters',\n              errorMessage: res.error.message\n            });\n          } else {\n            const fullyPrepared: FullyPreparedTransaction[] = txs.map((tx, i) => {\n              return {\n                ...tx,\n                fee: i === txs.length - 1 ? res.fee : '0',\n                gasLimit: res.customLimits[i].gasLimit.toString(),\n                storageLimit: res.customLimits[i].storageLimit.toString()\n              };\n            });\n            if (this.template) {\n              const fee = this.getTemplateFee(fullyPrepared);\n              console.log('Use template', this.template);\n              if (!this.template.silent) {\n                this.templateRequest = {\n                  template: this.template,\n                  partialOps: txs,\n                  ops: fullyPrepared,\n                  fee\n                };\n              } else {\n                let amount = Big(0);\n                for (const op of fullyPrepared) {\n                  amount = Big(op.amount).plus(amount);\n                }\n                amount = Big(fee.total).plus(amount);\n                amount = amount.times(Big(CONSTANTS.MAINNET && this.walletService.wallet?.XTZrate ? this.walletService.wallet.XTZrate : 5));\n                if (amount.gt(Big(this.thresholdUSD))) {\n                  this.operationResponse.emit('exceeded_threshold');\n                } else {\n                  this.silentInject(fullyPrepared);\n                }\n              }\n            } else {\n              this.confirmTransactions(fullyPrepared, true);\n            }\n          }\n        } else {\n          throw new Error('No simulation result');\n        }\n      };\n      await this.estimateService.estimateTransactions(JSON.parse(JSON.stringify(txs)), this.activeAccount.pkh, tokenTransfer, callback);\n    } catch (e) {\n      console.error(e);\n      this.operationResponse.emit('unknown_error');\n    } finally {\n      await this.messageService.stopSpinner();\n    }\n  }\n  prepareTransaction(): void {\n    this.prepareRequest = {\n      account: this.activeAccount,\n      tokenTransfer: this.tokenTransfer,\n      symbol: this.symbol\n    };\n  }\n  confirmTransactions(transactions: FullyPreparedTransaction[], externalReq: boolean): void {\n    if (this.isLbReq(transactions)) {\n      if (!externalReq) {\n        this.activeAccount = this.subjectService.activeAccount.getValue();\n      }\n      this.confirmSwapLiquidityRequest = {\n        account: this.activeAccount,\n        transactions,\n        externalReq\n      };\n    } else {\n      this.confirmRequest = {\n        account: this.activeAccount,\n        tokenTransfer: this.tokenTransfer,\n        transactions,\n        externalReq\n      };\n    }\n  }\n  private isLbReq(transactions: FullyPreparedTransaction[]): boolean {\n    if (\n      transactions.length === 1 &&\n      transactions[0].destination === this.lqdContract &&\n      ['xtzToToken', 'removeLiquidity'].includes(transactions[0].parameters?.entrypoint)\n    ) {\n      // xtzToToken or removeLiquidity\n      return true;\n    } else if (transactions[0].destination === this.tzBTCContract && transactions[0].parameters?.entrypoint === 'approve') {\n      // can be tokenToXtz or addLiquidity\n      if (transactions.length === 3 && transactions[0].parameters?.value?.args[1]?.int !== '0') {\n        console.log('prepend 0 approve');\n        // normalize\n        transactions.unshift({\n          ...transactions[0],\n          kind: 'transaction',\n          amount: '0',\n          destination: this.tzBTCContract,\n          parameters: this.operationService.getRevokeAmountParameters(this.lqdContract)\n        });\n      }\n      if (\n        transactions.length === 4 &&\n        new Set([transactions[0].destination, transactions[1].destination, transactions[3].destination, this.tzBTCContract]).size === 1 &&\n        new Set([transactions[0].parameters?.entrypoint, transactions[1].parameters?.entrypoint, transactions[3].parameters?.entrypoint, 'approve']).size ===\n          1 &&\n        new Set([\n          transactions[0].parameters?.value?.args[0]?.string,\n          transactions[1].parameters?.value?.args[0]?.string,\n          transactions[3].parameters?.value?.args[0]?.string,\n          this.lqdContract\n        ]).size === 1 &&\n        transactions[2].destination === this.lqdContract &&\n        ['tokenToXtz', 'addLiquidity'].includes(transactions[2].parameters?.entrypoint)\n      ) {\n        return true;\n      }\n    }\n    return false;\n  }\n  handlePrepareResponse(preparedTransactions: FullyPreparedTransaction[]): void {\n    this.prepareRequest = null;\n    if (preparedTransactions) {\n      console.log('PrepareResponse', JSON.stringify(preparedTransactions));\n      this.confirmTransactions(preparedTransactions, false);\n    }\n  }\n  handleConfirmResponse(opHash: string): void {\n    this.confirmRequest = null;\n    this.confirmSwapLiquidityRequest = null;\n    this.operationResponse.emit(opHash);\n  }\n  handleTemplateApproval(ops: FullyPreparedTransaction[]): void {\n    if (ops) {\n      this.silentInject(ops);\n    } else {\n      this.operationResponse.emit(null);\n    }\n    this.template = null;\n  }\n  private getTemplateFee(ops: FullyPreparedTransaction[]): TemplateFee {\n    let network = new Big(0);\n    let storageLimit = new Big(0);\n    for (const op of ops) {\n      network = network.plus(op.fee);\n      storageLimit = storageLimit.plus(op.storageLimit);\n    }\n    let storage = storageLimit.times(this.estimateService.costPerByte).div('1000000');\n    const total = network.plus(storage).toFixed();\n    network = network.toFixed();\n    storage = storage.toFixed();\n    return { network, storage, total };\n  }\n  async silentInject(ops: FullyPreparedTransaction[]): Promise<void> {\n    if (!this.walletService.isEmbeddedTorusWallet()) {\n      this.operationResponse.emit('UNSUPPORTED_WALLET_TYPE');\n      return;\n    }\n    for (const op of ops) {\n      // Limit to transactions for now\n      if (op.kind !== 'transaction') {\n        this.operationResponse.emit('UNSUPPORTED_KIND');\n        break;\n      }\n    }\n    if (!this.template.silent) {\n      this.messageService.startSpinner('Sending transaction...');\n    }\n    let keys;\n    try {\n      keys = await this.walletService.getKeys('', this.activeAccount.pkh);\n    } catch {\n      this.messageService.stopSpinner();\n    }\n    if (!keys) {\n      this.operationResponse.emit('FAILED_TO_SIGN');\n      return;\n    }\n    this.subscriptions.add(\n      this.operationService.transfer(this.activeAccount.address, ops, Number(ops[ops.length - 1].fee), keys, '').subscribe(\n        async (ans: any) => {\n          if (ans.success === true) {\n            console.log('Transaction successful ', ans);\n            await this.messageService.stopSpinner();\n            this.operationResponse.emit(ans.payload.opHash);\n            const metadata = {\n              transactions: ops,\n              opHash: ans.payload.opHash\n            };\n            await this.coordinatorService.boost(this.activeAccount.address, metadata);\n            for (const transaction of ops) {\n              if (this.walletService.addressExists(transaction.destination)) {\n                await this.coordinatorService.boost(transaction.destination);\n              }\n            }\n          } else {\n            await this.messageService.stopSpinner();\n            console.log('Transaction error id ', ans.payload.msg);\n            this.messageService.addError(ans.payload.msg, 0);\n            this.operationResponse.emit({\n              error: 'broadcast_error',\n              errorMessage: ans.payload.msg\n            });\n          }\n        },\n        (err) => {\n          this.messageService.stopSpinner();\n          console.log(err);\n          this.operationResponse.emit('UNKNOWN_ERROR');\n        }\n      )\n    );\n  }\n}\n","<div *ngIf=\"req\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-column top\">\n      <img class=\"flex-row button close\" (click)=\"cancel()\" src=\"../../../../assets/img/add-minterpop.svg\" />\n      <h1 class=\"title\">{{req.template.action || 'Confirmation'}}</h1>\n    </div>\n    <div class=\"seperator\"></div>\n    <div class=\"flex-column confirm-send\">\n        <div *ngIf=\"req.template.descriptions[0].text\" class=\"asset-name\">{{ req.template.descriptions[0].text }}</div>\n        <div class=\"flex-row transaction\">\n          <div class=\"flex-column left\">\n            <span *ngIf=\"req.template.descriptions[1].text\" class=\"default-text\">{{ req.template.descriptions[1].text }}</span>\n            <span *ngIf=\"req.template.descriptions[2]\" class=\"default-text amount\">{{ req.template.descriptions[2].text }}</span>\n            <span *ngIf=\"req.template.descriptions[3]\" class=\"default-text\">{{ req.template.descriptions[3].text }}</span>\n            <span class=\"default-text\">From:</span>\n            <div class=\"flex-row torus\" *ngIf=\"this.walletService.wallet.verifier\">\n              <img class=\"icon\" src=\"../../../assets/img/{{ this.walletService.wallet.verifier }}-logo.svg\">\n              <div class=\"flex-column\">\n                <span class=\"name\">{{ this.walletService.wallet.displayName() }}</span><span class=\"address\">{{\n                  req.activeAccount.address }}</span>\n              </div>\n            </div>\n            <span *ngIf=\"!this.walletService.wallet.verifier\" class=\"default-text single-to\">{{ req.activeAccount.address\n              }}</span>\n          </div>\n          <div *ngIf=\"req.template.descriptions[0]?.imgUrl\" class=\"flex-column right\">\n            <img class=\"token-image\" [src]=\"req.template.descriptions[0]?.imgUrl\" />\n          </div>\n        </div>\n      <br />\n      <div class=\"seperator\"></div>\n      <div class=\"flex-column bottom\">\n        <div class=\"flex-row default-text more-info\" [class]=\"showMore ? 'open' : ''\" (click)=\"showMore = !showMore\">{{ !showMore ?\n          'Show More' : 'Show Less' }}<img src=\"../../../../assets/img/dropdown-minterpop.svg\"></div>\n        <div *ngIf=\"showMore && req.payload\" class=\"info\">\n          <textarea style=\"width: 100%; padding: 0.5rem\" rows=10>{{req.payload}}</textarea>\n        </div>\n      </div>\n      <br />\n      <div class=\"flex-row buttons\">\n        <button (click)=\"approve()\">\n          <ng-container *ngIf=\"req.template.button; else defaultButtonText\">\n            {{req.template.button}}</ng-container>\n          <ng-template #defaultButtonText>Send</ng-template>\n        </button>\n      </div>\n      <div class=\"footer\">\n        <span>Powered by</span><img class=\"logo\" src=\"../../../../assets/img/header-logo-grey.svg\">\n      </div>\n    </div>\n  </div>\n</div> ","import { Component, EventEmitter, Input, OnChanges, OnInit, Output, SimpleChanges } from '@angular/core';\nimport { WalletService } from '../../../../../services/wallet/wallet.service';\n\n@Component({\n  selector: 'app-sign-expr-template',\n  templateUrl: './template.component.html',\n  styleUrls: ['../../confirm-send/confirm-send.component.scss']\n})\nexport class ExprTemplateComponent implements OnInit, OnChanges {\n  @Input() req = null;\n  @Output() isApproved = new EventEmitter();\n  constructor(public walletService: WalletService) {}\n\n  ngOnInit(): void {}\n  ngOnChanges(changes: SimpleChanges): void {}\n  cancel() {\n    this.isApproved.emit(false);\n  }\n  approve() {\n    this.isApproved.emit(true);\n  }\n}\n","<div *ngIf=\"signRequest && payload && !template\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-column top\">\n      <img class=\"flex-row button close\" (click)=\"rejectSigning()\" src=\"../../../../assets/img/add-minterpop.svg\" />\n      <h1 class=\"title\">{{ signRequest?.title ? signRequest.title : 'Sign Expression' }}</h1>\n    </div>\n    <div class=\"flex-column sign-expr\">\n      <div class=\"seperator\"></div>\n      <p class=\"previewAttention\">{{ description ? description : 'An application has requested you sign an\n        expression.' }}</p>\n        <div class=\"seperator\"></div>\n      <div class=\"flex-row more-info\" [class]=\"showMore ? 'open' : ''\" (click)=\"toggle()\">{{ !showMore ? 'Show More' : 'Show Less' }}<img src=\"../../../../assets/img/dropdown-minterpop.svg\"></div>\n      <div *ngIf=\"showMore\" class=\"info\">\n        <textarea rows=\"6\" readonly>{{ payload }}</textarea>\n      </div>\n      <div class=\"flex-column bottom\">\n        <span *ngIf=\"this.pwdInvalid\" class=\"danger margin\">{{ this.pwdInvalid }}</span>\n        <button class=\"purple confirm\" (click)=\"sign()\">SIGN</button>\n        <div class=\"footer\">\n          <span>Powered by</span><img class=\"logo\" src=\"../../../../assets/img/header-logo-grey.svg\">\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n<app-sign-expr-template *ngIf=\"signRequest && payload && template\" [req]=\"{payload: payload, template: template, activeAccount: activeAccount}\" (isApproved)=\"handleTemplateApproval($event)\"></app-sign-expr-template>","import { Component, OnInit, SimpleChanges, Input, Output, EventEmitter, OnChanges } from '@angular/core';\nimport { WalletService } from '../../../../services/wallet/wallet.service';\nimport { MessageService } from '../../../../services/message/message.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Account } from '../../../../services/wallet/wallet';\nimport { OperationService } from '../../../../services/operation/operation.service';\nimport { emitMicheline } from '@taquito/michel-codec';\nimport { valueDecoder } from '@taquito/local-forging/dist/lib/michelson/codec';\nimport { Uint8ArrayConsumer } from '@taquito/local-forging/dist/lib/uint8array-consumer';\nimport { InputValidationService } from '../../../../services/input-validation/input-validation.service';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'app-sign-expr-embed',\n  templateUrl: './sign-expr.component.html',\n  styleUrls: ['./sign-expr.component.scss']\n})\nexport class SignExprEmbedComponent implements OnInit, OnChanges {\n  @Input() signRequest: any;\n  @Input() activeAccount: Account;\n  @Output() signResponse = new EventEmitter();\n  syncSub: Subscription;\n  password = '';\n  pwdInvalid = '';\n  payload = '';\n  template = null;\n  description = null;\n  isMessage = false;\n  showMore = false;\n  constructor(\n    public walletService: WalletService,\n    private messageService: MessageService,\n    public translate: TranslateService,\n    private operationService: OperationService,\n    private inputValidationService: InputValidationService\n  ) {}\n  ngOnInit(): void {}\n  ngOnChanges(changes: SimpleChanges): void {\n    if (this.signRequest) {\n      const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\n      document.body.style.marginRight = scrollBarWidth.toString();\n      document.body.style.overflow = 'hidden';\n      this.template = this.signRequest.ui;\n      this.isMessage = this.inputValidationService.isMessageSigning(this.signRequest.payload);\n      const value = valueDecoder(Uint8ArrayConsumer.fromHexString(this.signRequest.payload.slice(2)));\n      const payload = emitMicheline(value, {\n        indent: '  ',\n        newline: '\\n'\n      });\n      this.payload = this.isMessage ? value.string : payload;\n    }\n  }\n  async sign() {\n    const pwd = this.password;\n    this.password = '';\n    await this.messageService.startSpinner(`Signing ${this.isMessage ? 'message' : 'payload'}...`);\n    let keys;\n    try {\n      keys = await this.walletService.getKeys(pwd, this.activeAccount.pkh);\n    } catch (e) {\n      console.warn(e);\n      this.messageService.stopSpinner();\n    }\n    if (keys) {\n      this.pwdInvalid = '';\n      try {\n        const signature = this.operationService.sign(this.signRequest.payload, keys.sk).edsig;\n        this.acceptSigning(signature);\n      } catch (e) {\n        this.pwdInvalid = 'Signing failed';\n        console.warn(e);\n      } finally {\n        this.messageService.stopSpinner();\n      }\n    } else {\n      this.messageService.stopSpinner();\n      if (this.walletService.isTorusWallet()) {\n        this.pwdInvalid = `Authorization failed`;\n      } else {\n        this.pwdInvalid = this.translate.instant('SENDCOMPONENT.WRONGPASSWORD');\n      }\n    }\n  }\n  rejectSigning() {\n    this.closeModal();\n    this.signResponse.emit(null);\n  }\n  acceptSigning(signature: string) {\n    this.messageService.addSuccess(this.isMessage ? 'Message signed!' : 'Payload signed!');\n    this.closeModal();\n    this.signResponse.emit(signature);\n  }\n  closeModal() {\n    // restore body scrollbar\n    document.body.style.marginRight = '';\n    document.body.style.overflow = '';\n    this.clear();\n  }\n  clear() {\n    this.password = '';\n    this.pwdInvalid = '';\n    this.payload = '';\n    this.isMessage = false;\n    this.template = null;\n  }\n  toggle() {\n    this.showMore = !this.showMore;\n  }\n  handleTemplateApproval(t) {\n    if (t) {\n      this.sign();\n    } else {\n      this.rejectSigning();\n    }\n  }\n}\n","<h3>Processing Transaction...</h3>\n<br />\n<h1 class=\"high-demand\">High Demand Item!</h1>\n<br />\n<p class=\"desc\">Your order is being delivered. Wait times vary, but can be<br />as short as seconds or a few minutes\n</p>\n<br />\n<br />\n<h1>Estimated Wait Time:</h1>\n<h1 class=\"flex-row time\">\n  <span *ngIf=\"hours !== '00'\"class=\"flex-column hours\">\n    <h1>{{ hours }}</h1>\n    <h5>Hours</h5>\n  </span>\n  <span class=\"flex-column minutes\">\n    <h1>{{ minutes }}</h1>\n    <h5>Minutes</h5>\n  </span>\n  <span class=\"flex-column seconds\">\n    <h1>{{ seconds }}</h1>\n    <h5>Seconds</h5>\n  </span>\n</h1>\n<br />\n<br />\n<h2 class=\"note\">Note: Do not close this window or leave this page!</h2>\n<br />\n<h2 class=\"desc\">You will cancel this transaction<br />and have to start over!</h2>","import { Component, Input, OnInit, SimpleChanges } from '@angular/core';\n\n@Component({\n  selector: 'app-queue-embed',\n  templateUrl: './queue.component.html',\n  styleUrls: ['./queue.component.scss']\n})\nexport class QueueEmbedComponent implements OnInit {\n  @Input('queueTime') queueTime = 0;\n  hours = '0';\n  minutes = '0';\n  seconds = '0';\n  constructor() {}\n  ngOnInit(): void {\n    this.updateTime();\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes.queueTime.currentValue !== changes.queueTime.previousValue) {\n      this.updateTime();\n    }\n  }\n\n  updateTime() {\n    let sec: any = this.queueTime;\n    let hrs: any = Math.floor(sec / 3600);\n    sec -= hrs * 3600;\n    let min: any = Math.floor(sec / 60);\n    sec -= min * 60;\n    sec = sec.toString();\n    min = min.toString();\n    hrs = hrs.toString();\n\n    this.hours = hrs.length < 2 ? '0' + hrs : hrs;\n    this.minutes = min.length < 2 ? '0' + min : min;\n    this.seconds = sec.length < 2 ? '0' + sec : sec;\n  }\n}\n","<app-queue-embed *ngIf=\"this.queueTimeVisible > 0\" [queueTime]=\"this.queueTimeVisible\"></app-queue-embed>\n<div *ngIf=\"this.queueTime === 0 && this.queueTimeVisible === 0\" class=\"direct-auth-login\">\n  <div class=\"body\">\n    <div class=\"header\">\n      <img (click)=\"abort()\" class=\"abort\" src=\"../../../assets/img/x.svg\">\n    </div>\n    <h2 *ngIf=\"this.loginConfig?.customPrio === 'high'\">Please re-authenticate your social<br>login to complete your purchase:</h2>\n    <h2 *ngIf=\"this.loginConfig?.customPrio !== 'high'\">Sign in with one of the<br>following providers:</h2>\n    <div class=\"login-options\" [class.vertically]=\"loginConfig.buttonsVertically\"\n      [class.horizontally]=\"!loginConfig.buttonsVertically\" *ngIf=\"torusService && torusService.verifierMapKeys\">\n      <ng-container *ngFor=\"let key of loginOptions\">\n        <div *ngIf=\"!loginConfig.buttonsVertically\" class=\"login-option\" (click)=\"login(key)\">\n          <img src=\"../../../../assets/img/torus-login/{{ key }}-color.svg\" width=\"24\">\n        </div>\n        <div *ngIf=\"loginConfig.buttonsVertically\" class=\"login-option\" (click)=\"login(key)\">\n          <img src=\"../../../../assets/img/torus-login/{{ key }}-color.svg\" width=\"24\"><span>Sign in with {{ key |\n            titlecase }}</span>\n        </div>\n      </ng-container>\n    </div>\n  </div>\n  <div class=\"footer\">\n    <span>Powered by</span><img class=\"logo\" src=\"../../../../assets/img/header-logo-grey.svg\">\n  </div>\n</div>","import { EventEmitter, Input, Output, SimpleChanges, Component, OnInit, OnChanges } from '@angular/core';\nimport { LoginConfig, TypeOfLogin, LoginPrio } from 'kukai-embed';\nimport { WalletService } from '../../../../services/wallet/wallet.service';\nimport { MessageService } from '../../../../services/message/message.service';\nimport { TorusService } from '../../../../services/torus/torus.service';\nimport { EmbeddedTorusWallet } from '../../../../services/wallet/wallet';\nimport { CONSTANTS } from '../../../../../environments/environment';\n\n@Component({\n  selector: 'app-signin',\n  templateUrl: './signin.component.html',\n  styleUrls: ['./signin.component.scss']\n})\nexport class SigninComponent implements OnInit, OnChanges {\n  constructor(private messageService: MessageService, public torusService: TorusService, private walletService: WalletService) {}\n  @Input() dismiss: Boolean;\n  @Input() loginConfig: LoginConfig;\n  @Output() loginResponse = new EventEmitter();\n  loginOptions = [];\n  queueTime: number = 0;\n  queueTimeVisible: number = 0;\n  statusCounter: number = 0;\n  queueInterval: NodeJS.Timeout;\n  ngOnInit(): void {}\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes?.dismiss?.currentValue === true) {\n      this.messageService.stopSpinner().then(() => this.loginResponse.emit('dismiss'));\n    }\n    if (changes?.loginConfig?.currentValue) {\n      if (this.loginConfig.customPrio === 'high') {\n        if (this.walletService.wallet && this.walletService.wallet instanceof EmbeddedTorusWallet) {\n          if (this.walletService.wallet?.verifier) {\n            this.loginConfig.loginOptions = [this.walletService.wallet.verifier as TypeOfLogin];\n          }\n          this.startQueue();\n        }\n      }\n      if (this.loginConfig.loginOptions?.length > 0) {\n        this.loginOptions = [];\n        for (const loginOption of this.loginConfig.loginOptions) {\n          if (this.torusService.verifierMapKeys.includes(loginOption)) {\n            this.loginOptions.push(loginOption);\n          }\n        }\n      } else {\n        this.loginOptions = this.torusService.verifierMapKeys;\n      }\n    }\n  }\n  async startQueue() {\n    // set high prio\n    if (this.walletService.wallet instanceof EmbeddedTorusWallet) {\n      this.queueTime = -1;\n      this.setHighPrio(this.walletService.wallet.verifier, this.walletService.wallet.id);\n    }\n    this.queueTimeVisible = -1;\n    this.messageService.startSpinner();\n    this.queueInterval = setInterval(() => {\n      if (this.queueTimeVisible > 1 || (this.queueTimeVisible === 1 && this.queueTime === 0)) {\n        this.queueTimeVisible -= 1;\n      }\n      if (this.walletService.wallet instanceof EmbeddedTorusWallet) {\n        let timeBetweenChecks = 300;\n        if (this.queueTimeVisible < 4) {\n          timeBetweenChecks = 2;\n        } else if (this.queueTimeVisible < 60) {\n          timeBetweenChecks = 15;\n        } else if (this.queueTimeVisible < 1800) {\n          timeBetweenChecks = 60;\n        }\n        this.statusCounter = ++this.statusCounter % timeBetweenChecks;\n        if (this.statusCounter === 0) {\n          this.checkQueue(this.walletService.wallet.verifier, this.walletService.wallet.id);\n        }\n      }\n      if (this.queueTimeVisible <= 0 && this.queueTime === 0) {\n        this.stopQueue();\n      }\n    }, 1000);\n  }\n  stopQueue() {\n    if (this.queueInterval) {\n      clearInterval(this.queueInterval);\n    }\n    this.queueTime = 0;\n    this.queueTimeVisible = 0;\n    this.statusCounter = 0;\n    this.messageService.stopSpinner();\n  }\n  abort() {\n    this.loginResponse.emit(null);\n    this.stopQueue();\n  }\n  async login(typeOfLogin: string) {\n    try {\n      this.messageService.startSpinner('Loading wallet...');\n      let loginData;\n      if (this.loginConfig?.customPrio === LoginPrio.Low) {\n        loginData = await this.torusService.loginTorus(typeOfLogin, '', true);\n      } else if (this.loginConfig?.customPrio === LoginPrio.High && this.walletService.wallet instanceof EmbeddedTorusWallet) {\n        loginData = await this.torusService.loginTorus(typeOfLogin, this.walletService.wallet.id);\n      } else {\n        loginData = await this.torusService.loginTorus(typeOfLogin);\n      }\n      if (!loginData?.keyPair) {\n        throw new Error('Login failed');\n      }\n      if (this.loginConfig?.customPrio === LoginPrio.Low) {\n        //loginData.keyPair = {pk: '', pkh: ''};\n        if (loginData?.keyPair?.pk === '') {\n          this.setLowPrio(loginData.userInfo);\n        } else {\n          console.log('skipping queue');\n        }\n      }\n      if (this.dismiss === null) {\n        await this.messageService.stopSpinner();\n      }\n      this.loginResponse.emit(loginData);\n      this.stopQueue();\n    } catch {\n      await this.messageService.stopSpinner();\n    }\n  }\n  async setLowPrio(userInfo: any) {\n    let { typeOfLogin, verifierId } = userInfo;\n    if (!CONSTANTS.MAINNET) {\n      typeOfLogin = 'mock';\n    }\n    const res = await this.get(`https://queue.tcinfra.net/q/low_priority?authorizer=${typeOfLogin}&id=${verifierId}`);\n    console.log('setLowPrio', res);\n    return res;\n  }\n  async setHighPrio(typeOfLogin: string, verifierId: string) {\n    if (!CONSTANTS.MAINNET) {\n      typeOfLogin = 'mock';\n    }\n    const res = await this.get(`https://queue.tcinfra.net/q/high_priority?authorizer=${typeOfLogin}&id=${verifierId}`);\n    console.log('setHighPrio', res);\n    this.updateQueue(res);\n    return res;\n  }\n  async checkQueue(typeOfLogin: string, verifierId: string) {\n    if (!CONSTANTS.MAINNET) {\n      typeOfLogin = 'mock';\n    }\n    const res = await this.get(`https://queue.tcinfra.net/check?authorizer=${typeOfLogin}&id=${verifierId}`, 0);\n    console.log('checkQueue', res);\n    this.updateQueue(res);\n    return res;\n  }\n  updateQueue(res: any) {\n    if (res?.EstimatedTimeSeconds !== -1) {\n      if (res.EstimatedTimeSeconds === 0 && res.Status === 'error') {\n        console.error('FailedToResolve');\n        this.abort();\n        return;\n      }\n      if (this.queueTimeVisible === -1) {\n        this.messageService.stopSpinner();\n      }\n      this.queueTime = this.queueTimeVisible = res.EstimatedTimeSeconds;\n    }\n  }\n  async get(url: string, triesLeft = 3) {\n    return await fetch(url)\n      .then(async (res) => {\n        return await res.json();\n      })\n      .catch(async (e) => {\n        if (triesLeft > 0) {\n          return await this.get(url, --triesLeft);\n        } else {\n          throw e;\n        }\n      });\n  }\n}\n","import { Component, OnInit, Input } from '@angular/core';\nimport { WalletService } from '../../../../services/wallet/wallet.service';\nimport { TorusWallet, ImplicitAccount } from '../../../../services/wallet/wallet';\n\n@Component({\n  selector: 'app-card',\n  templateUrl: './card.component.html',\n  styleUrls: ['../../../../../scss/components/views/embedded/card/card.component.scss']\n})\nexport class CardComponent implements OnInit {\n  @Input() activeAccount: ImplicitAccount;\n\n  constructor(private walletService: WalletService) {}\n\n  ngOnInit(): void {}\n\n  displayName(): string {\n    if (this.walletService.wallet instanceof TorusWallet) {\n      return this.walletService.wallet.displayName();\n    } else {\n      return '';\n    }\n  }\n\n  verifier(): string {\n    if (this.walletService.wallet instanceof TorusWallet) {\n      return this.walletService.wallet.verifier;\n    } else {\n      return '';\n    }\n  }\n}\n","<div class=\"container\">\n    <div>\n        <img src=\"../../../assets/img/torus-login/{{verifier()}}-color.svg\" width=\"24\">\n        <h4>{{displayName()}}</h4>\n        <p>{{activeAccount.pkh}}</p>\n    </div>\n    <div>\n        <h4>BALANCE:</h4>\n        <h3>{{activeAccount.balanceXTZ || 0}} XTZ</h3>\n    </div>\n</div>\n","<app-signin *ngIf=\"login\" [dismiss]=\"dismiss\" [loginConfig]=\"loginConfig\" (loginResponse)=\"loginResponse($event)\"></app-signin>\n<app-send [embedded]=\"true\" *ngIf=\"externalRequest\" (operationResponse)=\"operationResponse($event)\" [headless]=true [externalRequest]=externalRequest\n    [template]=\"template\" [activeAccount]=activeAccount></app-send>\n<app-sign-expr-embed *ngIf=\"signRequest && activeAccount\" [signRequest]=\"signRequest\" [activeAccount]=activeAccount (signResponse)=\"signResponse($event)\"></app-sign-expr-embed>\n<app-card *ngIf=\"activeAccount && !blockCard && (!externalRequest && !login && !signRequest)\" [activeAccount]=activeAccount></app-card>\n","import { Component, ElementRef, OnInit } from '@angular/core';\nimport { TorusService } from '../../../services/torus/torus.service';\nimport { CONSTANTS } from '../../../../environments/environment';\nimport { ImportService } from '../../../services/import/import.service';\nimport { KeyPair, ExternalRequest } from '../../../interfaces';\nimport { WalletService } from '../../../services/wallet/wallet.service';\nimport { PartialTezosTransactionOperation } from '@airgap/beacon-sdk';\nimport { EmbeddedTorusWallet, ImplicitAccount } from '../../../services/wallet/wallet';\nimport { CoordinatorService } from '../../../services/coordinator/coordinator.service';\nimport { utils, common } from '@tezos-core-tools/crypto-utils';\nimport { ActivatedRoute } from '@angular/router';\nimport { LookupService } from '../../../services/lookup/lookup.service';\nimport { ActivityService } from '../../../services/activity/activity.service';\nimport { EmbeddedAuthService } from '../../../services/embedded-auth/embedded-auth.service';\nimport {\n  RequestTypes,\n  ResponseTypes,\n  RequestMessage,\n  ResponseMessage,\n  OperationResponse,\n  LogoutRequest,\n  TrackRequest,\n  LoginRequest,\n  OperationRequest,\n  AuthRequest,\n  CardRequest,\n  CardResponse,\n  SignExprRequest,\n  SignExprResponse,\n  LoginConfig,\n  LoginPrio\n} from 'kukai-embed';\nimport { Subscription } from 'rxjs';\nimport { SubjectService } from '../../../services/subject/subject.service';\nimport { InputValidationService } from '../../../services/input-validation/input-validation.service';\nenum Permission {\n  LOGIN = 'login',\n  OPERATIONS = 'operations',\n  MICHELINE = 'micheline',\n  MICHELINE_SILENT = 'micheline_silent'\n}\ninterface Permissions {\n  origins: string[];\n  permissions: {\n    [Permission.LOGIN]: boolean;\n    [Permission.OPERATIONS]: boolean;\n    [Permission.MICHELINE]: boolean;\n    [Permission.MICHELINE_SILENT]?: boolean;\n  };\n}\n@Component({\n  selector: 'app-embedded',\n  templateUrl: './embedded.component.html',\n  styleUrls: ['../../../../scss/components/views/embedded/embedded.component.scss']\n})\nexport class EmbeddedComponent implements OnInit {\n  readonly permissionMatrix: Record<string, Permissions> = {\n    brio: {\n      origins: ['https://playwithbrio.com', 'https://www.playwithbrio.com', 'https://production.playwithbrio.com'],\n      permissions: {\n        login: true,\n        operations: true,\n        micheline: true\n      }\n    },\n    minterpop: {\n      origins: ['https://minterpop.com'],\n      permissions: {\n        login: true,\n        operations: true,\n        micheline: true\n      }\n    },\n    interpop: {\n      origins: ['https://interpopcomics.com', 'https://www.interpopcomics.com'],\n      permissions: {\n        login: true,\n        operations: true,\n        micheline: true\n      }\n    },\n    humanMachine: {\n      origins: ['https://human-machine.io'],\n      permissions: {\n        login: true,\n        operations: false,\n        micheline: false\n      }\n    },\n    ubisoft: {\n      origins: ['*.ubisoft.com'],\n      permissions: {\n        login: true,\n        operations: false,\n        micheline: true\n      }\n    },\n    gap: {\n      origins: ['*.gap.com'],\n      permissions: {\n        login: true,\n        operations: true,\n        micheline: true,\n        micheline_silent: true\n      }\n    },\n    lexus: {\n      origins: ['https://ldai.lexusdesign.in'],\n      permissions: {\n        login: true,\n        operations: false,\n        micheline: false\n      }\n    },\n    blockspace: {\n      origins: ['https://block-space.app'],\n      permissions: {\n        login: true,\n        operations: false,\n        micheline: false\n      }\n    },\n    evian: {\n      origins: ['https://nft.evian.com'],\n      permissions: {\n        login: true,\n        operations: false,\n        micheline: false\n      }\n    },\n    souvie: {\n      origins: ['https://souvie.dev'],\n      permissions: {\n        login: true,\n        operations: false,\n        micheline: false\n      }\n    },\n    tzstaging: {\n      origins: ['*.tzstaging.com', 'https://tzstaging.com', 'https://tezos.com'],\n      permissions: {\n        login: true,\n        operations: false,\n        micheline: false\n      }\n    },\n    studioexception: {\n      origins: ['https://studioexception.eu'],\n      permissions: {\n        login: true,\n        operations: false,\n        micheline: true\n      }\n    },\n    cleantree: {\n      origins: ['https://cleantree.artshelp.net'],\n      permissions: {\n        login: true,\n        operations: false,\n        micheline: false\n      }\n    },\n    vitality: {\n      origins: ['*.vitality.gg'],\n      permissions: {\n        login: true,\n        operations: false,\n        micheline: false\n      }\n    }\n  };\n  constructor(\n    private torusService: TorusService,\n    private importService: ImportService,\n    private walletService: WalletService,\n    private coordinatorService: CoordinatorService,\n    private route: ActivatedRoute,\n    private lookupService: LookupService,\n    private activityService: ActivityService,\n    private embeddedAuthService: EmbeddedAuthService,\n    private subjectService: SubjectService,\n    private inputValidationService: InputValidationService,\n    private elRef: ElementRef\n  ) {}\n  pendingOps: string[] = [];\n  ophashSubscription: Subscription;\n  origin = '';\n  login = false;\n  dismiss: Boolean = null;\n  blockCard = true;\n  activeAccount: ImplicitAccount = null;\n  template = null;\n  externalRequest: ExternalRequest = null;\n  signRequest = null;\n  loginConfig: LoginConfig = null;\n  queueMode: LoginPrio = null;\n  currentInstanceId = '';\n\n  ngOnInit(): void {\n    const htmlElem = this.elRef.nativeElement.closest('html');\n    htmlElem.style.fontSize = '100%';\n    document.body.style.background = 'none';\n    this.torusService.initTorus();\n    if (window.addEventListener) {\n      window.addEventListener('message', this.handleRequest, false);\n    } else {\n      (window as any).attachEvent('onmessage', this.handleRequest);\n    }\n    console.log('icabod is connected...');\n    this.route.queryParams\n      .filter((params) => params.instanceId)\n      .subscribe((params) => {\n        this.walletService.loadStoredWallet(params.instanceId);\n        this.currentInstanceId = params.instanceId;\n        if (this.walletService.wallet instanceof EmbeddedTorusWallet) {\n          this.origin = this.walletService.wallet.origin;\n          this.subjectService.origin.next(this.origin);\n          if (this.walletService.wallet?.implicitAccounts[0]) {\n            this.activeAccount = this.walletService.wallet.implicitAccounts[0];\n            this.coordinatorService.startXTZ();\n            this.coordinatorService.start(this.activeAccount.address, this.coordinatorService.defaultDelayActivity);\n            this.subscribeToConfirmedOps();\n          }\n        }\n      });\n    window.parent.window.postMessage(JSON.stringify({ type: ResponseTypes.initComplete, failed: false }), this.origin || '*');\n  }\n  handleRequest = (evt) => {\n    try {\n      const data: RequestMessage = JSON.parse(evt.data);\n      if (this.hasPermission(null, evt.origin)) {\n        console.log(`Received ${evt.data} from ${evt.origin}`);\n        if (data && data.type) {\n          this.origin = evt.origin;\n          this.subjectService.origin.next(this.origin);\n          switch (data.type) {\n            case RequestTypes.loginRequest:\n              this.handleLoginRequest(data);\n              break;\n            case RequestTypes.operationRequest:\n              this.handleOperationRequest(data);\n              break;\n            case RequestTypes.signExprRequest:\n              this.handleSignExprRequest(data);\n              break;\n            case RequestTypes.trackRequest:\n              this.handleTrackRequest(data);\n              break;\n            case RequestTypes.logoutRequest:\n              this.handleLogoutRequest(data);\n              break;\n            case RequestTypes.authRequest:\n              this.handleAuthRequest(data);\n              break;\n            case RequestTypes.cardRequest:\n              this.handleCardRequest(data);\n              break;\n            case RequestTypes.dismissRequest:\n              this.dismiss = true;\n              break;\n            default:\n              console.warn('Unknown request', data);\n          }\n        }\n      } else if (data && data.type) {\n        console.error(`Invalid origin (${evt.origin})`);\n      }\n    } catch {}\n  };\n  private handleSignExprRequest(req: SignExprRequest) {\n    if (!this.hasPermission(Permission.MICHELINE)) {\n      const response: ResponseMessage = {\n        type: ResponseTypes.signExprResponse,\n        failed: true,\n        error: 'NO_PERMISSION'\n      };\n      this.sendResponse(response);\n      return;\n    }\n    if (this.walletService.wallet instanceof EmbeddedTorusWallet && this.walletService.wallet.implicitAccounts[0] && req.expr) {\n      if (req.expr.slice(0, 2) === '0x') {\n        req.expr = req.expr.slice(2);\n      }\n      if (this.inputValidationService.isMichelineExpr(req.expr)) {\n        if (req?.ui?.silent && this.hasPermission(Permission.MICHELINE_SILENT)) {\n          this.embeddedAuthService\n            .signExprSilent(req.expr)\n            .then((signature) => {\n              this.signResponse(signature);\n            })\n            .catch((e) => {\n              this.sendResponse({\n                type: ResponseTypes.signExprResponse,\n                failed: true,\n                error: e.message ? e.message : 'UNKNOWN_ERROR'\n              });\n            });\n        } else {\n          this.signRequest = {\n            payload: req.expr,\n            ui: this.normalizeTemplate(req?.ui)\n          };\n        }\n      } else {\n        this.sendResponse({\n          type: ResponseTypes.signExprResponse,\n          failed: true,\n          error: 'INVALID_PARAMETERS'\n        });\n      }\n    } else {\n      let response: ResponseMessage;\n      if (!(this.walletService.wallet instanceof EmbeddedTorusWallet) || !this.walletService.wallet.implicitAccounts[0]) {\n        response = {\n          type: ResponseTypes.signExprResponse,\n          failed: true,\n          error: 'NO_WALLET_FOUND'\n        };\n      } else {\n        response = {\n          type: ResponseTypes.signExprResponse,\n          failed: true,\n          error: 'INVALID_PARAMETERS'\n        };\n      }\n      this.sendResponse(response);\n    }\n  }\n  public signResponse(response: any) {\n    this.signRequest = null;\n    let resp: SignExprResponse;\n    if (response && typeof response === 'string' && response.length > 95 && response.slice(0, 5) === 'spsig') {\n      resp = {\n        type: ResponseTypes.signExprResponse,\n        failed: false,\n        signature: response\n      };\n    } else {\n      resp = {\n        type: ResponseTypes.signExprResponse,\n        failed: true,\n        error: 'ABORTED_BY_USER'\n      };\n    }\n    this.sendResponse(resp);\n  }\n  private handleLoginRequest(req: LoginRequest) {\n    if (!this.hasPermission(Permission.LOGIN)) {\n      const response: ResponseMessage = {\n        type: ResponseTypes.loginResponse,\n        failed: true,\n        error: 'NO_PERMISSION'\n      };\n      this.sendResponse(response);\n      return;\n    }\n    this.queueMode = req?.config.customPrio ? req?.config.customPrio : null;\n    if (this.activeAccount || (this.queueMode === 'low' && this.walletService.wallet)) {\n      const response: ResponseMessage = {\n        type: ResponseTypes.loginResponse,\n        failed: true,\n        error: 'ALREADY_LOGGED_IN'\n      };\n      this.sendResponse(response);\n    } else if (this.queueMode === 'high' && !this.walletService.wallet) {\n      const response: ResponseMessage = {\n        type: ResponseTypes.loginResponse,\n        failed: true,\n        error: 'NO_WALLET_FOUND'\n      };\n      this.sendResponse(response);\n    } else {\n      if (req?.config?.customSpinnerDismissal) {\n        this.dismiss = false;\n      }\n      if (req?.config) {\n        this.loginConfig = req.config;\n      }\n      this.login = true;\n    }\n  }\n  private handleOperationRequest(req: OperationRequest) {\n    if (!this.hasPermission(Permission.OPERATIONS)) {\n      const response: ResponseMessage = {\n        type: ResponseTypes.operationResponse,\n        failed: true,\n        error: 'NO_PERMISSION'\n      };\n      this.sendResponse(response);\n      return;\n    }\n    if (this.walletService.wallet instanceof EmbeddedTorusWallet && this.walletService.wallet.implicitAccounts[0] && req.operations) {\n      if (this.isValidOperation(req.operations)) {\n        this.template = req.ui ? this.normalizeTemplate(req.ui) : null;\n        this.externalRequest = { operationRequest: req.operations, selectedAccount: this.activeAccount };\n      } else {\n        this.externalRequest = null;\n        this.sendResponse({\n          type: ResponseTypes.operationResponse,\n          failed: true,\n          error: 'INVALID_TRANSACTION'\n        });\n      }\n    } else {\n      this.sendResponse({\n        type: ResponseTypes.operationResponse,\n        failed: true,\n        error: 'NO_WALLET_FOUND'\n      });\n    }\n  }\n  private async handleTrackRequest(req: TrackRequest) {\n    this.pendingOps.push(req.opHash);\n  }\n  private handleLogoutRequest(req: LogoutRequest) {\n    if (this.walletService.wallet instanceof EmbeddedTorusWallet && this.walletService.wallet.instanceId) {\n      const instanceId = this.walletService.wallet.instanceId;\n      this.logout(instanceId);\n      this.sendResponse({\n        type: ResponseTypes.logoutResponse,\n        instanceId,\n        failed: false\n      });\n    } else {\n      this.noWalletError();\n    }\n  }\n  async loginResponse(loginData: any) {\n    let response: ResponseMessage;\n    let toImport: any;\n    if (loginData === 'dismiss') {\n      this.dismiss = null;\n      response = {\n        type: ResponseTypes.dismissResponse,\n        failed: false\n      };\n    } else if (loginData) {\n      const { keyPair, userInfo } = loginData;\n      const { idToken = '', accessToken = '', long_lived_token = '', ...filteredUserInfo } = { ...userInfo };\n      let instanceId;\n      if (\n        this.walletService.wallet &&\n        this.walletService.wallet instanceof EmbeddedTorusWallet &&\n        keyPair?.pk &&\n        !this.walletService.wallet.implicitAccounts[0] &&\n        this.currentInstanceId\n      ) {\n        instanceId = this.currentInstanceId;\n      } else {\n        // 160 bits of entropy, base58 encoded\n        instanceId = this.generateInstanceId();\n      }\n      response = {\n        type: ResponseTypes.loginResponse,\n        instanceId,\n        pk: keyPair.pk,\n        pkh: keyPair.pkh,\n        userData: filteredUserInfo,\n        failed: false\n      };\n      toImport = { keyPair, userInfo, instanceId };\n      if (this.loginConfig?.authParams) {\n        try {\n          response.authResponse = await this.embeddedAuthService.authenticate(this.loginConfig.authParams, this.origin, keyPair);\n        } catch (e) {\n          console.error(e);\n          response = {\n            type: ResponseTypes.loginResponse,\n            failed: true,\n            error: e?.message\n          };\n          toImport = undefined;\n        }\n      }\n    } else {\n      this.dismiss = null;\n      response = {\n        type: ResponseTypes.loginResponse,\n        failed: true,\n        error: 'ABORTED_BY_USER'\n      };\n    }\n    const loginConfig = this.loginConfig;\n    if (this.dismiss === null) {\n      this.login = false;\n      this.loginConfig = null;\n    }\n    setTimeout(() => {\n      this.sendResponse(response);\n      if (toImport) {\n        if (loginConfig?.strictAuth) {\n          toImport.keyPair.sk = '';\n        }\n        this.importAccount(toImport.keyPair, toImport.userInfo, toImport.instanceId);\n      }\n    }, 10);\n  }\n  async handleAuthRequest(authReq: AuthRequest) {\n    if (!this.hasPermission(Permission.LOGIN)) {\n      const response: ResponseMessage = {\n        type: ResponseTypes.loginResponse,\n        failed: true,\n        error: 'NO_PERMISSION'\n      };\n      this.sendResponse(response);\n      return;\n    }\n    this.embeddedAuthService\n      .authenticate(authReq, this.origin)\n      .then((authResponse: any) => {\n        this.sendResponse({\n          type: ResponseTypes.authResponse,\n          failed: false,\n          message: authResponse.message,\n          signature: authResponse.signature\n        });\n      })\n      .catch((e: Error) => {\n        this.sendResponse({\n          type: ResponseTypes.authResponse,\n          failed: true,\n          error: e.message ? e.message : 'UNKNOWN_ERROR'\n        });\n      });\n  }\n  handleCardRequest(req: CardRequest) {\n    this.blockCard = !req.show;\n    const response: CardResponse = {\n      type: ResponseTypes.cardResponse,\n      failed: false\n    };\n    this.sendResponse(response);\n  }\n  noWalletError() {\n    this.sendResponse({\n      type: ResponseTypes.logoutResponse,\n      failed: true,\n      error: 'NO_WALLET_FOUND'\n    });\n  }\n  operationResponse(opHash: any) {\n    let response: OperationResponse;\n    let errorMessage = '';\n    if (opHash?.error && opHash.errorMessage) {\n      errorMessage = opHash.errorMessage;\n      opHash = opHash.error;\n    }\n    if (!opHash) {\n      response = {\n        type: ResponseTypes.operationResponse,\n        failed: true,\n        error: 'ABORTED_BY_USER'\n      };\n    } else if (opHash === 'exceeded_threshold') {\n      response = {\n        type: ResponseTypes.operationResponse,\n        failed: true,\n        error: 'EXEEDED_THRESHOLD'\n      };\n    } else if (opHash === 'broadcast_error') {\n      response = {\n        type: ResponseTypes.operationResponse,\n        failed: true,\n        error: 'BROADCAST_ERROR',\n        errorMessage\n      };\n    } else if (opHash === 'invalid_parameters') {\n      response = {\n        type: ResponseTypes.operationResponse,\n        failed: true,\n        error: 'INVALID_PARAMETERS',\n        errorMessage\n      };\n    } else if (utils.validOperationHash(opHash)) {\n      response = {\n        type: ResponseTypes.operationResponse,\n        opHash,\n        failed: false\n      };\n    } else {\n      console.warn('Unknown operation response:', opHash);\n      response = {\n        type: ResponseTypes.operationResponse,\n        failed: true,\n        error: 'UNKNOWN_ERROR'\n      };\n    }\n    this.template = null;\n    this.externalRequest = null;\n    setTimeout(() => {\n      this.sendResponse(response);\n    }, 0);\n  }\n  private sendResponse(resp: ResponseMessage) {\n    window.parent.window.postMessage(JSON.stringify(resp), this.origin);\n  }\n  private async importAccount(keyPair: KeyPair, userInfo: any, instanceId: string) {\n    if (keyPair?.pk) {\n      await this.importService\n        .importWalletFromPk(\n          keyPair.pk,\n          '',\n          {\n            verifier: userInfo.typeOfLogin,\n            id: userInfo.verifierId,\n            name: userInfo.name,\n            embedded: true,\n            origin: this.origin\n          },\n          keyPair.sk,\n          instanceId\n        )\n        .then((success: boolean) => {\n          if (success) {\n            this.activeAccount = this.walletService.wallet.implicitAccounts[0];\n            this.coordinatorService.startXTZ();\n            this.coordinatorService.start(this.activeAccount.address, this.coordinatorService.defaultDelayActivity);\n            this.subscribeToConfirmedOps();\n          }\n        });\n    } else if (keyPair?.pk === '') {\n      // login without keys\n      await this.importService.importWalletFromPk(\n        keyPair.pk,\n        '',\n        {\n          verifier: userInfo.typeOfLogin,\n          id: userInfo.verifierId,\n          name: userInfo.name,\n          embedded: true,\n          origin: this.origin\n        },\n        '',\n        instanceId\n      );\n    }\n    this.currentInstanceId = instanceId;\n  }\n  private isValidOperation(transactions: PartialTezosTransactionOperation[]): boolean {\n    try {\n      transactions.forEach((tx) => {\n        if (tx.kind !== 'transaction' || typeof tx.amount !== 'string' || !utils.validAddress(tx.destination)) {\n          throw new Error('Invalid transaction');\n        }\n      });\n    } catch (e) {\n      console.warn(e);\n      return false;\n    }\n    return true;\n  }\n  private generateInstanceId(): string {\n    return common.base58encode(utils.mnemonicToEntropy(utils.generateMnemonic(15)), new Uint8Array([]));\n  }\n  private logout(instanceId: string) {\n    this.subjectService.logout.next(true);\n    this.walletService.clearWallet(instanceId);\n    this.lookupService.clear();\n    this.activeAccount = null;\n    if (this.ophashSubscription) {\n      this.ophashSubscription.unsubscribe();\n    }\n    this.currentInstanceId = '';\n  }\n  subscribeToConfirmedOps() {\n    this.ophashSubscription = this.subjectService.confirmedOp.subscribe((opHash) => {\n      if (this.pendingOps.includes(opHash)) {\n        this.sendResponse({\n          type: ResponseTypes.trackResponse,\n          opHash: opHash,\n          failed: false\n        });\n        for (let i = 0; i < this.pendingOps.length; i++) {\n          if (this.pendingOps[i] === opHash) {\n            this.pendingOps.splice(i, 1);\n          }\n        }\n      }\n    });\n  }\n  private normalizeTemplate(template: any): any {\n    if (template?.descriptions) {\n      for (let i in template.descriptions) {\n        if (typeof template.descriptions[i] === 'string') {\n          template.descriptions[i] = {\n            text: template.descriptions[i]\n          };\n        }\n      }\n    }\n    return template;\n  }\n  private hasPermission(permission: Permission, origin: string = this.origin): boolean {\n    if (!CONSTANTS.MAINNET) {\n      return true;\n    }\n    try {\n      const keys = Object.keys(this.permissionMatrix);\n      for (const key of keys) {\n        for (const allowedOrigin of this.permissionMatrix[key].origins) {\n          if (allowedOrigin.startsWith('*.') ? origin.endsWith(allowedOrigin.slice(1)) : origin === allowedOrigin) {\n            return permission ? this.permissionMatrix[key].permissions[permission] : !!this.permissionMatrix[key].permissions;\n          }\n        }\n      }\n    } catch (e) {\n      console.error(e);\n    }\n    return false;\n  }\n}\n","<div *ngIf=\"isOpen\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-row top\">\n      <div class=\"flex-row button close\" (click)=\"closeModal()\"><img class=\"x\"\n          src=\"../../../assets/img/close-btn-x.png\" /></div>\n      <h1 class=\"title\">Receive Address</h1>\n    </div>\n    <div class=\"seperator\"></div>\n    <div class=\"flex-column receive\">\n      <label class=\"value\">Your account QR code</label>\n      <canvas id='canvas'></canvas>\n      <span class=\"flex-row value\">{{ activeAddress }}<img class=\"copy\" src=\"../../../assets/img/copy-icon.svg\"\n          (click)=\"copy()\" /></span>\n    </div>\n  </div>\n</div>","import { Component, OnInit } from '@angular/core';\nimport * as QRCode from 'qrcode';\nimport { MessageService } from '../../../services/message/message.service';\nimport { ModalComponent } from '../modal.component';\nimport copy from 'copy-to-clipboard';\nimport { TranslateService } from '@ngx-translate/core';\n\n@Component({\n  selector: 'app-receive',\n  templateUrl: './receive.component.html',\n  styleUrls: ['../../../../scss/components/modals/modal.scss']\n})\nexport class ReceiveComponent extends ModalComponent implements OnInit {\n  activeAddress: string;\n  showReceiveFormat = {\n    btnOutline: true,\n    dropdownItem: false\n  };\n\n  name = 'receive';\n\n  constructor(private messageService: MessageService, private translate: TranslateService) {\n    super();\n  }\n\n  ngOnInit(): void {}\n  open(data: any): void {\n    this.activeAddress = data.address;\n    setTimeout(() => {\n      this.getQR();\n    }, 100);\n    super.open(data);\n  }\n  closeModal(): void {\n    ModalComponent.currentModel.next({ name: '', data: null });\n  }\n  getQR(): void {\n    QRCode.toCanvas(\n      document.getElementById('canvas'),\n      this.activeAddress,\n      {\n        errorCorrectionLevel: 'H',\n        scaleFactor: 2,\n        color: { light: '#FCFCFC' }\n      },\n      function (err, canvas) {\n        if (err) {\n          throw err;\n        }\n      }\n    );\n  }\n  copy(): void {\n    copy(this.activeAddress);\n    const copyToClipboard = this.translate.instant('OVERVIEWCOMPONENT.COPIEDTOCLIPBOARD');\n    this.messageService.add(this.activeAddress + ' ' + copyToClipboard, 5);\n  }\n}\n","<div *ngIf=\"isOpen\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-row top\">\n      <div class=\"flex-row button close\" (click)=\"closeModal()\"><img class=\"x\" src=\"../../../assets/img/close-btn-x.png\" /></div>\n      <h1 class=\"title\">Add New Account</h1>\n    </div>\n    <div class=\"seperator\"></div>\n    <div class=\"flex-column new-account\">\n      <div class=\"label\">\n        ENTER YOUR PASSWORD TO CONFIRM\n      </div>\n      <input #pwdInput [(ngModel)]=\"password\" class=\"text password\" autocomplete=\"current-password\"\n        placeholder=\"Password\" type=\"password\" (input)=\"this.errorMsg = ''\" (change)=\"this.errorMsg = ''\" (keydown.enter)=\"!messageService.spinnerOn ? addPkh() : null\">\n      <span *ngIf=\"this.errorMsg\" class=\"danger margin\">{{ this.errorMsg }}</span>\n      <div class=\"flex-column bottom\">\n        <div class=\"seperator\"></div>\n        <button class=\"confirm\" (click)=\"!messageService.spinnerOn ? addPkh() : null\">Confirm</button>\n      </div>\n    </div>\n  </div>\n</div>","import { Component, OnInit, ViewChild, ElementRef } from '@angular/core';\nimport { WalletService } from '../../../services/wallet/wallet.service';\nimport { HdWallet } from '../../../services/wallet/wallet';\nimport { CoordinatorService } from '../../../services/coordinator/coordinator.service';\nimport { MessageService } from '../../../services/message/message.service';\nimport { ModalComponent } from '../modal.component';\nimport { Router } from '@angular/router';\n\n@Component({\n  selector: 'app-new-implicit',\n  templateUrl: './new-implicit.component.html',\n  styleUrls: ['../../../../scss/components/modals/modal.scss']\n})\nexport class NewImplicitComponent extends ModalComponent implements OnInit {\n  @ViewChild('pwdInput') pwdView: ElementRef;\n  password = '';\n  errorMsg = '';\n  name = 'new-implicit';\n  constructor(\n    public walletService: WalletService,\n    private coordinatorService: CoordinatorService,\n    private messageService: MessageService,\n    private router: Router\n  ) {\n    super();\n  }\n  openModal(): void {\n    if (this.openPkhSpot()) {\n      ModalComponent.currentModel.next({ name: this.name, data: null });\n      this.clear();\n      setTimeout(() => {\n        const inputElem = this.pwdView.nativeElement as HTMLInputElement;\n        inputElem.focus();\n      }, 100);\n    } else {\n      this.messageService.addWarning(\"Can't create additional accounts when an unused account already exists\");\n    }\n  }\n  closeModal(): void {\n    ModalComponent.currentModel.next({ name: '', data: null });\n    this.clear();\n  }\n  ngOnInit(): void {}\n  async addPkh(): Promise<void> {\n    if (this.openPkhSpot()) {\n      this.messageService.startSpinner('Creating new account');\n      const pkh = await this.walletService.incrementAccountIndex(this.password);\n      if (pkh) {\n        this.coordinatorService.start(pkh, this.coordinatorService.defaultDelayActivity);\n        this.closeModal();\n        this.router.navigateByUrl(`/account/${pkh}`);\n      } else {\n        this.errorMsg = 'Wrong password!';\n      }\n      this.messageService.stopSpinner();\n    } else {\n      console.log('blocked!');\n      this.messageService.addError(\"Can't create additional accounts when an unused account already exists\");\n    }\n  }\n  openPkhSpot(): boolean {\n    const balance: number = this.walletService.wallet.implicitAccounts[this.walletService.wallet.implicitAccounts.length - 1].balanceXTZ;\n    const tokens = this.walletService.wallet.implicitAccounts[this.walletService.wallet.implicitAccounts.length - 1].tokens?.length;\n    return this.walletService.wallet instanceof HdWallet && ((balance && balance > 0) || (tokens && tokens > 0));\n  }\n  clear(): void {\n    this.password = '';\n    this.errorMsg = '';\n  }\n}\n","<div class=\"flex-row dropdown pr-request\" [class.expanded]=\"isOpen\" [id]=\"ecmpId\">\n  <div class=\"flex-row currentAddress\" (click)=\"toggleDropdown()\"><img\n      *ngIf=\"!!getUsername(selection?.address)\" class=\"logo\" src=\"../../../../assets/img/{{ getVerifier() }}-logo.svg\" /><span\n      class=\"address\">{{\n      getUsername(selection?.address) || \"&nbsp;&nbsp;&nbsp;&nbsp;\" + selection?.address }}</span><img\n      *ngIf=\"['', 'domain'].includes(getVerifier())\" class=\"button icon-db\"\n      src=\"../../../../assets/img/down-arrow.svg\" />\n  </div>\n  <div class=\"flex-column dropdown-content\">\n    <ng-container *ngFor=\"let account of options\">\n      <div class=\"option\" [class.selected]=\"account?.address === current?.address\"\n        (click)=\"selection = account; toggleDropdown()\">\n        <ng-container *ngIf=\"getUsername(account?.address)\">\n          <div class=\"flex-row alias\"><img class=\"logo\"\n              src=\"../../../../assets/img/{{ getVerifier() }}-logo.svg\" /><span>{{\n              getUsername(account?.address) }}</span></div>\n          <br /><span>{{\n            account?.address }}</span>\n        </ng-container>\n        <ng-container *ngIf=\"!getUsername(account?.address)\">{{ account?.address }}</ng-container>\n      </div>\n    </ng-container>\n  </div>\n</div>","import { Component, OnChanges, OnInit, SimpleChanges } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { TorusWallet } from '../../../../services/wallet/wallet';\nimport { LookupService } from '../../../../services/lookup/lookup.service';\nimport { WalletService } from '../../../../services/wallet/wallet.service';\nimport { DropdownComponent } from '../dropdown.component';\n\n@Component({\n  selector: 'app-ui-dropdown-permission-request',\n  templateUrl: './permission-request.component.html',\n  styleUrls: ['../../../../../scss/components/ui/dropdown/account-dropdown.component.scss']\n})\nexport class PermissionRequestDropdownComponent extends DropdownComponent implements OnInit, OnChanges {\n  constructor(public router: Router, public lookupService: LookupService, private walletService: WalletService) {\n    super();\n  }\n\n  ngOnInit(): void {\n    this.selection = this.current;\n    this.list = this.options;\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.options && changes.options.currentValue !== changes.options.previousValue) {\n      this.list = this.options;\n    }\n  }\n\n  getUsername(address: string): string {\n    if (this.walletService.wallet instanceof TorusWallet) {\n      return this.walletService.wallet.displayName();\n    } else {\n      const party = this.lookupService.resolve({\n        address: address || this.current?.address\n      });\n      if (party?.name) {\n        return party.name;\n      }\n    }\n    return '';\n  }\n  getVerifier(): string {\n    if (this.walletService.wallet instanceof TorusWallet) {\n      return this.walletService.wallet.verifier;\n    } else {\n      return 'domain';\n    }\n  }\n\n  toggleDropdown(): void {\n    this.dropdownResponse.emit(this.selection);\n    this.isOpen = !this.isOpen;\n  }\n}\n","<div *ngIf=\"permissionRequest\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-row top\">\n      <div class=\"flex-row button close\" (click)=\"rejectPermissions()\"><img class=\"x\" src=\"../../../assets/img/close-btn-x.png\" /></div>\n      <h1 class=\"title\">{{ permissionRequest.appMetadata.name }}</h1>\n    </div>\n    <div class=\"seperator\"></div>\n    <div class=\"flex-column permission-request\">\n      <ng-container *ngIf=\"cachedIcon(permissionRequest); let cachedIcon;\"><app-asset class=\"app-icon\" [assets]=\"{ displayAsset: cachedIcon }\"></app-asset></ng-container>\n      <h4>Permissions requests:</h4>\n      <div class=\"flex-row-wrap requests\">\n        <span class=\"flex-row\" *ngFor=\"let scope of permissionRequest.scopes\">{{ scopeToText(scope) }}</span>\n      </div>\n      <h6>Apply To Account:</h6>\n      <app-ui-dropdown-permission-request [options]=\"accounts\" [current]=\"preSelectedAccount\" (dropdownResponse)=\"selectedAccount = $event\" style=\"width: 100%;align-self: center;\"></app-ui-dropdown-permission-request>\n      <div class=\"flex-column bottom\">\n        <div class=\"seperator\"></div>\n        <button class=\"blue confirm\" (click)=\"grantPermissions()\">Approve</button>\n      </div>\n    </div>\n  </div>\n</div>","import { Component, OnInit, Input, EventEmitter, Output, OnChanges, SimpleChanges, OnDestroy } from '@angular/core';\nimport { WalletService } from '../../../services/wallet/wallet.service';\nimport { MessageService } from '../../../services/message/message.service';\nimport { Subscription } from 'rxjs';\nimport { SubjectService } from '../../../services/subject/subject.service';\nimport { Router } from '@angular/router';\nimport { BeaconService } from '../../../services/beacon/beacon.service';\nimport { Account } from '../../../services/wallet/wallet';\n\n@Component({\n  selector: 'app-permission-request',\n  templateUrl: './permission-request.component.html',\n  styleUrls: ['../../../../scss/components/modals/modal.scss']\n})\nexport class PermissionRequestComponent implements OnInit, OnChanges, OnDestroy {\n  @Input() permissionRequest: any;\n  @Input() activeAccount;\n  @Output() permissionResponse = new EventEmitter();\n  syncSub: Subscription;\n  preSelectedAccount: Account;\n  selectedAccount: Account;\n  accounts: Account[];\n  private subscriptions: Subscription = new Subscription();\n  constructor(\n    public walletService: WalletService,\n    private messageService: MessageService,\n    private subjectService: SubjectService,\n    private router: Router,\n    private beaconService: BeaconService\n  ) {}\n  ngOnInit(): void {\n    if (this.walletService.wallet) {\n      this.preSelectedAccount = this.selectedAccount = this.activeAccount?.address?.startsWith('tz')\n        ? this.activeAccount\n        : this.walletService.wallet.implicitAccounts[0];\n    }\n    this.subscriptions.add(\n      this.subjectService.walletUpdated.subscribe(async () => {\n        this.accounts = this.walletService.wallet?.getImplicitAccounts();\n      })\n    );\n    this.accounts = this.walletService.wallet?.getImplicitAccounts();\n  }\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.activeAccount) {\n      this.preSelectedAccount = this.selectedAccount = this.activeAccount?.address?.startsWith('tz')\n        ? this.activeAccount\n        : this.walletService.wallet.implicitAccounts[0];\n    }\n    if (this.permissionRequest) {\n      const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\n      document.body.style.marginRight = scrollBarWidth.toString();\n      document.body.style.overflow = 'hidden';\n      this.messageService.removeBeaconMsg(true);\n      this.syncSub = this.subjectService.beaconResponse.subscribe((response) => {\n        if (response) {\n          this.permissionResponse.emit('silent');\n          this.reset();\n        }\n      });\n    }\n  }\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n  rejectPermissions(): void {\n    this.permissionResponse.emit(null);\n    this.reset();\n  }\n  grantPermissions(): void {\n    const pk = this.selectedAccount?.pk;\n    this.permissionResponse.emit(pk);\n    this.reset();\n    this.router.navigate([`/account/${this.selectedAccount.address}`]);\n  }\n  reset(): void {\n    document.body.style.marginRight = '';\n    document.body.style.overflow = '';\n    this.permissionRequest = null;\n    if (this.syncSub) {\n      this.syncSub.unsubscribe();\n      this.syncSub = undefined;\n    }\n  }\n  scopeToText(scope: string): string {\n    if (scope === 'sign') {\n      return 'Request other signing';\n    } else if (scope === 'operation_request') {\n      return 'Request operation signing';\n    }\n    return scope;\n  }\n  cachedIcon(permissionRequest): string {\n    if (permissionRequest) {\n      for (const app of this.beaconService.peers) {\n        if (permissionRequest.senderId === app.senderId) {\n          if (app.cachedIcon) {\n            return app.cachedIcon;\n          }\n        }\n      }\n    }\n    return '';\n  }\n}\n","<div *ngIf=\"signRequest\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-row top\">\n      <div class=\"flex-row button close\" (click)=\"rejectSigning()\"><img class=\"x\" src=\"../../../assets/img/close-btn-x.png\" /></div>\n      <h1 class=\"title\">\n        <ng-container *ngIf=\"isMessage\">Sign Message</ng-container>\n        <ng-container *ngIf=\"!isMessage\">Sign Expression</ng-container>\n      </h1>\n    </div>\n    <div class=\"flex-column sign-expr\">\n      <p class=\"previewAttention\">An application has requested you sign a<ng-container *ngIf=\"isMessage\"> message</ng-container><ng-container *ngIf=\"!isMessage\">n expression</ng-container></p>\n      <p *ngIf=\"!isMessage\" class=\"previewAttention warning\">Warning! Only sign if you understand the expression or trust the source.</p>\n      <app-ui-toggle-advanced *ngIf=\"!isMessage\" style=\"width: 13rem; margin-bottom: 2rem;\" [default]=\"false\" (stateChange)=\"advancedForm = $event\"></app-ui-toggle-advanced>\n      <textarea *ngIf=\"advancedForm || isMessage\" rows=\"10\" readonly>{{ payload }}</textarea>\n      <div class=\"seperator\" style =\"left: 0\"></div>\n      <div class=\"flex-column bottom\">\n        <span *ngIf=\"this.pwdInvalid\" class=\"danger margin\">{{ this.pwdInvalid }}</span>\n        <input *ngIf=\"walletService.isPwdWallet()\" [(ngModel)]=\"password\"\n          autocomplete=\"current-password\" placeholder=\"Password\" class=\"text password\" type=\"password\"\n          (input)=\"this.pwdInvalid = ''\" (change)=\"this.pwdInvalid = ''\" (keydown.enter)='!messageService.spinnerOn ? sign(): null'>\n        <button class=\"purple confirm\" (click)=\"!messageService.spinnerOn ? sign(): null\" [disabled]=\"walletService.isWatchWallet()\">\n          {{ walletService.isLedgerWallet() ? 'Sign with Ledger' : 'Sign'}}</button>\n      </div>\n    </div>\n  </div>\n</div>","import { Component, OnInit, SimpleChanges, Input, Output, EventEmitter, OnChanges } from '@angular/core';\nimport { WalletService } from '../../../services/wallet/wallet.service';\nimport { MessageService } from '../../../services/message/message.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Account } from '../../../services/wallet/wallet';\nimport { OperationService } from '../../../services/operation/operation.service';\nimport { emitMicheline } from '@taquito/michel-codec';\nimport { valueDecoder } from '@taquito/local-forging/dist/lib/michelson/codec';\nimport { Uint8ArrayConsumer } from '@taquito/local-forging/dist/lib/uint8array-consumer';\nimport { LedgerService } from '../../../services/ledger/ledger.service';\nimport { InputValidationService } from '../../../services/input-validation/input-validation.service';\nimport { ModalComponent } from '../modal.component';\nimport { Subscription } from 'rxjs';\nimport { SubjectService } from '../../../services/subject/subject.service';\n\n@Component({\n  selector: 'app-sign-expr',\n  templateUrl: './sign-expr.component.html',\n  styleUrls: ['../../../../scss/components/modals/modal.scss']\n})\nexport class SignExprComponent extends ModalComponent implements OnInit, OnChanges {\n  @Input() signRequest: any;\n  @Input() activeAccount: Account;\n  @Output() signResponse = new EventEmitter();\n  syncSub: Subscription;\n  password = '';\n  pwdInvalid = '';\n  payload = '';\n  isMessage = false;\n  advancedForm = false;\n  name = 'sign-expr';\n  constructor(\n    public walletService: WalletService,\n    private messageService: MessageService,\n    public translate: TranslateService,\n    private operationService: OperationService,\n    private ledgerService: LedgerService,\n    private inputValidationService: InputValidationService,\n    private subjectService: SubjectService\n  ) {\n    super();\n  }\n  ngOnInit(): void {}\n  ngOnChanges(changes: SimpleChanges): void {\n    if (this.signRequest) {\n      ModalComponent.currentModel.next({ name: this.name, data: null });\n      this.isMessage = this.inputValidationService.isMessageSigning(this.signRequest.payload);\n      const value = valueDecoder(Uint8ArrayConsumer.fromHexString(this.signRequest.payload.slice(2)));\n      const payload = emitMicheline(value, {\n        indent: '  ',\n        newline: '\\n'\n      });\n      this.payload = this.isMessage ? value.string : payload;\n      this.syncSub = this.subjectService.beaconResponse.subscribe((response) => {\n        if (response) {\n          this.signResponse.emit('silent');\n          this.closeModal();\n        }\n      });\n    }\n  }\n  async sign(): Promise<void> {\n    if (this.walletService.isLedgerWallet()) {\n      this.requestLedgerSignature();\n    } else {\n      const pwd = this.password;\n      this.password = '';\n      await this.messageService.startSpinner(`Signing ${this.isMessage ? 'message' : 'payload'}...`);\n      let keys;\n      try {\n        keys = await this.walletService.getKeys(pwd, this.activeAccount.pkh);\n      } catch (e) {\n        console.warn(e);\n        this.messageService.stopSpinner();\n      }\n      if (keys) {\n        this.pwdInvalid = '';\n        try {\n          const signature = this.operationService.sign(this.signRequest.payload, keys.sk).edsig;\n          this.acceptSigning(signature);\n        } catch (e) {\n          this.pwdInvalid = 'Signing failed';\n          console.warn(e);\n        } finally {\n          this.messageService.stopSpinner();\n        }\n      } else {\n        this.messageService.stopSpinner();\n        if (this.walletService.isTorusWallet()) {\n          this.pwdInvalid = `Authorization failed`;\n        } else {\n          this.pwdInvalid = this.translate.instant('SENDCOMPONENT.WRONGPASSWORD');\n        }\n      }\n    }\n  }\n  async requestLedgerSignature(): Promise<void> {\n    await this.messageService.startSpinner('Waiting for Ledger signature...');\n    try {\n      const payload = this.signRequest.payload;\n      let signature = '';\n      if (payload.length <= 2290) {\n        signature = await this.ledgerService.signOperation(payload, this.walletService.wallet.implicitAccounts[0].derivationPath);\n      } else {\n        signature = await this.ledgerService.signHash(\n          this.operationService.ledgerPreHash(payload),\n          this.walletService.wallet.implicitAccounts[0].derivationPath\n        );\n      }\n      if (signature) {\n        this.acceptSigning(this.operationService.hexsigToEdsig(signature));\n      } else {\n        this.pwdInvalid = 'Failed to sign transaction';\n      }\n    } finally {\n      this.messageService.stopSpinner();\n    }\n  }\n  rejectSigning(): void {\n    this.closeModal();\n    this.signResponse.emit(null);\n  }\n  acceptSigning(signature: string): void {\n    this.messageService.addSuccess(this.isMessage ? 'Message signed!' : 'Payload signed!');\n    this.closeModal();\n    this.signResponse.emit(signature);\n  }\n  closeModal(): void {\n    ModalComponent.currentModel.next({ name: '', data: null });\n    this.clear();\n  }\n  clear(): void {\n    this.password = '';\n    this.pwdInvalid = '';\n    this.payload = '';\n    this.isMessage = false;\n    if (this.syncSub) {\n      this.syncSub.unsubscribe();\n      this.syncSub = undefined;\n    }\n  }\n}\n","<div *ngIf=\"isOpen\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-row top\">\n      <div class=\"flex-row button close\" (click)=\"closeModalAction()\"><img class=\"x\"\n          src=\"../../../assets/img/close-btn-x.png\" /></div>\n      <h1 class=\"title\">Originate</h1>\n    </div>\n    <div class=\"seperator\"></div>\n    <div class=\"flex-column originate\">\n      <div class=\"flex-column top\">\n        <span class=\"amount key\">AMOUNT:&nbsp;<span class=\"value\">{{ this.balance ? this.balance + ' ' + 'tez' : ''\n            }}</span></span>\n        <!-- <span class=\"amount-usd\"> </span> -->\n        <span class=\"section key\">From:&nbsp;<span class=\"from\">{{ externalRequest?.selectedAccount?.address }}</span></span>\n      </div>\n      <br />\n      <div class=\"flex-row attrs\">\n        <div class=\"flex-row attr\">\n          <span class=\"key\">FEE:&nbsp;</span><span class=\"value\">{{ this.getTotalFee() }} tez</span>\n        </div>\n        <div class=\"flex-row attr\">\n          <span class=\"key\">MAX STORAGE COST:&nbsp;</span><span class=\"value\">{{ getTotalBurn() }} tez</span>\n        </div>\n      </div>\n      <app-ui-toggle-advanced style=\"width: calc(100% - 1em);margin: 2em 0;\" [default]=\"false\"\n        (stateChange)=\"advancedForm = $event\">\n      </app-ui-toggle-advanced>\n      <form autocomplete=\"off\" *ngIf=\"advancedForm\" class=\"advanced-form\">\n        <div class=\"tabs-container\">\n          <div class=\"flex-row tabs\">\n            <span class=\"tab\" [class.active]=\"activeTab === 0\" (click)=\"activeTab = 0\">Code</span>\n            <span class=\"tab\" [class.active]=\"activeTab === 1\" (click)=\"activeTab = 1\">Storage</span>\n          </div>\n        </div>\n        <textarea rows=\"10\" readonly>{{ getScript() }}</textarea>\n        <ng-container *ngIf=\"!(walletService.isLedgerWallet() && !ledgerError)\">\n          <div class=\"flex-row\">\n            <div class=\"flex-column\">\n              <label class=\"label\">Gas limit</label>\n              <input numericinput=\"decimal\" name=\"none\" type=\"text\" class=\"text\" placeholder={{this.defaultTransactionParams.gas.toString()}}\n                [(ngModel)]=\"customGas\">\n            </div>\n            <div class=\"flex-column\">\n              <label class=\"label\">Fee</label>\n              <input numericinput=\"decimal\" name=\"none\" type=\"text\" class=\"text\" (keypress)=\"keyPressNumbersDecimal($event, 'customFee')\"\n                placeholder={{this.defaultTransactionParams.fee.toString()}} [(ngModel)]=\"customFee\">\n            </div>\n          </div>\n          <div class=\"flex-row\">\n            <div class=\"flex-column\">\n              <label class=\"label\">Storage limit</label>\n              <input numericinput=\"decimal\" name=\"none\" type=\"text\" class=\"text\"\n                placeholder={{this.defaultTransactionParams?.storage.toString()}} [(ngModel)]=\"customStorage\">\n            </div>\n            <div class=\"flex-column\">\n              <label class=\"label\">Max storage cost</label>\n              <input numericinput=\"decimal\" name=\"none\" type=\"text\" class=\"text read-only\" [value]=\"burnAmount() ? burnAmount() : '0 tez'\"\n                tabindex=-1 readonly>\n            </div>\n          </div>\n        </ng-container>\n      </form>\n      <span *ngIf=\"formInvalid\" class=\"danger margin\">\n        {{ formInvalid }}\n      </span>\n      <div class=\"flex-column bottom\">\n        <div class=\"seperator\"></div>\n        <br />\n        <ng-container *ngIf=\"walletService.isPwdWallet()\">\n          <input name=\"none\" [(ngModel)]=\"password\" placeholder=\"Password\" autocomplete=\"current-password\"\n            class=\"text password\" type=\"password\" (input)=\"this.pwdInvalid = ''\" (paste)=\"this.pwdInvalid = ''\"\n            (keydown.enter)='!messageService.spinnerOn ? inject() : null'>\n        </ng-container>\n        <button *ngIf=\"walletService.isLedgerWallet() && ledgerError; else elseBlock\" class=\"blue confirm\"\n          (click)=\"ledgerSign()\">Sign with Ledger</button>\n        <ng-template #elseBlock>\n          <button class=\"blue confirm\" (click)=\"!messageService.spinnerOn ? inject() : null\"\n            [disabled]=\"(walletService.isLedgerWallet() && (!sendResponse || !sendResponse.payload || !sendResponse.payload.signedOperation)) || walletService.isWatchWallet()\">\n            {{ walletService.isLedgerWallet() ? 'Broadcast' : 'Confirm'}}</button>\n        </ng-template>\n      </div>\n      <span *ngIf=\"this.pwdInvalid\" class=\"danger margin\">{{ this.pwdInvalid }}</span>\n    </div>\n  </div>\n</div>","import { Component, OnInit, Input, Output, EventEmitter, OnChanges, SimpleChanges, OnDestroy } from '@angular/core';\nimport { KeyPair, DefaultTransactionParams, ExternalRequest } from '../../../interfaces';\nimport { WalletService } from '../../../services/wallet/wallet.service';\nimport { CoordinatorService } from '../../../services/coordinator/coordinator.service';\nimport { OperationService } from '../../../services/operation/operation.service';\nimport { InputValidationService } from '../../../services/input-validation/input-validation.service';\nimport { LedgerService } from '../../../services/ledger/ledger.service';\nimport { LedgerWallet, Account, TorusWallet } from '../../../services/wallet/wallet';\nimport { MessageService } from '../../../services/message/message.service';\nimport Big from 'big.js';\nimport { emitMicheline, assertMichelsonData, assertMichelsonContract } from '@taquito/michel-codec';\nimport { EstimateService } from '../../../services/estimate/estimate.service';\nimport { Subscription } from 'rxjs';\nimport { ModalComponent } from '../modal.component';\nimport { SubjectService } from '../../../services/subject/subject.service';\n\nconst zeroTxParams: DefaultTransactionParams = {\n  gas: 0,\n  storage: 0,\n  fee: 0,\n  burn: 0\n};\n\n@Component({\n  selector: 'app-originate',\n  templateUrl: './originate.component.html',\n  styleUrls: ['../../../../scss/components/modals/modal.scss']\n})\nexport class OriginateComponent extends ModalComponent implements OnInit, OnChanges, OnDestroy {\n  readonly beaconMode = true;\n  @Input() externalRequest: ExternalRequest;\n  @Output() operationResponse = new EventEmitter();\n  syncSub: Subscription;\n  defaultTransactionParams: DefaultTransactionParams = zeroTxParams;\n  costPerByte: string = this.estimateService.costPerByte;\n\n  balance = '';\n  script: any;\n\n  customFee = '';\n  customGas = '';\n  customStorage = '';\n\n  pwdInvalid: string;\n  formInvalid = '';\n  sendResponse: any;\n  ledgerError = '';\n  simError = '';\n\n  password: string;\n  advancedForm = false;\n  simSemaphore = 0;\n  activeTab = 0;\n\n  name = 'originate';\n\n  private subscriptions: Subscription = new Subscription();\n\n  constructor(\n    private walletService: WalletService,\n    private operationService: OperationService,\n    private coordinatorService: CoordinatorService,\n    private inputValidationService: InputValidationService,\n    private ledgerService: LedgerService,\n    private messageService: MessageService,\n    private estimateService: EstimateService,\n    private subjectService: SubjectService\n  ) {\n    super();\n  }\n  ngOnInit(): void {}\n  ngOnChanges(changes: SimpleChanges): void {\n    if (this.beaconMode) {\n      if (\n        this.externalRequest?.operationRequest?.operationDetails?.length === 1 &&\n        this.externalRequest.operationRequest.operationDetails[0].kind === 'origination'\n      ) {\n        if (this.isValidOrigination()) {\n          this.openModal();\n          this.balance = Big(this.externalRequest.operationRequest.operationDetails[0].balance)\n            .div(10 ** 6)\n            .toFixed();\n          this.script = this.externalRequest.operationRequest.operationDetails[0].script;\n          const recommendations = {\n            gasRecommendation: this.externalRequest.operationRequest.operationDetails[0].gas_limit\n              ? this.externalRequest.operationRequest.operationDetails[0].gas_limit\n              : undefined,\n            storageRecommendation: this.externalRequest.operationRequest.operationDetails[0].storage_limit\n              ? this.externalRequest.operationRequest.operationDetails[0].storage_limit\n              : undefined\n          };\n          this.estimateFees(recommendations);\n          if (this.beaconMode) {\n            this.syncSub = this.subjectService.beaconResponse.subscribe((response) => {\n              if (response) {\n                this.operationResponse.emit('silent');\n                this.closeModal();\n              }\n            });\n          }\n        } else {\n          console.warn('Invalid origination');\n          this.operationResponse.emit('parameters_error');\n        }\n      }\n    }\n  }\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n  openModal(): void {\n    if (this.walletService.wallet) {\n      // hide body scrollbar\n      const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\n      document.body.style.marginRight = scrollBarWidth.toString();\n      document.body.style.overflow = 'hidden';\n      this.clearForm();\n      if (this.walletService.isLedgerWallet()) {\n        this.ledgerError = '?';\n      }\n      ModalComponent.currentModel.next({ name: this.name, data: null });\n    }\n  }\n  isValidOrigination(): boolean {\n    const origination = this.externalRequest.operationRequest.operationDetails[0];\n    if (!origination.balance || !this.inputValidationService.amount(origination.balance, 0)) {\n      console.warn('invalid balance');\n      return false;\n    }\n    try {\n      assertMichelsonContract(origination.script.code);\n      assertMichelsonData(origination.script.storage);\n    } catch (e) {\n      console.warn('Invalid script');\n      return false;\n    }\n    return true;\n  }\n  async estimateFees(recommendations: any = {}): Promise<void> {\n    const callback = (res) => {\n      if (res) {\n        if (res.error) {\n          this.simError = res.error;\n          this.formInvalid = this.simError;\n        } else {\n          this.defaultTransactionParams = res;\n        }\n      }\n      this.simSemaphore--;\n    };\n    this.simSemaphore++;\n    await this.estimateService.preLoadData(this.externalRequest.selectedAccount.pkh, this.externalRequest.selectedAccount.pk);\n    this.estimateService.estimateOrigination({ ...this.getOrigination(), ...recommendations }, this.externalRequest.selectedAccount.pkh, callback);\n  }\n  getOrigination(): {\n    balance: string;\n    script: string;\n    gasLimit: number;\n    storageLimit: number;\n  } {\n    const gasLimit = this.customGas ? Number(this.customGas) : this.defaultTransactionParams.gas;\n    const storageLimit = this.customStorage ? Number(this.customStorage) : this.defaultTransactionParams.storage;\n    return JSON.parse(\n      JSON.stringify({\n        balance: this.balance,\n        script: this.script,\n        gasLimit,\n        storageLimit\n      })\n    );\n  }\n  getTotalCost(display: boolean = false): string {\n    const totalFee = Big(this.getTotalFee()).plus(Big(this.getTotalBurn())).toString();\n    if (display && totalFee === '0') {\n      return '-';\n    }\n    return totalFee;\n  }\n  getTotalFee(): number {\n    if (this.customFee !== '' && Number(this.customFee)) {\n      return Number(this.customFee);\n    }\n    return Number(this.defaultTransactionParams.fee);\n  }\n  getTotalBurn(): number {\n    if (this.customStorage !== '' && Number(this.customStorage)) {\n      return Number(Big(this.customStorage).times(this.costPerByte).div(1000000).toString());\n    }\n    return this.defaultTransactionParams.burn;\n  }\n  burnAmount(): string {\n    const burn = this.customStorage ? Number(Big(this.customStorage).times(this.costPerByte).div(1000000)) : this.defaultTransactionParams.burn;\n    if (burn) {\n      return burn + ' tez';\n    }\n    return '';\n  }\n  getScript(): string {\n    return this.activeTab\n      ? emitMicheline(this.script.storage, {\n          indent: '  ',\n          newline: '\\n'\n        })\n      : emitMicheline(this.script.code, { indent: '  ', newline: '\\n' });\n  }\n  closeModalAction(): void {\n    this.operationResponse.emit(null);\n    this.closeModal();\n  }\n  closeModal(): void {\n    ModalComponent.currentModel.next({ name: '', data: null });\n    this.clearForm();\n    this.messageService?.stopSpinner();\n  }\n  async inject(): Promise<void> {\n    this.formInvalid = this.simError;\n    const valid = this.validateOrigination();\n    if (valid) {\n      const pwd = this.password;\n      this.password = '';\n      this.messageService.startSpinner('Signing operation...');\n      let keys;\n      try {\n        keys = await this.walletService.getKeys(pwd, this.externalRequest.selectedAccount.pkh);\n      } catch {\n        this.messageService.stopSpinner();\n      }\n      if (this.walletService.isLedgerWallet()) {\n        this.broadCastLedgerTransaction();\n        this.sendResponse = null;\n      } else {\n        if (keys) {\n          this.pwdInvalid = '';\n          this.messageService.startSpinner('Sending operation...');\n          this.sendOrigination(keys);\n          this.closeModal();\n        } else {\n          this.messageService.stopSpinner();\n          if (this.walletService.wallet instanceof TorusWallet) {\n            this.pwdInvalid = `Authorization failed`;\n          } else {\n            this.pwdInvalid = 'Wrong password!';\n          }\n        }\n      }\n    }\n  }\n  validateOrigination(): boolean {\n    if (this.simSemaphore) {\n      return false;\n    } else if (this.formInvalid) {\n      return false;\n    } else if (!this.inputValidationService.gas(this.customGas)) {\n      this.formInvalid = 'Invalid gas limit';\n      return false;\n    } else if (!this.inputValidationService.storage(this.customStorage)) {\n      this.formInvalid = 'Invalid storage limit';\n      return false;\n    } else if (!this.inputValidationService.amount(this.customFee, 6)) {\n      this.formInvalid = 'Invalid fee';\n      return false;\n    }\n    return true;\n  }\n  async ledgerSign(): Promise<void> {\n    this.formInvalid = this.simError;\n    const valid = this.validateOrigination();\n    if (valid) {\n      const keys = await this.walletService.getKeys('');\n      if (keys) {\n        this.sendOrigination(keys);\n      }\n    }\n  }\n  async sendOrigination(keys: KeyPair): Promise<void> {\n    //this.fee = '';\n    this.subscriptions.add(\n      this.operationService.originate(this.getOrigination(), this.getTotalFee(), keys).subscribe(\n        async (ans: any) => {\n          this.sendResponse = ans;\n          if (ans.success === true) {\n            if (ans.payload.opHash) {\n              this.operationResponse.emit(ans.payload.opHash);\n              const metadata = {\n                kt1: ans.payload.newPkh,\n                opHash: ans.payload.opHash,\n                origination: this.externalRequest.operationRequest.operationDetails[0]\n              };\n              this.coordinatorService.boost(this.externalRequest.selectedAccount.address, metadata);\n            } else if (this.walletService.isLedgerWallet()) {\n              this.requestLedgerSignature();\n            }\n          } else {\n            this.messageService.stopSpinner();\n            console.log('Origination error id ', ans.payload.msg);\n            this.messageService.addError(ans.payload.msg, 0);\n            this.operationResponse.emit('broadcast_error');\n            if (this.walletService.isLedgerWallet) {\n              this.closeModal();\n            }\n          }\n        },\n        (err) => {\n          console.log('Error Message ', JSON.stringify(err));\n          this.ledgerError = 'Failed to create operation';\n        }\n      )\n    );\n  }\n  async requestLedgerSignature(): Promise<void> {\n    if (this.walletService.wallet instanceof LedgerWallet) {\n      const op = this.sendResponse.payload.unsignedOperation;\n      this.messageService.startSpinner('Waiting for Ledger signature');\n      let signature;\n      try {\n        signature = await this.ledgerService.signOperation('03' + op, this.walletService.wallet.implicitAccounts[0].derivationPath);\n      } finally {\n        this.messageService.stopSpinner();\n      }\n      if (signature) {\n        const signedOp = op + signature;\n        this.sendResponse.payload.signedOperation = signedOp;\n        this.ledgerError = '';\n      } else {\n        this.ledgerError = 'Failed to sign operation';\n      }\n    }\n  }\n  async broadCastLedgerTransaction(): Promise<void> {\n    this.messageService.startSpinner('Broadcasting operation');\n    this.subscriptions.add(\n      this.operationService.broadcast(this.sendResponse.payload.signedOperation).subscribe(\n        (ans: any) => {\n          this.sendResponse = ans;\n          if (ans.success && this.externalRequest.selectedAccount.address) {\n            const metadata = {\n              kt1: ans.payload.newPkh,\n              opHash: ans.payload.opHash,\n              origination: this.externalRequest.operationRequest.operationDetails[0]\n            };\n            this.coordinatorService.boost(this.externalRequest.selectedAccount.address, metadata);\n          } else {\n            this.messageService.addError(this.sendResponse.payload.msg, 0);\n            this.operationResponse.emit('broadcast_error');\n          }\n          this.closeModal();\n          console.log('ans: ' + JSON.stringify(ans));\n        },\n        (error) => {\n          this.messageService.stopSpinner();\n          this.messageService.addError(error, 0);\n          this.operationResponse.emit('broadcast_error');\n        }\n      )\n    );\n  }\n  clearForm(): void {\n    this.defaultTransactionParams = zeroTxParams;\n    this.customFee = '';\n    this.customGas = '';\n    this.customStorage = '';\n\n    this.balance = '';\n    this.script = null;\n\n    this.advancedForm = false;\n\n    this.password = '';\n    this.pwdInvalid = '';\n    this.formInvalid = '';\n    this.simError = '';\n\n    this.sendResponse = null;\n    this.ledgerError = '';\n    this.simSemaphore = 0;\n    this.activeTab = 0;\n\n    if (this.syncSub) {\n      this.syncSub.unsubscribe();\n      this.syncSub = undefined;\n    }\n  }\n  // Only Numbers with Decimals\n  keyPressNumbersDecimal(event, input): boolean {\n    const charCode = event.which ? event.which : event.keyCode;\n    if (charCode !== 46 && charCode > 31 && (charCode < 48 || charCode > 57)) {\n      event.preventDefault();\n      return false;\n    } else if (charCode === 46 && this[input].length === 0) {\n      this[input] = '0' + this[input];\n    }\n    return true;\n  }\n}\n","<div *ngIf=\"isOpen\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-row top\">\n      <div class=\"flex-row button close\" (click)=\"closeModalAction()\"><img class=\"x\"\n          src=\"../../../assets/img/close-btn-x.png\" /></div>\n      <h1 class=\"title\">Confirm Staking</h1>\n    </div>\n    <div class=\"flex-column confirm-staking\">\n      <div class=\"flex-row head\">\n        <img *ngIf=\"delegate?.logo\" [src]=\"delegate.logo\" />\n        <div class=\"flex-column data\"\n          *ngIf=\"delegate?.name ? delegate.name : toPkh; let delegateDisplayName; else undelegate\">\n          <span class=\"name\">{{ delegateDisplayName }}</span>\n          <div class=\"flex-row fee-space\"><span class=\"fee\"><span>SPLIT:</span>&nbsp;{{ delegate?.fee ?\n              toPercent(delegate.fee) : 'UNKNOWN' }}</span><span *ngIf=\"delegate?.freeSpace\"\n              class=\"space\"><span>SPACE:</span>&nbsp;{{ round(delegate.freeSpace) }}</span>\n          </div>\n        </div>\n        <ng-template #undelegate>\n          <div class=\"flex-column data\">\n            <span class=\"name\">Undelegate from baker</span>\n          </div>\n        </ng-template>\n      </div>\n      <br />\n      <app-ui-toggle-advanced style=\"width: calc(100% - 1em);\" [default]=\"false\" (stateChange)=\"advanced = $event\">\n      </app-ui-toggle-advanced>\n      <br />\n      <br />\n      <ng-container *ngIf=\"advanced\">\n        <form autocomplete=\"off\">\n          <div class=\"label\">Fee <span class=\"label\" style=\"margin: 0; text-transform: lowercase;\">(tez)</span></div>\n          <input inputmode=\"decimal\" name=\"none\" [(ngModel)]=\"fee\" class=\"text fee\" type=\"text\" placeholder=\"{{defaultFee}}\"\n            [disabled]=\"walletService.isLedgerWallet() && sendResponse?.payload?.signedOperation\" />\n        </form>\n      </ng-container>\n      <br />\n      <br />\n      <div class=\"flex-column bottom\">\n        <div class=\"seperator\"></div>\n        <ng-container *ngIf=\"walletService.isPwdWallet()\">\n          <div class=\"label\">ENTER YOUR PASSWORD TO CONFIRM</div>\n          <span *ngIf=\"this.pwdValid\" class=\"label danger\">{{ this.pwdValid }}</span>\n          <input name=\"none\" [(ngModel)]=\"password\" placeholder=\"Password\" autocomplete=\"current-password\"\n            class=\"text password\" type=\"password\" (input)=\"this.pwdValid = ''\" (change)=\"this.pwdValid = ''\"\n            (keydown.enter)='!messageService.spinnerOn ? inject() : null'>\n        </ng-container>\n        <button class=\"confirm\" *ngIf=\"walletService.isLedgerWallet() && ledgerError; else elseBlock\"\n          (click)=\"ledgerSign()\">Sign with Ledger</button>\n        <ng-template #elseBlock>\n          <button class=\"confirm\" (click)=\"!messageService.spinnerOn ? inject() : null\"\n            [disabled]=\"(walletService.isLedgerWallet() && (!sendResponse || !sendResponse.payload || !sendResponse.payload.signedOperation)) || walletService.isWatchWallet()\">\n            {{ walletService.isLedgerWallet() ? 'Broadcast' : 'Confirm'}}</button>\n        </ng-template>\n      </div>\n    </div>\n  </div>\n</div>","import { Component, OnInit, Input, ViewChild, ElementRef, Output, EventEmitter, OnChanges, SimpleChanges, OnDestroy } from '@angular/core';\nimport { KeyPair, ExternalRequest } from '../../../interfaces';\nimport { WalletService } from '../../../services/wallet/wallet.service';\nimport { CoordinatorService } from '../../../services/coordinator/coordinator.service';\nimport { OperationService } from '../../../services/operation/operation.service';\nimport { ExportService } from '../../../services/export/export.service';\nimport { InputValidationService } from '../../../services/input-validation/input-validation.service';\nimport { LedgerService } from '../../../services/ledger/ledger.service';\nimport { LedgerWallet, Account, ImplicitAccount, OriginatedAccount, TorusWallet } from '../../../services/wallet/wallet';\nimport { MessageService } from '../../../services/message/message.service';\nimport { TezosDomainsService } from '../../../services/tezos-domains/tezos-domains.service';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ModalComponent } from '../modal.component';\nimport { Subscription } from 'rxjs';\nimport { SubjectService } from '../../../services/subject/subject.service';\nimport Big from 'big.js';\n\n@Component({\n  selector: 'app-delegate',\n  templateUrl: './delegate.component.html',\n  styleUrls: ['../../../../scss/components/modals/modal.scss']\n})\nexport class DelegateComponent extends ModalComponent implements OnInit, OnChanges, OnDestroy {\n  domainPendingLookup = false;\n  defaultFee = 0.0004;\n  readonly pkhFee = 0.0004;\n  readonly ktFee = 0.0008;\n  @ViewChild('toPkhInput') toPkhView: ElementRef;\n  @Input() beaconMode = false;\n  @Input() externalRequest: ExternalRequest;\n  @Output() operationResponse = new EventEmitter();\n  activeAccount: Account;\n  toPkh: string;\n  delegate = null;\n  fee: string = '';\n  password: string;\n  pwdValid: string;\n  formInvalid = '';\n  sendResponse: any;\n  ledgerError = '';\n  syncSub: Subscription;\n  advanced = false;\n\n  name = 'delegate-confirm';\n\n  private subscriptions: Subscription = new Subscription();\n\n  constructor(\n    private route: ActivatedRoute,\n    public walletService: WalletService,\n    private operationService: OperationService,\n    private coordinatorService: CoordinatorService,\n    private exportService: ExportService,\n    private inputValidationService: InputValidationService,\n    private ledgerService: LedgerService,\n    private messageService: MessageService,\n    private tezosDomains: TezosDomainsService,\n    private subjectService: SubjectService,\n    private router: Router\n  ) {\n    super();\n  }\n\n  ngOnInit(): void {\n    if (this.walletService.wallet) {\n      let address = this.route.snapshot.paramMap.get('address');\n      if (this.walletService.addressExists(address)) {\n        this.activeAccount = this.walletService.wallet.getAccount(address);\n      }\n      this.subscriptions.add(\n        this.subjectService.activeAccount.subscribe((activeAccount) => {\n          this.activeAccount = activeAccount;\n        })\n      );\n    }\n  }\n  ngOnChanges(changes: SimpleChanges): void {\n    if (this.beaconMode) {\n      if (this.externalRequest?.operationRequest) {\n        const opReq = this.externalRequest.operationRequest.operationDetails\n          ? this.externalRequest.operationRequest.operationDetails\n          : this.externalRequest.operationRequest;\n        if (opReq[0]?.kind === 'delegation') {\n          if (opReq[0].delegate) {\n            this.activeAccount = this.externalRequest.selectedAccount;\n            ModalComponent.currentModel.next({\n              name: '',\n              data: null\n            });\n            this.clearForm();\n            ModalComponent.currentModel.next({\n              name: 'delegate-confirm',\n              data: { address: opReq[0].delegate }\n            });\n          }\n        }\n      }\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n\n  open(data): void {\n    if (this.walletService.wallet) {\n      this.clearForm(true);\n      this.estimateDefaultFee();\n      this.toPkh = data.address;\n      this.delegate = data;\n      if (this.walletService.isLedgerWallet()) {\n        this.ledgerError = '?';\n      }\n      if (this.beaconMode) {\n        this.syncSub = this.subjectService.beaconResponse.subscribe((response) => {\n          if (response) {\n            this.operationResponse.emit('silent');\n          }\n        });\n      }\n      super.open();\n    }\n  }\n\n  async inject(): Promise<void> {\n    const pwd = this.password;\n    this.password = '';\n    this.messageService.startSpinner('Signing operation...');\n    let keys;\n    try {\n      keys = await this.walletService.getKeys(pwd, this.activeAccount.pkh);\n    } catch {\n      this.messageService.stopSpinner();\n    }\n    if (this.walletService.isLedgerWallet()) {\n      this.broadCastLedgerTransaction();\n      this.sendResponse = null;\n    } else {\n      if (keys) {\n        this.pwdValid = '';\n        this.messageService.startSpinner('Sending operation...');\n        this.sendDelegation(keys);\n      } else {\n        this.messageService.stopSpinner();\n        if (this.walletService.wallet instanceof TorusWallet) {\n          this.pwdValid = `Authorization failed`;\n        } else {\n          this.pwdValid = 'Wrong password!';\n        }\n      }\n    }\n  }\n  async ledgerSign(): Promise<void> {\n    const keys = await this.walletService.getKeys('');\n    if (keys) {\n      this.messageService.startSpinner('');\n      this.sendDelegation(keys);\n    }\n  }\n\n  async sendDelegation(keys: KeyPair): Promise<void> {\n    let fee = this.getFee();\n    this.subscriptions.add(\n      this.operationService.delegate(this.activeAccount.address, this.toPkh, Number(fee), keys).subscribe(\n        async (ans: any) => {\n          this.sendResponse = ans;\n          console.log(JSON.stringify(ans));\n          if (ans.success === true) {\n            if (ans.payload.opHash) {\n              this.operationResponse.emit(ans.payload.opHash);\n              const metadata = {\n                delegate: this.toPkh,\n                opHash: ans.payload.opHash\n              };\n              this.coordinatorService.boost(this.activeAccount.address, metadata);\n              this.closeModal();\n              this.router.navigate([`/account/${this.activeAccount.address}`]);\n            } else if (this.walletService.isLedgerWallet()) {\n              this.requestLedgerSignature();\n            }\n          } else {\n            console.log('Delegation error id ', ans.payload.msg);\n            this.messageService.addError(ans.payload.msg, 0);\n            this.operationResponse.emit('broadcast_error');\n            this.closeModal();\n          }\n        },\n        (err) => {\n          console.log('Error Message ', JSON.stringify(err));\n          this.ledgerError = 'Failed to create operation';\n        }\n      )\n    );\n  }\n  async requestLedgerSignature(): Promise<void> {\n    if (this.walletService.wallet instanceof LedgerWallet) {\n      const op = this.sendResponse.payload.unsignedOperation;\n      this.messageService.startSpinner('Waiting for Ledger signature');\n      let signature;\n      try {\n        signature = await this.ledgerService.signOperation('03' + op, this.walletService.wallet.implicitAccounts[0].derivationPath);\n      } finally {\n        this.messageService.stopSpinner();\n      }\n      if (signature) {\n        const signedOp = op + signature;\n        this.sendResponse.payload.signedOperation = signedOp;\n        this.ledgerError = '';\n      } else {\n        this.ledgerError = 'Failed to sign operation';\n      }\n    }\n  }\n  async broadCastLedgerTransaction(): Promise<void> {\n    this.messageService.startSpinner('Broadcasting operation');\n    this.operationService.broadcast(this.sendResponse.payload.signedOperation).subscribe(\n      (ans: any) => {\n        this.sendResponse = ans;\n        if (ans.success && this.activeAccount.address) {\n          this.operationResponse.emit(ans.payload.opHash);\n          const metadata = {\n            delegate: this.toPkh,\n            opHash: ans.payload.opHash\n          };\n          this.coordinatorService.boost(this.activeAccount.address, metadata);\n          this.closeModal();\n          this.router.navigate([`/account/${this.activeAccount.address}`]);\n        } else {\n          this.messageService.addError(this.sendResponse.payload.msg, 0);\n          this.operationResponse.emit('broadcast_error');\n        }\n        this.closeModal();\n        console.log('ans: ' + JSON.stringify(ans));\n      },\n      (error) => {\n        this.messageService.stopSpinner();\n        this.messageService.addError(error, 0);\n        this.operationResponse.emit('broadcast_error');\n      }\n    );\n  }\n  estimateDefaultFee(): void {\n    this.subscriptions.add(\n      this.operationService.isRevealed(this.activeAccount.pkh).subscribe((revealed: boolean) => {\n        const revealFee = revealed ? 0 : 0.0002;\n        if (this.activeAccount instanceof ImplicitAccount) {\n          this.defaultFee = Number(new Big(revealFee).plus(this.pkhFee));\n        } else if (this.activeAccount instanceof OriginatedAccount) {\n          this.defaultFee = Number(new Big(revealFee).plus(this.ktFee));\n        }\n      })\n    );\n  }\n  getFee(): string {\n    return this.fee !== '' ? this.fee : this.defaultFee.toString();\n  }\n  clearForm(init: boolean = false): void {\n    if (!init && this.syncSub) {\n      this.syncSub.unsubscribe();\n      this.syncSub = undefined;\n    }\n    this.toPkh = '';\n    this.fee = '';\n    this.defaultFee = 0.0004;\n    this.password = '';\n    this.pwdValid = '';\n    this.formInvalid = '';\n    this.sendResponse = '';\n    this.ledgerError = '';\n    this.domainPendingLookup = false;\n    this.delegate = null;\n    this.advanced = false;\n  }\n  async invalidInput(): Promise<string> {\n    // if it is a tezos-domain\n    if (this.toPkh && this.toPkh.indexOf('.') > -1) {\n      try {\n        this.domainPendingLookup = true;\n        const { pkh } = await this.tezosDomains.getAddressFromDomain(this.toPkh);\n        if (pkh) {\n          this.toPkh = pkh;\n        } else {\n          this.domainPendingLookup = false;\n          return 'Could not find the domain';\n        }\n      } catch (error) {\n        return error.message;\n      } finally {\n        this.domainPendingLookup = false;\n      }\n    }\n    if (\n      (!this.inputValidationService.address(this.toPkh) && this.toPkh !== '') ||\n      (this.toPkh.length > 1 && this.toPkh.slice(0, 2) !== 'tz') ||\n      this.walletService.wallet.getImplicitAccount(this.toPkh)\n    ) {\n      return 'invalid delegate address';\n    } else if (!this.inputValidationService.fee(this.fee)) {\n      return 'invalid fee';\n    } else {\n      return '';\n    }\n  }\n  // Only Numbers with Decimals\n  keyPressNumbersDecimal(event, input): boolean {\n    const charCode = event.which ? event.which : event.keyCode;\n    if (charCode !== 46 && charCode > 31 && (charCode < 48 || charCode > 57)) {\n      event.preventDefault();\n      return false;\n    } else if (charCode === 46 && this[input].length === 0) {\n      this[input] = '0' + this[input];\n    }\n    return true;\n  }\n  download(): void {\n    this.exportService.downloadOperationData(this.sendResponse.payload.unsignedOperation, false);\n  }\n\n  closeModalAction(): void {\n    this.operationResponse.emit(null);\n    this.closeModal();\n  }\n\n  closeModal(): void {\n    ModalComponent.currentModel.next({ name: '', data: null });\n    this.clearForm();\n    this.ledgerError = '';\n    this.messageService.stopSpinner();\n  }\n\n  round(val): string {\n    return Math.round(Number(val)).toString();\n  }\n\n  toPercent(val): string {\n    return parseFloat((Number(val) * 100).toFixed(2)).toString() + '%';\n  }\n}\n","<div #viewRef class=\"flex-column list\">\n  <a *ngFor=\"let account of list\" class=\"flex-row option\" [class.selected]=\"account?.address === current?.address\"\n    routerLink=\"/account/{{account?.address}}{{postfix}}\" (click)=\"closeModal()\">\n    <div class=\"flex-column left\">\n      <ng-container *ngIf=\"getUsername(account?.address)\">\n        <div class=\"flex-row alias\"><img class=\"logo\" src=\"../../../../assets/img/{{ getVerifier() }}-logo.svg\" /><span\n            class=\"name\">{{\n            getUsername(account?.address) }}</span><img class=\"copy\" src=\"../../../../assets/img/copy-icon.svg\"\n            (click)=\"this.copy($event, account?.address); false\" /></div>\n        <span class=\"addr\">{{\n          !isMobile ? account?.address : account?.shortAddress() }}</span>\n      </ng-container>\n      <ng-container *ngIf=\"!getUsername(account?.address)\">\n        <div class=\"flex-row\"><span class=\"addr default\">{{\n            !isMobile ? account?.address : account?.shortAddress() }}</span><img class=\"copy\"\n            src=\"../../../../assets/img/copy-icon.svg\" (click)=\"this.copy($event, account?.address); false\" /></div>\n      </ng-container>\n    </div>\n    <div class=\"flex-column balances\">\n      <div class=\"balance-tez\">{{ (getBalance(account) | number: '1.0-6' | removeComma) }} tez</div>\n      <div class=\"balance-fiat\">{{ '$' + (getBalanceFiat(account) | number:'1.2-2' | removeComma)\n        }}</div>\n    </div>\n  </a>\n  <div class=\"flex-row total-balances\">\n    <h3>TOTAL:</h3>\n    <div class=\"flex-column\">\n      <div class=\"balance-tez\">{{ (getTotalBalance() | number: '1.0-6' | removeComma) + ' tez' }}\n      </div>\n      <div class=\"balance-fiat\">{{ '$' + (getTotalFiat() | number:'1.2-2' | removeComma) }}\n      </div>\n    </div>\n  </div>\n</div>","import { AfterViewInit, Component, ElementRef, OnDestroy, OnInit, ViewChild } from '@angular/core';\nimport { NavigationEnd, Router } from '@angular/router';\nimport { TorusWallet } from '../../../../services/wallet/wallet';\nimport { LookupService } from '../../../../services/lookup/lookup.service';\nimport { WalletService } from '../../../../services/wallet/wallet.service';\nimport { ModalComponent } from '../../modal.component';\nimport { Subscription } from 'rxjs';\nimport { ListComponent } from '../../../ui/generic/list.component';\nimport copy from 'copy-to-clipboard';\nimport { MessageService } from '../../../../services/message/message.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport Big from 'big.js';\nimport { RemoveCommaPipe } from '../../../../pipes/remove-comma.pipe';\nimport { filter } from 'rxjs/operators';\nimport { SubjectService } from '../../../../services/subject/subject.service';\n\n@Component({\n  selector: 'app-account-list-body',\n  templateUrl: './body.component.html',\n  styleUrls: ['../../../../../scss/components/modals/account-list.scss']\n})\nexport class AccountListBodyComponent extends ListComponent implements OnInit, AfterViewInit, OnDestroy {\n  postfix = '';\n  isMobile = false;\n  @ViewChild('viewRef') viewRef: ElementRef;\n  preSelectedAccount: string;\n  private subscriptions: Subscription = new Subscription();\n\n  constructor(\n    public router: Router,\n    public lookupService: LookupService,\n    private walletService: WalletService,\n    public translate: TranslateService,\n    public messageService: MessageService,\n    public removeCommaPipe: RemoveCommaPipe,\n    private subjectService: SubjectService\n  ) {\n    super();\n    this.subscriptions.add(\n      this.router.events.pipe(filter((evt) => evt instanceof NavigationEnd)).subscribe(async (r: NavigationEnd) => {\n        let accountAddress = r.url.substr(r.url.indexOf('/account/') + 9);\n        this.postfix = !!accountAddress.substring(36) ? accountAddress.substring(36) : '';\n      })\n    );\n  }\n\n  ngOnInit(): void {\n    if (this.walletService.wallet) {\n      this.preSelectedAccount = this.current;\n    }\n    this.subscriptions.add(\n      this.subjectService.walletUpdated.subscribe(() => {\n        this.list = this.walletService.wallet?.getAccounts();\n      })\n    );\n    this.list = this.walletService.wallet?.getAccounts();\n\n    const e = () => {\n      this.isMobile = !!parseInt(document.documentElement.style.getPropertyValue('--is-mobile'));\n    };\n    window.addEventListener('resize', e);\n    e();\n  }\n\n  ngAfterViewInit(): void {\n    const selRef = this.viewRef.nativeElement.querySelector('.option.selected') as HTMLElement;\n    this.viewRef.nativeElement.scrollTo(0, selRef.offsetTop - 100);\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n\n  getUsername(address: string): string {\n    if (this.walletService.wallet instanceof TorusWallet) {\n      return this.walletService.wallet.displayName();\n    } else {\n      const party = this.lookupService.resolve({ address: address });\n      if (party?.name) {\n        return party.name;\n      }\n    }\n    return '';\n  }\n  getVerifier(): string {\n    if (this.walletService.wallet instanceof TorusWallet) {\n      return this.walletService.wallet.verifier;\n    } else {\n      return 'domain';\n    }\n  }\n  closeModal(): void {\n    ModalComponent.currentModel.next({ name: '', data: null });\n  }\n  copy(e, address: string): void {\n    e.stopPropagation();\n    copy(address);\n    const copyToClipboard = this.translate.instant('OVERVIEWCOMPONENT.COPIEDTOCLIPBOARD');\n    this.messageService.add(address + ' ' + copyToClipboard, 5);\n  }\n  getBalance(account): number | string {\n    return Big(account?.balanceXTZ ?? 0)\n      .div(1000000)\n      .toFixed();\n  }\n  getBalanceFiat(account): number {\n    return account?.balanceUSD ?? 0;\n  }\n\n  getTotalBalance(): number {\n    return Big(this.walletService.wallet.totalBalanceXTZ ?? 0)\n      .div(1000000)\n      .toFixed();\n  }\n\n  getTotalFiat(): number {\n    return this.walletService.wallet.totalBalanceUSD ?? 0;\n  }\n}\n","import { Component, Input, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { LookupService } from '../../../services/lookup/lookup.service';\nimport { ModalComponent } from '../modal.component';\nimport { MessageService } from '../../../services/message/message.service';\nimport { TranslateService } from '@ngx-translate/core';\n\n@Component({\n  selector: 'app-account-list',\n  templateUrl: './list.component.html',\n  styleUrls: ['../../../../scss/components/modals/modal.scss']\n})\nexport class AccountListComponent extends ModalComponent implements OnInit {\n  @Input() title;\n  @Input() activeAccount;\n  name = 'account-list';\n\n  constructor(public router: Router, public lookupService: LookupService, public translate: TranslateService, public messageService: MessageService) {\n    super();\n  }\n\n  ngOnInit(): void {}\n  closeModal(): void {\n    ModalComponent.currentModel.next({ name: '', data: null });\n  }\n}\n","<div [style.display]=\"!isOpen ? 'none' : ''\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-row top\">\n      <div class=\"flex-row button close\" (click)=\"closeModal()\"><img class=\"x\"\n          src=\"../../../assets/img/close-btn-x.png\" /></div>\n      <h1 class=\"title\">{{ title }}</h1>\n    </div>\n    <app-account-list-body [current]=\"activeAccount\">\n    </app-account-list-body>\n  </div>\n</div>","<div [style.display]=\"!isOpen ? 'none' : ''\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-column top\">\n      <div class=\"flex-row button close\" (click)=\"closeModal()\"><img class=\"x\"\n          src=\"../../../assets/img/close-btn-x.png\" /></div>\n      <h1 class=\"title\">{{ title }}</h1>\n    </div>\n    <div class=\"flex-column export-mnemonic\">\n      <div *ngIf=\"!!mnemonicPhrase\" class=\"whitebox\" (mouseout)=\"mouseOut($event)\" (touchstart)=\"$event.stopPropagation(); this.hideBlur = true;\"\n        (touchend)=\"checkSelection($event)\" (click)=\"$event.stopPropagation()\" (mouseup)=\"checkSelection($event)\">\n        {{ mnemonicPhrase }}<div *ngIf=\"!hideBlur\" class=\"flex-row seed-blur\"\n          (click)=\"$event.stopPropagation(); this.hideBlur = true;\">\n          <span>CLICK HERE TO REVEAL YOUR SEED WORDS</span>\n        </div>\n      </div>\n      <p *ngIf=\"!!mnemonicPhrase\" class=\"description red\">\n        <span *ngIf=\"isSelectedMnemonic\" style=\"margin: 1rem 0\" class=\"warning red\">\n          WARNING: Copying the seed words to your clipboard can result in sensitive leakage. The clipboard is a shared\n          resource that can be monitored by other web pages or browser extensions.<br />\n        </span>\n      </p>\n      <div *ngIf=\"!mnemonicPhrase\" class=\"flex-column bottom\">\n        <div class=\"seperator\"></div>\n        <div class=\"label\">\n          ENTER YOUR PASSWORD TO REVEAL \n        </div>\n        <span [style.visibility]=\"!pwdInvalid ? 'hidden' : ''\" [style.margin]=\"!pwdInvalid ? '0' : ''\"\n        class=\"label danger\">{{ this.pwdInvalid }}</span>\n        <input [(ngModel)]=\"pwd\" autocomplete=\"current-password\" placeholder=\"Password\" class=\"text password\"\n          type=\"password\" (input)=\"this.pwdInvalid = ''\" (change)=\"this.pwdInvalid = ''\" (keydown.enter)='!messageService.spinnerOn ? reveal() : null'>\n        <button class=\"button confirm\" (click)=\"!messageService.spinnerOn ? reveal() : null\">Continue</button>\n      </div>\n    </div>\n  </div>\n</div>","import { Component, OnInit } from '@angular/core';\nimport { MessageService } from '../../../services/message/message.service';\nimport { WalletService } from '../../../services/wallet/wallet.service';\nimport { ModalComponent } from '../modal.component';\n\n@Component({\n  selector: 'app-export-mnemonic',\n  templateUrl: './export-mnemonic.component.html',\n  styleUrls: ['../../../../scss/components/modals/modal.scss']\n})\nexport class ExportMnemonicComponent extends ModalComponent implements OnInit {\n  title = 'Reveal Seed Words';\n  name = 'export-mnemonic';\n  mnemonicPhrase = '';\n  ledgerError = '';\n  pwdInvalid = '';\n  pwd = '';\n  hideBlur = false;\n  isSelectedMnemonic = false;\n  constructor(public walletService: WalletService, private messageService: MessageService) {\n    super();\n  }\n\n  ngOnInit(): void {}\n\n  closeModal(): void {\n    this.reset();\n    ModalComponent.currentModel.next({ name: '', data: null });\n  }\n\n  async reveal(): Promise<void> {\n    try {\n      this.messageService.startSpinner();\n      this.mnemonicPhrase = await this.walletService.revealMnemonicPhrase(this.pwd);\n      this.pwdInvalid = this.mnemonicPhrase === '' ? 'INVLAID PASSWORD' : '';\n      this.messageService.stopSpinner();\n    } catch {\n      this.pwdInvalid = this.mnemonicPhrase === '' ? 'INVLAID PASSWORD' : '';\n    }\n  }\n\n  mouseOut(e): void {\n    e.stopPropagation();\n    this.hideBlur = false;\n    window.getSelection()?.removeAllRanges();\n  }\n  checkSelection(ev): void {\n    ev.stopPropagation();\n    if (this.isTextSelected()) {\n      this.isSelectedMnemonic = true;\n    }\n  }\n  private isTextSelected(): boolean {\n    let selection: Selection;\n    if (window.getSelection) {\n      selection = window.getSelection();\n    } else if (document.getSelection) {\n      selection = document.getSelection();\n    } else return false;\n    return !selection?.isCollapsed;\n  }\n  reset(): void {\n    this.mnemonicPhrase = '';\n    this.ledgerError = '';\n    this.pwdInvalid = '';\n    this.pwd = '';\n    this.hideBlur = false;\n    this.isSelectedMnemonic = false;\n  }\n}\n","import { Component, OnDestroy, OnInit, HostListener } from '@angular/core';\nimport { MessageService } from '../../../services/message/message.service';\nimport { WalletClient, BeaconMessageType, PermissionScope, PermissionResponseInput, OperationResponseInput } from '@airgap/beacon-sdk';\nimport { WalletService } from '../../../services/wallet/wallet.service';\nimport { CONSTANTS } from '../../../../environments/environment';\nimport { Account } from '../../../services/wallet/wallet';\nimport { BeaconService } from '../../../services/beacon/beacon.service';\nimport { DeeplinkService } from '../../../services/deeplink/deeplink.service';\nimport { assertMichelsonData } from '@taquito/michel-codec';\nimport { InputValidationService } from '../../../services/input-validation/input-validation.service';\nimport { SubjectService } from '../../../services/subject/subject.service';\nimport { Subscription } from 'rxjs';\nimport { ExternalRequest } from '../../../interfaces';\n\n@Component({\n  selector: 'app-uri-handler',\n  templateUrl: './uri-handler.component.html'\n})\nexport class UriHandlerComponent implements OnInit, OnDestroy {\n  private subscriptions: Subscription = new Subscription();\n  constructor(\n    public messageService: MessageService,\n    public walletService: WalletService,\n    private beaconService: BeaconService,\n    private deeplinkService: DeeplinkService,\n    private inputValidationService: InputValidationService,\n    private subjectService: SubjectService\n  ) {\n    this.subscriptions.add(\n      this.subjectService.activeAccount.subscribe((activeAccount) => {\n        this.activeAccount = activeAccount;\n      })\n    );\n  }\n  permissionRequest: PermissionResponseInput = null;\n  externalRequest: ExternalRequest = null;\n  signRequest: any = null;\n  activeAccount: Account;\n  selectedAccount: Account;\n  @HostListener('window:focus', ['$event'])\n  onFocus(event: FocusEvent): void {\n    this.changeFavicon();\n  }\n  ngOnInit(): void {\n    if (this.walletService.wallet) {\n      this.init();\n    }\n  }\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n  async init() {\n    const pairingString = this.deeplinkService.popPairingJson();\n    if (pairingString) {\n      console.log(pairingString);\n      this.beaconService.preNotifyPairing(pairingString);\n    }\n    window.addEventListener('storage', (e) => {\n      this.handleStorageEvent(e);\n    });\n    await this.connectApp().catch((error) => console.error('connect error', error));\n    if (pairingString) {\n      await this.beaconService.client.isConnected;\n      this.beaconService.addPeer(pairingString);\n    }\n  }\n  changeFavicon(active: boolean = false): void {\n    if (active && document.hasFocus()) {\n      active = false;\n    }\n    const src: string = active ? 'favicon-attention.ico' : 'favicon.ico';\n    document.getElementById('favicon').setAttribute('href', src);\n  }\n  /* https://github.com/airgap-it/beacon-sdk/blob/master/src/clients/wallet-client/WalletClient.ts */\n  connectApp = async (): Promise<void> => {\n    if (!this.beaconService.client) {\n      this.beaconService.client = new WalletClient({\n        name: 'Kukai Wallet'\n      });\n    }\n    await this.beaconService.client.init(); // Establish P2P connection\n    this.beaconService.client\n      .connect(async (message: any) => {\n        console.log('### beacon message', message);\n        if (message.type !== BeaconMessageType.SignPayloadRequest && message.network.type.replace('edo2net', 'edonet') !== CONSTANTS.NETWORK) {\n          console.warn(`Rejecting Beacon message because of network. Expected ${CONSTANTS.NETWORK} instead of ${message.network.type}`);\n          await this.beaconService.rejectOnNetwork(message);\n        } else if (!this.permissionRequest && !this.externalRequest && !this.signRequest) {\n          switch (message.type) {\n            case BeaconMessageType.PermissionRequest:\n              await this.handlePermissionRequest(message);\n              break;\n            case BeaconMessageType.OperationRequest:\n              if (await this.isSupportedOperationRequest(message)) {\n                this.externalRequest = { operationRequest: message, selectedAccount: this.selectedAccount };\n                this.changeFavicon(true);\n              }\n              break;\n            case BeaconMessageType.SignPayloadRequest:\n              if (await this.isSupportedSignPayload(message)) {\n                this.signRequest = message;\n                this.changeFavicon(true);\n              }\n              break;\n            default:\n              await this.beaconService.rejectOnUnknown(message);\n              console.warn('Unknown message type', message);\n          }\n        } else {\n          console.log('Blocked by other Beacon request');\n        }\n      })\n      .catch((error) => console.error('connect error', error));\n  };\n  async handlePermissionRequest(message: any): Promise<void> {\n    console.log('## permission request');\n    message.scopes = message.scopes.filter((scope: PermissionScope) => [PermissionScope.OPERATION_REQUEST, PermissionScope.SIGN].includes(scope));\n    if (message.scopes.length) {\n      if (this.walletService.wallet) {\n        this.permissionRequest = message;\n        this.changeFavicon(true);\n      } else {\n        console.warn('No wallet found');\n        await this.beaconService.rejectOnSourceAddress(message);\n      }\n    } else {\n      console.warn('No valid scope');\n    }\n  }\n  async isSupportedOperationRequest(message: any): Promise<boolean> {\n    if (!this.walletService.wallet) {\n      console.log('No wallet found');\n      await this.beaconService.rejectOnUnknown(message);\n      return false;\n    } else if (!this.walletService.wallet.getImplicitAccount(message.sourceAddress)) {\n      console.warn('Source address not recogized');\n      await this.beaconService.rejectOnSourceAddress(message);\n      return false;\n    } else if (message.operationDetails.length > 1) {\n      for (const op of message.operationDetails) {\n        if (op.kind !== 'transaction') {\n          console.warn('Only transaction batches supported');\n          await this.beaconService.rejectOnTooManyOps(message);\n          return false;\n        }\n      }\n    }\n    if (message.operationDetails[0].kind === 'transaction') {\n      for (let i = 0; i < message.operationDetails.length; i++) {\n        if (\n          message.operationDetails[i].destination &&\n          message.operationDetails[i].parameters &&\n          this.walletService.wallet.getAccount(message.operationDetails[i].destination)\n        ) {\n          console.warn('Invocation of user controlled contract is disabled');\n          await this.beaconService.rejectOnPermission(message);\n          return false;\n        } else if (!message.operationDetails[i].destination || !message.operationDetails[i].amount) {\n          console.warn('Missing destination or amount');\n          await this.beaconService.rejectOnUnknown(message);\n          return false;\n        } else if (this.invalidParameters(message.operationDetails[i].parameters)) {\n          await this.beaconService.rejectOnParameters(message);\n          return false;\n        } else if (this.invalidOptionals(message.operationDetails[i])) {\n          await this.beaconService.rejectOnParameters(message);\n          return false;\n        }\n      }\n    } else if (message.operationDetails[0].kind === 'delegation') {\n      if (!message.operationDetails[0].delegate) {\n        console.warn('Invalid delegate');\n        await this.beaconService.rejectOnUnknown(message);\n        return false;\n      }\n    } else if (message.operationDetails[0].kind === 'origination') {\n      if (!message.operationDetails[0].script) {\n        console.warn('No script found');\n        await this.beaconService.rejectOnParameters(message);\n        return false;\n      } else if (this.invalidOptionals(message.operationDetails[0])) {\n        await this.beaconService.rejectOnParameters(message);\n        return false;\n      }\n    } else {\n      console.warn('Unsupported operation kind');\n      await this.beaconService.rejectOnUnknown(message);\n      return false;\n    }\n    this.selectedAccount = this.walletService.wallet.getImplicitAccount(message.sourceAddress);\n    return true;\n  }\n  private invalidOptionals(op: any): boolean {\n    if (typeof op.gas_limit === 'number') {\n      // normalize\n      op.gas_limit = op.gas_limit.toString();\n    }\n    if (typeof op.storage_limit === 'number') {\n      op.storage_limit = op.storage_limit.toString();\n    }\n    if (op.gas_limit && (typeof op.gas_limit !== 'string' || !this.inputValidationService.amount(op.gas_limit, 0))) {\n      return true;\n    } else if (op.storage_limit && (typeof op.storage_limit !== 'string' || !this.inputValidationService.amount(op.storage_limit, 0))) {\n      return true;\n    }\n    return false;\n  }\n  async isSupportedSignPayload(message: any): Promise<Boolean> {\n    if (!this.walletService.wallet) {\n      console.log('No wallet found');\n      await this.beaconService.rejectOnUnknown(message);\n      return false;\n    } else if (!this.walletService.wallet.getImplicitAccount(message.sourceAddress)) {\n      console.warn('Source address not recogized');\n      await this.beaconService.rejectOnSourceAddress(message);\n      return false;\n    }\n    if (message.payload.slice(0, 2) === '0x') {\n      message.payload = message.payload.slice(2);\n    }\n    message.payload = message.payload.toLowerCase();\n    const hexString = message.payload;\n    console.log('hex', hexString);\n    if ((message.signingType !== 'raw' && message.signingType !== 'micheline') || !this.inputValidationService.hexString(hexString)) {\n      console.warn('Invalid sign payload');\n      await this.beaconService.rejectOnUnknown(message);\n      return false;\n    } else if (hexString.slice(0, 2) !== '05') {\n      console.warn('Unsupported prefix (expected 05)');\n      await this.beaconService.rejectOnUnknown(message);\n      return false;\n    }\n    if (!this.inputValidationService.isMichelineExpr(hexString)) {\n      await this.beaconService.rejectOnUnknown(message);\n      return false;\n    }\n    this.selectedAccount = this.walletService.wallet.getImplicitAccount(message.sourceAddress);\n    return true;\n  }\n  invalidParameters(parameters: any): boolean {\n    try {\n      if (parameters) {\n        if (!parameters.value || !parameters.entrypoint) {\n          throw new Error('entrypoint and value expected');\n        }\n        assertMichelsonData(parameters.value);\n      }\n      return false;\n    } catch (e) {\n      return true;\n    }\n  }\n  /* operation request handling */\n  async operationResponse(opHash: any): Promise<void> {\n    if (opHash?.error) {\n      opHash = opHash.error;\n    }\n    if (!this.externalRequest) {\n      return;\n    }\n    console.log('hash', opHash);\n    console.log('externalRequest', this.externalRequest);\n    if (!opHash) {\n      await this.beaconService.rejectOnUserAbort(this.externalRequest.operationRequest);\n    } else if (opHash === 'broadcast_error') {\n      await this.beaconService.rejectOnBroadcastError(this.externalRequest.operationRequest);\n    } else if (opHash === 'invalid_parameters') {\n      await this.beaconService.rejectOnParameters(this.externalRequest.operationRequest);\n    } else if (opHash === 'parameters_error') {\n      await this.beaconService.rejectOnParameters(this.externalRequest.operationRequest);\n    } else if (opHash === 'unknown_error') {\n      await this.beaconService.rejectOnUnknown(this.externalRequest.operationRequest);\n    } else if (opHash !== 'silent') {\n      const response: OperationResponseInput = {\n        type: BeaconMessageType.OperationResponse,\n        transactionHash: opHash,\n        id: this.externalRequest.operationRequest.id\n      };\n      await this.beaconService.client.respond(response);\n    }\n    if (opHash !== 'silent') {\n      this.beaconService.responseSync();\n    }\n    this.externalRequest = null;\n  }\n  /* permission handling */\n  async permissionResponse(publicKey: string): Promise<void> {\n    if (!publicKey) {\n      await this.beaconService.rejectOnUserAbort(this.permissionRequest);\n      this.beaconService.responseSync();\n    } else if (publicKey !== 'silent') {\n      await this.beaconService.approvePermissionRequest(this.permissionRequest, publicKey);\n      this.beaconService.syncBeaconState();\n      this.beaconService.responseSync();\n    }\n    this.permissionRequest = null;\n  }\n  /* sign payload handling */\n  async signResponse(signature: string): Promise<void> {\n    if (!signature) {\n      await this.beaconService.rejectOnUserAbort(this.signRequest);\n      this.beaconService.responseSync();\n    } else if (signature !== 'silent') {\n      await this.beaconService.approveSignPayloadRequest(this.signRequest, signature);\n      this.beaconService.responseSync();\n    }\n    console.log(signature);\n    this.signRequest = null;\n  }\n  private async handleStorageEvent(ev: StorageEvent): Promise<void> {\n    switch (ev.key) {\n      case 'beacon:communication-peers-wallet':\n        const peers = JSON.parse(ev.newValue);\n        const senderIds = (await this.beaconService.client.getAppMetadataList()).map((app) => {\n          return app.senderId;\n        });\n        const newPeers = peers.length - senderIds.length;\n        if (newPeers > 0) {\n          const newPeer = peers ? peers.pop() : null;\n          if (newPeer && !senderIds.includes(newPeer.senderId)) {\n            const { senderId, ...peer } = newPeer;\n            await this.beaconService.addPeer(JSON.stringify(peer), false);\n          }\n        } else {\n          this.beaconService.syncBeaconState();\n        }\n        break;\n      case 'beacon:request-response':\n        if (ev.newValue) {\n          this.subjectService.beaconResponse.next(true);\n          this.beaconService.syncBeaconState();\n          this.changeFavicon();\n        }\n        break;\n    }\n  }\n}\n","<app-send [embedded]=\"false\" (operationResponse)=\"operationResponse($event)\"\n  [externalRequest]=\"externalRequest\"></app-send>\n<app-delegate (operationResponse)=\"operationResponse($event)\" [beaconMode]=true [externalRequest]=externalRequest>\n</app-delegate>\n<app-originate (operationResponse)=\"operationResponse($event)\" [externalRequest]=externalRequest></app-originate>\n<app-permission-request (permissionResponse)=\"permissionResponse($event)\" [permissionRequest]=\"permissionRequest\"\n  [activeAccount]=activeAccount>\n</app-permission-request>\n<app-sign-expr (signResponse)=\"signResponse($event)\" [signRequest]=\"signRequest\" [activeAccount]=selectedAccount>\n</app-sign-expr>\n<app-account-list [title]=\"'Accounts'\" [activeAccount]=\"activeAccount\"></app-account-list>\n<app-new-implicit></app-new-implicit>\n<app-receive></app-receive>\n<app-export-mnemonic></app-export-mnemonic>","<div *ngIf=\"active\" class=\"moonpay\">\n  <div class=\"top\">\n    <a>\n      <button class=\"back secondary\" (click)=\"close()\">\n        <img src=\"../../../../../assets/img/left-arrow.svg\">Back</button>\n    </a>\n    <p>Buy XTZ (tez) with MoonPay</p>\n  </div>\n  <div class=\"main\">\n    <ng-container *ngIf=\"url\">\n      <iframe allow=\"accelerometer; autoplay; camera; gyroscope; payment\" frameborder=\"0\" height=\"100%\" [src]=\"this.url\"\n        width=\"100%\">\n        <p>Your browser does not support iframes.</p>\n      </iframe>\n    </ng-container>\n    <img *ngIf=\"!(url && mobile)\" class=\"loading\" src=\"../../../../../../assets/img/loader.svg\">\n  </div>\n</div>","import { Component, OnInit } from '@angular/core';\nimport { DomSanitizer, SafeUrl } from '@angular/platform-browser';\nimport { Account } from '../../../../../services/wallet/wallet';\nimport { WalletService } from '../../../../../services/wallet/wallet.service';\nimport { CONSTANTS, environment } from '../../../../../../environments/environment';\nimport { SubjectService } from '../../../../../services/subject/subject.service';\nimport { HostListener } from '@angular/core';\n\n@Component({\n  selector: 'app-moonpay',\n  templateUrl: './moonpay.component.html',\n  styleUrls: ['../../../../../../scss/components/views/logged-in/account-view/cards/moonpay/moonpay.component.scss']\n})\nexport class MoonpayComponent implements OnInit {\n  @HostListener('window:resize', ['$event'])\n  onResize() {\n    this.mobile = window.innerWidth < 575;\n  }\n  readonly dev: boolean = !(CONSTANTS.MAINNET && environment.production);\n  readonly baseUrl: string = `https://buy${this.dev ? '-staging' : ''}.moonpay.com`;\n  mobile = false;\n  url: SafeUrl;\n  active = false;\n  account: Account;\n  constructor(private walletService: WalletService, private sanitizer: DomSanitizer, private subjectService: SubjectService) {}\n\n  ngOnInit(): void {\n    this.onResize();\n    this.subjectService.activeAccount.subscribe((a) => {\n      this.account = a;\n    });\n    this.subjectService.moonpay.subscribe((o) => {\n      if (o) {\n        this.open();\n      } else {\n        this.close();\n      }\n    });\n  }\n  private async signUrl(address: string): Promise<SafeUrl> {\n    if (address?.startsWith('tz')) {\n      const query: string = `?apiKey=${\n        this.dev ? 'pk_test_M23P0Zc5SvBORSFV63sfWKi7n5QbGZR' : 'pk_live_rP9HlBRO54nY4QKLxc6ONl4Prrm6vymK'\n      }&colorCode=%237178E3&currencyCode=xtz&walletAddress=${encodeURIComponent(address)}`;\n      const sig = await this.post({ dev: this.dev, url: query });\n      if (sig) {\n        const url = this.sanitizer.bypassSecurityTrustResourceUrl(`${this.baseUrl}${query}&signature=${encodeURIComponent(sig)}`);\n        return url;\n      }\n    }\n    return null;\n  }\n  private async open(): Promise<void> {\n    this.active = true;\n    const address: string = this.account ? this.account.address : null;\n    if (!address?.startsWith('tz')) {\n      return;\n    }\n    this.url = await this.signUrl(address);\n  }\n  private close(): void {\n    this.url = null;\n    this.active = false;\n  }\n  private async post(data: any = {}): Promise<string> {\n    return fetch('https://utils.kukai.network/moonpay/sign', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(data)\n    })\n      .then(async (d) => {\n        return d.text();\n      })\n      .catch((e) => {\n        return '';\n      });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { StartComponent } from './components/views/start/start.component';\nimport { NewWalletComponent } from './components/views/start/login-types/new-wallet/new-wallet.component';\nimport { MnemonicImportComponent } from './components/views/start/login-types/mnemonic-import/mnemonic-import.component';\nimport { ConnectLedgerComponent } from './components/views/start/login-types/connect-ledger/connect-ledger.component';\nimport { P404Component } from './components/views/error/404.component';\nimport { P500Component } from './components/views/error/500.component';\nimport { PrivacyPolicyComponent } from './components/views/start/agreement/privacy-policy/privacy-policy.component';\nimport { TermsOfUseComponent } from './components/views/start/agreement/terms-of-use/terms-of-use.component';\nimport { EmbeddedComponent } from './components/views/embedded/embedded.component';\nimport { LoggedInComponent } from './components/views/logged-in/logged-in.component';\nimport { ActivateComponent } from './components/views/start/activate/activate.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    children: [\n      { path: '', component: StartComponent },\n      { path: 'new-wallet', component: NewWalletComponent },\n      { path: 'import', component: MnemonicImportComponent },\n      { path: 'connect-ledger', component: ConnectLedgerComponent },\n      {\n        path: 'account',\n        component: LoggedInComponent,\n        loadChildren: () => import(`./components/views/logged-in/logged-in.module`).then((module) => module.LoggedInModule)\n      },\n      { path: 'activate', component: ActivateComponent },\n      { path: 'serviceworker', component: TermsOfUseComponent },\n      { path: 'embedded', component: EmbeddedComponent }\n    ]\n  },\n  { path: 'privacy-policy', component: PrivacyPolicyComponent },\n  { path: 'terms-of-use', component: TermsOfUseComponent },\n  { path: '404', component: P404Component, data: { title: 'Page 404' } },\n  { path: '500', component: P500Component, data: { title: 'Page 500' } },\n  { path: '**', redirectTo: '404' }\n];\n\n@NgModule({\n  imports: [RouterModule.forRoot(routes, { relativeLinkResolution: 'legacy' })],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule {}\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-logged-in',\n  templateUrl: './logged-in.component.html'\n})\nexport class LoggedInComponent implements OnInit {\n  constructor() {}\n\n  ngOnInit(): void {}\n}\n","<app-uri-handler></app-uri-handler>\n<router-outlet></router-outlet>\n<app-moonpay></app-moonpay>","<div [style.display]=\"!isOpen ? 'none' : ''\" class=\"flex-column kukai-modal\">\n  <div class=\"content\">\n    <div class=\"flex-row top\">\n      <div class=\"flex-row button close\" (click)=\"close()\"><img class=\"x\"\n          src=\"../../../../../assets/img/close-btn-x.png\" />\n      </div>\n      <h1 class=\"title\">{{ title }}</h1>\n    </div>\n    <div class=\"flex-column info\">\n      <div class=\"message\">\n        {{ message }}\n      </div>\n      <div *ngIf=\"action\" class=\"flex-column bottom\">\n        <div class=\"seperator\"></div>\n        <button class=\"button confirm\" (click)=\"proceed()\">{{ action }}</button>\n      </div>\n    </div>\n  </div>\n</div>","import { Component, Input, OnInit } from '@angular/core';\nimport { ModalComponent } from '../modal.component';\n\n@Component({\n  selector: 'app-info',\n  templateUrl: './info.component.html',\n  styleUrls: ['../../../../scss/components/modals/modal.scss']\n})\nexport class InfoComponent extends ModalComponent implements OnInit {\n  action = '';\n  message = '';\n  href = '';\n  title = 'Info';\n  name = 'info';\n  constructor() {\n    super();\n  }\n\n  ngOnInit(): void {}\n\n  open(data: any): void {\n    this.action = data?.action;\n    this.message = data?.message;\n    this.href = data?.href;\n    this.title = data?.title || this.title;\n    super.open();\n  }\n\n  closeModal(): void {\n    super.close();\n  }\n  proceed(): void {\n    if (!!this.href) {\n      const newTab = window.open(this.href, '_blank');\n      newTab.focus();\n      newTab.opener = null;\n    }\n    this.closeModal();\n  }\n}\n","<ng-container *ngIf=\"!message?.timeout && message?.msg\">\n  <span *ngIf=\"!message?.email && !message?.username && !message?.twitterId && message?.msg\">{{ message.msg }}</span>\n  <span *ngIf=\"message?.email || message?.username || message?.twitterId\">Click <a target=\"_blank\"\n      href=\"{{ notifyFormat(message) }}\">here to notify</a> {{ getAlias(message) }} via {{ message.msg }}: <b>{{\n      message.amount }}</b> sent</span>\n  <svg version=\"1.2\" baseProfile=\"tiny-ps\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 14 14\" width=\"14\" height=\"14\"\n    class=\"flex-row button close\" (click)=\"removeMessage(index)\">\n    <title>Popups</title>\n    <g id=\"Popups\">\n      <g id=\"Confirmation TEZ\">\n        <g id=\"Close Button\">\n          <path id=\"Rectangle 13\" class=\"shp0\"\n            d=\"M13.46 0.54C14.18 1.25 14.18 2.41 13.46 3.12L3.12 13.46C2.41 14.18 1.25 14.18 0.54 13.46C-0.18 12.75 -0.18 11.59 0.54 10.88L10.88 0.54C11.59 -0.18 12.75 -0.18 13.46 0.54ZM3.12 0.54L13.46 10.88C14.18 11.59 14.18 12.75 13.46 13.46C12.75 14.18 11.59 14.18 10.88 13.46L0.54 3.12C-0.18 2.41 -0.18 1.25 0.54 0.54C1.25 -0.18 2.41 -0.18 3.12 0.54Z\" />\n        </g>\n      </g>\n    </g>\n  </svg>\n</ng-container>\n<ng-container *ngIf=\"message?.timeout && message?.msg\">\n  <span *ngIf=\"message?.msg\">{{ message.msg }}</span><img *ngIf=\"message?.loader\" class=\"loader\"\n    src=\"../../../../assets/img/wait.svg\">\n</ng-container>","import { Component, Input, OnInit } from '@angular/core';\nimport { MessageService } from '../../../services/message/message.service';\n\n@Component({\n  selector: 'app-alert',\n  templateUrl: './alert.component.html',\n  styleUrls: ['../../../../scss/components/modals/alert/alert.component.scss']\n})\nexport class AlertComponent implements OnInit {\n  @Input() public message;\n  @Input() index;\n\n  constructor(public messageService: MessageService) {}\n  readonly subject = 'Sent you Tezos tokens';\n  ngOnInit(): void {\n    if (this.message?.timeout) {\n      setTimeout(() => {\n        this.removeMessage(this.index);\n        this.message = null;\n      }, this.message?.timeout);\n    }\n  }\n\n  removeMessage(index: number): void {\n    this.messageService.messages.splice(index, 1);\n  }\n  getHostName(): string {\n    return location.hostname;\n  }\n  notifyFormat(message: any): string | Error {\n    if (message.email) {\n      return this.mailtoFormat(message);\n    } else if (message.username) {\n      return this.redditPmFormat(message);\n    } else if (message.twitterId) {\n      return this.twitterPmFormat(message);\n    } else {\n      throw new Error('Invalid message');\n    }\n  }\n  mailtoFormat(message: any): string {\n    const subject = encodeURI(this.subject);\n    const body = this.encodedBody(message.amount, 'Google', `https://${this.getHostName()}\\n\\n`);\n    return `mailto:${message.email}?subject=${subject}&body=${body}`;\n  }\n  redditPmFormat(message: any): string {\n    // https://www.reddit.com/message/compose?to=USERNAME&subject=SUBJECT&message=MESSAGE\n    const subject = encodeURI(this.subject);\n    const body = this.encodedBody(`${message.amount}`, 'Reddit', `[kukai.app](https://${this.getHostName()})`);\n    return `https://www.reddit.com/message/compose?to=${message.username}&subject=${subject}&message=${body}`;\n  }\n  twitterPmFormat(message: any): string {\n    // https://twitter.com/messages/compose?recipient_id=USER_ID&text=MESSAGE\n    const body = this.encodedBody(message.amount, 'Twitter', `https://${this.getHostName()}`);\n    return `https://twitter.com/messages/compose?recipient_id=${message.twitterId}&text=${body}`;\n  }\n  encodedBody(amount: string, accountType: string, url: string): string {\n    const s = accountType === 'Reddit' ? '  ' : '';\n    const b = accountType === 'Reddit' ? '**' : '';\n    const t = accountType === 'Twitter' ? 'Tezos ' : '';\n    return encodeURI(\n      `Hi,${s}\\nI sent you ${b}${amount}${b} using the Kukai wallet.\\n\\nYou can access your ${t}wallet with your ${accountType} account at: ${url}`\n    );\n  }\n  getAlias(message: any): string {\n    return message.email ? message.email : message.username ? message.username : message.handler ? message.handler : 'recipient';\n  }\n}\n","<div class='msg-container'>\n  <div *ngFor=\"let message of messageService.messages ; let i = index\">\n    <app-alert [message]=\"message\" [index]=\"i\" class=\"flex-row alert\" [class]=\"'alert alert-'+message.type\">\n    </app-alert>\n  </div>\n</div>","import { Component, OnInit } from '@angular/core';\nimport { MessageService } from '../../../services/message/message.service';\nimport { TorusService } from '../../../services/torus/torus.service';\n\n@Component({\n  selector: 'app-messages',\n  templateUrl: './messages.component.html',\n  styleUrls: ['../../../../scss/components/ui/messages/messages.component.scss']\n})\nexport class MessagesComponent implements OnInit {\n  constructor(public messageService: MessageService, public torusService: TorusService) {}\n  ngOnInit(): void {}\n}\n","<div *ngIf=\"router.url.indexOf('/account/') > -1\" class=\"flex-row dropdown\" [class.expanded]=\"isOpen\"\n  [style.cursor]=\"['', 'domain'].includes(getVerifier()) ? '' : 'text'\" [id]=\"ecmpId\">\n  <div class=\"flex-row currentAddress\" (click)=\"['', 'domain'].includes(getVerifier()) ? toggleDropdown() : ''\"><img\n      *ngIf=\"!!getUsername(current?.address)\" class=\"logo\"\n      src=\"../../../../assets/img/{{ getVerifier() }}-logo.svg\" /><span class=\"address\">{{\n      getUsername(current?.address) || \"&nbsp;&nbsp;&nbsp;&nbsp;\" + current?.shortAddress() }}</span><img\n      *ngIf=\"['', 'domain'].includes(getVerifier())\" class=\"button icon-db\"\n      src=\"../../../../assets/img/down-arrow.svg\" />\n  </div>\n  <div class=\"flex-column dropdown-content\">\n    <div class=\"flex-column body\">\n      <ng-container *ngFor=\"let account of list; trackBy: trackAccount\">\n        <a class=\"option\" routerLink=\"/account/{{account?.address}}{{postfix}}\"\n          [class.selected]=\"account?.address === current?.address\"\n          [style.padding]=\"!getUsername(current?.address) ? '0.75rem 1.125rem 0.75rem calc(2.5rem - var(--border-width))' : ''\"\n          (click)=\"toggleDropdown()\">\n          <ng-container *ngIf=\"getUsername(account?.address)\">\n            <div class=\"flex-row alias\"><img class=\"logo\"\n                src=\"../../../../assets/img/{{ getVerifier() }}-logo.svg\" /><span>{{\n                getUsername(account?.address) }}</span></div>\n          </ng-container>\n          <ng-container *ngIf=\"!getUsername(account?.address)\">{{ account?.shortAddress() }}</ng-container>\n        </a>\n      </ng-container>\n    </div>\n    <div *ngIf=\"list?.length > 1\" class=\"option show-all\" [style.padding]=\"!getUsername(current?.address) ? '0.75rem 1.125rem 0.75rem calc(2.5rem - var(--border-width))' : ''\" (click)=\"showAll()\">\n      <span>Show All</span>\n    </div>\n  </div>\n</div>","import { Component, Input, OnChanges, OnDestroy, OnInit, SimpleChanges } from '@angular/core';\nimport { NavigationEnd, Router } from '@angular/router';\nimport { TorusWallet } from '../../../../services/wallet/wallet';\nimport { WalletService } from '../../../../services/wallet/wallet.service';\nimport { LookupService } from '../../../../services/lookup/lookup.service';\nimport { DropdownComponent } from '../dropdown.component';\nimport { ModalComponent } from '../../../modals/modal.component';\nimport { filter } from 'rxjs/operators';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'app-ui-dropdown-account',\n  templateUrl: './account-dropdown.component.html',\n  styleUrls: ['../../../../../scss/components/ui/dropdown/account-dropdown.component.scss']\n})\nexport class AccountDropdownComponent extends DropdownComponent implements OnInit, OnChanges, OnDestroy {\n  postfix = '';\n\n  private subscriptions: Subscription = new Subscription();\n\n  constructor(public router: Router, public lookupService: LookupService, private walletService: WalletService) {\n    super();\n    this.subscriptions.add(\n      this.router.events.pipe(filter((evt) => evt instanceof NavigationEnd)).subscribe(async (r: NavigationEnd) => {\n        let accountAddress = r.url.substr(r.url.indexOf('/account/') + 9);\n        this.postfix = !!accountAddress.substring(36) ? accountAddress.substring(36) : '';\n      })\n    );\n  }\n\n  ngOnInit(): void {\n    this.list = this.options;\n    let accountAddress = this.router.url.substr(this.router.url.indexOf('/account/') + 9);\n    this.postfix = !!accountAddress.substring(36) ? accountAddress.substring(36) : '';\n  }\n\n  ngOnChanges(changes: SimpleChanges): void {\n    if (changes.options && changes.options.currentValue !== changes.options.previousValue) {\n      this.list = this.options;\n    }\n  }\n\n  ngOnDestroy() {\n    this.subscriptions.unsubscribe();\n  }\n\n  getUsername(address: string): string {\n    if (this.walletService.wallet instanceof TorusWallet) {\n      return this.walletService.wallet.displayName();\n    } else {\n      const party = this.lookupService.resolve({\n        address: address || this.current?.address\n      });\n      if (party?.name) {\n        return party.name;\n      }\n    }\n    return '';\n  }\n  getVerifier(): string {\n    if (this.walletService.wallet instanceof TorusWallet) {\n      return this.walletService.wallet.verifier;\n    } else {\n      return 'domain';\n    }\n  }\n  showAll(): void {\n    ModalComponent.currentModel.next({ name: 'account-list', data: null });\n  }\n  trackAccount(index: number, account: any) {\n    return account?.address ? account.address : index;\n  }\n}\n","<div class=\"hamburger-dropdown\" [class.expanded]=\"isOpen\" [id]=\"ecmpId\">\n  <img class=\"button icon-db\" src=\"../../../../assets/img/hamburger.svg\" (click)=\"toggleDropdown()\" />\n  <div *ngIf=\"router.url.indexOf('/account/') === 0\" class=\"flex-column mobile dropdown-content\">\n    <div class=\"flex-row-wrap account-content\">\n      <div class=\"flex-column button\" (click)=\"unlockableService.toggleFeature('theme', 'dark');toggleDropdown()\">\n        <div class=\"wrapper\">\n          <img class=\"icon\" [src]=\"this.unlockableService?.unlockables?.theme === 'dark' ? 'assets/img/light_mode_blue.svg' : 'assets/img/dark_mode_blue.svg'\" />\n        </div>\n        <span>THEME</span>\n      </div>\n      <div *ngIf=\"router.url.indexOf('/account/') === 0\" class=\"flex-column button\" (click)=\"copy();toggleDropdown()\">\n        <div class=\"wrapper\">\n          <img class=\"icon\" src=\"../../../../assets/img/copy-blue.svg\" />\n        </div>\n        <span>COPY</span>\n      </div>\n      <div class=\"flex-column button\" (click)=\"receive();toggleDropdown()\">\n        <div class=\"wrapper\">\n          <img class=\"icon\" src=\"../../../../assets/img/qr-blue.svg\" />\n        </div>\n        <span>QR</span>\n      </div>\n      <div *ngIf=\"walletService.isHdWallet()\" class=\"flex-column button\" (click)=\"newAccount();toggleDropdown()\">\n        <div class=\"wrapper\">\n          <img class=\"icon\" src=\"../../../../assets/img/add-blue.svg\" />\n        </div>\n        <span>ADD</span>\n      </div>\n    </div>\n    <div class=\"flex-row button delegation\" routerLink=\"/account/{{activeAccount?.address}}/stakers\"\n      (click)=\"toggleDropdown()\">\n      <div *ngIf=\"!activeAccount?.delegate\" class=\"flex-row\">\n        <span class=\"flex-row\">STAKING:</span><span class=\"choose\">NOT\n          STAKING</span>\n      </div>\n      <div *ngIf=\"activeAccount?.delegate\" class=\"flex-row\">\n        <span>STAKING</span>\n        <span class=\"flex-row address\">{{ delegateName\n          }}</span>\n      </div>\n    </div>\n\n    <div class=\"flex-row button\" [routerLink]=\"'/account/' + activeAccount?.address + '/settings'\" (click)=\"toggleDropdown()\">\n      <span>SETTINGS</span><img class=\"icon settings\" src=\"../../../../assets/img/cog.svg\" style=\"width: 2.75rem\" />\n    </div>\n    <div class=\"flex-row button\" (click)=\"logout();toggleDropdown()\">\n      <span>LOGOUT</span><img class=\"icon\" src=\"../../../../assets/img/sign-out-alt.svg\" style=\"width: 2.5rem\" />\n    </div>\n  </div>\n  <div *ngIf=\"router.url.indexOf('/account/') !== 0\" class=\"flex-column mobile dropdown-content\">\n    <div routerLink=\"/import/\" class=\"flex-row button\" (click)=\"toggleDropdown()\">\n      <span>Import Wallet</span>\n    </div>\n    <div routerLink=\"/new-wallet/\" class=\"flex-row button\" (click)=\"toggleDropdown()\">\n      <span>Create New Wallet</span>\n    </div>\n    <div routerLink=\"/connect-ledger/\" class=\"flex-row button\" (click)=\"toggleDropdown()\">\n      <span>Connect Ledger</span>\n    </div>\n  </div>\n</div>","import { Component, Input, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { WalletService } from '../../../../services/wallet/wallet.service';\nimport { Account } from '../../../../services/wallet/wallet';\nimport { DropdownComponent } from '../dropdown.component';\nimport { TranslateService } from '@ngx-translate/core';\nimport copy from 'copy-to-clipboard';\nimport { MessageService } from '../../../../services/message/message.service';\nimport { LookupService } from '../../../../services/lookup/lookup.service';\nimport { SubjectService } from '../../../../services/subject/subject.service';\nimport { ModalComponent } from '../../../../components/modals/modal.component';\nimport { take } from 'rxjs/operators';\nimport { UnlockableService } from '../../../../services/unlockable/unlockable.service';\n\n@Component({\n  selector: 'app-ui-mobile-menu',\n  templateUrl: './mobile-menu.component.html',\n  styleUrls: ['../../../../../scss/components/ui/dropdown/mobile-menu.component.scss']\n})\nexport class MobileMenuDropdownComponent extends DropdownComponent implements OnInit {\n  @Input() activeAccount: Account;\n  @Input() delegateName;\n  @Input() newAccount;\n  @Input() receive;\n\n  constructor(\n    public router: Router,\n    public walletService: WalletService,\n    public lookupService: LookupService,\n    private messageService: MessageService,\n    private translate: TranslateService,\n    private subjectService: SubjectService,\n    public unlockableService: UnlockableService\n  ) {\n    super();\n  }\n\n  ngOnInit(): void {}\n  toggleDropdown(): void {\n    if (window.innerHeight < document.body.scrollHeight) {\n      document.body.style.overflow = 'hidden';\n    }\n    this.isOpen = !this.isOpen;\n  }\n  copy(): void {\n    copy(this.activeAccount.address);\n    const copyToClipboard = this.translate.instant('OVERVIEWCOMPONENT.COPIEDTOCLIPBOARD');\n    this.messageService.add(this.activeAccount.address + ' ' + copyToClipboard, 5);\n  }\n  openSwap() {\n    this.messageService.startSpinner();\n    ModalComponent.currentModel.next({ name: 'swap-liquidity', data: null });\n  }\n  logout(): void {\n    this.subjectService.logout.next(true);\n    this.messageService.clear();\n    this.walletService.clearWallet();\n    this.lookupService.clear();\n    this.router.navigate(['']);\n  }\n}\n","<div class=\"flex-row top-container desktop\" [class]=\"router.url.indexOf('/account') === 0 ? 'default' : ''\">\n  <a routerLink=\"/\" class=\"flex-row brand-logo\">\n    <img class=\"icon\" src=\"../../../assets/img/header-logo.svg\" />\n  </a>\n  <div *ngIf=\"router.url.indexOf('/account/') === 0\" class=\"flex-row right\">\n    <div class=\"button icon\" (click)=\"unlockableService.toggleFeature('theme', 'dark')\">\n      <img [src]=\"this.unlockableService?.unlockables?.theme === 'dark' ? 'assets/img/light_mode.svg' : 'assets/img/dark_mode.svg'\" />\n      <div class=\"tooltip\">\n        <div class=\"description\">THEME</div>\n      </div>\n    </div>\n    <div class=\"flex-column left\">\n      <app-ui-dropdown-account [options]=\"accounts\" [current]=\"activeAccount\"></app-ui-dropdown-account>\n      <div class=\"delegation\">\n        <div class=\"flex-row outside-container\" *ngIf=\"!beaconMode\">\n          <div class=\"flex-row button\" routerLink=\"/account/{{activeAccount?.address}}/stakers\">\n            <span *ngIf=\"!activeAccount?.delegate\">STAKING: <span class=\"choose\">NOT\n                STAKED</span></span>\n            <span *ngIf=\"activeAccount?.delegate\" class=\"address\">STAKING: <span>{{ delegateName }}</span></span>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"flex-row right\">\n      <div class=\"button icon\" (click)=\"copy()\">\n        <img src=\"../../../assets/img/copy.svg\" />\n        <div class=\"tooltip\">\n          <div class=\"description\">COPY ADDRESS</div>\n        </div>\n      </div>\n      <div class=\"button icon receive\" (click)=\"receive()\">\n        <img src=\"../../../assets/img/qr.svg\" />\n        <div class=\"tooltip\">\n          <div class=\"description\">ADDRESS QR</div>\n        </div>\n      </div>\n      <div *ngIf=\"walletService.isHdWallet()\" class=\"button icon\" (click)=\"newAccount()\">\n        <img src=\"../../../assets/img/add.svg\" />\n        <div class=\"tooltip\">\n          <div class=\"description\">ADD ACCOUNT</div>\n        </div>\n      </div>\n      <div class=\"button icon settings\" [routerLink]=\"'/account/' + activeAccount?.address + '/settings'\">\n        <img src=\"../../../assets/img/settings.svg\" />\n        <div class=\"tooltip\">\n          <div class=\"description\">SETTINGS</div>\n        </div>\n      </div>\n      <div class=\"button icon\" (click)=\"logout()\">\n        <img src=\"../../../assets/img/logout.svg\" />\n        <div class=\"tooltip\">\n          <div class=\"description\">SIGN OUT</div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div *ngIf=\"router?.url?.indexOf('/account/') !== 0\" class=\"flex-row right\">\n    <div class=\"right\">\n      <span *ngIf=\"router.url.indexOf('/import') === 0 || router.url === '/' || router.url.startsWith('/?type')\" routerLink=\"/import/\" class=\"button\"\n        [class.selected]=\"router.url.indexOf('/import') === 0\">Import Wallet</span>\n      <span *ngIf=\"router.url.indexOf('/new-wallet') === 0 || router.url === '/' || router.url.startsWith('/?type')\" routerLink=\"/new-wallet/\"\n        class=\"button\" [class.selected]=\"router.url.indexOf('/new-wallet') === 0\">Create New Wallet</span>\n      <span *ngIf=\"router.url.indexOf('/connect-ledger') === 0 || router.url === '/' || router.url.startsWith('/?type')\" routerLink=\"/connect-ledger/\"\n        class=\"button\" [class.selected]=\"router.url.indexOf('/connect-ledger') === 0\">Connect Ledger</span>\n      <span *ngIf=\"router.url.indexOf('/activate') === 0\" routerLink=\"/activate/\" class=\"button\"\n        [class.selected]=\"router.url.indexOf('/activate') === 0\">Activate</span>\n    </div>\n  </div>\n</div>\n<div class=\"flex-row top-container mobile\" [class]=\"router.url.indexOf('/account') === 0 ? 'default' : ''\">\n  <a routerLink=\"/\" class=\"flex-row brand-logo\">\n    <img class=\"icon\" src=\"../../../assets/img/header-logo.svg\" />\n  </a>\n  <div *ngIf=\"router.url.indexOf('/account/') > -1\" class=\"flex-row center\">\n    <app-ui-dropdown-account [options]=\"accounts\" [current]=\"activeAccount\" style=\"width: 100%;\">\n    </app-ui-dropdown-account>\n  </div>\n  <app-ui-mobile-menu [activeAccount]=\"activeAccount\" [delegateName]=\"delegateName\" [newAccount]=\"newAccount\" [receive]=\"receive\"></app-ui-mobile-menu>\n</div>","import { Component, OnInit, Input, SimpleChanges, OnChanges, OnDestroy } from '@angular/core';\nimport { Router, NavigationEnd, ActivatedRoute } from '@angular/router';\nimport { WalletService } from '../../../../services/wallet/wallet.service';\nimport { Account } from '../../../../services/wallet/wallet';\nimport { LookupService } from '../../../../services/lookup/lookup.service';\nimport { MessageService } from '../../../../services/message/message.service';\nimport { CONSTANTS as _CONSTANTS } from '../../../../../environments/environment';\nimport { filter } from 'rxjs/operators';\nimport copy from 'copy-to-clipboard';\nimport { TranslateService } from '@ngx-translate/core';\nimport { ModalComponent } from '../../../modals/modal.component';\nimport { DelegateService } from '../../../../services/delegate/delegate.service';\nimport { SubjectService } from '../../../../services/subject/subject.service';\nimport { Subscription } from 'rxjs';\nimport { DeeplinkService } from '../../../../services/deeplink/deeplink.service';\nimport { UnlockableService } from '../../../../services/unlockable/unlockable.service';\n\n@Component({\n  selector: 'app-header',\n  templateUrl: './header.component.html',\n  styleUrls: ['../../../../../scss/components/views/layouts/header/header.component.scss']\n})\nexport class HeaderComponent implements OnInit, OnChanges, OnDestroy {\n  window = window;\n  document = document;\n  @Input() activeAccount: Account;\n  accounts: Account[];\n  delegateName = '';\n  readonly CONSTANTS = _CONSTANTS;\n  private subscriptions: Subscription = new Subscription();\n  constructor(\n    public router: Router,\n    private route: ActivatedRoute,\n    private deeplinkService: DeeplinkService,\n    public walletService: WalletService,\n    public lookupService: LookupService,\n    private messageService: MessageService,\n    private translate: TranslateService,\n    private delegateService: DelegateService,\n    private subjectService: SubjectService,\n    public unlockableService: UnlockableService\n  ) {}\n\n  ngOnInit(): void {\n    this.subscriptions.add(\n      this.subjectService.walletUpdated.subscribe(async () => {\n        this.accounts = this.walletService.wallet?.getAccounts();\n        this.delegateName = await this.getDelegateName(this.activeAccount?.delegate);\n      })\n    );\n    this.accounts = this.walletService.wallet?.getAccounts();\n    this.subscriptions.add(\n      this.route.queryParams.subscribe(async (params) => {\n        if (params?.type) {\n          this.deeplinkService.set(params);\n        }\n      })\n    );\n    this.subscriptions.add(\n      this.router.events.pipe(filter((evt) => evt instanceof NavigationEnd)).subscribe(async (r: NavigationEnd) => {\n        document.body.scrollTop = 0;\n        if (!(this.accounts?.length > 0) && r.url.indexOf('/account/') === 0) {\n          this.router.navigateByUrl('/');\n        } else if (this.accounts?.length > 0 && !r.url.match(/terms\\-of\\-use|privacy\\-policy/g)) {\n          let accountAddress = r.url.substr(r.url.indexOf('/account/') + 9);\n          accountAddress = accountAddress.indexOf('/') !== -1 ? accountAddress.substring(0, accountAddress.indexOf('/')) : accountAddress;\n          if (!this.walletService.addressExists(accountAddress)) {\n            this.router.navigateByUrl(`/account/${this.accounts[0].address}`);\n            this.activeAccount = this.accounts[0];\n            this.subjectService.activeAccount.next(this.accounts[0]);\n          } else {\n            this.activeAccount = this.walletService.wallet?.getAccount(accountAddress);\n            this.subjectService.activeAccount.next(this.activeAccount);\n          }\n          this.delegateName = await this.getDelegateName(this.activeAccount?.delegate);\n        }\n      })\n    );\n  }\n\n  async ngOnChanges(changes: SimpleChanges): Promise<void> {\n    if (changes?.activeAccount?.currentValue) {\n      this.delegateName = await this.getDelegateName(changes?.activeAccount?.currentValue.delegate);\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n\n  logout(): void {\n    this.subjectService.logout.next(true);\n    this.messageService.clear();\n    this.walletService.clearWallet();\n    this.lookupService.clear();\n    this.router.navigate(['']);\n  }\n  copy(): void {\n    copy(this.activeAccount.address);\n    const copyToClipboard = this.translate.instant('OVERVIEWCOMPONENT.COPIEDTOCLIPBOARD');\n    this.messageService.add(this.activeAccount.address + ' ' + copyToClipboard, 5);\n  }\n\n  toggleDropdown(sel): void {\n    document.querySelector(sel).parentNode.classList.toggle('expanded');\n  }\n  newAccount(): void {\n    ModalComponent.currentModel.next({ name: 'new-implicit', data: null });\n  }\n  receive(): void {\n    ModalComponent.currentModel.next({\n      name: 'receive',\n      data: { address: this.activeAccount.address }\n    });\n  }\n\n  async getDelegateName(address: string): Promise<string> {\n    return address\n      ? (await this.delegateService.resolveDelegateByAddress(address))?.name ??\n          address.substring(0, 7) + '...' + address.substring(address.length - 4, address.length)\n      : address;\n  }\n}\n","<div *ngIf=\"this.path !== '/embedded'\" class=\"foot-container\" [class.dark]=\"true\">\n  <div class=\"flex-row links\">\n    <div class=\"flex-row left low\">\n      <a href=\"./terms-of-use\" target=\"_blank\">Terms of Use</a>\n      <a href=\"./privacy-policy\" target=\"_blank\">Privacy</a>\n      <a class=\"desktop\" target=\"_blank\" href=\"mailto:contact@kukai.app\">Contact</a>\n    </div>\n    <div class=\"flex-column since low\">\n      <div class=\"flex-row-wrap\" id=\"follow\">\n        <span>follow kukai on</span>\n        <a href=\"https://github.com/kukai-wallet/kukai\" target=\"_blank\"><img src=\"../../../assets/img/logo-github.svg\"></a>\n        <a (click)=\"promptTelegramDialog($event)\" id=\"tg\"><img src=\"../../../assets/img/logo-telegram.svg\"></a>\n        <a href=\"https://twitter.com/KukaiWallet/\" target=\"_blank\"><img src=\"../../../assets/img/logo-twitter.svg\"></a>\n        <a id=\"since\">Since 2018 &trade;</a>\n      </div>\n    </div>\n    <div class=\"flex-row low\">\n      <a class=\"mobile\" target=\"_blank\" href=\"mailto:contact@kukai.app\">Contact</a>\n        <a class=\"docs\" href=\"https://docs.kukai.app\" target=\"_blank\">\n          Help</a>\n    </div>\n  </div>\n</div>","import { Component, OnInit } from '@angular/core';\nimport { ModalComponent } from '../../../../components/modals/modal.component';\n\n@Component({\n  selector: 'app-footer',\n  templateUrl: './footer.component.html',\n  styleUrls: ['../../../../../scss/components/views/layouts/footer/footer.component.scss']\n})\nexport class FooterComponent implements OnInit {\n  darkText = false;\n  path = '';\n  ModalComponent = ModalComponent;\n  constructor() {}\n\n  ngOnInit(): void {}\n  promptTelegramDialog(ev) {\n    ev.preventDefault();\n    ModalComponent.currentModel.next({\n      name: 'info',\n      data: {\n        href: 'https://t.me/KukaiWallet',\n        message: `Social engineering attacks are currently a high threat on Telegram.\n\n Do not answer anyone that sends you private messages or calls you\n\n Do not click on any links in a private message, or share your seed words with anyone`,\n        title: 'Security Notice',\n        action: 'I understand'\n      }\n    });\n  }\n}\n","import { Component, Input, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-spinner-new',\n  templateUrl: './spinner-new.component.html',\n  styleUrls: ['./spinner-new.component.scss']\n})\nexport class SpinnerNewComponent implements OnInit {\n  @Input() logo: string;\n  constructor() {}\n\n  ngOnInit(): void {}\n}\n","<img class=\"spinner\" src=\"../../../../assets/img/spinner/gradientSpiral.svg\">\n<img class=\"logo\" src=\"../../../../assets/img/spinner/{{logo}}.svg\">","<ng-container *ngIf=\"messageService && messageService.spinnerOn\">\n  <app-spinner-new [logo]=\"logo\"></app-spinner-new>\n  <!-- <app-spinner-legacy *ngIf=\"!embedded\"></app-spinner-legacy> -->\n</ng-container>","import { Component, OnInit, Input, OnDestroy } from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { MessageService } from '../../../services/message/message.service';\nimport { SubjectService } from '../../../services/subject/subject.service';\n\n@Component({\n  selector: 'app-spinner',\n  templateUrl: './spinner.component.html',\n  styleUrls: ['./spinner.component.scss']\n})\nexport class SpinnerComponent implements OnInit, OnDestroy {\n  @Input() embedded: boolean;\n  logo = 'default';\n  private subscriptions: Subscription = new Subscription();\n  constructor(public messageService: MessageService, private subjectService: SubjectService) {}\n\n  ngOnInit(): void {\n    this.subjectService.origin.subscribe((o) => {\n      if (o?.endsWith('gap.com')) {\n        this.logo = 'gap';\n      } else if (o?.endsWith('truesy.com')) {\n        this.logo = 'truesy';\n      } else if (o?.endsWith('playwithbrio.com')) {\n        this.logo = 'brio';\n      } else if (o && o?.indexOf('interpop') !== -1) {\n        this.logo = 'minterPop';\n      } else {\n        this.logo = 'default';\n      }\n    });\n  }\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n}\n","<div *ngIf=\"displayAgreement\" class=\"agreement-wrapper fade-in\">\n  <div class=\"agreement-body\">\n    <div class=\"agreement-footer fade-in\">\n      <p>By Accessing, Continuing to Use & Browse this Website including its Services provided therein (Kukai Wallet),\n        you agree that you have read and reviewed our <a href=\"./terms-of-use\" target=\"_blank\">Terms of Use</a> and <a\n          href=\"./privacy-policy\" target=\"_blank\">Privacy Policy</a>.</p>\n      <div>\n        <div class=\"flex-column accept\">\n          <button class=\"fade-in\" (click)=\"accept()\">Accept</button>\n          <p>I have reviewed the Terms of Use and Privacy Policy, I hereby Accept and Agree to the Terms of Use and\n            Privacy Policy.</p>\n        </div>\n        <div class=\"flex-column decline\">\n          <a class=\"flex-column\" href=\"about:blank\"><button>Decline</button></a>\n          <p>I have reviewed the Terms of Use and Privacy Policy, I hereby DO NOT Accept and Agree to the Terms of Use\n            and Privacy Policy.</p>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>","import { Component, OnInit } from '@angular/core';\nimport { Location } from '@angular/common';\n\n@Component({\n  selector: 'app-agreement',\n  templateUrl: './agreement.component.html',\n  styleUrls: ['../../../../../scss/components/views/start/agreement/agreement.component.scss']\n})\nexport class AgreementComponent implements OnInit {\n  displayAgreement = false;\n  key = 'accepted-terms';\n  constructor(private location: Location) {}\n  ngOnInit(): void {\n    // localStorage.removeItem(this.key);\n    const accepted = localStorage.getItem(this.key);\n    const path = this.location.path();\n    if (!accepted && path !== '/terms-of-use' && path !== '/privacy-policy') {\n      this.displayAgreement = true;\n      const scrollBarWidth = window.innerWidth - document.body.offsetWidth;\n      document.body.style.marginRight = scrollBarWidth.toString();\n      document.body.style.overflowY = 'hidden';\n    }\n  }\n  accept(): void {\n    localStorage.setItem(this.key, '1');\n    this.displayAgreement = false;\n    document.body.style.marginRight = '';\n    document.body.style.overflowY = '';\n  }\n  reject(): void {\n    document.body.style.marginRight = '';\n    document.body.style.overflowY = '';\n    window.open('', '_self');\n  }\n}\n","<div *ngIf=\"!CONSTANTS.MAINNET && !embedded\" class=\"network\"\n  [style.boxShadow]=\"document?.body.scrollTop !== 0 ? '0 2px 10px #3333' : ''\">\n  WARNING: TEST ONLY {{ CONSTANTS.NETWORK.toUpperCase() }}\n</div>\n<app-header *ngIf=\"!embedded\"></app-header>\n<router-outlet></router-outlet>\n<app-messages *ngIf=\"!embedded\"></app-messages>\n<app-spinner [embedded]=\"embedded\"></app-spinner>\n<app-agreement *ngIf=\"!embedded\"></app-agreement>\n<app-info></app-info>\n<app-footer *ngIf=\"!embedded\" [class.initial]=\"router.url !== '/'\"></app-footer>","import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { Router, Event, NavigationEnd } from '@angular/router';\nimport { WalletService } from './services/wallet/wallet.service';\nimport { TranslateService } from '@ngx-translate/core';\nimport { Location } from '@angular/common';\nimport { CONSTANTS as _CONSTANTS } from '../environments/environment';\nimport { Subscription } from 'rxjs';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent implements OnInit, OnDestroy {\n  readonly CONSTANTS = _CONSTANTS;\n  embedded = false;\n  isMobile = false;\n  previous = 0;\n  current = 0;\n  diff = 0;\n  container = null;\n  post = false;\n  private subscriptions: Subscription = new Subscription();\n  constructor(private walletService: WalletService, public router: Router, public translate: TranslateService, private location: Location) {\n    // this language will be used as a fallback when a translation isn't found in the current language\n    translate.setDefaultLang('en');\n\n    // the lang to use, if the lang isn't available, it will use the current loader to get them\n    const languagePreference = window.localStorage.getItem('languagePreference');\n    const browserLang = translate.getBrowserLang();\n    translate.use('en');\n  }\n\n  ngOnInit() {\n    this.checkEmbedded();\n    if (!this.embedded) {\n      this.walletService.loadStoredWallet();\n    }\n    this.subscriptions.add(\n      this.router.events.subscribe((event: Event) => {\n        if (event instanceof NavigationEnd) {\n          this.checkEmbedded();\n          window.scrollTo(0, 0);\n        }\n      })\n    );\n    if (!this.embedded) {\n      window.addEventListener('storage', (e) => {\n        this.handleStorageEvent(e);\n      });\n    }\n\n    const e = () => {\n      const brk = getComputedStyle(document.documentElement).getPropertyValue('--layout-break-5');\n      if (parseFloat(brk.replace(/[a-zA-Z]/g, '')) * 16 > document.documentElement.clientWidth) {\n        document.documentElement.style.setProperty('--is-mobile', '1');\n      } else {\n        document.documentElement.style.setProperty('--is-mobile', '0');\n      }\n    };\n    window.addEventListener('resize', e);\n    window.addEventListener('load', e);\n    e();\n  }\n  ngOnDestroy(): void {\n    this.subscriptions.unsubscribe();\n  }\n  private handleStorageEvent(e: StorageEvent) {\n    if (e.key === 'kukai-wallet' && !this.embedded) {\n      if (e.oldValue && !e.newValue) {\n        window.location.reload();\n      } else if (!e.oldValue && e.newValue) {\n        setTimeout(async () => {\n          await this.router.navigate(['']);\n          window.location.reload();\n        }, 10000);\n      }\n    }\n  }\n  returnLanguage(lang: string) {\n    // this.translate.use(lang);\n    // console.log('lang ', lang);\n\n    const map: Map<string, string> = new Map([\n      ['en', 'English'],\n      ['cn', ''],\n      ['es', 'Espaol'],\n      ['fr', 'Franais'],\n      ['ru', 'P'],\n      ['jp', ''],\n      ['kor', ''],\n      ['por', 'Portugus'],\n      ['swe', 'Svenska']\n    ]);\n\n    const language = map.get(lang);\n\n    return language;\n  }\n  checkEmbedded() {\n    const path = this.location.path();\n    this.embedded = path.startsWith('/embedded');\n    const bg = this.embedded ? 'none' : '#f8f9fa';\n    if (!!this.embedded) {\n      document.documentElement.style.setProperty('--base-background-color', bg); // recheck\n      const resize = () => {\n        if (document.body.clientWidth < 540) {\n          document.documentElement.style.fontSize = '75%';\n        } else if (document.body.clientWidth < 650) {\n          document.documentElement.style.fontSize = '87.5%';\n        } else {\n          document.documentElement.style.fontSize = '100%';\n        }\n      };\n      window.addEventListener('resize', resize);\n      window.addEventListener('load', resize);\n      resize();\n    }\n  }\n  setLanguage(lang) {\n    window.localStorage.setItem('languagePreference', lang);\n    this.translate.use(lang);\n  }\n}\n","import { Pipe, PipeTransform } from '@angular/core';\n\n@Pipe({\n  name: 'truncate'\n})\nexport class TruncatePipe implements PipeTransform {\n  transform(value?: string, args?: number, endTrail?: boolean): string {\n    const limit = args ? args : 3;\n    const trail = '...';\n\n    let returnString;\n\n    if (endTrail && value.length > limit) {\n      const endTrailstring = value.slice(-limit);\n      returnString = value.substring(0, limit) + trail + endTrailstring;\n\n      return returnString;\n    } else {\n      return value.length > limit ? value.substring(0, limit) + trail : value;\n    }\n  }\n}\n","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { HttpClientModule, HttpClient } from '@angular/common/http';\nimport { AppRoutingModule } from './app-routing.module';\n\n// From Angular Material\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\n\n// For translation\nimport { TranslateModule, TranslateLoader } from '@ngx-translate/core';\nimport { TranslateHttpLoader } from '@ngx-translate/http-loader';\n\n// External libraries\nimport { AppComponent } from './app.component';\n\n// Services\nimport { MessageService } from './services/message/message.service';\nimport { WalletService } from './services/wallet/wallet.service';\nimport { ActivityService } from './services/activity/activity.service';\nimport { BalanceService } from './services/balance/balance.service';\nimport { EncryptionService } from './services/encryption/encryption.service';\nimport { ImportService } from './services/import/import.service';\nimport { TzrateService } from './services/tzrate/tzrate.service';\nimport { ExportService } from './services/export/export.service';\nimport { DelegateService } from './services/delegate/delegate.service';\nimport { InputValidationService } from './services/input-validation/input-validation.service';\nimport { LedgerService } from './services/ledger/ledger.service';\nimport { BeaconService } from './services/beacon/beacon.service';\nimport { TorusService } from './services/torus/torus.service';\nimport { EmbeddedAuthService } from './services/embedded-auth/embedded-auth.service';\nimport { TokenBalancesService } from './services/token-balances/token-balances.service';\nimport { SubjectService } from './services/subject/subject.service';\nimport { UnlockableService } from './services/unlockable/unlockable.service';\nimport { CoordinatorService } from './services/coordinator/coordinator.service';\nimport { OperationService } from './services/operation/operation.service';\n\n// View components\nimport { StartComponent } from './components/views/start/start.component';\nimport { NewWalletComponent } from './components/views/start/login-types/new-wallet/new-wallet.component';\nimport { MnemonicImportComponent } from './components/views/start/login-types/mnemonic-import/mnemonic-import.component';\nimport { MessagesComponent } from './components/ui/messages/messages.component';\nimport { ModalComponent } from './components/modals/modal.component';\nimport { HeaderComponent } from './components/views/layouts/header/header.component';\nimport { ConnectLedgerComponent } from './components/views/start/login-types/connect-ledger/connect-ledger.component';\nimport { FooterComponent } from './components/views/layouts/footer/footer.component';\nimport { AccountViewComponent } from './components/views/logged-in/account-view/account-view.component';\nimport { ActivityComponent } from './components/views/logged-in/account-view/activity/activity.component';\nimport { EventComponent } from './components/views/logged-in/account-view/activity/event/event.component';\nimport { NftsComponent } from './components/views/logged-in/account-view/nfts/nfts.component';\nimport { PendingComponent } from './components/views/logged-in/account-view/pending/pending.component';\nimport { BalancesComponent } from './components/views/logged-in/account-view/balances/balances.component';\nimport { BalanceTokenComponent } from './components/views/logged-in/account-view/balances/token/balance-token.component';\nimport { SpinnerComponent } from './components/ui/spinner/spinner.component';\nimport { AgreementComponent } from './components/views/start/agreement/agreement.component';\nimport { TermsOfUseComponent } from './components/views/start/agreement/terms-of-use/terms-of-use.component';\nimport { PrivacyPolicyComponent } from './components/views/start/agreement/privacy-policy/privacy-policy.component';\nimport { EmbeddedComponent } from './components/views/embedded/embedded.component';\nimport { SigninComponent } from './components/views/embedded/signin/signin.component';\nimport { CardComponent } from './components/views/embedded/card/card.component';\nimport { SendButtonComponent } from './components/ui/button/basic/send/send-button.component';\nimport { TokenDetail } from './components/modals/send/detail/token-detail.component';\nimport { AlertComponent } from './components/modals/alert/alert.component';\nimport { SpinnerLegacyComponent } from './components/ui/spinner/legacy/spinner-legacy.component';\nimport { SpinnerNewComponent } from './components/ui/spinner/new/spinner-new.component';\nimport { AccountDropdownComponent } from './components/ui/dropdown/account/account-dropdown.component';\nimport { MobileMenuDropdownComponent } from './components/ui/dropdown/mobile-menu/mobile-menu.component';\nimport { P404Component } from './components/views/error/404.component';\nimport { P500Component } from './components/views/error/500.component';\n\n// Modules\nimport { LoggedInModule } from './components/views/logged-in/logged-in.module';\n\n// Pipes\nimport { ErrorHandlingPipe } from './pipes/error-handling.pipe';\nimport { TruncatePipe } from './pipes/truncate.pipe';\nimport { TimeAgoPipe } from './pipes/time-ago.pipe';\nimport { DeeplinkService } from './services/deeplink/deeplink.service';\nimport { RemoveCommaPipe } from './pipes/remove-comma.pipe';\n\n// AoT requires an exported function for factories\nexport function HttpLoaderFactory(http: HttpClient) {\n  return new TranslateHttpLoader(http, './assets/i18n/', '.json');\n}\n\n@NgModule({\n  declarations: [\n    AppComponent,\n\n    // View components\n    NewWalletComponent,\n    StartComponent,\n    MnemonicImportComponent,\n    MessagesComponent,\n    ModalComponent,\n    HeaderComponent,\n    P404Component,\n    P500Component,\n    SendButtonComponent,\n    ConnectLedgerComponent,\n    FooterComponent,\n    AccountViewComponent,\n    ActivityComponent,\n    EventComponent,\n    NftsComponent,\n    PendingComponent,\n    BalancesComponent,\n    BalanceTokenComponent,\n    SpinnerComponent,\n    AgreementComponent,\n    TermsOfUseComponent,\n    PrivacyPolicyComponent,\n    EmbeddedComponent,\n    SigninComponent,\n    CardComponent,\n    TokenDetail,\n    SpinnerLegacyComponent,\n    SpinnerNewComponent,\n    AccountDropdownComponent,\n    MobileMenuDropdownComponent,\n    SpinnerLegacyComponent,\n\n    // Modals\n    ModalComponent,\n    AlertComponent,\n\n    // Pipes\n    ErrorHandlingPipe,\n    TruncatePipe,\n    TimeAgoPipe\n  ],\n  imports: [\n    BrowserModule,\n    BrowserAnimationsModule,\n    FormsModule,\n    AppRoutingModule,\n    HttpClientModule,\n    LoggedInModule,\n    TranslateModule.forRoot({\n      loader: {\n        provide: TranslateLoader,\n        useFactory: HttpLoaderFactory,\n        deps: [HttpClient]\n      }\n    }) // lazy loading will need TranslateModule.forChild() in the lazy loaded modules\n  ],\n  providers: [\n    // Services\n    MessageService,\n    WalletService,\n    ActivityService,\n    EncryptionService,\n    BalanceService,\n    ImportService,\n    TzrateService,\n    CoordinatorService,\n    OperationService,\n    ExportService,\n    DelegateService,\n    InputValidationService,\n    LedgerService,\n    BeaconService,\n    TorusService,\n    EmbeddedAuthService,\n    SubjectService,\n    TokenBalancesService,\n    DeeplinkService,\n    UnlockableService,\n    // Pipes\n    ErrorHandlingPipe,\n    TruncatePipe,\n    TimeAgoPipe,\n    RemoveCommaPipe\n  ],\n  bootstrap: [AppComponent]\n})\nexport class AppModule {}\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n  window.console.log = function () {};\n}\n\nplatformBrowserDynamic()\n  .bootstrapModule(AppModule)\n  .catch((err) => console.log(err));\n","var map = {\n\t\"./af\": 58685,\n\t\"./af.js\": 58685,\n\t\"./ar\": 254,\n\t\"./ar-dz\": 4312,\n\t\"./ar-dz.js\": 4312,\n\t\"./ar-kw\": 32614,\n\t\"./ar-kw.js\": 32614,\n\t\"./ar-ly\": 18630,\n\t\"./ar-ly.js\": 18630,\n\t\"./ar-ma\": 28674,\n\t\"./ar-ma.js\": 28674,\n\t\"./ar-sa\": 49032,\n\t\"./ar-sa.js\": 49032,\n\t\"./ar-tn\": 24730,\n\t\"./ar-tn.js\": 24730,\n\t\"./ar.js\": 254,\n\t\"./az\": 53052,\n\t\"./az.js\": 53052,\n\t\"./be\": 60150,\n\t\"./be.js\": 60150,\n\t\"./bg\": 63069,\n\t\"./bg.js\": 63069,\n\t\"./bm\": 13466,\n\t\"./bm.js\": 13466,\n\t\"./bn\": 18516,\n\t\"./bn-bd\": 90557,\n\t\"./bn-bd.js\": 90557,\n\t\"./bn.js\": 18516,\n\t\"./bo\": 26273,\n\t\"./bo.js\": 26273,\n\t\"./br\": 9588,\n\t\"./br.js\": 9588,\n\t\"./bs\": 19815,\n\t\"./bs.js\": 19815,\n\t\"./ca\": 83331,\n\t\"./ca.js\": 83331,\n\t\"./cs\": 21320,\n\t\"./cs.js\": 21320,\n\t\"./cv\": 72219,\n\t\"./cv.js\": 72219,\n\t\"./cy\": 68266,\n\t\"./cy.js\": 68266,\n\t\"./da\": 66427,\n\t\"./da.js\": 66427,\n\t\"./de\": 67435,\n\t\"./de-at\": 52871,\n\t\"./de-at.js\": 52871,\n\t\"./de-ch\": 12994,\n\t\"./de-ch.js\": 12994,\n\t\"./de.js\": 67435,\n\t\"./dv\": 82357,\n\t\"./dv.js\": 82357,\n\t\"./el\": 95649,\n\t\"./el.js\": 95649,\n\t\"./en-au\": 59961,\n\t\"./en-au.js\": 59961,\n\t\"./en-ca\": 10860,\n\t\"./en-ca.js\": 10860,\n\t\"./en-gb\": 3924,\n\t\"./en-gb.js\": 3924,\n\t\"./en-ie\": 70864,\n\t\"./en-ie.js\": 70864,\n\t\"./en-il\": 91579,\n\t\"./en-il.js\": 91579,\n\t\"./en-in\": 30940,\n\t\"./en-in.js\": 30940,\n\t\"./en-nz\": 16181,\n\t\"./en-nz.js\": 16181,\n\t\"./en-sg\": 44301,\n\t\"./en-sg.js\": 44301,\n\t\"./eo\": 85291,\n\t\"./eo.js\": 85291,\n\t\"./es\": 54529,\n\t\"./es-do\": 53764,\n\t\"./es-do.js\": 53764,\n\t\"./es-mx\": 12584,\n\t\"./es-mx.js\": 12584,\n\t\"./es-us\": 63425,\n\t\"./es-us.js\": 63425,\n\t\"./es.js\": 54529,\n\t\"./et\": 35203,\n\t\"./et.js\": 35203,\n\t\"./eu\": 70678,\n\t\"./eu.js\": 70678,\n\t\"./fa\": 83483,\n\t\"./fa.js\": 83483,\n\t\"./fi\": 96262,\n\t\"./fi.js\": 96262,\n\t\"./fil\": 52521,\n\t\"./fil.js\": 52521,\n\t\"./fo\": 34555,\n\t\"./fo.js\": 34555,\n\t\"./fr\": 63131,\n\t\"./fr-ca\": 88239,\n\t\"./fr-ca.js\": 88239,\n\t\"./fr-ch\": 21702,\n\t\"./fr-ch.js\": 21702,\n\t\"./fr.js\": 63131,\n\t\"./fy\": 267,\n\t\"./fy.js\": 267,\n\t\"./ga\": 23821,\n\t\"./ga.js\": 23821,\n\t\"./gd\": 71753,\n\t\"./gd.js\": 71753,\n\t\"./gl\": 4074,\n\t\"./gl.js\": 4074,\n\t\"./gom-deva\": 92762,\n\t\"./gom-deva.js\": 92762,\n\t\"./gom-latn\": 5969,\n\t\"./gom-latn.js\": 5969,\n\t\"./gu\": 82809,\n\t\"./gu.js\": 82809,\n\t\"./he\": 45402,\n\t\"./he.js\": 45402,\n\t\"./hi\": 315,\n\t\"./hi.js\": 315,\n\t\"./hr\": 10410,\n\t\"./hr.js\": 10410,\n\t\"./hu\": 38288,\n\t\"./hu.js\": 38288,\n\t\"./hy-am\": 67928,\n\t\"./hy-am.js\": 67928,\n\t\"./id\": 71334,\n\t\"./id.js\": 71334,\n\t\"./is\": 86959,\n\t\"./is.js\": 86959,\n\t\"./it\": 34864,\n\t\"./it-ch\": 51124,\n\t\"./it-ch.js\": 51124,\n\t\"./it.js\": 34864,\n\t\"./ja\": 36141,\n\t\"./ja.js\": 36141,\n\t\"./jv\": 29187,\n\t\"./jv.js\": 29187,\n\t\"./ka\": 42136,\n\t\"./ka.js\": 42136,\n\t\"./kk\": 94332,\n\t\"./kk.js\": 94332,\n\t\"./km\": 18607,\n\t\"./km.js\": 18607,\n\t\"./kn\": 84305,\n\t\"./kn.js\": 84305,\n\t\"./ko\": 70234,\n\t\"./ko.js\": 70234,\n\t\"./ku\": 16003,\n\t\"./ku.js\": 16003,\n\t\"./ky\": 75061,\n\t\"./ky.js\": 75061,\n\t\"./lb\": 32786,\n\t\"./lb.js\": 32786,\n\t\"./lo\": 66183,\n\t\"./lo.js\": 66183,\n\t\"./lt\": 50029,\n\t\"./lt.js\": 50029,\n\t\"./lv\": 24169,\n\t\"./lv.js\": 24169,\n\t\"./me\": 68577,\n\t\"./me.js\": 68577,\n\t\"./mi\": 68177,\n\t\"./mi.js\": 68177,\n\t\"./mk\": 50337,\n\t\"./mk.js\": 50337,\n\t\"./ml\": 65260,\n\t\"./ml.js\": 65260,\n\t\"./mn\": 52325,\n\t\"./mn.js\": 52325,\n\t\"./mr\": 14695,\n\t\"./mr.js\": 14695,\n\t\"./ms\": 75334,\n\t\"./ms-my\": 37151,\n\t\"./ms-my.js\": 37151,\n\t\"./ms.js\": 75334,\n\t\"./mt\": 63570,\n\t\"./mt.js\": 63570,\n\t\"./my\": 97963,\n\t\"./my.js\": 97963,\n\t\"./nb\": 88028,\n\t\"./nb.js\": 88028,\n\t\"./ne\": 86638,\n\t\"./ne.js\": 86638,\n\t\"./nl\": 50302,\n\t\"./nl-be\": 66782,\n\t\"./nl-be.js\": 66782,\n\t\"./nl.js\": 50302,\n\t\"./nn\": 33501,\n\t\"./nn.js\": 33501,\n\t\"./oc-lnc\": 50563,\n\t\"./oc-lnc.js\": 50563,\n\t\"./pa-in\": 50869,\n\t\"./pa-in.js\": 50869,\n\t\"./pl\": 65302,\n\t\"./pl.js\": 65302,\n\t\"./pt\": 49687,\n\t\"./pt-br\": 74884,\n\t\"./pt-br.js\": 74884,\n\t\"./pt.js\": 49687,\n\t\"./ro\": 79107,\n\t\"./ro.js\": 79107,\n\t\"./ru\": 33627,\n\t\"./ru.js\": 33627,\n\t\"./sd\": 30355,\n\t\"./sd.js\": 30355,\n\t\"./se\": 83427,\n\t\"./se.js\": 83427,\n\t\"./si\": 43906,\n\t\"./si.js\": 43906,\n\t\"./sk\": 54590,\n\t\"./sk.js\": 54590,\n\t\"./sl\": 20184,\n\t\"./sl.js\": 20184,\n\t\"./sq\": 56361,\n\t\"./sq.js\": 56361,\n\t\"./sr\": 78965,\n\t\"./sr-cyrl\": 81287,\n\t\"./sr-cyrl.js\": 81287,\n\t\"./sr.js\": 78965,\n\t\"./ss\": 25456,\n\t\"./ss.js\": 25456,\n\t\"./sv\": 70451,\n\t\"./sv.js\": 70451,\n\t\"./sw\": 77558,\n\t\"./sw.js\": 77558,\n\t\"./ta\": 51356,\n\t\"./ta.js\": 51356,\n\t\"./te\": 73693,\n\t\"./te.js\": 73693,\n\t\"./tet\": 21243,\n\t\"./tet.js\": 21243,\n\t\"./tg\": 42500,\n\t\"./tg.js\": 42500,\n\t\"./th\": 55768,\n\t\"./th.js\": 55768,\n\t\"./tk\": 77761,\n\t\"./tk.js\": 77761,\n\t\"./tl-ph\": 35780,\n\t\"./tl-ph.js\": 35780,\n\t\"./tlh\": 29590,\n\t\"./tlh.js\": 29590,\n\t\"./tr\": 33807,\n\t\"./tr.js\": 33807,\n\t\"./tzl\": 93857,\n\t\"./tzl.js\": 93857,\n\t\"./tzm\": 60654,\n\t\"./tzm-latn\": 8806,\n\t\"./tzm-latn.js\": 8806,\n\t\"./tzm.js\": 60654,\n\t\"./ug-cn\": 30845,\n\t\"./ug-cn.js\": 30845,\n\t\"./uk\": 19232,\n\t\"./uk.js\": 19232,\n\t\"./ur\": 47052,\n\t\"./ur.js\": 47052,\n\t\"./uz\": 77967,\n\t\"./uz-latn\": 32233,\n\t\"./uz-latn.js\": 32233,\n\t\"./uz.js\": 77967,\n\t\"./vi\": 98615,\n\t\"./vi.js\": 98615,\n\t\"./x-pseudo\": 12320,\n\t\"./x-pseudo.js\": 12320,\n\t\"./yo\": 31313,\n\t\"./yo.js\": 31313,\n\t\"./zh-cn\": 64490,\n\t\"./zh-cn.js\": 64490,\n\t\"./zh-hk\": 55910,\n\t\"./zh-hk.js\": 55910,\n\t\"./zh-mo\": 98262,\n\t\"./zh-mo.js\": 98262,\n\t\"./zh-tw\": 44223,\n\t\"./zh-tw.js\": 44223\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 46700;"]}